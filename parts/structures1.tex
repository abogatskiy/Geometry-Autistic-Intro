% !TEX root = ../geom_autistic_intro.tex
\chapter{Klein Geometry}

\section{Klein geometry}

Felix Klein saw geometry as the study of invariants under actions of Lie groups. This led him to start the famous Erlangen program for the classification of all ``symmetric'' geometries corresponding to simple Lie groups. He noticed that each interesting symmetric geometry is based on a connected manifold with a \emph{transitive} action of a Lie group $G$ of ``motions'', and moreover, all properties of figures studied in the geometry remain invariant under these motions. For example, in the case of Euclidean geometry, the properties studied are angle and length, and the group is the group of rigid motions. Thus Klein unified a wide range of classical geometries by \emph{defining} a geometry as consisting of a Lie group $G$, a smooth manifold $M$ with a smooth, faithful, and transitive action of $G$. This means that Klein geometries are a special kind of principal bundles. We shall not require faithfulness in our treatment here.

Let $H\sub G$ be a closed Lie subgroup and consider the action $H\acts G$ by right translation. Let $K$ be the maximal normal subgroup of $G$ lying inside $H$. By the Initial Subgroup Theorem~\ref{thm initial subgroup}, $K$ is a weakly embedded Lie subgroup of $G$. Since $H$ is closed, the closure $\wb{K}$ is also a normal subgroup of $G$ lying inside $H$. By maximality, we conclude that $K$ is closed, and hence embedded, so $K\sub H\sub G$. By Corollary~\ref{cor 6.5.3 RS1}(1), the canonical map $\pi:G\slash K\to G\slash H$ is a \gls{pfb} with fiber $H\slash K$, inducing a diffeomorphism
\[(G\slash K)\slash (H\slash K)\to G\slash H\]
commuting with the canonical left $G\slash K$-actions.

\begin{xca}
    Show that if a homogeneous space $G\slash H$ contains multiple connected components, then each component is a homogeneous space of $G$ with conjugate stabilizer subgroups.
\end{xca}

\begin{defn}[Klein geometry]\index{Klein geometry}
    A Klein geometry is a pair $(G,H)$, where $G$ is a Lie group and $H\sub G$ is a closed subgroup such that the homogeneous space $G\slash H$ is connected. $G$ is called the \emph{principal group} of the geometry. The \emph{kernel} of the Klein geometry is the maximal normal subgroup $K$ of $G$ lying inside $H$, i.e., the set of all elements of $G$ that act trivially on $G\slash H$. The Klein geometry is called \emph{effective} (or faithful) if $K=\{e\}$ and \emph{locally effective} if $K$ is discrete. \index{Klein geometry!Locally effective}\index{Klein geometry!Effective}\index{Kernel of a Klein geometry}
    % A Klein geometry is \emph{geometrically oriented} if $G$ is connected. The homogeneous space $M=G\slash H$ is called the \emph{space of the Klein geometry}. It is called \emph{reductive} if the adjoint representation of $G$, viewed as a $\Ad(H)$-module, decomposes into a direct sum $\frakg=\frakh\oplus \frakm$, where $\frakg$ and $\frakh$ are the Lie algebras of $G$ and $H$, respectively. 
\end{defn}

\begin{rem}
    \begin{enumerate}
        \item The same space $M=G\slash H$ might be the space of multiple Klein geometries, so a Klein geometry is not  just a homogeneous space, but rather a principal bundle of the form $G\to G\slash H$. 
        \item Under this definition, $M=G\slash H$ has a canonical basepoint given by the coset of the identity, $[e]=eH$. An alternative definition of a Klein geometry is as a manifold $M$ with a transitive $G$-action of orbit type $[H]$, in which case the subgroup $H$ is determined only up to conjugacy, and a choice of basepoint is an additional structure. We will follow the first definition out of convenience.
        \item Every Klein geometry is a \emph{tautological principal bundle} in the sense that the fiber over $gH\in G\slash H$ is the coset $gH\subset G$ itself. 
    \end{enumerate}
\end{rem}



If $(G,H)$ is a Klein geometry with kernel $K$, then, for any closed subgroup $N<K$ that is normal in $G$, the pair $(G\slash N,H\slash N)$ is also a Klein geometry with the same space $(G\slash N)\slash(H\slash N)\cong G\slash H$. Of course, these geometries are all ineffective except when $N=K$. This leads to the following.

\begin{defn}[Associated effective Klein geometry]
    if $(G,H)$ is a Klein geometry with kernel $K$, then $(G\slash K,H\slash K)$ is called the associated effective Klein geometry.
\end{defn}

More generally, if $K_0$ is the identity component of $K$, then $(G\slash K_0,H\slash K_0)$ is a locally effective Klein geometry with kernel $K\slash K_0$.

\begin{rem}
    Despite the space of the Klein geometry being ``independent'' of its kernel, ineffective Klein geometries are still important to study, seeing as many important phenomena such as spin can only be described as ineffective geometries. Still, all geometrically important examples of Klein geometries are locally effective. Nevertheless, non-locally effective descriptions still often show up because they are easier to formulate. 
\end{rem}

% The next result shows that every Klein geometry $(G,H)$ determines a geometrically oriented geometry $(G_0,H')$ with the same space but a possibly smaller principal group.

% \begin{prop}[{{\cite[Prop.~3.5]{Sharpe}}}]
%     Let $(G,H)$ be a Klein geometry. Let $G_0$ be the identity component of $G$ and set $H'\coloneqq H\cap G_0$. Then
%     \begin{enumerate}[label=(\roman*)]
%         \item $G=G_0\cdot H$,
%         \item $G\slash H=G_0\slash H'$.
%     \end{enumerate}
% \end{prop}
% \begin{proof}
%     (i) It suffices to show that $G\subset G_0\cdot H$. Let $g\in G$. Since $G\slash H$ is connected, there is a path $gH\leadsto eH$. Since the map $G\to G\slash H$ is a bundle, we can lift this path to a path $g\leadsto h$ where $h\in H$. Thus $gh^{-1}\in G_0$ and $g=(gh^{-1})h\in G_0\cdot H$.

%     (ii) By (i) the map $j:G_0\to G\slash H$ is surjective. Suppose $g_1,g_2\in G_0$. Then $g_2^{-1}g_1\in G_0$ and
%     \[j(g_1)=j(g_2)\Leftrightarrow g_1\in g_2H\Leftrightarrow g_2^{-1}g_1\in H.\]
%     Thus $j$ induces a diffeomorphism $G_0\slash H'\to G\slash H$.
% \end{proof}



Much like with principal bundles, we shall follow up the original geometric definition by a bundle definition. To motivate it, we recall the following natural data associated to a Klein geometry $(G,H)$:
\begin{enumerate}[label=(\alph*)]
    \item the connected homogeneous manifold $M=G\slash H$;
    \item the principal $H$-bundle $G\to G\slash H$;
    \item the Maurer-Cartan form $\theta_G:\T G\to \frakg$ satisfying
    \begin{enumerate}[label=(\roman*)]
        \item $\theta_G$ is a linear isomorphism on each fiber,
        \item $\rmR_h^\ast \theta_G=\Ad_h^{-1}\theta_G$ for all $h\in H$,
        \item $\theta_G(X_\rmL)=X$ for any $X\in \frakh$ and corresponding left-invariant vector field $X_\rmL$. These vector fields should be thought of as $H$-invariant \emph{vertical} (tangent to the fibers) vector fields on the principal bundle.
    \end{enumerate}
\end{enumerate}

The notion of isomorphism of Klein geometries is exactly that of isomorphisms of \glspl{pfb}, with the extra requirement that they be Lie group isomorphisms (which amounts to the preservation of identity).



\begin{defn}[Isomorphic Klein geometries]
    An isomorphism between two Klein geometries $(G,H)$ and $(G',H')$ is a Lie group homomorphism $\vartheta:G\to G'$ such that $\vartheta(H)=H'$.
\end{defn}

In particular, $(G,H)\cong (G,gHg^{-1})$ is an isomorphism that effectively changes the basepoint of the homogeneous space from $[e]$ to $[g]$.

\begin{example}
    \begin{enumerate}
        \item $(\Aff_n(\bbK), \GL_n(\bbK))$ is the affine geometry on $\bbK^n$, and the bundle $\Aff_n(\bbK)\to \bbA(\bbK^n)$ is the frame bundle of the affine space $\bbA(\bbK^n)$. Similarly, $(\Aff_n^+(\bbK), \GL_n^+(\bbK))$ is the affine geometry with an orientation.

        \item $(\SE_n,\SO_n)$ is the Euclidean geometry (``school geometry'') of orientation-preserving congruences, or rigid motions, on $\bbA(\bbR^n)$. The corresponding principal bundle $\SE_n\to \bbA(\bbR^n)$ is the bundle of orthonormal frames at every point of the Euclidean space. This adds a metric to the real affine geometry.

        \item Let $H$ be the subgroup of $\GL_n^+(\bbR)$ consisting of matrices $A$ such that $AA^T=\lambda I$ for some $\lambda>0$. Every such matrix has the form $\sqrt{\lambda}R$ where $R\in\SO_n$ is a rotation matrix, so this is precisely the group of similarity transformations in Euclidean geometry. Then the Klein geometry $(H\ltimes \bbR^n,H)$ can be called the ``geometry of similarity'' on $\bbR^n$.
        
        \item The space of $(\SL_2(\bbR),\SO_2)$ is the \emph{hyperbolic half-plane} $\bbC^+=\{z\in \bbC\mid \Im z>0\}$ from Example~\ref{ex siegel upper half-space} with the transitive action of real \glspl{flt} $\SL_2(\bbR)$ acting by \index{Hyperbolic half-plane}
        \[\begin{pmatrix}
            a&b\\c&d
        \end{pmatrix}\cdot z=\frac{az+b}{cz+d}.\]
        Note that the negative identity $-\rmI_2$ acts on $\bbC^+$ trivially. Thus, to be more precise, the \emph{M\"obius group} is the image of this homomorphism, which is the projective special linear group $\PSL_2(\bbR)=\SL_2(\bbR)\slash \{\pm \rmI_2\}$. It is also isomorphic to $\PGL^+_2(\bbR)=\GL^+_2(\bbR)\slash (\bbR^\times\cdot \rmI_2)$. Thus, the hyperbolic plane is also a homogeneous space of type $(\PGL^+_2(\bbR),\SO_2)=(\PSL_2(\bbR),\SO_2)$. The latter geometry is effective.

        \item Let $H<\GL_{n+1}(\bbR)$ be the subgroup
        \[H=\left\{\begin{pmatrix}
            A& \bf{x}\\ \bf{0}_n^T &\lambda
        \end{pmatrix}
        \middle| A\in\GL_n(\bbR),\bf{x}\in\bbR^n,\lambda\in \bbR^\times \right\}.\]
        Then $(\GL_{n+1}(\bbR),H)$ is the \emph{projective geometry} on $\RP^n$ with the standard action of $\GL_{n+1}(\bbR)$ on lines in $\bbR^{n+1}$. Its effective analog is $(\PGL_{n+1}(\bbR),H\slash \bbR^\times)$.
        
        \item $(\SO_{n+1},\Or_n)$, with $\Or_n$ embedded via
        \[A\mapsto \begin{pmatrix}
            A& \bf{0}_n\\\bf{0}_n^T & (\det A)^{-1}
        \end{pmatrix},\]
        is the \emph{elliptic geometry} on $\RP^n$ (since great circles on the sphere intersect at two points, their images on $\RP^n$ intersect only at one) with Euclidean transformations acting on lines in $\bbR^{n+1}$. This adds a metric to the projective geometry: the distance between two lines is proportional to the angle between them, and is preserved by the symmetry group.

        \item $(\Or_{1,n}^+\ltimes\bbR^n,\Or_{1,n}^+)$ is the \emph{Minkowski geometry} on $\bbR^n$.

        \item Recall that under the standard Minkowski metric of signature $(1,n+1)$ on $\bbR^{n+2}$, the light cone $C=\{x\mid \lVert x\rVert=0\}$ is homogeneous in the sense that if $x\in C$, then $\lambda x\in C$ for all $\lambda\in\bbR$. As we will show in \S\ref{sec: dS and AdS}, the space $C\slash \sim\cong\bbS^n$ of null lines through the origin then inherits a transitive $\Or_{1,n+1}$-action with stabilizers isomorphic to the \emph{Poincar\'e conformal group} $P\cong \CO_n\ltimes \bbR^n$. This is the \emph{conformal geometry} on $\bbS^n$. In the case $n=2$ this is the \emph{M\"obius sphere geometry}.

        \item If $H<G=\Or_{2,2}^+$ (where the metric is $\mathrm{diag}(-1,1,1,-1)$) is the stabilizer of the line spanned by $(1,1,0,0)$, then $Q=G\slash H$ can be identified with the \emph{projective completion} of a one-sheeted hyperboloid in $\bbR^3$ given by $x_1^2+x_2^2-x_3^3=1$, and so is diffeomorphic to the torus $\bbT^2$. This is called the \emph{Lie sphere geometry} on the \emph{Lie quadric} $Q$. In this geometry lines, circles and points are treated on equal footing: lines and points are circles of infinite and zero radius, respectively. The symmetry group can transform points into circles etc. This generalizes to $\Or_{n+2,2}$.

        \item $(\SL_2(\bbC),H)$, where $H$ is the stabilizer of a point of $\CP^1$, then this is the geometry of a complex projective line on $\bbS^2$ and $\SL_2(\bbC)$ is the group of \glspl{flt}.
    \end{enumerate}
\end{example}









\section{Locally Klein geometry}\label{sec: locally Klein geom}


\begin{defn}[Klein manifold]
    A Klein manifold is a triple $(\Gamma,G,H, M)$, where $H\sub G$ is a closed subgroup, $\Gamma\sub G$ is a discrete subgroup, and $M\subset G\slash H$ is an open $\Gamma$-invariant subset such that the action of $\Gamma$ on $M$ obtained by restriction of the action of $G$ on $G\slash H$ is properly discontinuous, and such that the double coset space $\Gamma\bslash G\slash H$ is connected. The pair $(G,H)$ is called the \emph{model geometry} of the Klein manifold. If $M=G\slash H$, the Klein manifold is called \emph{complete}.
\end{defn}

We will usually be interested only in complete Klein manifolds, and so will describe them simply as triples $(\Gamma,G,H)$. Note that we do not require $G\slash H$ to be connected. However, the following exercise shows that we can always replace $(\Gamma,G,H)$ by $(\Gamma',G',H)$ with the same space, for which $(G',H)$ is a Klein geometry.

\begin{xca}
    Let $(\Gamma,G,H)$ be a complete Klein manifold and set $G'=G_0\cdot H$, where $G_0$ is the identity component, and $\Gamma'=G'\cap \Gamma$. Show that $G'$ is a Lie group, $G'\slash H$ is connected, and the inclusion $G'\hookrightarrow G$ induces a diffeomorphism $\Gamma'\bslash G'\to \Gamma\bslash G$.
\end{xca}

Klein manifolds can also be defined as principal bundles. This depends on the following lemma.

\begin{lem}[{{\cite[Lem.~3.3.12]{Sharpe}}}]\label{lem 3.3.12 Sharpe}
    Let $\Gamma$ and $H$ be Lie groups with commuting left and right  (respectively) free proper actions on a smooth manifold $P$. Then the properness of the following two actions is simultaneous: 
    \[(\Gamma\bslash P)\lacts H\text{ is proper}\Leftrightarrow \Gamma\acts (P\slash H)\text{ is proper}.\]
\end{lem}
\begin{proof}
    By symmetry it suffices to prove only the forward implication. 
    
    \emph{Step 1.} The simultaneous action $((\Gamma\times H)\times P\to P$ by $((g,h),p)\mapsto gph^{-1}$ is proper. Let $A,B\subset P$ be compact and let $C=\{(g,h)\in \Gamma\times H\mid gAh\cap B\neq \varnothing\}$. We must show that $C$ is compact, and it suffices to show it is sequentially compact (every sequence has a convergent subsequence).

    Let $(g_i,h_i)\in\Gamma\times H$ be a sequence in $C$. Let $A'$ and $B'$ be the (compact) images of $A$ and $B$, respectively, in $\Gamma\bslash P$. Since the $H$-action on $\Gamma\bslash P$ is proper by assumption, the set $C'=\{h\in H\mid A'h\cap B'\neq \varnothing\}$ is compact. Moreover it is clear that $h_i\in C'$, hence $(h_i)$ has a convergent subsequence. Replacing $(g_i,h_i)\in C$ by the corresponding subsequence, we may assume that 
    \[\lim h_i=h_\infty\in C'.\]
    Since $(g_i,h_i)\in C$ we may choose points $a_i\in A$ and $b_i\in B$ such that $g_ia_ih_i=b_i$. Since $A$ and $B$ are compact, $(a_i)$ and $(b_i)$ have convergent subsequences. Replacing $(g_i,h_i)\in C$ by a corresponding subsequence, we obtain
    \[\lim a_i=a_\infty\in A,\quad \lim b_i=b_\infty\in B.\]
    Now let $K\subset P$ be a compact neighborhood of $a_\infty h_\infty$ so that $a_ih_i\in K$ for sufficiently large $i$. Since $\Gamma\times P\to P$ is a proper action, the set
    \[C''=\{g\in\Gamma\mid b_\infty\in gK \}=\{g\in\Gamma\mid g^{-1}b_\infty\in K\}\]
    is compact. Now $\lim g_i^{-1}b_\infty=\lim g_i^{-1} b_i=\lim a_i h_i=a_\infty h_\infty\in K$. Thus $g_i^{-1}b_\infty\in K$ for sufficiently large $i$. Thus $(g_i)$ has a convergent subsequence, and we may pass to this subsequence to obtain 
    \[\lim g_i=g_\infty \in\Gamma.\]
    It follows that the original sequence $(g_i,h_i)\in\Gamma\times H$ has a convergent subsequence, and hence $C$ is sequentially compact.

    \emph{Step 2.} The action $\Gamma\times (P\slash H)\to P\slash H$ is proper.

    Let $A,B\subset P\slash H$ be compact. We must show that $\{g\in\Gamma\mid gA\cap B\neq \varnothing\}$ is compact. If we write $A=\bigcup_{1\leq i\leq a}A_i$, $B=\bigcup_{1\leq j\leq b}B_j$, with $A_i$ and $B_j$ compact, then it suffices to show that $\{g\in\Gamma\mid gA_i\cap B_j\neq\varnothing\}$ is compact for all $i,j$. Thus it suffices to assume that $A$ and $B$ are small sets (i.e., subordinate to some open covering of $X\slash H$). Since $P\to P\slash H$ is a principal $H$-bundle, there is an open covering of $P\slash H$ over which $P$ is trivialized. We may assume that $A$ and $B$ are subordinate to this cover.

    Applying a local section to $A$ and $B$, we can obtain compact sets $A'$ and $B'$ in $P$ with images $A$ and $B$ in $P\slash H$. Thus, $\{(g,h)\in\Gamma\times H\mid gA' h^{-1}\cap B'\neq \varnothing\}$ is compact. Therefore the image of this set under the canonical projection $\Gamma\times H\to \Gamma$ is also compact; but this image is clearly $\{g\in\Gamma\mid gA\cap B\neq \varnothing\}$.
\end{proof}


This means that if $P$ has two commuting free and proper group actions on it as in the above theorem, we have the following commuting square of principal bundles:
\[\begin{tikzcd}
    P \arrow[r]\arrow[d] & P\slash H\arrow[d]\\
    \Gamma\bslash P\arrow[r] & \Gamma\bslash P\slash H,
\end{tikzcd}\]
where the left and right arrows are principal $\Gamma$-bundles and the top and bottom arrows are principal $H$-bundles.


\begin{cor}[{{\cite[Cor.~3.3.13]{Sharpe}}}]
    If $(\Gamma,G,H)$ is a complete Klein manifold, then the quotient map $\Gamma\bslash G\to \Gamma\bslash G\slash H$ is a principal $H$-bundle.
\end{cor}
\begin{proof}
    Apply Lemma~\ref{lem 3.3.12 Sharpe}, taking $P=G$, and use the left and right translation actions of $\Gamma$ and $H$, respectively. Since $\Gamma$ and $H$ are closed subgroups, these actions are proper. Since $(\Gamma,G,H)$ is a complete Klein manifold, it follows that the action $\Gamma\times(G\slash H)\to G\slash H$ is free and proper. By the preceding lemma, $(\Gamma\bslash G)\times H\to \Gamma\bslash G$ is also free and proper.
\end{proof}

According to the last exercise, the principal bundle $\Gamma\bslash G\to \Gamma\bslash G\slash H$ is the same as the principal bundle $\Gamma'\bslash G'\to \Gamma'\bslash G'\slash H$, where $G'=G_0\cdot H$ and $\Gamma'=G'\cap\Gamma$.

Since the Maurer-Cartan form $\theta_G$ on $G$ is left-invariant, it induces a form $\theta_{\Gamma\bslash G}$ on $\Gamma\bslash G$ with all the same properties. For example, since there is a principal right $H$-action on $\gamma\bslash G$, the \emph{vertical} Killing vector fields $A_\ast$ generated by $A\in\frakh$ correspond to the left-invariant vector fields $A_\rmL$ on $G$, so 
\[\theta_{\Gamma\bslash G}(A_\ast)=A.\]
But more generally, even though there is no $G$-action, left-invariant fields on $G$ project to \emph{constant vector fields} $X_A$ for each $A\in \frakg$ defined by 
\[\theta_{\Gamma\bslash G}(X_A)=A.\]
These vector fields are complete, which is why the form $\theta_{\Gamma\bslash G}$ itself is complete (cf.\ Definition~\ref{def complete form}). Moreover, $\theta_{\Gamma\bslash G}$ establishes a linear isomorphism between each tangent space and $\frakg$, i.e., it defines an absolute parallelism on $\Gamma\bslash G$.  The fact that $\theta_{\Gamma\bslash G}$ satisfies the Maurer-Cartan (structure) equation is equivalent to the statement that $[X_A,X_B]=X_{[A,B]}$, i.e., the map $A\mapsto X_A$ is a Lie algebra homomorphism. This leads to the following generalization of Klein manifolds (however, we will show below that each structure of this kind ends up being a Klein manifold, albeit with a different model geometry).


\begin{defn}[Locally Klein geometry]\index{Locally Klein geometry}
    A locally Klein geometry of type $(G,H)$ is a principal $H$-bundle $\pi:P\to M$ with a $1$-form $\eta\in \Omega^1(P;\frakg)$ such that 
    \begin{enumerate}
        \item $\eta$ is \emph{nondegenerate} in the sense that it defines a bundle isomorphism $\T P\to P\times \frakg$, or an absolute parallelism;
        \item $\eta(A_\ast)=A$ for all $A\in\frakh$, where $A_\ast$ is the Killing vector field generated by $A$ via the principal right action;
        \item satisfies the structure equation $\dd\eta+\frac12[\eta,\eta]=0$.
    \end{enumerate}
    If $\eta$ is complete (i.e., all constant vector fields $\eta^{-1}(A)$ are complete), we call this a \emph{complete locally Klein geometry}.
\end{defn}

\begin{example}
    Restricting the homogeneous principal bundle $G\to G\slash H$ to an open subset $U\subset G\slash H$, we get an incomplete locally Klein geometry.
\end{example}

Note that the group $G$ doesn't directly enter this definition, so we can actually say that the model geometry is $(\frakg,H)$. We will see later that this is exactly the definition of a \emph{flat Cartan geometry}. For now we prove the main theorem of locally Klein geometries, showing that all of them are locally isomorphic to Klein geometries, and in fact the complete ones are coverings of homogeneous spaces.

\begin{thm}[Development/Uniformization Theorem (Ehresmann, 1936)]\label{prop locally klein}
    Given a locally Klein geometry $(P\to M,\eta)$ of type $(G,H)$ on a connected manifold $M$ whose universal cover is $\wt M$, there exist:
    \begin{enumerate}
        \item a local diffeomorphism $\dev: \wt M\to G\slash H$, called the \emph{developing map};
        \item a \emph{monodromy homomorphism} $\hol:\pi_1(M,m)\to G$ that is equivariant: \index{Monodromy!in Klein geometry}
        \[\dev([\gamma]\cdot \wt{m})=\wh{\rmL}_{\hol([\gamma])}\dev(\wt{m}),\quad [\gamma]\in \pi_1(M,m),\wt{m}\in\wt M.\]
    \end{enumerate} 
    The \emph{development pair} $(\dev,\hol)$ is unique up to replacement by $(\wh{\rmL}_g\circ \dev,\Adg_g\circ\hol)$, $g\in G$.

    If $\eta$ is complete, then $\dev$ is a covering map. In particular, if $G\slash H$ is simply connected, then $M\cong \Gamma\bslash G\slash H$, where $\Gamma=\hol(\pi_1(M,m))$.
\end{thm}
\begin{proof}
    Consider the universal cover $\wt\pi:\wt M\to M$ and pull back the bundle to get a bundle over $\wt M$:
    \[\wt P={\wt\pi}^\ast P.\]
    It comes with two natural projections $\pi_{\wt P}:\wt P\to \wt M$ and $\wt{\pi}_P:\wt{P}\to P$. The form $\wt\eta\coloneqq {\wt{\pi}_P}^\ast\eta$ still satisfies the structure equation by naturality. Proposition~\ref{prop 8.1 Sharpe} provides a unique monodromy homomorphism $\hol:\pi_1(\wt{P},p)\to G$ via developments of $\wt\eta$. The long exact sequence of the bundle $\wt P\to \wt M$ (cf.\ Theorem~\ref{thm long exact sequence of serre fibration}) ends with
    \[\pi_1(H,e)\to \pi_1(\wt P,p)\to \pi_1(\wt M,\wt{m})=\{e\},\]
    and by composition with $\hol$ we get the exact sequence 
    \[\{e\}=\hol(\pi_1(H,e))\to \hol(\pi_1(\wt P,p))\to \{e\},\]
    showing that the period group $\hol(\pi_1(\wt P,p))$ of $\wt\eta$ is trivial. Here, $\hol(\pi_1(H,e))=\{e\}$ because $H$, seen as a fiber of $\wt P$, is developed by the identity diffeomorphism to $H\subset G$.

    By the global Cartan's Fundamental Theorem~\ref{thm 7.14 Sharpe fundamental global}, there is a \emph{development map} $F:\wt{P}\to G$ such that $\wt\eta=F^\ast\theta_G$. It is necessarily a local diffeomorphism that preserves the fibers since $\wt\eta$ identifies the tangent space of each fiber with $\frakh$. Therefore, $F$ descends to a smooth developing map 
    \[\dev:\wt{M}\to G\slash H\]
    which is again a local diffeomorphism. The development map is unique up to left translations by elements of $G$.

    Now, the action of $[\gamma]\in \pi_1(M,m)$ on $\wt M$ can be lifted to $\wt P$ by
    \[[\gamma]\cdot (m,p)\coloneqq ([\gamma]\cdot m,p).\]
    Hence, $\wt{\pi}_P\circ [\gamma]=\wt{\pi}_P$. We obtain
    \[\wt\eta={\wt{\pi}_P}^\ast \eta=[\gamma]^\ast {\wt{\pi}_P}^\ast \eta=[\gamma]^\ast\wt\eta.\]
    Since $[\gamma]$ is an automorphism of $\wt P$, it corresponds to a left translation by an element $\hol([\gamma])\in G$. Indeed, for any path $\tau$ based at $p\in\wt P$, the forms $\tau^\ast\wt\eta$ and $\tau^\ast[\gamma]^\ast\wt\eta$ are equal and hence the endpoints of their developments differ by $\hol([\gamma])$ which does not depend on $\tau$. It is easy to check that $\hol:\pi_1(M,m)\to G$ is a homomorphism by concatenating loops. It also equivariant as asserted by Proposition~\ref{prop 8.1 Sharpe}. Changing $\dev\to \wh{\rmL}_g\circ \dev$ clearly leads to $\hol\to \Adg_g\circ\hol$.

    Now suppose $\eta$ is complete. The shortcut way of concluding that $\dev$ is a covering map is to observe that it must be a fiber bundle by Corollary~\ref{thm Ehresmann vector fields}. However, let us also provide a direct argument. The developing map $\dev$ is a covering map iff it has the path lifting property. We check that $\dev$ can uniquely lift any path in $G\slash H$ given a choice of starting points $x\in\wt{M}$ and $\dev(x)\in G\slash H$. Any smooth path $\gamma:[0,1]\to G\slash H$ can be arbitrarily lifted to a path $\wt\gamma:[0,1]\to G$. Then its logarithmic derivative is $\delta\wt\gamma={\wt\gamma}^\ast \theta_G$, and there is a unique path $\alpha:[0,1]\to \wt{P}$ such that $\alpha^\ast \wt\eta=\delta\wt\gamma$ (this is because completeness of $\wt\eta$ guarantees that the universal cover of $\wt P$ is a Lie group by Theorem~\ref{thm 8.7 Sharpe}, so a development exists in that group and can then be projected back onto $\wt P$). The projection of $\alpha$ onto $\wt M$ is a lifting of $\gamma$ by construction. It is unique because developments of curves in Lie groups are unique under given initial conditions (Proposition~\ref{prop 7.13 Sharpe}).

    If $G\slash H$ is simply connected, then by denoting $\Gamma\coloneqq \hol(\pi_1(M,m))$, we conclude that $\dev$ is a diffeomorphism and $M\cong \Gamma\bslash G\slash H$.
\end{proof}

\begin{xca}
    While the choice of the pair $(\dev,\hol)$ is not unique, it is still ``natural'' in the sense that if there is a \emph{morphism of Klein geometries} (see also the next \sect) consisting of a homomorphism $\lambda:G\to G'$ and a base map $\underline{\lambda}:G\slash H\to G'\slash H'$ such that $\underline{\lambda}(g\cdot m)=\lambda(g)\cdot \underline{\lambda}(m)$ for all $m\in G\slash H$, $g\in G$, then $(\underline{\lambda}\circ \dev,\lambda\circ \hol)$ is a valid development pair for $(G',H')$.
\end{xca}

The following lemma shows that the universal cover of a homogeneous space is itself a homogeneous space with the ``big'' group $G$ replaced by its own universal covering group. This space is unsurprisingly called the \emph{universal covering homogeneous space}.\index{Universal covering homogeneous space}

\begin{lem}[Universal covering homogeneous space]\label{lem univ cov hom space}
    Let $G\slash H$ be a connected homogeneous space (Klein geometry) of a connected Lie group $G$. Then the universal cover of $G\slash H$ is also a homogeneous space:
    \[\widetilde{G\slash H}\cong \wt{G}\slash H'_0,\]
    where $\wt G$ is the universal covering group of $G$ and $H'_0$ is the identity component of the preimage $H'$ of $H$ in $\wt{G}$.
\end{lem}
\begin{proof}
    First we show that $\wt{G}\slash H'_0$ is simply connected. Indeed, the long exact sequence of the principal $H_0'$-bundle $\wt{G}\to \wt{G}\slash H'_0$ reads, in part,
    \[\{e\}=\pi_1(\wt{G})\to \pi_1(\wt{G}\slash H_0')\to \pi_0(H_0')=\{e\}.\]
    Exactness implies that $\pi_1(\wt{G}\slash H_0')=\{e\}$.

    Now let $K\coloneqq H'\slash H'_0$ be the discrete group of components of $H'$. Using Example~\ref{ex 1.2.4 RS2}(1), we observe that there is a natural diffeomorphism of the following manifolds, which are in fact total spaces of principal $K$-bundles over $\wt{G}\slash H'$:
    \[\wt{G}\times^{H'}K=\wt{G}\times^{H'}(H'\slash H'_0)\cong \wt{G}\slash H'_0.\label{10125}\]
    Finally, letting $\Gamma$ be the kernel of the covering homomorphism $\pi:\wt{G}\to G$, Corollary~\ref{cor 6.5.3 RS1} gives the diffeomorphism
    \[G\slash H=(\wt{G}\slash \Gamma)\slash (H'\slash \Gamma)\cong \wt{G}\slash H'.\]
    Therefore, the quotient of (\ref{10125}) by $K$ reads
    \[G\slash H\cong (\wt{G}\slash H')\slash K,\]
    so $\wt{G}\slash H'$ is exactly the universal cover of $G\slash H$ and $K\cong \pi_1(G\slash H)$.
\end{proof}
\begin{rem}
    It is not difficult to see what the free $K$-action on $\wt{G}\slash H'_0$ implicitly constructed in the proof above  looks like. Let us try to define a left action of $H'$ on $\wt{G}\slash H'_0=\{\wt{g}H'_0\mid \wt{g}\in\wt{G}\}$ as follows:
    \[h\cdot (\wt{g} H'_0)\coloneqq (\wt{g}h^{-1})H'_0,\quad h\in H',\wt{g}\in \wt{G}.\]
    This is well-defined because $H'_0$ is a normal subgroup of $H'$, so the resulting coset is independent of the choice of $\wt{g}$: for any $h_0\in H'_0$,
    \[h\cdot (\wt{g}h_0H'_0)=\wt{g}h_0 h^{-1}H'_0=\wt{g}h_0H'_0h^{-1}=\wt{g}H'_0h^{-1}=\wt{g}h^{-1}H'_0=h\cdot (\wt{g}H'_0).\]
    It is now easy to check that this action induces a free $K$-action.
\end{rem}

The above lemma, combined with Theorem~\ref{prop locally klein}, allows us to conclude that all \emph{complete} locally Klein geometries, in fact, give rise to Klein manifolds, albeit with a different model geometry. In this sense these two notions are almost equivalent (however this is not an equivalence of categories).
\begin{cor}
    If $(P\to M,\eta)$ is a complete locally Klein geometry of type $(G,H)$, then it naturally induces a Klein manifold structure on $M$ of type $(\Gamma,\wt{G},H'_0)$ for some $\Gamma<\wt{G}$ such that $\Gamma\cong\pi_1(M,m)$. In particular, $M\cong \Gamma\bslash \wt{G}\slash H_0'$.
\end{cor}

Now we can try to give a local definition of Klein manifolds. Since $\Gamma\bslash G\slash H$ is locally diffeomorphic to $G\slash H$, and these local diffeomorphisms are unique up to the action of an element of $\Gamma<G$, we can propose the following definition. Unfortunately, it is only equivalent to the previous definition when $(G,H)$ is effective, i.e., when the action of $H$ on $G\slash H$ is faithful. This explains, in part, why Klein's classic definition assumed effectiveness.

\begin{figure}[tp]
    \centering
    \includegraphics[scale=1.2]{figures/Klein.pdf}
    \caption{Effective locally Klein geometry.}
    \label{fig:klein}
\end{figure}

\begin{defn}[Effective $(G,H)$-structure]\label{def GH-structure}
    A locally homogeneous structure \emph{modeled on} an effective homogeneous space of type $(G,H)$ is a connected manifold $M$ with a \emph{$(G,H)$-atlas} $\{(U_\alpha,\varphi_\alpha)\}_\alpha$, where $\{U_\alpha\}$ is an open covering of $M$ and $\varphi_\alpha:U_\alpha\to \wh{U}_{\alpha}\subset G\slash H$ are diffeomorphisms such that for each non-empty intersection $U_{\alpha\beta}=U_\alpha\cap U_\beta$ there exists $g_{\beta\alpha}\in G$ such that 
    \[\varphi_{\beta}=\wh{\rmL}_{g_{\beta\alpha}}\circ \varphi_\alpha\text{ on }U_{\alpha\beta}.\]
    A \emph{$(G,H)$-structure} on $M$ is a maximal $(G,H)$-atlas $\calA$. The tuple $(M,\calA)$ is called a \emph{$(G,H)$-manifold}.
\end{defn}

\begin{rem}
    We could drop the effectiveness condition in the above definition, but then a $(G,H)$-structure is the same thing as an effective $(G/K,H/K)$-structure, where $K$ is the kernel of the Klein geometry $(G,H)$.
\end{rem}

For a deep exploration of many classical $(G,H)$-structures see the book \cite{Goldman}. We now show that this is indeed a special case of a locally Klein geometry, and that the two definitions of effective locally Klein geometries are equivalent. In light of this, the procedure of development becomes very intuitive: every local chart map is a local diffeomorphism into $G\slash H$, so by stitching them together we get a map from the universal cover to $G\slash H$.

\begin{prop}
    An effective $(G,H)$-structure on $M$ induces a natural locally Klein geometry on $M$.
\end{prop}
\begin{proof}
    Since $(G,H)$ is effective, $\varphi_\alpha=\varphi_\beta$ on overlaps $U_{\alpha\beta}$. Consider the pullback principal $H$-bundles $P_\alpha=\varphi_\alpha^\ast G$. Since the $\varphi_\alpha$ agree on overlaps, the $P_\alpha$ stitch together into a principal $H$-bundle $P\to M$. The Maurer-Cartan form $\theta_G$ also pulls back to a $1$-form $\eta\in\Omega^1(P;\frakg)$ that satisfies all necessary properties.
\end{proof}


We will discuss locally Klein geometries (more commonly known as flat Cartan geometries) in more detail, including many important examples, in \S\ref{sec: uniformization of cartan}. To wrap up this \sect, let us look at what kind of local differential forms can be defined on $M=\Gamma\bslash G\slash H$ using the Maurer-Cartan form. The following holds for Klein and locally Klein geometries.

\begin{prop}[{{\cite[Prop.~4.7.1]{Sharpe}}}]\label{prop 4.7.1 Sharpe}
    If $\chi:\pi^{-1}(U)\to U\times H$ is a local chart for the principal bundle $G\to G\slash H$ corresponding to the local section $ s:U\to G$. Then the local representative of the Maurer-Cartan form $\theta_G$ in this chart at point $(m,h)$ is $\Ad_h^{-1}\circ  s^\ast\theta_G +\pr_2^\ast\theta_H$, that is,
    \[(\chi^{-1})^\ast\theta_G(X_m,Y_h)=\Ad_h^{-1}\theta_G( s_\ast X_m)+\theta_H(Y_h),\quad X_m\in \T_mU,Y_h\in \T_h H.\]
\end{prop}
\begin{proof}
    We have $ s(m)=\chi^{-1}(m,e)$. Also let $i_h:U\to U\times H$ and $j_m:H\to U\times H$ be the inclusions of the slices $m\mapsto (m,h)$ and $h\mapsto (m,h)$, respectively. Then we have
    \[(\chi^{-1\ast}\theta_G)\circ i_{h\ast}=(\chi^{-1}\circ i_h)^\ast \theta_G=(\rmR_h s)^\ast \theta_G= s^\ast \rmR_h^\ast \theta_G= s^\ast(\Ad_h^{-1}\theta_G)=\Ad_h^{-1} s^\ast \theta_G,\]
    and on the other hand, 
    \[(\chi^{-1\ast}\theta_G)\circ j_{m\ast}=(\chi^{-1}\circ j_m)^\ast \theta_G=\rmL_{ s(m)}^\ast\restr{\theta_G}{\T_hH}=\restr{\theta_G}{\T_hH}=\theta_H.\]
\end{proof}

Let $ s_\alpha:U_\alpha\to G$ be a local gauge, that is, a local section of the principal $H$-bundle $G\to G\slash H$ over an open set $U_\alpha\subset G\slash H$. Then $ s_\alpha$ pulls back the Maurer-Cartan form $\theta_G$ to a $\frakg$-valued $1$-form $\theta_\alpha$ on $U_\alpha$: \[\theta_\alpha\coloneqq  s_\alpha^\ast\theta_G.\] 
The Maurer-Cartan equation for $\theta_G$ then yields the structure equation for $\theta_\alpha$:
\[\dd\theta_\alpha+\frac 12[\theta_\alpha,\theta_\alpha]=0.\]
Note that $\theta_\alpha$ \emph{almost} determines $ s_\alpha$ since the Fundamental Theorem~\ref{thm 6.1 Sharpe fundamental local} says that $\theta_\alpha$ determines $ s_\alpha$ up to left multiplication by a fixed element of $G$. Then, for an effective Klein geometry, if $ s$ is a section, then $g s$ is a section iff $g=e$, so in this case $ s_\alpha$ is recovered uniquely.\footnote{If $g s$ is a section, then $u=\pi(g s(u))$ and hence $g\cdot u=u$ for all $u\in U$. Thus $f^{-1}gf\in H$ for all $f\in\pi^{-1}(U)\subset G$. Thus shows that $\{f\in G\mid f^{-1}gf\in H\}$ contains an open subset of $G$. But it is also an analytic subset of $G$, so it must be equal to $G$, at least for connected $G$. Thus $g\in \bigcap_{f\in G}fHf^{-1}$, and this latter is a normal subgroup of $G$ inside $H$ and is therefore trivial.} 
For this reason we may refer to $\theta_\alpha$ as an \emph{infinitesimal gauge}. We have the non-canonical isomorphism at every $m\in U_\alpha$
\[\underline{\theta}_\alpha:\T_mU_\alpha\overset{\theta_\alpha}{\longrightarrow}\frakg\overset{\mod\frakh}{\longrightarrow} \frakg\slash\frakh.\]
The infinitesimal gauge $\theta_\alpha$ can be roughly interpreted as assigning to each tangent vector $X_m\in \T_mM$ an infinitesimal ``motion'' $\theta_\alpha(X_m)\in \frakg$ of $M$ whose Killing vector field at $m$ coincides with $X_m$.

By differentiating the transformation rule $ s_\beta(m)= s_\alpha(m)h_{\alpha\beta}(m)$ (cf.\ (\ref{eq transf rule for sections})) we get
\[ s_\beta^{\ast}\theta_G=\Ad_{h_{\alpha\beta}}^{-1} s_\alpha^\ast\theta_G+h_{\alpha\beta}^\ast\theta_H,\]
that is
\[\theta_\beta=\Ad_{h_{\alpha\beta}}^{-1}\theta_\alpha+h_{\alpha\beta}^\ast\theta_H.\]
This transformation is called an \emph{infinitesimal change of gauge}, and the two infinitesimal gauges are called gauge equivalent.

Since in the effective case the $\theta_\alpha$ let us recover the local sections $s_\alpha$ uniquely, one can give an alternative definition of effective locally Klein geometries in terms of a collection of local $1$-forms on $M$ satisfying the structure equation and the above transformation rule. Up to isomorphism, this allows one to reconstruct the principal bundle of the geometry. Completeness is a little more subtle, so we shall put off this view of locally Klein geometry and until our discussion of flat Cartan geometries in \S\ref{sec: uniformization of cartan}.

% \begin{defn}[Effective locally Klein geometry III]
%     An effective locally Klein geometry \emph{modeled on} an effective Klein geometry $(G,H)$ is a connected manifold $M$ with a collection $\{(U_\alpha,\theta_\alpha)\}_\alpha$, where $\{U_\alpha\}$  is an open covering of $M$ and each $\theta_\alpha\in \Omega^1(U_\alpha;\frakg)$ is a $\frakg$-valued local $1$-form that satisfies the structure equation 
%     \[\dd\theta_\alpha+\frac12 [\theta_\alpha,\theta_\alpha]=0,\]
%     and such that on every intersection $U_{\alpha\beta}$ there exists a smooth function $h_{\alpha\beta}:U_{\alpha\beta}\to G$ such that 
%     \[\theta_\beta=\Ad_{h_{\alpha\beta}}^{-1}\theta_\alpha+{h_{\alpha\beta}}^\ast\theta_H.\]
% \end{defn}




% \begin{example}[Meteor tracking]
%     Suppose we live in a small open set $U\subset M=G\slash H$ and a meteor flashes through $U$. We wish to describe its motion. We formalize the meteor as a point set $X$, and a \emph{configuration} of the meteor is a map $X_0:X\to M$. This is the origin for Cartan's idea of a ``moving frame''.\index{Moving frames}
    
%     We assume the meteor is \emph{rigid} and \emph{sufficiently complicated}. By the term rigid in the given geometry, we mean that for any two of its positions, where it has the configurations $X_0$ and $X_1$ say, there is an element of $G$ carrying $X_0$ to $X_1$. By sufficiently complicated we mean that the subgroup of $G$ that fixes the body pointwise (its stabilizer) is the identity.  It follows that if $X(t)$ is the configuration of its points at time $t$, then there is a unique path $g(t)\in G$ such that $X(t)=g(t)X(0)$. One way to describe the motion would be to specify the path $g(t)$ itself. However, it is more useful, and closer to what is actually observed, to describe the motion differently. We first describe the motion of one of its points $q\in X(0)$, which we take to be $eH$, by a path $q(t)=g(t)H$ on $U$, and then describe the motion of the rest of the body as turning about this one point as it moves along. For this we will need the concept of a gauge.

%     Let us assume that $U$ is small enough to admit a local section $s:U\to G$. Any two such sections $s,s'$ are related by a map $h:U\to H$ by $s'(u)=s(u)h(u)$. A ``choice of gauge'' is a choice of such a local section, and $h(u)$ is called a gauge transformation. A choice of gauge can be regarded as a choice of motions, varying smoothly with $u$, which maps the base point to $u$. The value of a gauge at any point may be called a \emph{frame} at that point and the gauge itself may be called a \emph{moving frame}. From this point of view the principal bundle $G\to G\slash H$ is a bundle of frames.

%     Since both $s(q(t))$ and $g(t)$ lie over $q(t)$, they must differ by an element $k(t)\in H$. Thus, in the presence of a gauge, the motion can be described by giving $q(t)$ and $(k(t)$. The latter describes the way the meteor turns about the point $q(t)$. Crucially, there is no intrinsic geometric meaning attached to the choice of gauge $s$, or the function $k(t)$ alone. Together, however, they complete the description of the motion.
% \end{example}


\begin{example}
    Recall the \emph{hyperbolic upper half-plane} $\bbC^+=\SL_2(\bbR)\slash \SO_2$ from Example~\ref{ex siegel upper half-space}. The Uniformization Theorem of Riemann Surfaces states that any closed (compact with no boundary) orientable \emph{simply connected} surface with its conformal/projective/complex structures is isomorphic to one of three: the Riemann sphere $\CP^1$, the plane $\bbC$, or the upper half-plane $\bbC^+$.

    In the case of $\CP^1$, it is not the covering space of anything else, so every genus $0$ surface is isomorphic to $\CP^1$. In the case of $\bbC$, every properly discontinuous action is determined by a lattice $\Lambda\subset \bbC$, so the quotient $\bbC\slash\Lambda$ has genus $1$, and thus every Riemann surface of genus $1$ is isomorphic to such a quotient. Finally, any oriented surface $\Sigma_g$ of genus $g>1$ is isomorphic to $\Gamma\bslash \bbC^+$ for some choice of discrete subgroup $\Gamma<\SL_2(\bbR)$. Let $\Gamma_g$ be such a subgroup. Then $\Sigma_g\cong \Gamma_g\bslash \bbC^+$ is a locally Klein geometry.
\end{example}

The Uniformization Theorem of Riemann Surfaces itself can be proven by reduction to the Uniformization Theorem of flat Cartan geometries, but the hard part is in fully demonstrating that every Riemann surface carries a \emph{complete} holomorphic projective connection (every such connection is automatically flat because the space is $1$-dimensional). 

\begin{example}[Moduli spaces of algebraic curves]
    An \emph{elliptic curve} is a Riemann surface $\Sigma$ of genus $1$. Per the preceding example, $\Sigma\cong \bbC\slash\Lambda$ for some lattice $\Lambda\subset\bbC$, hence $\Sigma$ is a homogeneous space. Any biholomorphism between elliptic curves arises from a complex affine linear map $\bbC\to\bbC$ matching lattices. We can always arrange by isomorphism that $\Lambda$ is generated by $1,\tau$ for some $\tau\in \bbC^+$. But then $\tau$ is only determined up to \glspl{flt} of $\bbC^+$ with integer coefficients (so that $1$ is a fixed point). Hence, the ``coarse moduli space'' of elliptic curves is a complete Klein manifold $\Gamma\bslash \bbC^+$, where $\Gamma\cong \SL_2(\bbZ)$ is the set of \glspl{flt} with integer coefficients. Similarly, the coarse moduli space of compact Riemann surfaces of genus $g$ is a complete Klein manifold $\Sp_{2g}(\bbZ) \bslash \calH_g$ where $\calH_g$ is the complex hyperbolic space of complex dimension $g(g+1)$ (cf.~\ref{ex siegel upper half-space}).
\end{example}


\begin{example}[Affine elliptic curves]
    Every elliptic curve $E=\bbC\slash\Lambda$ has a complex affine structure, i.e., $G=\bbC^\times\ltimes\bbC$ and $H=\bbC^\times$. The developing map is the identity $\dev^0=\id_\bbC$ and the holonomy homomorphism is 
    \[\hol^0:\Lambda\to G,\quad \lambda\mapsto (1,\lambda).\]
    There are other affine structures on $E$. For every $c\in \bbC^\times$, we can produce an affine structure on $E$ via the developing map $\dev^c:\bbC\to \bbC^\times,$ $z\mapsto \rme^{cz}$, with holonomy morphism 
    \[\hol^c:\Lambda\to G,\quad \lambda\mapsto (\rme^{c\lambda},0).\]
    Since the developing map of an affine structure is unique up to affine transformations, we could just as well use the map $z\mapsto c^{-1}(\rme^{cz}-1)$, which lets us think of $\dev=\id_\bbC$ as the limiting case $c\mapsto 0$.  To forget the chose of affine coordinate $z$, we can identify the moduli space of affine structures on an elliptic curve $E$ with the space of holomorphic $1$-forms on $E$: each $1$-form is expressed in terms of an affine chart as $c\dd z$. The developing map $\dev^c$ is a map to the \emph{linear} geometry on $\bbC\setminus\{0\}$, i.e., $(G',H')=(\bbC^\times,\{e\})$.  The holomorphic $1$-form $\dd\zeta/\zeta$ on $\bbC\setminus\{0\}$, with the standard coordinate $\zeta$, is $G'$-invariant, and pulls back to $c\dd z$ on $\bbC$. Hence, we identify the isomorphism class of the affine structure with this induced holomorphic $1$-form, and take the zero $1$-form as the limit $c\to 0$.  It is well known that every holomorphic affine structure arises uniquely this way. The automorphism group of the affine structure with $c=0$, the one with linear developing map, is the biholomorphism group of the elliptic curve (which is a semidirect product of the translation group $\bbC$ with a finite group of at most $24$ elements). The automorphism group of any of the affine structures with $c\neq 0$ is only the group $\bbC$ of translations.
\end{example}

\begin{example}[Projective structures on Riemann surfaces]\index{Projective structure}\label{ex projective structure}
    A \emph{Riemann surface}\index{Riemann surface}, also called a \emph{complex curve}, is a connected $1$-dimensional complex manifold $\Sigma$, i.e., its atlas consists of $\bbC$-valued maps with complex analytic, or holomorphic, transition maps (in the $1$-dimensional case holomorphic maps are also called conformal, although the equivalence between these terms is nontrivial, cf.\ Remark~\ref{rem holomorphic functions}). Thus, the inverses of the transition maps are also complex analytic, so that the transition maps are \emph{biholomorphic}.\index{Biholomorphism} Now, a \emph{projective structure} $\calP$ on $\Sigma$ is a $(\PSL_2(\bbC),\U_1)$-structure in the sense of Definition\ \ref{def GH-structure}. In particular, the chart maps are \emph{meromorphic} biholomorphisms, i.e., they take values in $\CP^1$ instead of just $\bbC$ (so they are allowed to have simple poles). The pair $(\Sigma,\calP)$ is called a \emph{complex projective surface}.
    
    Every Riemann surface admits many non-equivalent projective structures, but the Uniformization Theorem (stating that there is a unique, up to a \gls{flt}, biholomorphism between the universal cover of $\Sigma$ and one of three standard subsets of $\CP^1$) implies the existence of a \emph{canonical projective structure}.
    Moreover, every affine structure induces a projective structure via the obvious inclusion $\bbC\cong \CP^1\setminus \{\infty\}\to \CP^1$. Among the various affine structures on elliptic curves given above, each induces a distinct projective structure, except for pairs $\{c,-c\}$, which are clearly related by a \gls{flt}, $\rme^{-cz}=\frac{1}{\rme^{cz}}$. It turns out that these are all of the projective structures on $E$: we can identify the moduli space of projective structure on any elliptic curve with the space of quadratic differentials $c^2\dd z^{\otimes 2}$, as we will see. For $c\neq 0$, the developing map is $z\mapsto \rme^{cz}\in \CP^1$ and the holonomy homomorphism is 
    \[\hol^c:\lambda \mapsto \begin{bmatrix}
        \rme^{c\lambda/2} & 0\\
        0 & \rme^{-c\lambda/2}
    \end{bmatrix}\in G.\]
    For $c=0$, the developing map is the inclusion map $\bbC\to \CP^1$ and the holonomy morphism is 
    \[\hol^0:\lambda\to \begin{bmatrix}
        1 & \lambda \\ 0 & 1
    \end{bmatrix}\in G.\]
    The automorphism group of the projective structure at $c=0$ is still the biholomorphism group of the curve. At $c\neq 0$, the automorphism group is $\bbZ_2\ltimes\bbC$, where $\bbZ_2$ acts on $\bbC\slash\Lambda$ by $z\mapsto -z$ and $\bbC$ acts by translations.

    Clearly, $\CP^1$ has an obvious projective structure, being the model geometry. The developing map and the holonomy homomorphism are trivial and the biholomorphism group is $G=\PSL_2(\bbC)$.
\end{example}


\begin{example}[Monopole bundles]\label{ex monopole bundles}\index{Monopole!bundles}\index{Hopf fibration}
    Consider the Hopf bundle $\bbS^3\to \bbS^2$ defined as a $\U_1$-principal bundle, or as a Klein geometry of type $(\SU_2,\U_1)$. Let $m\geq 1$ and $\Gamma=\bbZ_m\subset \U_1$ act on $\bbS^3$ by the restriction of the $\U_1$ action. The space $\Gamma\bslash \bbS^3$ is the loop space $L(m;1)$. We get the principal $\U_1$-bundle
    \[L(m;1)\to L(m;1)\slash \U_1=\bbS^2\]
    (since the induced action of $\U_1$ on $L(m;1)$ is trivial).
    Note that the structure groups here are abelian so right and left actions are indistinguishable.
    
    In the standard atlas consisting of two hemispheres (Example~\ref{ex hopf bundle atlas}), the transition function of this new bundle is $\tau_{-+}(z)=z^{-m}$, i.e., this is exactly the $\U_1$-bundle with Chern number $-m$ from Example~\ref{ex circle bundles over S2}. This proves that the lens space is simultaneously $\bbS^3\slash \bbZ_m$ and the gluing of two solid tori, thus solving Exercise~\ref{xca two definitions of lens spaces}. As principal $\U_1$-bundles, these bundles are known as \emph{monopole bundles}.

    We thus have the surjective vertical morphism of principal bundles $\vartheta:\bbS^3\to L(m;1)$ given by the quotient by the $\bbZ_m$-action and the group homomorphism $\lambda:\U_1\to \U_1$ given by the $m$-fold covering of the circle. Note that these bundles are also defined for $m$ negative as the duals (inverse transition functions), or via the inverse $\U_1$-action on $\bbS^3$.
\end{example}

\begin{example}
    In many cases of interest, a $(G,H)$-structure on $M$ is equivalent to the specification of a $G$-invariant geometric object on $G\slash H$. The most prominent example is a locally homogeneous Riemannian metric. For example, if $X$ is a simply connected Riemannian manifold of constant curvature $K$ and $G$ is its group of isometries with stabilizer $H$, then locally modeling $M$ on $X\cong G\slash H$ is equivalent to giving $M$ a metric of constant curvature $K$.
\end{example}







\section{Morphisms}\label{sec: morphisms of klein geom}

In this \sect\ we discuss changing the models of $(G,H)$-structures via morphisms.

\begin{defn}[Morphism of Klein geometries]
    If $(G,H)$ and $(G',H')$ are two Klein geometries, then a morphism between them is a Lie group homomorphism $\lambda:G\to G'$ such that $\lambda(H)\subset H'$. Equivalently, it is a morphism of the principal bundles $G\to G\slash H$ and $G'\to G'\slash H'$ which is $G$-equivariant via the homomorphism $\lambda$, or whose base map $\underline{\lambda}:G\slash H\to G'\slash H'$ is $G$-equivariant: $\underline{\lambda}([g])=\wh{\rmL}_{\lambda(g)}([e])$.
\end{defn}

\begin{example}
    The double cover $\bbS^n\to \RP^n$ can be realized as a morphism of two Klein geometries $(G,H)\to (G',H')$, where $G$ is the subgroup of $\GL_{n+1}(\bbR)$ consisting of matrices with determinant $\pm 1$, and $G'=\PGL_{n+1}(\bbR)=G\slash \{\pm \rmI\}$. Then $\bbS^n\to \RP^n$ is $G$-equivariant with $\lambda(g)=g/\det g$.
\end{example}

Given a manifold $M$ with a $(G,H)$-structure (with its principal $H$-bundle $P\to M$) and a morphism $\lambda:(G,H)\to (G',H')$ of models, we can induce a $(G',H')$-structure by composing the charts with the $G$-equivariant base map $\underline{\lambda}$. This also gives the new $H'$-bundle $P'\to M$.

Conversely, given a $(G',H')$-structure $(P'\to M,\eta)$, it is interesting to ask whether it is induced from a $(G,H)$-structure $(P\to M,\eta)$. Factoring $(G,H)\to (G',H')$ into two maps 
\[(G,H)\to (\lambda(G),\lambda(H))\to (G',H'),\]
we are able to split the question into two separate problems, where the morphism is surjective in one and injective in the other.

First consider surjective morphisms. First, to be able to reconstruct a $\frakg$-valued form from a $\frakg'$-valued one, we clearly need $\lambda:G\to G'$ to be a covering homomorphism. Then $H\to \lambda(H)$ is also a covering map. If the bundle $P'\to M$ is associated to some smooth principal $H$-bundle $P\to M$ via (the restriction of) a homomorphism $\lambda:G\to G'$ and if $\lambda_{\ast e}:\frakg\to \frakg'$ is an isomorphism, we just let 
\[\eta\coloneqq \lambda^{-1}_{\ast e}\circ \iota_e^\ast \eta',\] where $\iota_e:P\to P'$, $p\mapsto [(p,e)]$, is the canonical covering map. This induces a $(G,H)$-structure on $P\to M$. 

\begin{example}
    \begin{enumerate}
        \item Consider the trivial double cover $(\Aff_n(\bbR),\GL_n(\bbR))\to (\Aff_n^+(\bbR),\GL_n^+(\bbR))$. Thus, any oriented affine manifold can be turned into a regular affine manifold (e.g., by adding reflected chart maps to the atlas).
        \item Consider the nontrivial double cover $(\Spin_n\ltimes\bbR^n,\Spin_n)\to (\SE_n,\SO_n)$. Thus, assuming we are given a corresponding covering bundle morphism $P\to P'$, then we can reconstruct the affine spin structure from the affine Riemannian structure. The assumption of the existence of a covering spin bundle here is crucial because not every Riemannian structure admits one, or may admit multiple.
    \end{enumerate}
\end{example}

In the injective case, not every structure on $P'$ is induced from one on $P$, so this case will be treated via holonomy in Theorem~\ref{thm 16.30 McKay} below.

\begin{example}
    \begin{enumerate}
        \item If $M=\bbS^1$, then (by picking an arbitrary connection) all bundles over $M$ are quotients of the form $P=(\bbR\times H)\slash \sim$, where $(x,h)\sim (x+1,h_0h)$ with $h_0$ (the generator of monodromy) determined up to conjugacy. So every element of $H'$ is conjugate to an element of the image $\lambda(H)\subset H'$ iff all $H'$-bundles arise from $H$-bundles.
        \item If $M$ is contractible, then every $(G',H')$-structure on it lifts to a $(G,H)$-structure since all bundles over $M$ are trivial.
        \item If $M=\bbS^n$, it has a covering by two open sets whose intersection deformation retracts to the equator. So if the induced homomorphism of homotopy groups $\pi_{n-1}(H)\to \pi_{n-1}(H')$ is surjective, we can lift every $H'$-bundle on $\bbS^n$ to an $H$-bundle.
    \end{enumerate}
\end{example}

We return to the problem of how a Klein geometry (i.e., its principal bundle and Maurer-Cartan form) changes under morphisms. We will describe the new principal bundle $P'$ and its associated form $\eta'$ in a language more suited to our ultimate study of Cartan geometries.

\begin{lem}[{{\cite[Lem.~13.2]{McKayCartan}}}]\label{lem 13.2 McKay}
    Let $\lambda:(G,H)\to (G',H')$ be a morphism of Klein geometries (or homogeneous spaces). Denote $M\coloneqq G\slash H$ and $M'\coloneqq G'\slash H'$. Also denote $H''\coloneqq \lambda^{-1}(H')\subset H$ and $M''\coloneqq \underline{\lambda}(M)\subset M'$. Then $G\to M''$ is a principal $H''$-bundle and induces the pullback bundle $G_{H'}=\restr{G'}{M''}\to M''$. 
    
    In more detail, define $\psi:G\times H'\to G'$ by $\psi(g,h')=\lambda(g)h'$. Then, at any point $(g,h')\in G\times H'$, 
    \[\psi^\ast\theta_{G'}=\theta_{H'}+\Ad_{h'}^{-1}\circ\lambda_{\ast e}\circ \theta_G.\] 
    The map $\psi$ is a surjective $H''$-bundle map to $\restr{G'}{M''}$ under the right $H''$-action $(g,h')\cdot h\coloneqq (gh,\lambda(h)^{-1}h')$, $H'$-equivariant under the right $H'$-action $(g,h')\cdot k'\coloneqq (g,h'k')$, and $G$-equivariant under the left $G$-action $a(g,h')\coloneqq (ag,h')$. Quotienting by that right $H''$-action gives an $H'$-bundle isomorphism 
    \[\begin{tikzcd}
        G_{H'}=G\times^{H''}H'\arrow[rr,"\cong"]\arrow[dr] & & \restr{G'}{M''}\arrow[dl]\\
        & M''. &
    \end{tikzcd}\]
\end{lem}
\begin{proof}
    The map $\psi$ is clearly invariant and equivariant in the three stated ways, therefore it descends as stated to a map $G\times^{H''} H'\to G'$. Its image is clearly the pullback $\restr{G'}{M''}$ of $G'\to M'$ to $M''\subset M'$. By $G$-equivariance, $M''$ is a $G$-orbit in $M'$, so a smooth manifold. Two elements $(g,h)$, $(\wt g,\wt h)\in G\times H'$ map to the same point $g'\in G'$ iff $\lambda(g)h=\lambda(\wt g)\wt h$, i.e., $\lambda(g^{-1}\wt g)=h\wt{h}^{-1}$, so $\wt{g}=gk\in \lambda^{-1}(H')=H''$ and $\lambda(k)=h\wt{h}^{-1}$ so $\wt{h}=\lambda(k)^{-1}h$. So the map $\psi$ descends to an injection $G\times^{H''}H'\hookrightarrow G'$. 

    The subgroup $H''=\lambda^{-1}(H')$ is a closed Lie subgroup since $H'\sub G'$ is closed. Hence, it acts on $G$ freely and properly, hence acts on $G\times H'$ freely and properly, so the quotient is a smooth manifold and $G\times H\to G\times^{H''}H'$ is a smooth principal $H''$-bundle, and the map to $G'$ is smooth. The left $G$-action and right $H'$-action on $G\times H'$ are smooth, and invariant under the right $H''$-action, so descend to smooth $\psi$-equivariant actions on the quotient.

    Thus, $G\times^{H''}H'\to \restr{G'}{M''}$ is an equivariant bijection of homogeneous spaces of $G\times H'$, hence a diffeomorphism, and a bundle isomorphism over $M'$ by equivariance. The formula relating the Maurer-Cartan forms is just the differential-geometric version of the matrix identity 
    \[(gh')^{-1}\dd (gh')=(h')^{-1}g^{-1}(g\dd h'+\dd g \cdot h')=(h')^{-1}\dd h'+(h')^{-1}(g^{-1}\dd g)h'.\]
\end{proof}

\begin{cor}
    In the setting of the preceding lemma, let $\underline{\lambda}:G\slash H\to G'\slash H'$ be a local diffeomorphism. Let $(P\to M,\eta)$ be a locally Klein geometry of type $(G,H)$. Then the  geometry of type $(G',H')$ associated to this one via the morphism $\lambda$ has bundle $P'=P\times^{H''}H'$ and its form $\eta'$ pulls back to $P\times H'$ to become (omitting obvious pullbacks)
    \[\eta'=\theta_{H'}+\Ad_{h'}^{-1}\circ\lambda_{\ast e}\circ\eta.\]
\end{cor}
\begin{proof}
    From the preceding lemma, this holds on each of the $H$-invariant open sets in $P$ which are identified by the local bundle charts with $H$-invariant open subsets of $G$. By $G$-equivariance, this description glues together under the transition maps to cover all of $P$ and $P'$.
\end{proof}







\section{Homogeneous bundles}\label{sec: homogeneous bundles}


We now consider the tangent bundle of a Klein geometry. Since it is a locally trivial principal bundle, we have local diffeomorphisms of the form $\T(\pi^{-1}(U))\cong \T(U\times H)\to \T U\times \T H$. Local trivializations of $\T U$ and $\T H$ are given by the Maurer-Cartan forms $\theta_G$ and $\theta_H$, respectively, so the diagram
\[
\begin{tikzcd}
    \T_g(gH)\arrow[r]\arrow[d,"\theta_H","\cong"'] & \T_g G\arrow[r]\arrow[d,"\theta_G","\cong"'] & \T_{m}(G\slash H)\arrow[d,dashed,"\chi_g","\cong"'] \\
    \frakh\arrow[r,hookrightarrow]&\frakg \arrow[r] & \frakg\slash \frakh
\end{tikzcd}
\]
is commutative with exact rows. Since $\frakh$  us only a subalgebra (not an ideal), the quotient $\frakg\slash\frakh$ is merely a vector space. The linear isomorphism $\chi_g$ is the unique map making the diagram commute.

We can identify the tangent space of $G\slash H$ at $m$ with $\frakg\slash\frakh$, but the identification $\chi_g$ depends on the choice of $g\in G$ over $m$. In fact, since $\pi\circ \rmR_h=\pi$, the relation $\rmR_h^\ast \theta_H=\Ad_h^{-1}\theta_H$ implies that $\chi_{gh}=\Ad_h^{-1}\circ \chi_g$. It follows that the identification of $\T_m(G\slash H)$ with $\frakg\slash \frakh$ is determined only up to the adjoint action of $H$ on $\frakg\slash\frakh$. This accounts for the frequent occurrence of the adjoint action in the sequel. 

\begin{prop}[{{\cite[Prop.~4.5.1]{Sharpe}}}]\label{prop 4.5.1 Sharpe}
    $\T(G\slash H)\cong G\times^H \frakg\slash\frakh$ as \glspl{vb} over $G\slash H$.
\end{prop}
\begin{proof}
    Define a map $\varphi:G\times \frakg\to \T(G\slash H)$ by $\varphi(g, X)=(\pi(g),\pi_\ast \circ \rmL_{g\ast}X)$, where $\pi:G\to G\slash H$ is the canonical projection. Clearly $\varphi$ is smooth, surjective, and fiberwise linear. Moreover, for $X\in \T_eH$, $\rmL_{g\ast}X\in \T_g(gH)\in\ker\pi_\ast$. Thus, $\varphi(g, X)=(g,0)$. On the other hand,
    \begin{multline}
        \varphi(gh,\Ad_h^{-1}X)=(\pi(gh),\pi_\ast \rmL_{gh\ast}\Ad_h^{-1}X)=(\pi(g),\pi_\ast(\rmL_{gh\ast}\rmL_{h\ast}^{-1} \rmR_{h\ast}X))=\\
        =(\pi(g),\rmL_{g\ast }\pi_\ast (\rmR_{h\ast}X))=(\pi(g),\rmL_{g\ast}(\pi \rmR_h)_\ast X)
        =(\pi(g),\rmL_{g\ast}(\pi_\ast X))=\varphi(g,X).
    \end{multline}
    Thus $\varphi$ induces a smooth quotient map $\wb\varphi:G\times^H \frakg\slash\frakh\to \T(G\slash H)$. Moreover, this map is injective since $\varphi(g,X)=\varphi(g',X')$ implies $g'=gh$ for some $h\in H$ and $\pi_\ast \rmL_{gh\ast}X'=\pi_\ast \rmL_{g\ast}X$. The latter means that $\pi_\ast \rmL_{h\ast}X'=\pi_\ast X$ and hence that $X'-\Ad_h^{-1}X\in\frakh$. Thus,
    \[[(g',X')]=[(gh,\Ad_h^{-1}X+\frakh)]=[(g,X+\frakh)]\in G\times^H\frakg\slash\frakh.\]
    Thus $\wb\varphi$ is a vertical \gls{vb} isomorphism.
\end{proof}


\begin{example}
    \begin{enumerate}
        \item Taking $\bbS^n=\SO_{n+1}\slash \SO_n$, we get the identification $\T\bbS^n\cong \SO_{n+1}\times^{\SO_n}\bbR^n$, where $\bbR^n$ is the standard (defining) representation of $\SO_n$.
        \item Since the Grassmannian manifolds can be written as $\Gr_k(\bbK^n)\cong \calO_n\slash (\calO_{n-k}\times \calO_{k})$, by comparing transition functions it is easy to see that $\T\Gr_k(\bbK^n)\cong \Hom(\gamma_k(\bbK^n),\gamma_k(\bbK^n)^\perp)$, where $\gamma_k(\bbK^n)$ is the tautological bundle over $\Gr_k(\bbK^n)$ and $\gamma_k(\bbK^n)^\perp$ is its orthogonal complement in $\Gr_k(\bbK^n)\times \bbK^n$.
    \end{enumerate}
\end{example}


Note that the basepoint $[e]=H\in G\slash H$ is preserved by the left action of $H$ via $\wh{\rmL}_h$, $h\in H$, thus it generates an isotropy representation of $H$, which we specify in the following definition.

\begin{defn}[Isotropy representation]
    For a Klein geometry $(G,H)$, identify $\T_{[e]}(G\slash H)$ with $\frakg\slash\frakh$ using the natural isomorphism constructed above. We call the induced representation $\underline{\Ad}:H\to \GL(\frakg\slash\frakh)$ given by $h\mapsto \wh{\rmL}_{h\ast [e]}$, the isotropy representation of the Klein geometry.

    Since $\frakh<\frakg$ is invariant under $\Ad(H)$, the restriction of the adjoint representation to $H$, $\restr{\Ad}{H}:G\to \GL(\frakg)$, which descends to a map $H\to \GL(\frakg\slash h)$, which coincides with $\underline{\Ad}$.
\end{defn}

Since tangent bundles involve only first derivatives, we can make the following rough division of Klein geometries into two types according to whether $H$ is faithfully represented by this action.

\begin{defn}[First order Klein geometry]
    A Klein geometry $(G,H)$ is of first order if the isotropy representation $\underline{\Ad}:H\to \GL(\frakg\slash\frakh)$ is faithful. Otherwise, the geometry is said to have \emph{higher order}.
\end{defn}

\begin{rem}
    First order Klein geometries have a simple intuitive description in terms of $H$-structures. Since $H$ is faithfully represented on $\frakg\slash\frakh$, via the global trivialization of $\T M$ constructed above, it traces out an $H$-orbit in the set of linear frames mapping $\T_mM\to \frakg\slash\frakh$ for each $m\in M$. This was exactly our original definition of an $H$-structure on $\T M$. Equivalently, this describes the principal bundle $G\to M$ as a reduction of the frame bundle $\Fr(\T M)$ to structure group $H$.
\end{rem}

The tangent bundle of a Klein geometry is an example of an important class of bundles that are equivariant w.r.t.\ the natural $G$-action $\wh L$ on the base $G\slash H$ in the following sense.


\begin{defn}[Homogeneous bundle]
    Let $G$ be a Lie group and $H\sub G$ a closed subgroup. A (left) homogeneous, or \emph{equivariant}, \gls{fb} of type $(G,H)$ is a \gls{fb} $E\overset{\pi}{\to}G\slash H$ over the homogeneous space of (left) cosets $G\slash H$ together with a (left) action $G\overset{\wt L}{\acts} E$ that lifts the natural (left) action $\wh L$ on $G\slash H$, i.e., which satisfies \[\pi\circ \wt{L}_g=\wh{\rmL}_g\circ \pi,\text{ for all } g\in G.\] 

    In particular, a homogeneous \gls{vb} is a \gls{vb} which is also a homogeneous \gls{fb} such that the $G$-action is by \gls{vb} morphisms. Similarly, a homogeneous \gls{pfb} is a \gls{pfb} which is also a homogeneous \gls{fb} such that the $G$-action is by \gls{pfb} morphisms, i.e., by maps equivariant w.r.t.\ the (right) action of the structure group.

    A morphism of homogeneous bundles over $G\slash H$ is a vertical $G$-equivariant bundle morphism. The categories of homogeneous \glspl{fb} and \glspl{vb} are denoted $\FB_{(G,H)}$ and $\VB_{(G,H)}$, respectively. 
\end{defn}

\begin{example}
    The principal $H$-bundle $G\to G\slash H$ is obviously homogeneous because the left action $\rmL$ is a lift of $\wh \rmL$.
\end{example}

One common way of producing homogeneous bundles is by applying a natural bundle functor $F$ to $G\slash H$. Since by definition such a functor maps local diffeomorphisms to bundle morphisms, $F(\wh{\rmL}_g)$ is a $G$-action as required in the definition of a homogeneous bundle. Thus, any natural bundle over a homogeneous space is homogeneous. As we will see below, the tangent bundle functor $T$ that we considered in the previous section is an example of this.

Let $E\to G\slash H$ be a homogeneous bundle. Consider the basepoint $[e]=eH\in G\slash H$ and the fiber $E_{[e]}$. The $G$-action on $E$ restricts to an $H$-action on $F$, thus we can build the associated bundle $G\times^H E_{[e]}\to G\slash H$. We now show that this bundle is isomorphic to $E$, thus characterizing all homogeneous bundles as bundles associated to principal bundles of the form $G\to G\slash H$.

\begin{thm}[{{\cite[Prop.~1.4.3]{Cap}}}]\label{prop 1.4.3 Cap}
    The mapping $E\to E_{[e]}$ (and restrictions of morphisms to the fiber) induces equivalences of categories $\FB(G,H)\simeq H\mathsf{-Man}$ and $\VB(G,H)\simeq H\mathsf{-FinVect}$, where $H\mathsf{-FinVect}$ is the category of finite-dimensional representations of $H$.
\end{thm}
\begin{proof}
    Consider the map $G\times E_{[e]}\to E$ given by $(g,f)\mapsto g\times f$, where we use the action of $G$ on $E$. Since the action $H\acts E_{[e]}$ is simply a restriction of this action, this map descends to a map $\varphi:G\times^H E_{[e]}\to E$ which is smooth since the projection $G\times E_{[e]}\to G\times^H E_{[e]}$ is a surjective submersion. Moreover, the definition $\varphi=g\cdot f$ implies that $\varphi$ covers the identity and is also right $G$-equivariant, so it is a morphism of homogeneous bundles.

    Now we build the inverse morphism. If $p\in E$, then by transitivity there exists a $g\in G$ such that $g\cdot \pi_E(p)=[e]$. Then $\pi_E(g\cdot p)=[e]$, so $g\cdot p\in E_{[e]}$, and we may consider $[(g^{-1},g\cdot p)]\in G\times^H E_{[e]}$. This is independent of the choice of $g$, since for another choice $g'\in G$ we must have $(g'g^{-1})\cdot p=p$, thus $g'g^{-1}\in H$, and thus
    \[[(g^{\prime-1},g'\cdot p)]=[(g^{\prime-1}g'g^{-1},gg^{\prime-1}g'\cdot p)]=[(g^{-1},g\cdot p)].\]
    Thus we get a well-defined map $\psi:E\to G\times^H E_{[e]}$. Choosing a local smooth section $s$ of $G\to G\slash H$ we can locally write $\psi(p)=[(s(\pi_e(p))^{-1},s(\pi_E(p))\cdot p)]$, which shows that $\psi$ is smooth. One immediately verifies that $\psi$ and $\varphi$ are mutually inverse bundle isomorphisms.

    To verify functoriality, if $\vartheta:E\to E'$ is a morphism of homogeneous bundles, then $\vartheta(E_{[e]})\subset E_{[e]}'$ and the restriction $\restr{\vartheta}{E_{[e]}}:E_{[e]}\to E_{[e]}'$ is $H$-equivariant. Equivariance of $\vartheta$ implies that for $g\in G$ and $f\in E_{[e]}$, we get $\vartheta(g\cdot f)=g\cdot \vartheta(f)$ which means that $\vartheta(\varphi([(g,f)]))=\varphi'([(g,\restr{\vartheta}{E_{[e]}}(f))])$, so we see that identifying $E$ and $E'$ with $G\times^H E_{[e]}$, respectively, $G\times^H E_{[e]}'$, the map $\vartheta$ is induced by $\id\times \restr{\vartheta}{E_{[e]}}$. Conversely, any $H$-equivariant map $F\to F'$ clearly induces a morphism of associated homogeneous bundles.

    Finally, note that for a homogeneous \gls{vb}, the above construction clearly produces an isomorphism $G\times^H E_{[e]}\to E$ of homogeneous \glspl{vb}, and homogeneous \glspl{vb} correspond to linear $H$-equivariant maps between their typical fibers.
\end{proof}

Thus an alternative definition of homogeneous bundles is simply as bundles associated to principal bundles of the form $G\to G\slash H$. Functoriality implies that these equivalences are compatible with various constructions such as fibered produces, Whitney sums, tensor products, etc. Conversely, for example, a decomposition of a tensor product of representations into a direct some of smaller representations induces a similar decomposition of corresponding Whitney products of homogeneous \glspl{vb}.

\begin{example}\label{ex 1.4.3 Cap}
    The  tangent  bundle $\T(G\slash H)$ that we studied in Proposition~\ref{prop 4.5.1 Sharpe} is clearly homogeneous because the left action $\wh{\rmL}_g$ on $G\slash H$ induces a lifted action $\wh{\rmL}_{g\ast}$ on $\T(G\slash H)$, and it corresponds to the $H$-representation on $\frakg\slash \frakh$ coming from the restriction to $H$ of the adjoint representation of $G$. The isomorphism with $G\times^H (\frakg\slash\frakh)$ established in that proposition is exactly the same as what we would obtain from Proposition~\ref{prop 1.4.3 Cap}. Namely, it maps $X\in \T_{gH}(G\slash H)$ to $[(g^{-1},\omega(Y)+\frakh)]$, where $Y\in \T_g G$ is some lift of $X$, i.e., $\pi_\ast Y=X$.

    By the naturality of the correspondence, the cotangent bundle $\T^\ast(G\slash H)$ corresponds to the dual representation $(\frakg\slash\frakh)^\ast$. Note that the latter is just the annihilator of $\frakh$ in $\frakg^\ast$, so this is a subrepresentation of the restriction of the coadjoint representation of $G$ to $H$. Again, by naturality, the tensor bundle $\T^k_l G\slash H$ corresponds to $\bbT^k_l(\frakg\slash\frakh)=(\frakg\slash\frakh)^{\otimes k}\otimes (\frakg\slash\frakh)^{\ast\otimes l}$.
\end{example}


Finally, we provide a similar classification of principal homogeneous bundles.

\begin{prop}[{{\cite[Lem.~1.4.5]{Cap}}}]
    Let $(G,H)$ be a homogeneous space and $K$ a Lie group. Let $P\to G\slash H$ be a homogeneous principal $K$-bundle of type $(G,H)$. Then there is a smooth homomorphism $\lambda:H\to K$ such that $P\cong G\times^H K=G^{[\lambda]}$, where the action of $H$ on $K$ is $h\cdot k=\lambda(h)k$.

    The bundles corresponding to two homomorphisms $\lambda,\lambda':H\to K$ are (vertically) isomorphic  iff $\lambda$ and $\lambda'$ are conjugate, i.e., $\lambda'(h)=k\lambda(h)k^{-1}$ for some $k\in K$ and all $h\in H$.
\end{prop}
\begin{proof}
    Let $P_{[e]}$ be the fiber of $P$ over $[e]=eH\in G\slash H$. The left $G$-action on $P$ restricts to a left $H$-action on $P_{[e]}$, and $P\cong G\times^H P_{[e]}$ as homogeneous bundles. Fixing a point $p_0\in P_{[e]}$, the map $k\mapsto p_0\cdot g$ is a diffeomorphism $K\to P_{[e]}$, so it remains to describe the $H$-action in this picture.

    For $h\in H$, we have $h\cdot p_0\in P_{[e]}$, so there is a unique element $\lambda(h)\in K$ such that $h\cdot p_0=p_0\cdot \lambda(h)$. By smoothness of the two actions, the map $\lambda:H\to K$ defined this way is smooth, and $\lambda(e)=e$. Since $H$ acts by principal bundle maps, we see that $h\cdot (p_0\cdot k)=(h\cdot p_0)\cdot k=p_0\cdot \lambda(h)k$. From here, $\lambda$ is a homomorphism.

    Suppose that we are given an isomorphism $G\times_\lambda K\to G\times^{\lambda'}K$ of homogeneous \glspl{pfb}/ Then the restriction to the fibers over $[e]$ is a diffeomorphism $\phi:K\to K$ which commutes with the principal right $K$-action and is equivariant for the two left $H$-actions. By the first property, $\phi(k)=k_0k$, where $k_0=\phi(e)$. But then the second property reads as follows:
    \[k_0\lambda(h)k=\phi(\lambda(h)k)=\lambda'(h)\phi(k)=\lambda'(h)k_0k.\]
    In particular, $\lambda'(h)=k_0\lambda(h)k_0^{-1}$. Conversely, if $\lambda$ and $\lambda'$ are conjugate, right multiplication by $k_0$ induces a diffeomorphism with the two required equivariance properties. From Proposition~\ref{prop 1.4.3 Cap} we conclude that this gives rise to an isomorphism of homogeneous principal bundles. 
\end{proof}





\section{Kernels and jets}


Since we will in the future describe the group $G$ of a Klein geometry $(G,H)$ as defining a certain geometric structure on the manifold $G\slash H$, it is important to better understand the induced $G$-action on $G\slash H$, which is not necessarily faithful. In particular, the kernel $K$ acts trivially on $G\slash H$ and hence on the model tangent space $\frakg\slash\frakh$. However, the kernel of the isotropy representation $\underline{\Ad}:\frakh\to \GL(\frakg\slash\frakh)$ does not necessarily coincide with $K$ (it might be larger). In this section we examine how one could nevertheless compute $K$ using only infinitesimal information.

Let $G$ be a Lie group with Lie algebra $\frakg$. To each linear subspace $\frakl<\frakg$ and closed subgroup $H\sub G$, associate the closed subgroup $K_\frakl\sub H\sub G$ defined as follows:
\[K_\frakl\coloneqq \left\{h\in H\mid \forall A\in\frakg\;\; \Ad_h A-A\in \frakl\right\},\]
i.e., $\frakl$ is $K_\frakl$-invariant and the induced action of $\Ad(K_\frakl)$ on $\frakg\slash\frakl$ is also trivial.

\begin{lem}
    If $\frakl<\frakh$ is an $\Ad(H)$-invariant linear subspace then $K_\frakl\sub H$ is a closed normal subgroup.
\end{lem}
\begin{proof}
    For any $h\in H$ and $a\in H_\frakl$, the operator
    \[\Ad_{hah^{-1}}-\id_\frakg=\Ad_h\Ad_a\Ad_h^{-1}-\id_\frakg=\Ad_h(\Ad_a-\id_\frakg)\Ad_h^{-1}\]
    maps $\frakg$ to $\Ad_h (\frakl)=\frakl$ by definition of $K_\frakl$. Thus, $hah^{-1}\in K_\frakl$ and $K_\frakl$ is normal.
\end{proof}

Now let 
\[K_1\coloneqq K_{\frakh},\quad K_{i+1}\coloneqq K_{\frakk_i},\quad i\geq 1.\]
By induction, since $K_i\sub H$ is normal, $\frakk_i<\frakh$ is an ideal, and $K_{i+1}\sub H$ is also a closed normal subgroup (of $H$).

\begin{lem}
    If $(G,H)$ is a Klein geometry with kernel $K$ and $K_i\sub H$ is the sequence of normal subgroups of $H$ defined above, then 
    \[K=\bigcap_{i=1}^\infty K_i.\]
\end{lem}
\begin{proof}
    Let $M=G\slash H$. Every element $h\in K$ by definition acts trivially on $M$, hence preserves $\frakh$ and acts trivially on $\frakg\slash\frakh=\T_{[e]}(G\slash H)$, so lies in $K_1=K_{\frakh}$. Thus, $M_1\coloneqq G\slash K_1$ is identified with a $G$-invariant set of linear isomorphisms $\T_m M\to \frakg\slash\frakh$, $m\in M$. Therefore, $K$ acts trivially on $M_1$ as well. By induction, $K\subset \bigcap_i K_i$.

    % Denote by $G_0$ the identity component of $G$. Let $G'<G$ be the subgroup generated by $G_0\cup H$. Let $G''$ be the union of all connected components of $G$ of the coset form $hG_0$, $h\in H$. First, we show that $G''=G'$. Clearly $H\cup G_0\subset G''$ and each component $hG_0$ lies in $G'$, so $G''\subset G'$. On the other hand, for $h,h'\in H$, $hG_0g'G_0=hh'G_0$ because $G_0$ is a normal subgroup of $G$, therefore $G''$ is a subgroup of $G$. Finally, since $G''$ contains both $G_0$ and $H$, it contains the group generated by them, which is $G'$. Hence, $G'=G''$.

    Suppose that $N$ is a normal subgroup of $G$ that lies inside $H$. Then for $g\in G$ and $n\in N$,
    \[n(gH)=(ng)H=gNH=gH,\]
    so $N$ stabilizes every point of $M$, and thus $N<K$. Let $K'\coloneqq \bigcap_i K_i$. This is a closed subgroup by virtue of being the intersection of closed subgroups. Its Lie algebra $\frakk'$ is the smallest of the nested $\frakk_i$. For any $A\in\frakg$ and $k\in K'$, 
    \[\Ad_k A-A\in\frakk'.\]
    Thus, $\Ad_k$ acts trivially on $\frakg\slash\frakk'$. We can exponentiate in $G\slash K'$ to conclude that $\Adg_k$ acts trivially on the identity component $(G\slash K')_0$. In other words, $K'$ commutes with $(G\slash K')_0$, which means that $K'$ is normal in $G_0$ and in $H$, and thus normal in $G$ (which is generated by $G_0$ and $H$ since $G\slash H$ is connected by definition of Klein geometry). Thus, $K'\subset K$.
\end{proof}

As an immediate corollary, we find the following infinitesimal description of the kernel.

\begin{thm}[{{\cite[Thm.~4.4.1]{Sharpe}}}]\label{thm 4.4.1 Sharpe}
    Let $(G,H)$ be a Klein geometry with kernel $K$ and $\frakk=\Lief K$. Then 
    \[K=\{h\in H\mid \Ad_h X-X\in\frakk \text{ for all }X\in\frakg\}.\]
\end{thm}

As a special case, in effective Klein geometries there are no proper subgroups of $H$ whose lie algebra is $\Ad(H)$-invariant.

\begin{cor}[Fundamental property of effective Klein geometries{{\cite[Cor.~4.4.2]{Sharpe}}}]\label{Cor 4.2 Sharpe}
    If $(G,H)$ is an effective Klein geometry, $N$ is a subgroup of $H$, and $\frakn=\Lief N$, then
    \[N=\{h\in H\mid \Ad_h X-X\in\frakn \text{ for all }X\in\frakg\}\implies N=\{e\}.\]
\end{cor}

\begin{example}[Real projective space]\label{ex real projective Klein model}
    Consider the projective space $\RP^n$ as a homogeneous space of type $(G=\SL_{n+1}(\bbR),H)$ with $H$ the stabilizer of the basepoint $[e]=[\bf{e}_{n+1}]$, i.e., the set of unimodular matrices preserving $\bf{e}_{n+1}$ up to a scale. $H$ consists of matrices of the form 
    \[ \begin{pmatrix}
        a & \bf{0}_n \\
        \bf{x}^T & (\det a)^{-1} 
    \end{pmatrix},\quad a\in \GL_n(\bbR),\bf{x}\in\bbR^n.\]
    $H$ acts on $\frakg=\fraksl_{n+1}(\bbR)$ via conjugation. The tangent space $\T_{[e]}(\RP^n)=\frakg\slash\frakp$ then consists of elements of the form 
    $\left(\begin{smallmatrix}
        \ast & \bf{y} \\
        \ast & \ast
    \end{smallmatrix}\right)$, where $\ast$ stands for the entirety of the subspaces of $\frakh$ spanned by the corresponding components of the matrix. The $\Ad(H)$-action on this space reads 
    is acted on via 
    \[\begin{pmatrix}
        a & \bf{0}_n\\
        \bf{x}^T & (\det a)^{-1}
    \end{pmatrix}
    \begin{pmatrix}
        \ast & \bf{y} \\
        \ast & \ast 
    \end{pmatrix}
    \begin{pmatrix}
        a & \bf{0}_n\\
        \bf{x}^T & (\det a)^{-1}
    \end{pmatrix}^{-1}=
    \begin{pmatrix}
        \ast & (\det a) a\bf{y} \\
        \ast & \ast
    \end{pmatrix}.
    \]
    Thus, the elements of $H$ that act trivially on $\T_{[e]}(\RP^n)$ are precisely the subgroup $K_1\subset H$ of matrices with $a\bf{y} (\det a)=\bf{y}$ for all $\bf{y}\in\bbR^n$, i.e., 
    \[K_1=\left\{ 
        \begin{pmatrix}
            \lambda \rmI_n & \bf{0}_n \\
            \bf{x}^T & \lambda
        \end{pmatrix} \middle| \bf{x}\in\bbR^n,\lambda\in\bbR, \lambda^{n+1}=1
    \right\}, \quad \frakk_1=\left\{ 
        \begin{pmatrix}
            \mathrm{0}_{n,n} & \bf{x} \\
            \bf{0}_n^T & 0
        \end{pmatrix} \middle| \bf{x}\in\bbR^n\right\}.\]
    This subgroup $K_1<G$ is precisely the subgroup preserving both $[e]=[\bf{e}_{n+1}]\in\RP^n$ and the standard basis for $\T_{[e]}\RP^n$, so $G\slash K_1\to \RP^n$ is the frame bundle of $\RP^n$, i.e., the set of pairs $(m,u)$ of point $m\in \RP^n$ and linear isomorphism $u:\T_m\RP^n\to \bbR^n$.  To act trivially on $\RP^n$, an element of $G$ must lie in $K_1$, but it must also act trivially on the frame bundle of $\RP^n$, i.e., on $G\slash K_1$. By the same reasoning, it must act trivially on $\T_{u_0}(G\slash K_1)$, where $u_0$ is the standard basis of $\bbR^n$ viewed as a frame on $\RP^n$. But $\T_{u_0}(G\slash K_1)=\frakg\slash\frakk_1$, and we compute that $K_1$ acts on $\frakg\slash\frakk_1$ by 
    \[\begin{pmatrix}
        \lambda\rmI_n & \bf{0}_n\\
        \bf{b}^T & \lambda
    \end{pmatrix}
    \begin{pmatrix}
        A & \bf{y} \\
        \ast& d
    \end{pmatrix}
    \begin{pmatrix}
        \lambda\rmI_n & \bf{0}_n\\
        \bf{b}^T & \lambda
    \end{pmatrix}^{-1}=
    \begin{pmatrix}
        A-\lambda^{-1}\bf{y}\bf{b}^T& \bf{y}\\
        \ast  & d+\lambda^{-1}\bf{b}^T\bf{y}
    \end{pmatrix}.
    \]
    Now, $K_2$ is the set of elements of $K_1$ that act trivially, i.e., $0=\lambda^{-1}\bf{y}\bf{b}^T=\lambda^{-1}\bf{b}^T\bf{y}$ for all vectors $\bf{y}$, hence $\bf{b}=0$. Thus, $K_2$ is 
    \[K_2=\left\{ 
        \begin{pmatrix}
            \lambda \rmI_n & 0 \\
            0 & \lambda
        \end{pmatrix} \middle| \lambda\in\bbR, \lambda^{n+1}=1
    \right\}=\rmZ(\SL_{n+1}(\bbR)).\]
    This is clearly the kernel of this Klein geometry, as these are precisely the elements of $G$ that act trivially on $\RP^n$. As a consequence, the projective model $\RP^n\cong \PSL_{n+1}(\bbR)\slash (H\slash K)$ is effective.
\end{example}


Next, recall that the $r$-jet of a smooth map can be identified, given a particular coordinate chart, with the Taylor series of that map up to and including $r$-th order derivatives. We now show that $K_r$ consists of exactly those elements of $G$ which induce diffeomorphisms of $G\slash H$ with trivial derivatives up to order $r$ (by trivial we mean they coincide with the derivatives of the identity map).

\begin{lem}
    The subgroup $K_r\sub G$ is precisely the set of elements $g\in G$
    such that the $r$-th jet at $[e]$ of the induced action $\wh{\rmL}_g$ on $M=G\slash H$ is the same as that of the identity map:
    \[K_r=\left\{g\in G: \rmj^k_{[e]}\wh{\rmL}_g=\rmj^k_{[e]}\id_{M}\right\}.\]
\end{lem}
\begin{proof}
    For $r=1$, $K_1=K_{\frakh}$ is the set of elements $h\in H$ such that $\underline{\Ad}_h$ is trivial. But, as established above, $\underline{\Ad}$ is exactly the isotropy representation of the action $\wh{\rmL}$, i.e., $\underline{\Ad}_h$ being trivial is equivalent to the first derivative of $\wh{\rmL}_h$ at $[e]$ being the identity.

    Now we prove for $r>1$ by induction. Assume that the statement is known for all $i\leq r-1$. To each $g\in G$ we associate the $r$-th order jet $\rmj^r_{[e]}\wh{\rmL}_g$ (its target is $gH\in M$). This defines a smooth map into the $r$-th jet space (and in particular invertible $r$-jets):
    \[\Phi_r\coloneqq \rmj_{[e]}^r\circ \wh{\rmL}_{\smbullet}: G\to \rmJ^r_{[e]}(M,M)^\times.\]
    By hypothesis, $K_{r-1}$ is exactly the elements of $G$ whose $r$-jets are trivial:
    \[K_{r-1}=\Phi_{r-1}^{-1}\left(e_r\right), \quad \text{ where }e_r\coloneqq \rmj^r_{[e]}\id_M.\]
    Thus, $\Phi_{r-1}$ descends to an \emph{injective immersion} of the quotient manifold
    \[\varphi_{r-1}:G\slash K_{r-1}\hookrightarrow \rmJ^{r-1}_{[e]}(M,M)^\times.\]
    Therefore, we can identify $G\slash K_{r-1}$ with the submanifold $\varphi_{r-1}(G\slash K_{r-1})< \rmJ^{r-1}_{[e]}(M,M)^\times$, and replace the action $\wh{\rmL}_k$, $k\in K_{r-1}$ on $G\slash K_{r-1}$ with the action of $\rmj^{r-1}_{[e]}\wh{\rmL}_k$ on $\rmJ^{r-1}_{[e]}(M,M)^\times$ by pre-composition of jets. This is well-defined because $\wh{\rmL}_k$ preserves the basepoint of $G\slash K_{r-1}$.
    
    By definition, $K_r$ is the subgroup of $K_{r-1}$ acting trivially on the tangent space of $G\slash K_{r-1}$ at the basepoint, i.e., the kernel of the isotropy representation of the Klein geometry $(G,K_{r-1})$. Thus, via the above identification with a submanifold of $\rmJ^{r-1}_{[e]}(M,M)^\times$, the subgroup $K_r$ can be identified with those elements of $K_{r-1}$ whose $1$-jets of the $(r-1)$-jets vanish. But this is the same as the vanishing of the $r$-jets: 
    \[K_r=\left\{k\in K_{r-1}: \rmj^1_{[e]}\circ \rmj^{r-1}_{[e]}\circ\wh{\rmL}_k=e_r\right\}=\left\{g\in G: \rmj^r_{[e]}\circ \wh{\rmL}_g=e_r\right\}.\]
    Indeed, since $\varphi_{r-1}$ is an immersion, the triviality of the derivative of its composition with $\wh{\rmL}_k$ is equivalent to the triviality of the derivative of $\wh{\rmL}_k$ itself. This concludes the induction step.
\end{proof}



\begin{example}[\ref{ex real projective Klein model} continued]
    Consider the projective space $\RP^n$ viewed as a Klein geometry $(G,H)$ with $G=\PGL_{n+1}$. As we saw, $G\slash K_1$ is the frame bundle of $\RP^n$, i.e., all of $\rmJ^1_{[e]}(\RP^n,\RP^n)^\times$. Thus, any linear isomorphism of tangent spaces of $\RP^n$ arises as the first derivative of a projective transformation. Then $K_2$ is trivial, and $G\slash K_2=G=\PGL_{n+1}\subset \rmJ^2_{[e]}(\RP^n,\RP^n)^\times$ is the set of $2$-jets of projective transformations: a projective transformation is determined by its $2$-jet. Moreover, the set of $2$-jets with a given $1$-jet is $K_1\slash K_2=K_1$, the group of projective transformations of the form 
    \[\begin{pmatrix}
        \rmI_n & \bf{0}_n\\
        \bf{x}^T & 1
    \end{pmatrix},\quad \bf{x}\in\bbR^n,\]
    modulo multiplication by $(n+1)$-roots of unity.  So the space of $2$-jets of projective transformations with a given $1$-jet has dimension $n$.
\end{example}

\begin{example}[Complex projective space]
    Similarly, $\CP^n\cong \SL_{n+1}(\bbC)\slash H$, where $H$ is the stabilizer of $[\bf{e}_{n+1}]$. We also note that $\PSL_{n+1}(\bbC)\cong \PGL_{n+1}(\bbC)$ (cf.\ Exercise~\ref{xca psl=pgl}), and everything we found in Example~\ref{ex real projective Klein model} carries over to the complex case with the substitution $\bbR \to \bbC$. We find that the kernel is 
    \[K=K_2=\rmZ(\SL_{n+1}(\bbC))=\{\lambda \rmI_{n+1}\mid \lambda\in\bbC ,\lambda^n=1\}.\]
    As a consequence, the projective model $(\PSL_{n+1}(\bbC),H\slash K)=(\PGL_{n+1}(\bbC),H\slash K)$ is effective. 

    The most important example of course is the Riemann sphere $\CP^1\cong \PGL_2(\bbC)\slash (H\slash K)$, where $\PGL_2(\bbC)$ is the M\"obius group.
\end{example}







\section{Frobenius reciprocity}\label{sec: Frobenius reciprocity}

Consider the set $\Gamma^\infty(E)$ of sections of a homogeneous vector bundle $E\to G\slash H$. There is a natural left $G$-action on $\Gamma^\infty(E)$ defined by
\[g\cdot s\coloneqq \wt{L}_g\circ s\circ\wh{\rmL}^{-1}_g,\]
where $\wt L$ and $\wh L$ are the actions on $E$ and $G\slash H$, respectively. Note that this particular combination of the two actions is required so that sections get mapped to sections, i.e., so that the action preserves the point in the base.

\begin{defn}[Induced representation]\index{Induced representation}
    Let $(G,H)$ be a homogeneous space, $G\acts V$ a finite-dimensional linear representation $G$, and $E=G\times^H V$ be the corresponding homogeneous \gls{vb}. The representation of $G$ on $\Gamma^\infty(E)$ defined above is called the \emph{induced representation} of $G$, denoted $\Ind^G_H(V)$. The association functor for bundles makes this a functor of $V$.

    In addition, we denote by $\Res^G_H(V)$ the representation of $H$ on $G$ obtained by restriction of the representation of $G$. This is also obviously functorial in $V$.
\end{defn}

The correspondence between sections of an associated bundle and equivariant functions on the principal bundle (Proposition~\ref{prop 1.2.6 RS2}) gives rise to another interpretation of the induced action of $G$ on sections. This picture is (in the case of homogeneous \glspl{vb}) frequently used in representation theory. Namely, via the isomorphism $E\cong G\times^H E_{[e]}$ from Proposition~\ref{prop 1.4.3 Cap}, we can identify $\Gamma^\infty(E)$ with $\Gamma\left(G\times^H E_{[e]}\right)$, which in turn by Proposition~\ref{prop 1.2.6 RS2} is in bijective correspondence with the set $\Hom_H(G,E_{[e]})$. Explicitly, the correspondence between a section $s$ and a function $\varphi$ is characterized by $s(gH)=[(g,\varphi(g))]=g\cdot \varphi(g)$ or by $\varphi(g)=g^{-1}\cdot s(gH)$. In the case of a homogeneous vector bundle, this bijection is clearly a linear isomorphism.

To get the action of $G$ on $\Gamma^\infty(E)$ in the picture of equivariant functions, we only have to notice that by definition $(g\cdot  s)(g'H)=g\cdot  s(g^{-1}g'H)$. Consequently, the map $g\cdot f:G\to E_{[e]}$ corresponding to $g\cdot s\in \Gamma^\infty(E)$ is given by none other than the natural action by pullbacks $\rmL_g^\ast$:
\[(g\cdot \varphi)(g')=g^{\prime-1}\cdot(g\cdot s(g^{-1}g'H))=(g^{-1}g')^{-1}\cdot s(g^{-1}g'H)=\varphi(g^{-1}g').\]

The next fundamental result shows that in certain situations one can reduce questions about the infinite-dimensional space $\Gamma^\infty(E)$ to questions about the finite-dimensional manifold $E_{[e]}$. In particular, determining $G$-invariant sections of a homogeneous bundle always reduces to a finite-dimensional problem.

\begin{thm}[Geometric Frobenius reciprocity {{\cite[Thm.~1.4.4]{Cap}}}]\label{thm 1.4.4 Cap}
    Let $E\to G\slash H$ be a homogeneous bundle with standard fiber $E_{[e]}$ (viewed as an $H$-space), and let $X$ be a smooth manifold endowed with a smooth left $G$-action. Then the evaluation at $[e]$ induces a natural bijection between the set of $G$-equivariant maps $X\to \Gamma^\infty(E)$ and the set of $H$-equivariant maps $X\to E_{[e]}$. In particular, there is a natural bijection between the set $\Gamma^\infty(E)^G$ of $G$-invariant sections of $E$ and the set $(E_{[e]})^H$ of $H$-invariant elements of the typical fiber.

    If $E$ is the homogeneous \gls{vb} induced by an $H$-representation $W$, and $V$ is a representation of $G$, then the bijections above are linear and respect the subspaces of linear equivariant maps, so that there is a natural linear isomorphism
    \[\Hom_G\left(V,\Ind^G_H(W)\right)\cong \Hom_H\left(\Res^G_H(V),W\right),\]
    i.e., $\Res^G_H$ and $\Ind^G_H$ are adjoint functors.
\end{thm}
\begin{proof}
    Suppose are given a map $X\to\Gamma^\infty(E)$ written as $x\mapsto  s_x$. This map is $G$-equivariant iff $ s_{g\cdot x}(g'H)=g\cdot s_x(g^{-1}h'H)$. In particular, if we consider the map $X\to E_{[e]}$ defined by $x\mapsto  s_x([e])$, then for $h\in H$, we get $ s_{h\cdot x}([e])=h\cdot  s_x(h^{-1}\cdot[e])=h\cdot s_x([e])$, so this is $H$-equivariant. 
    
    Conversely, if $\varphi:X\to E_{[e]}$ is $H$-equivariant, then for $x\in X$ we define $ s_x:G\slash H\to E$ by $ s_x(gH)=g\cdot \varphi(g^{-1}\cdot x)$. This is well defined since $\varphi(h^{-1}g^{-1}\cdot x)=h^{-1}\cdot \varphi(g^{-1}\cdot x)$, and thus $gh\cdot \varphi(h^{-1}g^{-1}\cdot x)=g\cdot \varphi(g^{-1}\cdot x)$. Moreover, $ s_x([e])=\varphi(x)$ and 
    \[ s_{g\cdot x}(g'H)=g'\cdot \varphi(g^{\prime-1}g\cdot x)=g\cdot g^{-1}g'\cdot \varphi(g^{\prime-1}g\cdot x)=g\cdot s_x(g^{-1}g'H),\]
    so $x\mapsto  s_x$ is $G$-equivariant. Since for any $G$-equivariant map $x\mapsto  s_x$ we must have $ s_x(gH)=g\cdot g^{-1}\cdot  s_x(g^{-1}gH)=g\cdot  s_{g\cdot x}([e])$, the two constructions are inverse bijections between the set of $G$-equivariant maps $X\to \Gamma^\infty(E)$ and the set of $H$-equivariant maps $X\to E_{[e]}$.

    Taking $X=\{*\}$ a single point with the trivial $G$-action, a $G$-equivariant map $X\to \Gamma^\infty(E)$ is just a $G$-invariant section $g\cdot  s_*= s_*$, and a $H$-equivariant map $X\to E_{[e]}$ is an $H$-invariant element in $E_{[e]}$. Thus we get a bijection $\Gamma^\infty(E)^G\to (E_{[e]})^H$.

    Finally, if $E$ is a natural \gls{vb} induced by an $H$-representation $W$ and $X$ is a $G$-representation $V$, then $\Lin(V,\Gamma^\infty(E))$ and $\Lin(V,E_{[e]})$ are vector spaces under the pointwise operations, and the evaluation at $[e]$ induces a linear map $\Lin(V,\Gamma^\infty(E))\to \Lin(V,E_{[e]})$. If we start from a linear map $\varphi:V\to E_{[e]}$, the construction above produces $ s_v(gH)=g\cdot \varphi(g^{-1}\cdot v)$. Since $\varphi$ is linear and $G$ acts by linear maps, this is linear in $v$.
\end{proof}

\begin{example}[Spherical harmonics]
    Looking ahead, we can take $H$ to be a maximal torus subgroup $T\sub G$. Since $T$ is abelian, its irreducible representations (irreps) are one-dimensional and are called \emph{weights}, labeled by $\lambda$. The associated homogeneous line bundles over $G\slash T$ are denoted $L_\lambda$. Further if $V_\gamma$ is an irrep of $G$ (labeled by a highest weight $\gamma$, irrelevant to this statement), then by Schur's Lemma the dimension of the space $\Hom_G(V_k,\Gamma^\infty(L_n))$ is simply counting the multiplicity of $V_k$ in the decomposition of $\Gamma^\infty(L_n)$ into irreps. Therefore the Frobenius reciprocity in the language of representation theory states that the multiplicity of a $G$-irrep $V_\gamma$ in the decomposition of $\Gamma^\infty(L_\lambda)$ is equal to the multiplicity of the weight $\lambda$ in $V_\gamma$. If $G$ is compact, then for any given weight $\lambda$, the induced representation $\Gamma^\infty(L_\lambda)$ will decompose into an infinity of irreducibles (because each is finite-dimensional for compact $G$), namely all those that contain the weight $\lambda$.

    Consider $G=\SU_2$ and $T=\U_1$ the subgroup fixing a vector. Then $G\slash T\cong \bbS^2$. Since $T$ is abelian, all of its representations decompose into sums of one-dimensional (hence irreducible) ones, and the one-dimensional representations are labeled by an integer $n\in\bbZ$ (namely the representation is given by multiplication by $z^n$, where $z\in\U_1\subset \bbC$). Meanwhile the irreducible representations $V_k$ of $\SU_2$ are known to be labeled by non-negative integers $k$, where $k$ is the largest integer that occurs when you restrict $V_k$ to be a $\U_1$ representation. Frobenius reciprocity implies
    \[\dim\Hom_{\SU_2}(V_k,\Gamma^\infty(L_n))=\dim \Hom_{\U_1}(V_k,n)\]
    where $L_n$ is the complex line bundle over $\bbS^2$ corresponding to $n$. The right hand side is the multiplicity of the weight $n$ in $V_k$ (that is, the multiplicity of $n$ in the restriction of the representation on $V_k$ to $T$). Since we know what the weights of $V_k$ are ($-k,-k+2,\ldots,k-2,k$, all with multiplicity one), we can see that the decomposition of $\Gamma^\infty(L_n)$ into irreducibles will include all $V_k$ where $k$ is the same parity as $n$ and $k\geq n$.

    In the case $n=0$, $L_0$ is the trivial $\bbC$-bundle and $\Gamma^\infty(E_0)\cong C^\infty(\bbS^2,\bbC)$ is just the space of complex-valued functions on $\bbS^2$. Only $V_k$ with even $k$ include the weight $0$, therefore $C^\infty(\bbS^2,\bbC)$ decomposes into a sum of such irreps. To compute the multiplicity of each of them, we use Frobenius reciprocity. As stated above, the multiplicity of $n=0$ in $V_{2l}$ is $1$. For analytic reasons that will be clarified in the Peter-Weyl theorem, the direct sum of all the $V_{2l}$, once endowed with a proper topology and completed, is not exactly $C^\infty(\bbS^2)$, but rather the Hilbert space $L^2(\bbS^2)$ of square integrable functions:
    \[L^2(\bbS^2,\bbC)\cong \bigoplus_{l=0}^\infty V_{2l}.\]
    This holds both over reals and complexes. The space $V_{2l}$ is $(2l+1)$-dimensional and a standard basis is given by the spherical harmonics $Y^l_m(\theta,\varphi)$. If we replace $\SU_2$ by $\SO_3$, the only difference is that $V_k$ with odd $k$ disappear from the list of irreps, so the final result for $n=0$ is the same. This is the beginning of the subject of \emph{harmonic analysis} (and in particular Fourier transforms) on Lie groups.
\end{example}








The geometric version of Frobenius reciprocity immediately allows us to reduce questions about the existence of invariant Riemannian metrics and other invariant tensor fields to problems of finite-dimensional representation theory: if $M=G\slash H$ is a homogeneous space, then from Proposition~\ref{prop 1.4.3 Cap} we know that the tensor bundle $\bbT^k_lM$ is associated to $G\to M$ w.r.t.\ the representation $\bbT^k_l(\frakg\slash \frakh)$. By Frobenius reciprocity, $G$-invariant sections of this bundle are in bijective correspondence with $H$-invariant elements in the representation. Since invariant elements are the same as homomorphisms from the trivial representation, this can be rephrased in such a way that the dimension of invariant tensor fields of type $\left(\begin{smallmatrix}k\\l\end{smallmatrix}\right)$
on $G\slash H$ equals the multiplicity of the trivial representation in $\bbT^k_l(\frakg\slash\frakh)$. Moreover, the proof of Theorem~\ref{thm 1.4.4 Cap} gives an explicit construction of the invariant tensor field from the invariant element in the representation. Clearly, the whole construction respects symmetries of any kind, so invariant tensor fields having certain symmetries are in correspondence with invariant elements of the representations having the same symmetries. Finally, if we consider (pointwise) questions of non-degeneracy they clearly reduce to the analogous non-degeneracy properties in the representation. In particular, the set of $G$-invariant Riemannian metrics on $G\slash H$ is in bijective correspondence with the set of $H$-invariant inner products on $\frakg\slash\frakh$. Hence, we get
\begin{cor}
    A homogeneous space $G\slash H$ admits a $G$-invariant Riemannian metric iff the image $H_1=\underline{\Ad}(H)\subset \GL(\frakg\slash\frakh)$ of $H$ under the map induced by the restriction to $H$ of the adjoint representation of $G$ has compact closure in $\GL(\frakg\slash\frakh)$.
\end{cor}
\begin{proof}
    From above we know that existence of an invariant Riemannian metric is equivalent to existence of an $H_1$-invariant positive definite inner product on $\frakg\slash\frakh$. If such an inner product exists, then $H_1$ is contained in the orthogonal group of this  product, which is compact. Hence $H_1$ has compact closure. Conversely, if $K\subset \GL(\frakg\slash\frakh)$ is a compact subgroup containing $H_1$, then averaging any inner product on $\frakg\slash\frakh$ over $K$ (as in Proposition~\ref{prop 5.5.6 RS1}) gives a $K$-invariant and thus a $H_1$-invariant inner product.
\end{proof}

\begin{example}
    \begin{enumerate}
        \item Viewing the sphere $\bbS^n$ as the homogeneous space $\Or_{n+1}\slash \Or_n$, we have $H=\Or_n$ and the $H$-representation $\frakg\slash\frakh\cong\bbR^n$ is just the standard one, so the set of $\Or_{n+1}$-invariant Riemannian metrics on $\bbS^n$ consists exactly of all constant positive multiples of the standard metric (since the same statement holds on $\bbR^{n+1}$).
        \item The description of invariant Riemannian metrics on $\bbR^n$, viewed as a homogeneous space of the Euclidean group $\SE_n$ is exactly the same. 
        \item For the projective sphere we have $H_1=\GL(\frakg\slash\frakh)$, so there is certainly no $\SL_{n+1}(\bbR)$-invariant metric on $\bbS^n$. Similarly, one shows that on the contact, conformal, and CR spheres there are no invariant Riemannian metrics.
    \end{enumerate}
\end{example}






\chapter{Differential Equations and Symmetry}






\clearpage
\chapter{Exterior Differential Systems}\label{sec: PDEs}


This \chap\ is devoted to the first side of Cartan geometry, namely as a study of geometric structures described by systems of PDEs.
Much like in the Frobenius Theorem, which is the basic special case, the goal is to reduce the problem of the existence of solutions to a certain problem of linear algebra on the $C^\infty(M)$-module of differential forms on $M$. Since linear algebra on modules is exactly what homological algebra studies, it should not come as a surprise that this \chap\ will also see our first encounter with cohomology.

Why, one might ask, would we be interested in existence results for solutions of PDEs when doing geometry? The main question that Cartan's theory answers for a given PDE is \emph{which initial value problems for it are well-posed}. In geometric context, we will think of a PDE with a well-posed initial condition as a \emph{compressed form} of its unique solution. The ``initial values'' will be the \emph{differential invariants} describing certain geometric structures, and the PDE itself will be some form of a \emph{structure equation} (related to the Maurer-Cartan equation). The unique solution then will be a geometric structure on the underlying manifold. Thus, Cartan's analysis of PDEs will allow us to ``distill'' very general geometric structures down to a minimal set of quantities that suffice to describe them (for example, isometric embeddings of Riemannian surfaces are described by two scalar curvatures subject to a certain compatibility condition).

Since this theory will be concerned specifically with \emph{analytic} solutions to differential equations (i.e., those expressed by convergent Taylor series), we start with the most classical setting -- finding the flow of an analytic vector field. The next natural step will be to look for integral manifolds of a system of many analytic vector fields, which is the setting for the Frobenius Theorem. Its analytic version will be subsumed by the Cartan-K\"ahler theory presented below. Unfortunately, there are few quality sources on this topic, so the material in this \chap\ is mainly synthesized from the excellent books \cite{Bryant,Ivey,McKayEDS}. In particular, the book by Bryant, who is an ``academic grandchild'' of \'Elie Cartan, is the most detailed reference on \glspl{eds}.




\section{Cauchy-Kovalevskaya theorem}


For real variables $x^1,x^2,\ldots,x^n\in\bbR$ and integers $k_1,k_2,\ldots,k_n\geq 0$ we use multi-index notation \index{Multi-index}
\begin{align}
    \bm{k}&=(k_1,\ldots,k_n), &\bm{k}!&=k_1!\cdots k_n!,&  |\bm{k}|&=k_1+\cdots+k_n,\\
    \bf{x}&=(x^1,\ldots,x^n), &\bf{x}^{\bm{k}}&=(x^1)^{k_1}\cdots (x^n)^{k_n},& \partial^{\bm k}_{\bf x}=\frac{\partial^{|\bm{k}|}}{\partial\bf{x}^{\bm k}}&=\partial^{k_1}_{x^1}\cdots \partial^{k_n}_{x^n}.
\end{align}

\textbf{Warning on notation:} in the context of PDEs it is conventional to denote partial derivatives by subscripts. When this does not clash with geometric notation, we will do so as well. For example, a function $u(t,x)$ has partial derivatives $u_t=\partial_t u$, $u_{x}=\partial_x u$, $u_{tt}=\partial_t^2 u$, and so on. In addition, contravariant induces like $x^i$ can clash with power exponents. In the context of power series, we will reserve superscripts for exponents. Elements of standard vector spaces such as $\bbR^n$, $\bbR^{r\times s}$, etc., will be denoted by bold symbols, e.g., $\bf{x},\bf{u},\bf{p}$. Matrix-valued derivatives of vector-valued functions w.r.t.\ vector arguments will be written e.g., as $\bf{p}=\bf{u}_{\bf{x}}$.

\begin{defn}[Formal power series]\index{Formal power series}
    A formal power series in $\bf{x}$ centered at $\bf{x}_0\in\bbR^n$ is an expression $\sum_{\bm{k}\in\bbN^n}c_{\bm k}(\bf{x}-\bf{x}_0)$ with real constants $c_{\bm k}$. The set $\bbR\llbracket\bf{x}\rrbracket$ of all formal power series in $\bf{x}$ has an obvious structure of a real vector space isomorphic to $\bbR^{\bbN^n}$. Moreover, it is an algebra under multiplication, and the operator $\partial^{\bf{m}}$ is well-defined. Finally, power series $f$ and $g$ can be composed, $f\circ g$, if $f(0)=0$ (well-defined because each coefficient the series $f\circ g$ depends only on finitely many of the input terms). Each of these operations only adds or multiplies coefficients, so in particular, the set of series with positive coefficients is preserved by all of these operations.
\end{defn}

\begin{defn}[Germ of an analytic function]
    A formal power series that converges within some radius $r>0$ is called a germ of an analytic function.\index{Germ of an analytic function} Germs also form an algebra and can be differentiated and composed (if the outer germ has no constant term).
\end{defn}

\begin{defn}[Majorants]
    A formal power series $f=\sum_{\bm k} b_{\bm k}\bf{x}^{\bm k}$ with non-negative coefficients is said to majorize $g=\sum_{\bm k} c_{\bm{k}}\bf{x}^{\bm k}$ if $b_{\bm k}\geq |c_{\bm k}|$ for all $\bm{k}$. If a convergent series majorizes another, the latter is absolutely convergent. If $f$ majorizes $g$ and $u$ majorizes $v$, then $f\circ u$, $f+u$, $fu$, $\partial^{\bf{m}}f$ majorizes $g\circ v,g+v,gv,\partial^{\bm m}g$, respectively. 
\end{defn}

\begin{example}
    The geometric series $(1-t)^{-1}=\sum_k t^k$ has positive coefficients. Any other series $c_k t^k$ with $|c_k|<1$ is majorized by the geometric series, and hence converges for $|t|<1$.  Rescaling $t$ and the series, we see that if a formal power series is majorized by a geometric series, then it is an analytic germ. Note that $(1-t)\in\bbR\llbracket t\rrbracket$, so the convergence of the geometric series can be understood as the statement of its invertibility in this ring.
\end{example}

\begin{lem}\label{lem 121}
    A formal power series is a germ of an analytic function iff it is majorized by a product of geometric series in one variable each.
\end{lem}
\begin{proof}
    We give the proof for one variable, and the general case is analogous. Take any analytic germ $f(x)=\sum_k c_k x^k$ near the origin. Since it converges absolutely for $x$ near $0$, $\sum_k |c_k| r^k$ converges for $r$ close to $0$, so the terms of this series are bounded. Rescale to get a bound of $1$, i.e., $|c_k|r^k<1$ for all $k$. 
    Therefore $|c_k|\leq r^{-n}$, so $f$ is majorized by $(1-x)^{-1}$.
\end{proof}

\begin{xca}
    \begin{enumerate}
        \item Prove that any two germs of analytic functions centered at the same point that converge to the same analytic function must coincide.
        \item Prove that if $f(\bf{x})=\sum_{\bm k} c_{\bm k} {\bf x}^{\bm k}$ converges for $|\bf x|<r$, then it also has convergent power series centered at any other point $|\bf{x}_0|<r$.
        \item Prove that any two analytic functions defined on a connected open set which agree on any open subset must agree everywhere. This property is called \emph{uniqueness of analytic continuation}. In fact, agreement on a convergent sequence of points suffices.
        \item Notably, if $f_1,f_2$ are analytic on two \emph{different} but overlapping domains $U_1,U_2$, respectively, then their agreement on any one connected component of $U_1\cap U_2$ does \emph{not} imply agreement on others. 
        
        For example, defining the \emph{argument} \index{Argument of a complex number} of a complex number $z=r\rme^{\i \varphi}$ by $\arg(z)=\varphi$ for $\varphi\in (-\pi,\pi]$, we have that $f_1(z)=\sqrt{|z|}\rme^{\i \arg z/2}$ (i.e., the square root with branch cut $(-\infty,0]$) is analytic on $U_1=\bbC\setminus (-\infty,0]$ and $f_2(z)=\sqrt{r}\rme^{\i \varphi/2}$ for $\varphi\in [0,2\pi)$ (the square root with branch cut $[0,+\infty)$), then the overlap $U_1\cap U_2=\bbC^+\cup \bbC^-$ consists of two disjoint open half-planes, and $f_1=\pm f_2$ on $\bbC^\pm$. 
        
        We conclude that a sequence of analytic functions $(f_i)$ defined on connected open domains $U_i\subset\bbC^n$ such that $f_{i+1}=f_i$ on $U_i\cap U_{i+1}$ do not necessarily determine a (single-valued) analytic function on $U=\bigcup_i U_i$. This failure can happen if $U$ allows for loops that cannot be decomposed as products of loops, each of which is homotopic to a loop wholly contained in just one of the $U_i$ (we have to allow the basepoints to move freely as well since not all $U_i$ overlap). Nevertheless, we do get an analytic function on the universal covering space of $U$ (and in fact on a smaller covering space of $U$ if we quotient out $\pi_1(U_i)$), which can also be viewed as a \emph{multi-valued} function on $U$. Thus, the phenomenon of the change in the value of an analytic function after analytic continuation along a loop is known as \emph{monodromy} by analogy with covering spaces.\index{Monodromy!of analytic continuation}
    \end{enumerate}
\end{xca}

By a similar majorization argument, every power series on $\bbR^n$ that converges within open subset $D$, also converges when its argument is replaced with a complex vector $\bf{z}\in\bbC^n$ such that $\Re \bf{z}\in D$ and $\Im\bf{z}$ is sufficiently small. The natural inclusion $\bbR\llbracket\bf{x}\rrbracket\hookrightarrow \bbC\llbracket\bf{z}\rrbracket$ can then be restricted to germs of analytic functions on both sides. 

As a result, every real analytic function on an open subset of $\bbR^n$ can be \emph{analytically continued} to give a complex analytic function on an open subset of $\bbC^n$. By the exercise above, this continuation is unique, and by elementary complex analysis, sums, differences, products and derivatives of analytic functions on an open set are analytic, as are ratios (whenever the denominator doesn't vanish). The analytic Inverse and Implicit Mapping Theorems also hold. 

\begin{xca}
    Show that if $f(z^1,\ldots,z^n)$ is complex analytic within a \emph{polydisk}\index{Polydisk} $D_{\bf{r}}(\bf{z}_0)=D_{r_1}(z_0^1)\times\cdots \times D_{r_n}(z_0^n)$, where $D_r(z_0) \subset \bbC$ is the open disk of radius $r$ centered at $z_0$, then the Taylor series of $f$ centered at $\bf{z}_0$ converges in all of $D_{\bf{r}}(\bf{z}_0)$.
\end{xca}

\begin{example}
    Liouville's Theorem in complex analysis states that every bounded \emph{entire} function (function holomorphic on all of $\bbC$) must be constant.\index{Entire function} An even more general fact is that if $f$ is entire and $|f(z)|$ is bounded by a polynomial $p(|z|)$, then $f$ is a polynomial. Both statements are immediate consequences of Cauchy's Residue Theorem applied either to $f$ or to its derivative of the same order as the degree of $p$.
\end{example}


We can finally move on to differential equations. All of the methods for solving PDEs that we will discuss in this book amount to reducing the original problem to well-posed \emph{initial value problems}, also known as \emph{Cauchy problems}.\index{Cauchy problem}\footnote{Cauchy problems also encompass boundary value problems, but locally every boundary value problem is an initial value problem. We will only be interested in local solutions here.} In geometric terms, a Cauchy problem is nothing more than the problem of constructing the flow of a vector field. 

Consider a simple PDE, $u_t=u_x$. We will view it as the vanishing condition on the Lie derivative of $u$ w.r.t.\ the vector field $X=\partial_t-\partial_x$ in the $xt$-plane. The flow lines of $X$ are the diagonal lines of constant $(x+t)$, so all solutions of our PDE have the form $u(t,x)=u_0(t+x)$ for some function $u_0$, which can be determined from any set of ``initial data'' specified on a curve that intersects each line of constant $(x+t)$ exactly once. 

Note that in the above example, as in the case of equations of the form $X\cdot u=0$ in general, the smoothness (or analyticity) of the initial data is reflected in the smoothness of the solution. For nonlinear equations, however, no degree of smoothness is guaranteed to be preserved. 

Consider an equation of the form 
\[u_t=f(u,u_x)\] 
with initial condition $u(0,x)=u_0(x)$. The PDE then allows us to compute all $t$-derivatives at $t=0$ from the initial condition: $u_{tt}=f\partial_1f+(u_x\partial_1 f+u_{xx}\partial_2f)\partial_2f$, where $\partial_i$ stand for partial derivatives of $f$ w.r.t.\ its arguments, and so on for higher derivatives. Thus, we have a \emph{formal solution} in the form of a formal power series 
\[u(t,x)=\sum_{k\geq 0}t^k u_k(x),\]
where each $u_k$ is some computable expression involving $f$, $u_0(x)$, and their derivatives. This property of being able to compute all higher-order terms given a finite collection of lower-order ones is called \emph{involutivity}. We may also say that the infinite system of recurrence relations resulting from the substitution of the power series ansatz is \emph{closed}.
Crucially, there is no guarantee that this series will converge for any $t\neq 0$ (see example below). Finally, note that this discussion also applies to all \emph{evolution equations} of the form $u_t=f(u,u_x,u_{xx},\ldots)$.\index{Evolution equation}

\begin{example}\label{example heat equation}
    The initial value problem for the heat equation 
    \[u_t=u_{xx},\quad u(0,x)=(1+x^2)^{-1},\] 
    has a unique formal solution given by 
    \[u(t,x)=\sum_{j,k=0}^\infty (-1)^{j+k}(2(j+k))!\frac{t^j}{j!}\frac{x^{2k}}{(2k)!},\]
    which doesn't converge for any $t>0$.
\end{example}

The following classical theorem establishes a sufficient (and, in some general sense, necessary) condition for the convergence of formal solutions to initial value problems of this involutive type.

\begin{thm}[Cauchy-Kovalevskaya (1842, 1874)]
    An analytic system of PDEs of the form $\bf{u}_t=\bf{f}(t,\bf{x},\bf{u},\bf{u}_{\bf x})$, defined in an open set of $(t,\bf{x},\bf{u})\in \bbR\times\bbR^n\times\bbR^s$, with any analytic initial condition $\bf{u}(t_0,\bf{x})=\bf{u}_0(\bf{x})$, has an analytic solution near $t=t_0$. Any two solutions agree near $t=t_0$.
\end{thm}
\begin{proof}
    We will prove the theorem by generalizing from basic special cases. It will be clear that the method works for the general case, and writing down a general proof is only a matter of notation.

    Let us start with a simpler problem, $u_t=f(t,u)$ with initial condition $u(0)=u_0$ (this is an ODE). We can find the Taylor coefficients of the formal solution $\sum_k t^k u_k$ by taking derivatives of the equation:
    \begin{align}
        u_t(0)&=f(0,u_0),\\
        u_{tt}(0)&=f_t(0,u_0)+f_u(0,u_0)u_t=\\
                 &=f_t(0,u_0)+f_u(0,u_0)f(0,u_0),\text{ etc.}
    \end{align}
    If $u_0\geq 0$ and all of the Taylor coefficients of $f$ are non-negative, then inductively all of the Taylor coefficients of $u$ are non-negative. In other words, if $u_0\geq 0$ and $f$ majorizes $0$, then $u$ majorizes $0$.

    By the same reasoning, if we have two equations $u_t=f(t,u)$ and $v_t=g(t,v)$ with initial conditions $u(0)\geq v(0)$, and if $f$ majorizes $g$, then by the same induction, $u$ majorizes $v$. In particular, if the Taylor series of $u$ converges, then so does that of $v$.

    We will now use the \emph{toy equation} 
    \[u_t=\frac{1}{(1-t)(1-u)},\quad u(0)=0,\]
    whose explicit solution is $u(t)=1-\sqrt{1+2\ln(1-t)}$ (the exact form is not important).
    Consider the power series expansion of the right hand side of the toy equation:
    \[
        u_t=\frac{1}{(1-t)(1-u)}=\sum_{jk}t^j u^k.
    \]
    Suitable rescaling of $t$ and $u$ produces any convergent geometric series. By Lemma~\ref{lem 121}, any analytic function $f(t,u)$ is majorized by a geometric series in $t$ and $u$. So the equation $u_t=f(t,u)$ is majorized by the toy equation, after some rescaling of variables. Then the solution $u(t)$ to $u_t=f(t,u)$ with $u(0)=0$ is majorized by the toy solution, so has convergent Taylor series.

    We will now generalize this toy example through a sequence of majorizing equations to get to the general result. The function 
    \[u(t,x)=1-x-\sqrt{(1-x)^2-2t}\label{eq 3179}\]
    satisfies 
    \[u_t=\frac{1+u_x}{1-x},\quad u(0,x)=0.\]
    With suitable rescalings of $x,t,u$, this equation majorizes any equation of the form $u_t=f(x,u)+g(x,u)u_x$ for any analytic $f,g$, with $x,u\in\bbR$ in a suitable open set. Therefore all such equations have local analytic solutions with initial condition $u(0,x)=0$.

    To allow more independent variables ($x$): if $u(t,s)$ is the function (\ref{eq 3179}) and we let $v(t,\bf{x})\coloneqq u(t,s(\bf{x}))$, where $s(\bf{x})\coloneqq \sum_i x^i$ for $\bf{x}\in\bbR^n$, then 
    \[v_t=\frac{1+\frac{1}{n}\sum_i v_{x^i}}{1-\sum_i x^i},\quad v(0,\bf{x})=0.\]
    Again, up to rescaling of variables, this equation majorizes any equation of the form $u_t=f(x,u_t)+g(x,u)u_x$ for any analytic $f,g$ and $t,u\in\bbR$, $\bf{x}\in\bbR^n$ in some open set. Of course the same trick works even if we allow multiple unknown functions, i.e., $\bf{u}\in\bbR^s$ (in this case $f$ is vector-valued and $g$ is matrix-valued). In the remainder of the proof we will continue working with scalar functions of one variable, as the generalization is straightforward.

    To allow $t$ to enter on the right hand side, we add a new equation $v_t=1$ with $v(0)=0$, so we are just forcing $v=t$. Then any system like $u_t=f(t,x,u)+g(t,x,u)u_x$ with $u(0,x)=0$ is equivalent to 
    \begin{align}
        u_t&=f(v,x,u)+g(v,x,u)u_x,\quad &u(0,x)=0,\\
        v_t&=1,\quad &v(0)=0.
    \end{align}
    We have already shown that such systems have solutions near the origin.

    If we want to solve a system of the form $u_t=f(t,x,u,u_x)$, introduce a new variable $v$ and solve instead 
    \begin{align}
        u_t&=f(t,x,u,v),\quad &u(0,x)=0,\\
        v_t&=f_x(t,x,u,v)+f_u(t,x,u,v)v+f_v(t,x,u,v)v_x,\quad &v(0,x)=0,
    \end{align}
    which forces $v=u_x$. Again, we have already shown the existence of an analytic solution.

    Finally, suppose that we want to solve a system $u_t=f(t,x,u,u_x)$ with a general analytic initial condition $u(0,x)=u_0(x)$. Replacing the system with $v_t=f(t,x,v+u_0,v_x+u_0')$ with $v(0,x)=0$, which we already know has an analytic solution, we can reconstruct $u$ by $u(t,x)=v(t,x)+u_0(x)$.
\end{proof}

\begin{rem}
    
\begin{enumerate}
    \item Note that the applications of the Cauchy-Kovalevskaya Theorem are not limited to first-order PDEs. For example, to solve a second-order system of the form 
    \[u_{tt}=f(t,x,u_t,u_x,u_{tx},u_{xx}),\quad u(0,x)=u_0(x),\quad u_x(0,x)=p_0(x),\]
    we can denote $p\cong u_t$ and $q=u_x$. Then the above system is equivalent to 
    \begin{align}
        u_t&=p,\quad &u(0,x)=u_0(x),\\
        p_t&=f(t,x,u,p,q,p_x,q_x),\quad & p(0,x)=p_0(x),\\
        q_t&=p_x,\quad &q(0,x)=u_0'(x).
    \end{align}
    Any solution or formal solution of this system arises from a solution or formal solution of the original system and vice versa. Similarly, any system of PDEs of any order can be reduced to a first-order system by adding more variables. Assuming the resulting first-order system can be brought (at least locally) to the form necessary for the Cauchy-Kovalevskaya theorem, the general solution will then depend on one arbitrary scalar function (``initial data'') for each unknown function in this first-order system. 

    \item The general PDE that the proof allows to reduce to the standard form is 
    \[\partial^{m}_t\bf{u}=\bf{F}(t,x,\partial^j_t\partial^{\bm k}_{\bf x}\bf{u}),\quad j<m,\; |\bm{k}|+j\leq m,\]
    with initial conditions $\partial^j_t\bf{u}(0,\bf{x})=\bf{f}_j(\bf{x})$. In other words, one must be able to express the highest-order derivative w.r.t.\ one variable in terms of only lower-order derivatives. Example~\ref{example heat equation} shows why the condition $|\bm{k}|+j\leq m$ is necessary.

    \item The proof of the Cauchy-Kovalevskaya Theorem reduces a certain class of PDEs to the ODE $\partial_t\bf{u}=\bf{F}(t,\bf{u})$, where $\bf{F}:\bbR\times\bbR^s\to\bbR^s$ is analytic. This is nothing but the problem of finding the flow of an analytic time-dependent vector field on $\bbR^s$, and so it suffices to provide analytic initial values along any analytic surface that's everywhere transversal to $\bf{F}$.
\end{enumerate}
\end{rem}


\begin{example}[Wave equation]\index{Equation!Wave}\label{ex wave eq kovalevskaya}
    Consider the wave equation 
    \[u_{tt}=u_{xx},\quad u(0,x)=u_0(x),\quad u_t(0,x)=p_0(x),\]
    and let 
    \[v(t,x)\coloneqq \int p_0(x)\dd x+\int_0^t u_x(s,x)\dd s,\]
    so that $v_t=u_x$. Differentiating this equation w.r.t.\ $x$, we also find $v_x=u_t$, so $u,v$ satisfy 
    \begin{align}
        u_t&=v_x,\quad & u(0,x)=u_0(x),\\
        v_t&=u_x,\quad & v(0,x)=p_0(x).
    \end{align}
    Conversely, any solution to this system recovers our solution $u$ to the wave equation. Thus, the general solution of the wave equation depends on two arbitrary functions, for example the initial height and velocity.
\end{example}

Crucially, for the Cauchy-Kovalevskaya Theorem to be applicable, the first-order system must first be solved for the derivatives w.r.t.\ \emph{any one} of the independent variables (we've been calling it $t$ so far). If this is not possible, a more general approach is necessary to construct analytic solutions. The following two examples demonstrate how this condition can fail and provide some intuition for our upcoming description of Cartan's analysis of differential equations, which essentially boils down to finding (when possible) the right variables to \emph{adjoin} to our system to bring it to the Cauchy-Kovalevskaya form, i.e., to make it involutive.

\begin{example}
    Consider the equation 
    \[\curl \bf{u}=\bf{f}\]
    for an unknown vector field $\bf{u}\in\fX(\bbR^3)$ given $\bf{f}\in\fX(\bbR^3)$. In components, it reads 
    \[u^3_{x^2}-u^2_{x^3}=f^1,\quad u^1_{x^3}-u^3_{x^1}=f^2,\quad u^2_{x^1}-u^2_{x^1}=f^3,\label{eq 1795}\]
    so $3$ first-order equations for $3$ unknowns. Naively, this should be solvable. However, computing the divergence of both sides reveals $\div \bf{f}=0$. Thus, if $\div\bf{f}\neq 0$, then there are no solutions at all. Otherwise, all smooth solutions are of the form $\bf{u}=\bf{u}_0+\grad \phi$, where $\bf{u}_0$ is a particular solution and $\phi\in C^\infty(\bbR^3)$ is arbitrary. Thus, local solutions depend on one function of $3$ variables, and not on initial data given on a surface. The reason for this failure is that (\ref{eq 1795}) cannot be solved for the derivatives w.r.t.\ any one of the three variables, say $(u^1_{x^1},u^2_{x^1},u^3_{x^1})$, because only two of these enter the system. So this problem cannot be brought to the form required by the Cauchy-Kovalevskaya Theorem. Moreover, this kind of a system requires additional ``compatibility conditions'' (not unlike a generalization of the involutivity condition in the Frobenius Theorem) that are not present in the theorem.
\end{example}

\begin{example}\label{example curl pde}
    Modify the previous example to 
    \[\curl \bf{u}+\bf{u}=\bf{f}.\label{eq 317}\]
    This is still a system of $3$ equations on $3$ unknowns, and once again there is compatibility condition, but this time it is another first-order PDE on $\bf{u}$:
    \[\div\bf{u}=\div\bf{f}.\]
    All together we have $4$ scalar equations. The first one reads 
    \[u^3_{x^2}-u^2_{x^3}=f^1-u^1,\label{eq 1794}\] 
    and it can be solved just in the plane $x^1=0$ using the Cauchy-Kovalevskaya Theorem in the variables $x^2,x^3$, starting with any choice of initial values $u^1(0,x^2,x^3)$, $u^2(0,x^2,x^3)$ on the plane $x^1=0$ and $u^3(0,0,x^3)$ on the line $x^1=x^2=0$. Now we can apply the Cauchy-Kovalevskaya Theorem to the remaining $3$ equations:
    \begin{align}
        u^1_{x^3}-u^3_{x^1}&=f^2-u^2,\\
        u^2_{x^1}-u^1_{x^2}&=f^3-u^3,\\
        u^1_{x^1}+u^2_{x^2}+u^3_{x^3}&=\div\bf{f}.
    \end{align}
    This can be resolved for the $x^1$-derivatives:
    \begin{align}
        u^1_{x^1}&=-u^2_{x^2}-u^3_{x^3}+\div\bf{f},\\
        u^2_{x^1}&=u^1_{x^2}+f^3-u^3,\\
        u^3_{x^1}&=u^1_{x^3}-f^2+u^2,
    \end{align}
    so this system can be solved via the Cauchy-Kovalevskaya Theorem given an initial value $\bf{u}(0,x^2,x^3)$, which is already provided by the solution of the first equation that we've constructed. The tricky question is whether the resulting functions actually solve the original problem. In fact, they do: we have already solved the first equation (\ref{eq 1794}) at $x^1=0$, and it is easy to check that its $x^1$-derivative
    \[(u^3_{x^2}-u^2_{x^3}-f^1+u^1)_{x^1}=0\]
    is satisfied automatically when the other $3$ equations are. We say that the first equation holds identically \emph{modulo} the other three. Thus, the general solution to (\ref{eq 317}) is uniquely determined by $1$ function of $1$ variable and $2$ functions of $2$ variables. Once again, the difference from the Cauchy-Kovalevskaya setting stems from the fact that the original system can't be solved for all three $x^1$-derivatives. We will revisit this problem in Example~\ref{example curl pde 2}.
\end{example}

\begin{example}[Self-dual equations]\label{ex self-dual equations}
    A more interesting problem is to consider the so-called self-dual equations in $4$ dimensions. Recall the Hodge star operator $\ast:\Omega^p(\bbR^n)\to \Omega^{n-p}(\bbR^n)$, which is defined by 
    \[\alpha\wedge(\star \beta)=\<\alpha,\beta\>\dd x^1\wedge\cdots\dd x^n,\]
    where $\<\alpha,\beta\>$ is the Euclidean inner product extended to differential forms (so all the standard basis elements $\dd x^I$ of the same degree are orthonormal, and those of differing degrees are orthogonal). It satisfies 
    \[{\star}{\star}\alpha=(-1)^{p(n-p)}\alpha,\quad \alpha\in\Omega^p(\bbR^n).\]
    In particular, when $n=4$ and $p=2$, the $2$-forms can be split into \emph{self-dual} forms that satisfy $\star\alpha=\alpha$ and \emph{anti-self-dual} forms that satisfy $\star\alpha=-\alpha$. These two spaces are denoted $\Omega^2_\pm(\bbR^4)$, respectively. For example, every $\phi\in\Omega^2_+(\bbR^4)$ is of the form 
    \begin{multline}
        \phi=u^1(\dd x^2\wedge\dd x^3+\dd x^1\wedge\dd x^0)+\\
        +u^2(\dd x^3\wedge\dd x^1+\dd x^2\wedge\dd x^0)+u^3(\dd x^1\wedge\dd x^2+\dd x^3\wedge\dd x^0),
    \end{multline}
    where $(x^0,x^1,x^2,x^3)$ are the standard coordinates on $\bbR^4$. 
    The equation $\dd\phi=0$ (to which vacuum Yang-Mills equations $\dd \phi={\star}{\dd}{\star}\phi=0$ reduce under the assumption that $\phi$ is self-dual or anti-self-dual) then represents four equations for the three unknowns $u^1,u^2,u^3$. Obviously this overdetermined system cannot be put in Cauchy form. This raises the interesting question: how can we describe the space of local solutions of these equations? Explicitly, the equations read 
    \[
        0=\div \bf{u}, \quad \partial_{x^0}\bf{u}=\curl\bf{u},
    \]
    where $\bf{u}=(u^1,u^2,u^3)$, and the divergence and curl are taken w.r.t.~$\bf{x}=(x^1,x^2,x^3)$. Setting aside the first equation, the remaining ones are in Cauchy form and we could solve them, at least near $x^0=0$, for any real-analytic initial conditions 
    \[\bf{u}(\bf{x},0)=\bf{f}(\bf{x}).\]
    The first equation of the system then enforces the following compatibility condition on these data:
    \[0=\div \bf{f},\]
    and only these $\bf{f}$ can generate a solution of the full system. If $\div\bf{f}=0$ is satisfied, then we can check that the resulting $\bf{u}$ \emph{automatically} satisfies the remaining equation. To see this, define the `error' function $E\coloneqq \div\bf{u}$. By the choice of $\bf{f}$, we know $E(\bf{x},0)=0$. Moreover, by the above equations and commuting partials, we have 
    \[\partial_{x^0}E=\partial_{x^0}\div\bf{u}=\div\partial_{x^0}\bf{u}=\div\curl\bf{u}=0.\]
    Thus, $E(\bf{x},x^0)=E(\bf{x},0)=0$, so the first equation on $\bf{u}$ is indeed satisfied.

    Thus, the solutions to the full system are found by choosing initial conditions $\bf{f}$ to be divergence-free. Of course, this can be regarded as an equation in Cauchy form, now underdetermined, for example by splitting off $\partial_{x^3}f^3$. By the Cauchy-Kovalevskaya Theorem, we can solve this uniquely by choosing $f^1(\bf{x})$ and $f^2(\bf{x})$ as arbitrary analytic functions on $\bbR^3$ and then also choosing $f^3(x^1,x^2,0)$ as an analytic function on $\bbR^2$.
\end{example}


Finally, we emphasize the importance of analyticity. Without analyticity, there are numerous surprising ``counterexamples'' of existence:
\begin{enumerate}
    \item The Cauchy-Riemann system admits only analytic solutions, so smooth non-analytic initial data fails to give a solution.
    \item Certain linear \emph{determined} (see next \sect) equations $L\bf{u}=\bf{f}$ for some linear first-order differential operator $L$ with analytic coefficients have no solutions for any smooth $\bf{f}$ unless $\bf{f}$ is analytic (so called \emph{Lewy's example}). In this very general sense, the sufficient condition of analyticity in the Cauchy-Kovalevskaya Theorem is a necessary one.
\end{enumerate}
Uniqueness can also fail without analyticity:
\begin{enumerate}
    \item Some smooth linear determined equations have smooth solutions that agree on one side of a noncharacteristic hypersurface and disagree on the other (example by S.~Alinhac and M.~S.~Baouendi, 1995).
    \item Some analytic nonlinear determined equations have smooth solutions which agree on one side of a noncharacteristic hypersurface and disagree on the other (example by G.~M\'etivier, 1993).
\end{enumerate}

Thus, our assumption of analyticity of solutions automatically discards a lot of the complexity that general PDEs have, and for such questions purely geometric or finite-dimensional algebraic methods will not be sufficient. This is why, for example, the Navier-Stokes problem is so difficult. Nor will our methods be able to address global questions of existence (very few of which can be answered for general nonlinear PDEs anyway). These problems fall outside of the purview of Cartan's methods and we will not concern ourselves with them in this book.









\section{Differential operators}\label{sec: diff operators}


The Cauchy-Kovalevskaya Theorem states that analytic solutions exist if we can resolve our system of PDEs for the highest derivatives in a single variable. If this is not possible right away, it might be possible after a change of variables (both independent and unknown). Thus, we need a coordinate-free description of ``how many derivatives'' are taken in a given direction.

Any linear differential operator 
\[P=\sum_{|\bm{\alpha}|\leq m}c_{\bm{\alpha}}(\bf{x})\partial^{\bm{\alpha}}\]
can be viewed as a polynomial $P=P(\bf{x},\partial)$ in the operators $\partial_{x^i}$ with coefficients that are functions of $\bf{x}$. Note that, when acting on sufficiently smooth functions, partial derivatives commute, so $\partial^{\bm{\alpha}}$ can be interpreted as a section of a symmetric power of the tangent bundle. More generally, differential operators can act on sections of arbitrary \glspl{vb}. This motivates the following definition 

\begin{defn}[Filtered algebra]\index{Filtered algebra}
    A filtration on an algebra $A$ with an increasing (not necessarily strictly) sequence of subspaces 
    \[\{0\}\subset A_0\subset A_1\subset A_2\cdots \]
    such that $A=\bigcup_{i=0}^\infty A_i$ and which is compatible with the multiplication in the sense that $A_i\cdot A_j\subset A_{ij}$.
\end{defn}

\begin{defn}[Linear differential operator]\index{Differential operator (linear)}
    Let $E\overset{\pi}{\to}M$ and $E'\overset{\pi}{\to}M$ be two \glspl{vb} over a manifold $M$. Let $\OP(E,E')=\Hom(\Gamma^\infty(E), \Gamma^\infty(E'))$ be the space of all linear operators between sections of $E$ and $E'$. We give several equivalent definitions of the space of linear differential operators $\PDO(E,E')$.
    \begin{enumerate}
        \item $\PDO(E,E')$ is the subspace of $\OP(E,E')$ consisting of operators that are locally represented by linear partial differential operators with coefficients in (local) vertical \gls{vb} morphisms.
        \item $\PDO(E,E')$ is the subspace of $\OP(E,E')$ consisting of \emph{support non-increasing} operators, i.e., $D\in\OP(E,E')$ such that $\supp Ds\subset \supp s$ for any $s\in\Gamma^\infty(E)$.\footnote{The support of a section $s\in\Gamma^\infty(E)$ is defined as the closure of the set of points $m\in M$ where $s(m)\neq 0$. Recall also that the closure of a set $A$ is the intersection of all open sets containing $A$.}
        \item Recall that the $k$-jet prolongation bundle $\rmJ^k E\to M$ is also a \gls{vb}. Then $\PDO(E,E')$ is the subspace of $\OP(E,E')$ consisting of elements $D$ that factor through $k$-jet prolongations of sections, i.e.,
        \[D(s)(m)=\wt{D}(\rmj^ks)(m),\quad s\in \Gamma^\infty(E),\; m\in M,\]
        for some \gls{vb} morphism $\wt{D}:\rmJ^kE\to E'$.
    \end{enumerate}
\end{defn}
\begin{defn}[Order $k$ operator]
    In particular, if $E'=E$, the set of such operators comprises an algebra $\PDO(E)$ over the ring $\Gamma^\infty(\End(E))$.
    
    Each operator $D\in\PDO(E,E')$ has a well-defined \emph{order}, which is the order of any of its local representations. Composition of operators sums their orders. Therefore there is a natural filtration on this algebra, 
    \[\PDO^0(E,E')\subset \PDO^{\leq 1}(E,E')\subset\PDO^{\leq 2}(E,E')\subset\cdots,\] 
    where $\PDO^{\leq k}(E,E')$ is the subspace of linear differential operators of orders $\leq k$. In particular, $\PDO^0(E)\cong \Gamma^\infty(\End(E))$ is a subalgebra of $\PDO(E)$. We define the set (not a vector space) of \emph{$k$-th order operators}
    \[\PDO^k(E,E')\coloneqq \PDO^{\leq k}(E,E')\setminus \PDO^{\leq k-1}(E,E').\]
\end{defn}

\begin{thm}[Peetre Theorem {{\cite[\S19]{Kolar}}}]
    The above three definitions of linear differential operators are equivalent.
\end{thm}
\begin{proof}
    The statement of the theorem is invariant under local diffeomorphisms, so it suffices to prove it for $M=U$ an open subset of $\bbR^n$ and trivial vector bundles $E=U\times\bbR^s$, $E'=U\times\bbR^r$ over it.

    We need to prove that any linear operator $D:\Gamma^\infty(E)\to \Gamma^\infty(E')$ such that $\supp (Df)\subset \supp f$ necessarily has the form 
    \[(Df)(\bf{x})=\sum_{|\bm{\alpha}|\leq k}a_{\bm{\alpha}}(\bf{x})(\partial^{\bm{\alpha}}f)(\bf{x})\]
    for some functions $a_{\bm\alpha}\in C^\infty(U,\bbR^{s\times r})$.

    First we prove the following lemma.
    \begin{lem}
        Let $D$ be as above and support non-increasing. Then for any $\bf{x}\in U$ and $C>0$, there exists an open neighborhood $V$ of $\bf{x}$ and an integer $k>0$ such that, for any $\bf{y}\in V\setminus\{\bf{x}\}$ and any $s\in\Gamma^\infty(E)$, $(\rmj^ks)(\bf{y})=0$ implies $\lVert (Ds)(\bf{y})\rVert<C$.
    \end{lem}
    \begin{proof}
        Suppose the statement is false. Then there exists a convergent sequence $\bf{x}_k\to \bf{x}$, a sequence of open balls $B_k$ centered at $\bf{x}_k$ which are separated by nonzero distance from each other, and a sequence of local sections $s_k\in\Gamma^\infty(\restr{E}{B_k})$ such that $(\rmj^ks_k)(\bf{x}_k)=0$, and yet $\lVert(Ds_k)(\bf{x}_k)\rVert\geq C>0$.

        Let $\rho(\bf{x})$ be a standard bump function for the unit ball $B_1$ in $\bbR^s$, i.e., a smooth function that equals $1$ for $\lVert\bf{x}\rVert<\frac12$ and $0$ for $\lVert\bf{x}\rVert>1$.

        We will now consider every other section, $s_{2k}$. Since these functions satisfy $(\rmj^{2k}s_{2k})(\bf{x}_[2k])=0$, we can pick a smaller ball $B_{\delta}'(\bf{x}_{2k})$ around $\bf{x}_{2k}$ such that the derivatives up to order $k$ are bounded by an arbitrary constant, for example 
        \[\sum_{|\bm{\alpha}|\leq k} \sup_{B_\delta'(\bf{x}_{2k})}\lVert\partial^{\bm\alpha}s_{2k}\rVert\leq \frac{(\delta/2)^k}{\sum_{|\bm{\alpha}|\leq k}\sup_{B_1} \lVert\partial^{\bm\alpha}\rho\rVert}.\]
        Now let 
        \[\rho_{2k}(\bf{y})\coloneqq \rho\left(\frac{\bf{y}-\bf{x}_{2k}}{\delta}\right)\]
        be the bump function for the ball $B_\delta'(\bf{x}_{2k})$. Then the derivatives of $\rho_{2k}s_{2k}$ are bounded in such a way that 
        \[\max_{|\bf{\alpha}|\leq k}\sup_{B_\delta'(\bf{x}_{2k})}\lVert\partial^{\bm\alpha}(\rho_{2k}s_{2k})\rVert\leq 2^{-k}.\]
        By the uniform convergence lemma of functional analysis, this guarantees that the sum of these local sections converges to another smooth section on $V$,
        \[q\coloneqq \sum_{k=1}^\infty \rho_{2k}s_{2k}.\]
        Since the balls $B_{2k}$ are disjoint, in a neighborhood of each $\bf{x}_{2k}$, this $q$ coincides with $s_{2k}$, therefore, by assumption, 
        \[\lim_{k\to\infty}\lVert(Dq)(\bf{x}_{2k})\rVert\geq C>0.\]
        Since $\bf{x}_{2k}\to\bf{x}$ and $Dq$ is continuous, we have 
        \[\lVert (Dq)(\bf{x})\rVert\geq C>0.\]
        On the other hand, $(Dq)(\bf{x}_{2k+1})=0$ for all $k$ since $q$ vanishes on $B_{2k+1}$ and $D$ is support non-increasing. Taking a limit, this implies that $(Dq)(\bf{x})=0$, which contradicts the above estimate.
    \end{proof}
    Let us now show that, under the assumptions of the lemma, $\lVert (Ds)(\bf{y})\rVert=0$. Pick a $\bf{y}\in V\setminus\{\bf{x}\}$ so that $\rmj^ks(\bf{y})=0$ but $\lVert Ds(\bf{y})\rVert=g>0$. Rescale $s$ by a factor of $2C/g$. Then if $g\neq 0$, by linearity of $D$, $\lVert(Ds)(\bf{y})\rVert=2C>C$, which is impossible by the lemma. This proves the theorem in the punctured neighborhood $V\setminus\{\bf{x}\}$ because it implies that $D$ factors through the $k$-th jet bundle $\rmJ^kE$.

    It remains to extend the result to the central point $\bf{x}$ itself. $D$ is a linear differential operator with smooth coefficients and it sends germs of smooth functions at $\bf{x}$ to germs of smooth functions at $\bf{x}$. Thus the coefficients of $D$ are also smooth at $\bf{x}$.
\end{proof}

\begin{rem}
    \begin{enumerate}
        \item Linearity of the operators is not actually essential to this result. In the case of nonlinear support non-increasing operators, the modified statement is that for any $\epsilon>0$ we can find a neighborhood $V$ of $\bf{x}$ on which the value of $Df$ remains within some ball of radius $\epsilon$ regardless of the choice of $f$ with a fixed $k$-jet $(\rmj^kf)(\bf{x})$. Meanwhile, the assumption of smoothness of the operator (i.e., that it maps smooth sections to smooth sections) is key to establishing that it depends only on finitely many derivatives. As a counterexample, we can consider the continuous operator $C^\infty(\bbR)\to C^0(\bbR)$ given by $f\mapsto \sum_{k\geq 0} 2^{-k}\arctan\circ f^{(k)}$.
        \item There is another natural way of defining differential operators without reference to local representations that uses connections (see \S\ref{sec: koszul lin connections}). Namely, the space of all differential operators is generated by covariant derivatives $\nabla_X$, $X\in\fX(M)$, corresponding to any fixed linear connection $\nabla$ on $E$ (one always exists), with morphism-valued coefficients as above.
    \end{enumerate}
\end{rem}

Locally, every differential operator of order $k$ on a \gls{vb} can be written as 
\[D=\sum_{|\bm{\alpha}|<k}B_{\bm{\alpha}}\partial^{\bm{\alpha}},\]
where each $B_{\bm{\alpha}}$ is a local section of the endomorphism (or vertical morphism) bundle, i.e., in a local frames for $E$ and $E'$ it can be represented by a matrix $(B_{\bm{\alpha}}(m))_i^j$, $m\in M$. Using elementary calculus,  we see that under a change $\bf{x}\mapsto \bf{y}$ of local coordinates on $M$, $\partial^{\bm{\alpha}}_{\bf{x}}$ turns into a linear differential operator of the same order $|\bm{\alpha}|$ in $\bf{y}$, including (generically) terms of all lower orders as well. Hence, $\partial^{\bm{\alpha}}$ is not a tensorial object. Nevertheless, the term of the highest order $k$ \emph{is} tensorial. Writing $\partial^{\bm{\alpha}}_{\bf{x}}$ instead as $\partial_{x^{i_1}}\cdots \partial_{x^{i_k}}$, we have 
\[\partial_{x^{i_1}}\cdots \partial_{x^{i_k}}=\frac{\partial y^{j_1}}{\partial x^{i_1}}\cdots \frac{\partial y^{j_k}}{\partial x^{i_k}}\partial_{y^{j_1}}\cdots \partial_{y^{j_k}}+\cdots ,\]
where $\cdots$ stands for a differential operator of order $k-1$. Thus we see that the leading term transforms as a symmetric contravariant tensor of rank $k$. The rest of this \sect\ is dedicated to formalizing this observation in a coordinate-free language.

We will identify $C^\infty(M)$ with the set of multiplication operators which form the center of $\PDO^0(E)$. Since $\PDO(E)$ is an algebra, it also has a Lie algebra structure with the Lie bracket given by the commutator.
This allows us to give the following, purely algebraic, inductive definition of differential operators (due to Grothendieck). It is also an extremely useful criterion for showing that a given operator is a differential operator, similar to how Theorem~\ref{thm tensor characterization} characterized tensor fields.

\begin{prop}
    If we let $\PDO^{-1}(E,E')\coloneqq \{0\}$, then for any integer $k\geq 0$,
    \[\PDO^{\leq k}(E,E')=\{D\in\OP(E,E')\mid \ad_f D\in\PDO^{\leq k-1}(E,E')\text{ for all }f\in C^\infty(M)\}.\]
\end{prop}
\begin{proof}
    The first equality means that $(D\cdot f)(s)=f D(s)$ for any $f\in C^\infty(M)$ and $s\in\Gamma^\infty(E)$, but this is exactly the characterization of a bundle morphism by Theorem~\ref{thm tensor characterization}. The fact that $\PDO^{\leq k}$ is contained in the second set follows immediately from the local representation of differential operators. To see the opposite inclusion, we show inductively that $\PDO^{\leq k}(E,E')$ defined as in the statement of the proposition consists of support non-increasing operators, hence differential operators.

    Assume that $\PDO^{\leq k-1}(E,E')$, as defined in the proposition, is already known to consist of differential operators (this is also known for $\PDO^0(E,E')$). Let $D$ be such that $\ad_fD\in\PDO^{\leq k-1}(E,E')$ for any smooth function $f$. For a section $s$, let $\rho$ be a bump function such that $\rho\equiv 1$ on $\supp s$ and $\rho\equiv 0$ outside of some open neighborhood $U\supset \supp s$. Then $s=\rho s$ and 
    \[Ds=D(\rho s)=\rho Ds-(\ad_f D)s.\]
    This means that $\supp Ds\subset U$, and $U$ can be an arbitrary neighborhood of the closed set $\supp s$. Thus, $\supp Ds\subset \supp s$ and $D$ is a differential operator.
\end{proof}

In other words, differential operators can be defined using the \emph{inverse of the Leibniz rule}, $Dfs=fDs+[D,f]s$.\footnote{This observation allowed Grothendieck to define differential operators on modules of arbitrary commutative unital algebras (in our case the algebra is $C^\infty(M)$ and the module is $\Gamma^\infty(E)$). This becomes especially interesting when the algebra contains nilpotent elements.} This result is extremely powerful because it essentially translates all of calculus into the language of linear algebra, making available all of the tools of linear algebra for studying differential systems, as we shall do in the rest of this \chap.

\begin{rem}
    A more classical local proof of the validity of this inductive definition is to consider the commutators $P_i\coloneqq [D,x^i]$ with coordinate functions $x^i$, write these operators as regular differential operators by the assumption of the induction step, and then consider $Q=D-x^iP_i$. Noticing that $[Q,x^i]=0$ for all $i$, one can use the ``fundamental lemma of differential operators'' stating that any operator that commutes with all coordinate functions must be a multiplication (zeroth-order) operator, i.e.,  $Q=[Q,1]$. This lemma is the differential analog of the statement that the center of $\GL_n(\bbR)$ is the set of scalar matrices.\index{Lemma!Fundamental Lemma of Differential Operators}
\end{rem}

By induction, for any $D\in\PDO^k(E,E')$ and any $f_1,\ldots,f_k\in C^\infty(M)$, we have the zeroth-order operator
\[\ad_{f_1}\ad_{f_2}\cdots \ad_{f_k} D=[f_1,[f_2,\ldots,[f_k,D]]]\in \PDO^0(E,E').\label{eq 1803}\]

\begin{lem}
    The expression (\ref{eq 1803}) is symmetric under permutations of $(f_1,\ldots,f_k)$.
\end{lem}
\begin{proof}
    Using the Jacobi identity for commutators,
    \[\ad_f\ad_g D=[f,[g,D]]=[[f,g],D]+[g,[f,D]]=[g,[f,D]]=\ad_g\ad_f D.\]
    By induction, (\ref{eq 1803}) is symmetric as well.
\end{proof}

Therefore, the set of bundle morphisms (\ref{eq 1803}) is completely determined by monomials of the form $\ad_f^k D$, $f\in C^\infty(M)$ via the \emph{polarization identity} (which is just an obvious formula for the top derivative of a polynomial or a symmetric multilinear map),\index{Polarization identity}
\[\ad_{f_1}\cdots \ad_{f_k}D=\frac{1}{k!}\frac{\partial^k}{\partial t_1\cdots \partial t_k}\ad_{(t_1f_1+\cdots+t_kf_k)}^k D.\]

\begin{lem}
    Let $D\in\PDO^k(E,E')$, fix a point $m\in M$ and denote the (maximal) ideal 
    \[I_m\coloneqq \{f\in C^\infty(M)\mid f(m)=0\}\sube C^\infty(M).\]
    Then, $(\ad_{f_1}\cdots \ad_{f_k}D)_m=0$ whenever one of the $f_i$ belongs to $I^2_m$.
\end{lem}
\begin{proof}
    From the identity for any $P\in \OP(E,E')$ and $f,g\in C^\infty(M)$,
    \[\ad_{fg}P=fgP-fPg+[f,P]g=(\ad_f P)g+f(\ad gP),\]
    we deduce that if $f_1=gh$ with $g,h\in I_m$, then 
    \[\ad_{f_1}\cdots \ad_{f_k}D=\ad_{gh}\underbrace{\ad_{f_2\cdots f_k}}_{\coloneqq P}D=(\ad_g P)h+g(\ad_h P).\]
    On the other hand, $\ad_h P\in\PDO^0(E,E')$, so $(\ad_g P)h=h\ad_g P$. We conclude 
    \[\ad_{f_1}\cdots \ad_{f_k}D=h\ad_g P+g\ad_h P.\]
    Both $\ad_g P$ and $\ad_h P$ are bundle morphisms and for every section $s\in\Gamma^\infty(E)$ we have 
    \[(\ad_{f_1}\cdots \ad_{f_k}D)s(m)=h(m)(\ad_g P)s(m)+g(m)(\ad_h P)s(m)=0.\]
\end{proof}

This shows that at each point $m\in M$ we have a symmetric, $k$-linear map (also known as a \emph{homogeneous polynomial} of degree $k$)
\begin{align}
    \sigma(D)_m:(I_m\slash I_m^2)^k &\to \Hom(E_m,E_m'),\\
    (\xi_1,\ldots,\xi_k)&\mapsto \frac{(-1)^k}{k!}(\ad_{f_1}\cdots \ad_{f_k}D)_m,\quad f_i\in I_m,\quad f_i\equiv \xi_i\mod I^2_m. \label{eq 104}
\end{align}
Since it's symmetric, this function is uniquely determined by 
\[\sigma(D)(\xi)\coloneqq \sigma(D)(\underbrace{\xi,\ldots,\xi}_k).\]
To obtain a more explicit description of $\sigma(D)$, we need the following classical lemma that identifies $I_m\slash I^2_m$ with the cotangent space $\T^\ast_m M$.

\begin{lem}[Hadamard]\index{Lemma!Hadamard}
    Let $m\in M$. A function $f\in C^\infty(M)$ belongs to $I^2_m$ iff $f(m)=0$ and $(\dd f)_m=0$, so that we have a natural isomorphism of vector spaces 
    \[\T^\ast_m M\cong I_m\slash I^2_m.\]
\end{lem}
\begin{proof}
    The forward implication is immediate by the Leibniz rule for $\dd$. It suffices to prove the converse locally, i.e., for functions on $M=\bbR^n$ and at $m=\bf{x}=0$. We use the Fundamental Theorem of Calculus to write 
    \[f(\bf{x})=\int_0^1 \partial_t f(t\bf{x})\dd t=\int_0^1 \partial_{x^i}f(t\bf{x})x^i\dd t=g_i(\bf{x})x^i,\]
    where the functions $g_i$ are defined by this formula. Each $g_i$ is smooth and vanishes at the origin since $\dd f$ does. Thus, we have represented $f$ as a sum of products of pairs of elements of $I_0$, as required. 
\end{proof}

\begin{defn}[Symbol]\index{Symbol of a differential operator}
    Let $D\in\PDO^k(E,E')$. By Hadamard's Lemma, the map $\sigma(D)$ from (\ref{eq 104}) can be identified with a bundle morphism
    \[(\sigma_D)_m:\bigodot^k \T^\ast_mM\to \Hom(E_m,E_m'),\quad \xi^{\otimes k}\mapsto \frac{(-1)^k}{k!}(\ad_f^k D)_m, \]
    where $f\in C^\infty(M)$ is such that $(\dd f)=\xi$, called the (principal) symbol of $D$. That is, $\sigma_D\in \Gamma^\infty(\bigodot^k(\T^\ast M)\otimes \Hom_M(E,E'))$.
\end{defn}

We can finally connect this definition of the symbol to our original observation that a $k$-th order differential operator, modulo $(k-1)$-st order operators, is identified with a tensorial object.

\begin{defn}[Associated graded algebra]
    For any filtered algebra $A=\bigcup_{i=0}^\infty A_i$, $A_i\subset A_{i+1}$, there is a natural associated graded algebra defined by virtue of the functor 
    \[\gr A= \bigoplus_{i=0}^\infty \gr_i A\coloneqq \bigoplus_{i=0}^\infty A_i\slash A_{i-1},\]
    where we put $A_{-1}=\{0\}$. The quotient map from the filtered algebra $A$ onto $\gr A$ is called the \emph{symbol map}, written as $\sigma$; its component in degree $i$ is the quotient map $\sigma:A_i\to \gr A$ with kernel $A_{i-1}$.
\end{defn}

Since the symbol is determined by its action on symmetric elements of the form $\xi^{\otimes k}$, $\xi\in \T^\ast M$, we can derive a formula for it in terms of one covector. In fact, $\sigma_D(\xi^{\otimes k})$, as a function of $\xi$, can be identified with a section of the pullback bundle $\pi^\ast \Hom_M(E,E')\to \T^\ast M$, where $\pi:\T^\ast M\to M$ is the cotangent bundle projection. Symbols are one-to-one with such sections that are homogeneous polynomials as functions along each fiber of $\T^\ast M$.

\begin{prop}[{{\cite[Prop.~2.1]{Berline}}}]
    The associated graded algebra 
    \[\gr\PDO(E,E')=\bigoplus_{k=0}^{\infty}\PDO^{\leq k}(E,E')\slash\PDO^{k-1}(E,E')\]
    to the filtered algebra of linear differential operators is isomorphic to the space of sections of the bundle $\bigodot(\T M)\otimes\Hom_M(E,E')$. This isomorphism,
    \[\sigma:\gr_k\PDO(E,E')\to \Gamma^\infty\left(M,\bigodot^k(\T M)\otimes\Hom_M(E,E')\right),\quad D\mapsto \sigma_D,\] 
    is induced by the symbol and is given by the following formula: if $D\in\PDO^{\leq k}(E,E')$, then for $m\in M$ and $\xi\in \T^\ast_m M$,
    \[\sigma_D(\xi)=\lim_{t\to\infty}t^{-k}(\rme^{-tf}\cdot D\cdot \rme^{tf})(m)=\frac{(-1)^k}{k!}\ad_f^k D\in\Hom(E_m,E_m'),\label{eq 1249}\]
    where $f$ is any smooth function on $M$ such that $(\dd f)_m=\xi$.
\end{prop}
\begin{proof}
    Let $D$ be a differential operator whose local representative in some coordinates $\bf{x}$ on $M$ is, up to differential operators of lower order, $a \partial_{x^{i_1}}\cdots\partial_{x^{i_k}}$ with some $a\in\Gamma^\infty(\End(E))$. By the Leibniz rule, the operator $e^{-tf}De^{tf}$ is a differential operator depending polynomially on $t$, of the form 
    \[e^{-tf}De^{tf}=t^k a\cdot \xi(X_1)\cdots \xi(X_k)+\calO(t^{k-1}),\quad t\to\infty.\]
    It follows that the leading order is a zeroth-order operator, and that the limit in (\ref{eq 1249}) is independent of the function $f$ as long as $(\dd f)_m=\xi$, and defines a linear isomorphism from $\gr_k\PDO(E)$ to $\Gamma^\infty\left(\bigodot^k(\T M)\otimes \End(E)\right)$.
\end{proof}


\begin{rem}
    \begin{enumerate}
        \item From (\ref{eq 1249}) it is clear that symbols are multiplicative: if $D_i\in\PDO^{k_i}(E)$, $i=1,2$, then 
        \[\sigma_{D_1\cdot D_2}(\xi)=\sigma_{D_1}(\xi)\cdot \sigma_{D_2}(\xi).\]
        \item Let $h:E\to E$ and $h':E'\to E'$ be vertical isomorphisms. Then, for any $D\in\PDO(E,E')$, 
        \[\sigma_{h'Dh}(\xi)=h'\circ \sigma_D(\xi)\circ h.\]
    \end{enumerate}
\end{rem}


\begin{example}\label{ex symbols}
    \begin{enumerate}
        \item Consider a $k$-th order differential operator on $\bbR^n$, $D=\sum_{|\bm{\alpha}|\leq k}a_{\bm{\alpha}}(\bf{x})\partial^{\bm{\alpha}}_{\bf{x}}$. Then its principal symbol is 
        \[\sigma_D(\bf{x},\xi)=\sum_{|\bm{\alpha}|= k}a_{\bm{\alpha}}(\bf{x})\xi^{\bm{\alpha}}.\]
        \item The exterior derivative $\dd:\Omega^p(M)\to \Omega^{p+1}(M)$ is an element of $\PDO^1\left(\bigwedge^p \T M,\bigwedge^{p+1}\T M\right)$. Its symbol is 
        \[\sigma_{\dd}(\dd f)\alpha=[\dd,f]\alpha=\dd f\wedge\alpha,\] so we can write $\sigma_{\dd}(\xi)=\xi\wedge$.
        \item The Lie derivative $\Lie_X$, $X\in \fX(M)$, acting on functions is an element of $\PDO^1(M\times\bbR)$ and its symbol is $\sigma_X(\xi)=\xi(X)\in\bbR$.
        \item The $2$-dimensional heat operator is $Pu=u_t-u_{xx}-u_{yy}$ for a function $u(t,x,y)$, and its symbol is 
        \[\sigma_P(e\dd t+v_x\dd x+v_y\dd y)=-v_x^2-v_y^2.\]
    \end{enumerate}
\end{example}










\section{Characteristics of PDEs}


The goal of this \sect\ is to give a geometric (coordinate-free) formulation of the Cauchy-Kovalevskaya Theorem. For this we will need the fundamental concept of \emph{characteristics}. If the initial submanifold is not chosen in a way that is required by the theorem, solutions may either not exist, or the system may be undetermined with infinitely many solutions. Consider the following elementary example.

\begin{example}\label{ex 5.6.1 Ivey}
    Consider the system 
    \[u_x=v_y,\quad u_y=u_x.\label{eq 5.20 Ivey}\]
    If we pick initial data for $u,v$ along a line through the origin other than $x=\pm y$, then it extends to a unique solution to the system. But if we specify initial data along the line $y=x$, then unless $u-v=\const$, this cannot be extended to a solution. If $u-v=\const$ along $y=x$, then there are an infinite number of local extensions to a solution.
\end{example}

For any $\bbK$-vector space $V$, we denote by $\bbP V$ is projectivization, i.e., the quotient $V\slash \sim$ by the equivalence relation $v\sim w$ iff $v=\lambda w$ for some $\lambda\in\bbK^\times$. If $\bbK=\bbR$ or $\bbC$ and $\dim_\bbK V=n+1$, then $\bbP V$ is a (real or complex, respectively) $n$-manifold. In algebraic geometry, it is common to denote such a manifold simply by $\bbP^n$ (diffeomorphic either to $\RP^n$ or $\CP^n$).

Any nonzero linear function (covector) $\xi\in\Hom(V,\bbK)$ vanishes on a hyperplane in $V$, and this hyperplane determines $\xi$ up to rescaling, and vice versa. Thus, each point $[\xi]\in \bbP V^\ast$ is naturally identified with a hyperplane of $V$.

\begin{defn}[Characteristic variety]\index{Characteristic variety}
    Let $D\in\PDO(E,E')$ be a linear differential operator over a manifold $M$. The characteristic variety of $D$ is defined, for each $m\in M$,\footnote{Varieties are the algebraic geometric analogs of manifolds and have several definitions. An \emph{affine variety}\index{Variety!affine} is the zero locus of a collection $S$ of polynomials on an affine space $V$ over an algebraically closed field $\bbK$ (say $\bbC$), together with the Zariski topology (closed sets are exactly the zero locuses of collections of polynomials). If $\bbK$ is not closed (say $\bbR$), then one first constructs the zero locus of $S$ in $V\otimes_{\bbK} \wb{\bbK}$ and then takes the subset of points that lie in $V$ proper (e.g., real points). A \emph{projective variety}\index{Variety!projective} is the same thing but all polynomials have to be homogeneous, so one can pass to subsets of the projective space $\bbP V$. The analog of a smooth atlas is provided by the \emph{coordinate ring},\index{Coordinate ring} which is the quotient $\bbK[V]\slash I$, where $\bbK[V]=\bigodot V^\ast$ is the ring of all polynomials on $V$ and $I$ is the ideal generated by $S$. The abstract definition of varieties that avoids identifying them with subsets of other spaces is based on the more general concept of \emph{schemes}.\index{Scheme}}
    \[\Xi_{D,m}\coloneqq \{[\xi]\in \bbP \T^\ast_m M\mid \ker\sigma_D(\xi)\neq 0\}.\]
    Let $\T^{\bbC\ast}_m M\coloneqq \T_m^\ast M\otimes\bbC$ be the complexified cotangent space. The symbol can be naturally extended to this space by linearity. Then the \emph{complex characteristic variety} consists of complex lines in a complex vector space:
    \[\Xi_{D,m}^\bbC\coloneqq \{[\xi]\in \bbP \T^{\bbC\ast}_m M\mid \ker\sigma_D(\xi)\neq 0\}.\]
\end{defn}

Thus, $\xi$ is characteristic iff $D$ takes ``exceptionally few'' derivatives in the direction of $\xi$.

\begin{example}
    \begin{enumerate}
        \item For the heat operator from Example~\ref{ex symbols}(4), the characteristic variety is the set of $[e,v_x,v_y]\in\bbP^2$ such that $v_x^2+v_y^2=0$, i.e., the single point $[1,0,0]$, while the complex characteristic variety consists of the complex solutions of the same equation: $[e,v,\pm v]$, i.e., $v_y=\i v$ and $v_y=-\i v$, a union of two complex lines.
        \item Consider the exterior derivative acting on $p$-forms, whose symbol is $\sigma_{\dd}(\xi)=\xi\wedge$ (Example~\ref{ex symbols}(2)), so the characteristic variety is the set of all lines $[\xi]$ spanned by covectors such that $\xi\wedge\omega=0$ for some $p$-form $\omega\neq 0$. If $p=0$, this forces $\xi=0$ and the characteristic variety is empty. If $p>0$, then such an $\omega$ exists for any $\xi$, so the characteristic variety is all of $\bbP \T^\ast_m M$. The same holds for the complex varieties.
        \item For a Lie derivative $\Lie_X$ acting on functions (Example~\ref{ex symbols}(3)), the characteristic variety is the set of $[\xi]$ such that $\xi(X)=0$, i.e., the set of hyperplanes containing the vector $X$.
        \item For the wave operator $Du=u_{tt}-\Delta u$ on $\bbR^n$, where $\Delta=\sum_i \partial_{x^i}^2$ is the Laplace operator, the symbol is $\sigma_D(e,\bf{p})=e^2-\lVert\bf{p}\rVert^2$, where $(e,\bf{p})\in (\bbR\times\bbR^n)^\ast$. By rescaling, we can arrange $e=1$, so the characteristic variety is the sphere $\bbS^{n-1}$ consisting of $[1,\bf{p}]\in \bbP^n$ such that $\lVert\bf{v}\rVert^2=1$. As a family of hyperplanes, this sphere is the set of hyperplanes tangent to the \emph{light cone} $\dd t^2=\lVert\dd \bf{x}\rVert^2$.
    \end{enumerate}
\end{example}


Now we briefly discuss the notion of characteristic varieties for \emph{nonlinear differential operators}, i.e., maps $D:\Gamma^\infty(E)\to \Gamma^\infty(E')$ that factor through jets as $D=\wt{D}\circ \rmj^k$ for some smooth map $\wt{D}:\rmJ^kE\to E'$. For simplicity, let us work with functions $u\in C^\infty(\bbR^n)$ in local coordinates. Consider a nonlinear operator $D[u]=F(\bf{x},u,u_{\bf{x}})$ and any function $u$ such that $D[u]=0$. Then the \emph{linearization} of $D$ about $u$ is the linear differential operator acting on functions $v$ by
\[D'[u]v\coloneqq F_u(\bf{x},u,u_{\bf{x}})v+F_{u_{\bf{x}}}(\bf{x},u,u_{\bf{x}})\cdot v_{\bf{x}},\]
and linearization can be similarly defined for higher order differential operators, as well as vector-valued functions $\bf{u}$ and $\bf{F}$. We can now speak of a \emph{differential equation} $\bf{F}(\bf{x},\bf{u},\bf{u}_{\bf x})=0$, defined for $\bf{x}\in\bbR^n$, $\bf{u}\in\bbR^s$, $\bf{u}_{\bf x}\in\bbR^{n\times s}$ in some open subset of $\bbR^{n+s+n\times s}$, and we implicitly assume that $\bf{F}$ is analytic and that the zero locus of $\bf{F}$ is a manifold such that the projection $(\bf{x},\bf{u},\bf{p})\mapsto (\bf{x},\bf{u})$ onto independent and dependent variables is a submersion (so that the differential equation doesn't, locally, constrain the values of the independent or dependent variables). More broadly, a \emph{differential equation} is any submanifold $S$ of a jet bundle $\rmJ^k E$ whose projection onto $E$ is locally a submersion.

If we are given the values of $\bf{u}$ and $\bf{u}_{\bf{x}}$ at one point $\bf{x}$, then we can calculate $\bf{F}(\bf{x},\bf{u},\bf{u}_{\bf x})$ at $\bf{x}$, and if it vanishes, then we can also calculate the linearization $D'[\bf{u}]$ at $\bf{x}$, or in other words we can calculate the coefficients of the linearization at $\bf{x}$:
\[\bf{F}_{\bf{u}}(\bf{x},\bf{u},\bf{u}_{\bf{x}})\text{ and }\bf{F}_{\bf{u}_{\bf{x}}}(\bf{x},\bf{u},\bf{u}_{\bf{x}}).\]
This allows us to find the characteristic variety $\Xi_{(\bf{x},\bf{u},\bf{u}_{\bf x})}$ of the differential equation, by which we mean that of the linearization at $(\bf{x},\bf{u},\bf{u}_{\bf{x}})$.

\begin{example}
    \begin{enumerate}
        \item Take the nonlinear equation $u_t=u_{xx}u+\sin(u_x)$ and some solution $u(t,x)$. Take an arbitrary smooth function $v(t,x)$ and plug $u+\epsilon v$ into the equation, supposing that it is also a solution, at least to linear order in $\epsilon$:
        \[u_t+\epsilon v_t=u u_{xx}+\sin(u_x)+\epsilon(u_{xx}v+uv_{xx}+\cos(u_x)v_x)+\calO(\epsilon^2).\]
        Since $u$ is already a solution, this requires that 
        \[v_t=u_{xx}v+uv_{xx}+\cos(u_x)v_x,\]
        which is a linear differential equation on $v$ with coefficients dependent on the original solution $u$. This linear equation essentially defines the tangent space to the manifold of solutions of the nonlinear PDE.
        \item The linearization of $u_t=uu_{xx}+u_{yy}+u^2$ is $v_t=u_{xx}v+uv_{xx}+v_{yy}+2uv$, so the characteristic variety at $(t,x,y,u)$ is given by $0=u\xi_x^2+\xi_y^2$, where $\xi=\xi_t \dd t+\xi_x\dd x+\xi_y\dd y$.
    \end{enumerate}
\end{example}

We can finally give a geometric description of the class equations that can be brought to the Cauchy-Kovalevskaya form.

\begin{defn}[Determined equation]
    A differential equation $S<\rmJ^k E$ is called determined if the value  $\sigma(\xi)$ of its symbol (corresponding to linearizations of the equation) is an isomorphism of vector spaces for \emph{some} $\xi\in \T^\ast M$.
\end{defn}

Since every higher-order differential equation can be written as a first-order equation on a prolonged jet bundle, it suffices to prove the following for first-order equations, i.e., submanifolds of $\rmJ^1E$.

\begin{lem}
    A differential equation $\bf{F}(\bf{x},\bf{u},\bf{u}_{\bf x})=0$ can be locally written in the Cauchy-Kovalevskaya form in some coordinates iff it is determined.
\end{lem}
\begin{proof}
    If we linearize the equation around some $1$-jet $(\bf{x},\bf{u},\bf{p})$, we get the linear equation 
    \[\bf{F}_{\bf{u}}(\bf{x},\bf{u},\bf{u}_{\bf x})\bf{v}+\bf{F}_{\bf p}(\bf{x},\bf{u},\bf{u}_{\bf x})\cdot \bf{v}_{\bf x},\]
    with symbol $\sigma(\xi)\bf{v}=(\bf{F}_{\bf p}(\bf{x},\bf{u},\bf{u}_{\bf x})\cdot \xi) \bf{v}$. So if we write coordinates as $x^i,\xi_i,u^a,p^a_i$, then the symbol matrix is 
    \[\sigma(\xi)=\bf{F}_{p_i}\xi_i.\]
    We want to find the condition under which we can smoothly solve, at least locally, the equation $\bf{F}=0$ for some partial $\bf{u}_{x^i}$ as a function of $\bf{x},\bf{u}$ and the other $\bf{u}_{x^j}$. By the \gls{immt}, we can do this just when $\bf{F}_{p_i}$ is an invertible square matrix. Note that 
    \[\sigma(\dd x^i)=\bf{F}_{p_i}.\]
    On the other hand, if $\sigma(\xi)$ is an invertible square matrix for some $\xi$, we can linearly change variables to arrange $\xi=\dd x^i$ and reverse the above steps.
\end{proof}

The problem of specifying initial data for nonlinear equations is much more complicated than for linear ones because admissible initial data don't form a vector space. Take a hypersurface $H\subset\bbR^n$ (of codimension $1$) of the $\bf{x}$-variables and choose maps $\bf{u}(\bf{x})$ and $\bf{p}(\bf{x})$ defined along $H$ so that $\bf{p}\cdot X=X^i\partial_{x^i}\bf{u}$ for any tangent vector $X\in \T H$. The maps $\bf{u},\bf{p}$ are called \emph{noncharacteristic initial data} if $(\bf{x},\bf{u}(\bf{x}),\bf{p}(\bf{x}))\in M$ for each $\bf{x}\in H$ and $\T_{\bf{x}}H$ is noncharacteristic for the linearization of our equations at each point $(\bf{x},\bf{u}(\bf{x}),\bf{p}(\bf{x}))$.

\begin{lem}
    A determined system of equations $\bf{F}(\bf{x},\bf{u},\bf{p})=0$ admits some analytic noncharacteristic initial data through any point $(\bf{x},\bf{u},\bf{p})$.
\end{lem}
\begin{proof}
    Since the symbol matrix is invertible for some hyperplane, the characteristic variety $\Xi_m$ is not all of $\bbP \T^\ast_m M$, where $m=(\bf{x},\bf{u},\bf{p})$ and $M=\rmJ^1(\bbR^n,\bbR^s)$.
\end{proof}

We can finally give a coordinate-free formulation of the Cauchy-Kovalevskaya Theorem.

\begin{thm}[Cauchy-Kovalevskaya]\index{Theorem!Cauchy-Kovalevskaya}
    Consider an initial value problem for a determined system of PDEs with noncharacteristic initial data specified along an embedded hypersurface, all real analytic. Then there is an analytic solution to the problem in some open neighborhood of the initial hypersurface, and any two such solutions agree in any connected open set on which both are defined.
\end{thm}
\begin{proof}
    If we can prove uniqueness of local solutions near local patches of the initial hypersurface, and then we can glue them together to get a unique ``global'' solution. Thus it suffices to prove the result locally. By an analytic change of variables, arrange that our hypersurface  is $t=0$ in some $(t,\bf{x})$ variables. By the \gls{immt}, if we have a smooth map $\bf{F}(t,\bf{x},\bf{u},\bf{p},\bf{q})$ (where $\bf{p},\bf{q}$ correspond to $\bf{u}_t,\bf{u}_{\bf x}$), we are able to locally smoothly solve $\bf{F}=0$ for a variable $\bf{p}$ as a function of the other variables iff $\bf{F}_{\bf{p}}$ is a matrix of full rank. In other words, we can rewrite the PDE $\bf{F}=0$ in the Cauchy-Kovalevskaya form, i.e., solve for $\bf{u}_t$ as a function of the other variables, iff $\bf{F}_{\bf{u}_t}$ is a matrix of full rank, i.e., exactly when the hypersurface $t=0$ is not characteristic for the linearization of the equation. The classical Cauchy-Kovalevskaya Theorem now yields a unique local analytic solution.
\end{proof}
\begin{cor}
    A determined analytic initial value problem has a local analytic solution near every point.
\end{cor}

\begin{example}[Eikonal equation]\index{Equation!Eikonal}
    Consider the $2$-dimensional \emph{eikonal equation} 
    \[u_t^2+u_x^2=1\]
    with initial data $u(0,x)=0$. Thus also $u_x(0,x)=0$. The equation now says that $u_t=\pm 1$ at $t=0$. The linearization at any point is 
    \[2u_t v_t+2u_x v_x=0.\]
    Along our initial data, this becomes $2v_t=0$. The symbol is $\sigma(\xi)=2\xi_t$, which is determined and the line $t=0$ is noncharacteristic. 

    Of course we could've just solved the equation for $u_t$ explicitly, $u_t=\pm \sqrt{1-u_x^2}$, and then any initial data $u(0,x)$ with $-1<u_x(0,x)<1$ would give rise to a unique analytic solution near $t=0$. Notice how initial data is constrained in a complex way due to the nonlinearity.
\end{example}

\begin{example}
    The linear operator $Du=u_{xx}$ has symbol $\sigma_D(\xi)=-\xi^2$. Now consider a first order-operator $Q$ with the same kernel (i.e., it has the same solutions $u$):
    \[Q\begin{pmatrix}
        u\\v
    \end{pmatrix}=
    \begin{pmatrix}
        v_x\\u_x
    \end{pmatrix}=
    \begin{pmatrix}
        0& 1\\1&0
    \end{pmatrix}
    \partial_x
    \begin{pmatrix}
        u\\v
    \end{pmatrix}.
    \]
    The symbol of $Q$ is 
    \[\sigma_Q(\xi)=\begin{pmatrix}
        0&\xi\\\xi&0
    \end{pmatrix}.\]
    The characteristic variety is $\Xi_Q=\{\xi^2=0\}=\Xi_D$.
\end{example}

From the above example we see that replacing a system of PDEs by its equivalent first-order system doesn't change the characteristic variety (not the complex characteristic variety). A particularly ``nice'' class of operators, called \emph{elliptic}, is distinguished by the fact that their real characteristic varieties consist only of $\xi=0$.

\begin{defn}[Elliptic operator]\index{Elliptic!differential operator}
    A differential operator $D\in\PDO^k(E)$ is called elliptic if the values of the symbol $\sigma(D)(\xi)\in\End(E_m)$ are invertible for any nonzero $\xi\in \T^\ast M$. Equivalently, $D$ has no real characteristic directions.
\end{defn}

Hence, initial data for elliptic equations can be specified along arbitrary hypersurfaces. On a geometric level, this is why, for example, the Laplace equation $\Delta u=0$ allows for \emph{boundary value problems}, where initial data is specified on the $(n-1)$-dimensional boundary of some connected open domain.


\begin{xca}\index{Undertermined system}
    Suppose that $\bf{F}(\bf{x},\bf{u},\bf{u}_{\bf x})=0$ is an analytic PDE such that the symbol of its linearization about any point $(\bf{x},\bf{u},\bf{u}_{\bf{x}})$ has a covector $\xi$ for which $\sigma(\xi)$ is a surjective linear map, with kernel of dimension $l>0$ (such systems are called \emph{underdetermined}). Prove that we can locally add $l$ additional equations to make the system determined, and conclude that there are local solutions. What is the correct notion of noncharacteristic data?
\end{xca}


The rest of this \chap\ will be devoted to developing the geometric methods necessary for extending this sort of analysis to arbitrary non-determined (most intriguingly, overdetermined) systems.










\section{Cauchy characteristics}


We now switch from PDEs to the more general context of \glspl{eds}, which are defined as differential ideals in the algebra of differential forms $\Omega^{\smbullet}(M)$ (cf.~\S\ref{sec: frobenius ii}). Integral manifolds were defined as submanifolds of $M$ on which the pullbacks of all of the forms of the ideal vanish. The Frobenius Theorem, as discussed in \S\ref{sec: frobenius i} and \S\ref{sec: frobenius ii}, shows that a completely integrable system takes a very simple form upon a proper choice of local coordinates (in which the leaves of the foliation are slices). Given any \gls{eds}, one can ask the question whether there is a coordinate system in which the system is generated by forms in a smaller number of these coordinates. This is answered by the Cauchy characteristics. Its algebraic basis is the \emph{retraction theorem}, which we do not cover here.

First we introduce the more general concept of infinitesimal symmetries of an \gls{eds}.

\begin{defn}[Killing vector fields]
    Let $\calI$ be an \gls{eds} on $M$. A vector field $X\in\fX(M)$ is an infinitesimal symmetry, or a Killing vector field, of $\calI$ if 
    \[\Lie_X (\calI)\subset \calI.\]
    Since $\Lie_X$ is natural w.r.t.\ wedge products and exterior derivatives, it suffices to show that $\Lie_X \theta^a\in \calI$ for a set $\{\theta^a\}$ of \emph{differential} generators of $\calI$. The set of all Killing vector fields automatically forms a Lie subalgebra of $\fX(M)$.
\end{defn}

Given an integral manifold $N_0$ of an \gls{eds} $\calI$ on $M$, a Killing vector field $X$ can be used to obtain a one-parameter family of integral manifolds: with $\Fl^X_t$ denoting the flow of $X$, put
\[N_t\coloneqq \Fl^X_t(N_0).\label{eq 7.3 Ivey}\]
It is easy to see that, as long as the flow is well-defined, $N_t$ is a smooth integral manifold of $\calI$. 

\begin{rem}
    Cartan initiated the classification of \glspl{eds} whose symmetries depend on arbitrary functions (thus forming infinite-dimensional Lie algebras). Determining the symmetries usually amounts to solving an overdetermined system of differential equations, so most of the time the Lie algebra of symmetries is empty. An interesting exception is the Pfaffian system $\<\dd y-p\dd x,\dd p-q\dd x,\dd z-q^2\dd x\>_{\mathrm{diff}}$ on $\bbR^5$ with coordinates $x,y,z,p,q$. In this case the symmetries form a $14$-dimensional Lie algebra isomorphic to the split form of the exceptional Lie algebra $\frakg_2$. In his famous ``five variables paper'' Cartan proved that this is the largest possible Lie algebra of symmetries for a rank three Pfaffian system with generic derived flag on a 5-dimensional manifold.
\end{rem}

Unfortunately, enumerating the Killing vector fields (also called \emph{Lie point symmetries}, or simply \emph{symmetries}) for a given system of PDEs is usually harder than solving the system itself. We direct the reader to \cite{Olver} for an comprehensive exploration of this subject.

\begin{defn}[Cauchy characteristics]
    Let $\calI$ be an \gls{eds} on $M$. A vector field $X\in\fX(M)$ is a Cauchy characteristic vector field of $\calI$ if 
    \[i_X (\calI)\subset \calI.\]
    Since $i_X$ is a $\wedge$-derivation, it suffices to show that $i_X\theta\in\calI$ for a set $\{\theta^a\}$ of \emph{algebraic} generators of $\calI$. Since Cauchy vector fields are preserved by multiplications by arbitrary scalar function, we can talk of \emph{Cauchy characteristic line fields}. Since $\calI$ is a differential ideal, each Cauchy characteristic vector field is automatically a Killing vector field. Moreover, Cauchy characteristic vector fields also form a Lie subalgebra of $\fX(M)$ (see the exercise below).
\end{defn}

\begin{xca}
    Prove that the set of Cauchy characteristics of an \gls{eds} on $M$ is a Lie subalgebra of $\fX(M)$. \emph{Hint:} use Cartan's magic formula. See \cite[Prop.~2.1]{Bryant}.
\end{xca}

The condition for finding Cauchy characteristics is thus algebraic, which makes them much easier to find than other Killing vector fields. And while Killing vector fields preserve the set of integral manifolds, for Cauchy characteristics a stronger statement holds.

\begin{prop}[{{\cite[Prop.~7.1.8]{Ivey}}}]\label{prop 7.1.8 Ivey}
    Let $N_0$ be an integral $n$-manifold for an \gls{eds} $\calI$ and let $X$ be a Cauchy characteristic vector field transverse to $N_0$. Let $N_t$ be as in (\ref{eq 7.3 Ivey}), and let $S$ be the $(n+1)$-dimensional union of the $N_t$. Then $S$, when smooth, is an integral manifold of $\calI$.
\end{prop}
\begin{proof}
    Assume $\dim N_0=1$, so $N_0$ is an integral curve with $X$ transverse to it. In order for $S$ to be smooth, we must restrict $t$ to an open interval of values for which $X$ is transverse to $N_t$. Let $\omega\in\calI^2$ and let $Y$ be tangent to one of the $N_t$. Then $\omega(X,Y)=(i_X\omega)(Y)=0$ because $i_X\omega\in\calI$.  This easily generalizes to higher dimensionality of $N_0$ by replacing $Y$ with a local frame for $N_t$.
\end{proof}


\begin{example}[A first-order PDE]
    Let $(x^1,x^2,u,p_1,p_2)$ be the usual coordinates on $\rmJ^1(\bbR^2,\bbR)$. The equation 
    \[u_t=u_x\] 
    is equivalent to the \gls{eds} obtained by restricting the canonical contact system to the smooth hypersurface $M$ defined by $p_2=p_1$. We will use $x=x^1,t=x^2,p=p_1$, and $u$ as coordinates on $M$, where the system is generated algebraically by 
    \[\theta\coloneqq \dd u-p(\dd x+\dd t),\quad \dd\theta=-\dd p\wedge(\dd x+\dd t).\]
    Suppose 
    \[X=a\partial_x+b\partial_t+c\partial_p+e\partial_u\]
    is a Cauchy characteristic vector field on $M$. Then $i_X\theta=0$ implies $e=(a+b)p$. Then $i_X\dd \theta\equiv 0$ modulo $\theta$ implies that $c=a+b=0$. Hence,
    \[X=\partial_x-\partial_t\]
    up to a multiple. Integral surfaces of $\calI$ are constructed by translating integral curves along curves where $u,p$, and $x+t$ are constant.
\end{example}

All Cauchy characteristics (vector fields) together span a well-defined distribution $\calA(\calI)< \T M$ given by 
\[\calA(\calI)_m\coloneqq \{X\in \T_mM\mid i_X(\calI)\subset \calI\},\quad m\in M.\]
The rank of $\calA(\calI)$ is upper semicontinuous on $M$ (in an open neighborhood of $m$ it can only decrease), so we can restrict to an open set on which it is constant. The dual of $\calA(\calI)$ is a Pfaffian system that we define next.

\begin{defn}[Retracting space of $\calI$]\index{Retracting space}
    Let $\calI$ be an \gls{eds} on $M$ with characteristic distribution $\calA(\calI)$. The retracting space, or Cartan system, of $\calI$ is the Pfaffian system $\calC(\calI)<\T^\ast M$ defined by 
    \[\calC(\calI)_m\coloneqq \{\theta\in \T^\ast_m M\mid i_X\theta=0 \text{ for all }X\in \calA(\calI)_m\}.\]
\end{defn}

Assume $\calC(\calI)$ is regular, i.e., it has constant rank. Since the space of sections $\Gamma^\infty(\calA(\calI))$ (taken locally) is closed under Lie brackets of vector fields, $\calC(\calI)$ is closed under $\dd$, so it is Frobenius.\footnote{Because $\dd\theta(X,Y)=-\theta([X,Y])$ for $\theta\in\Gamma^\infty(\calC(\calI))$ and $X,Y\in\Gamma^\infty(\calA(\calI))$.} 

\begin{defn}[Cauchy characteristics]
    The leaves of the foliation defined by the distribution $\calA(\calI)$ (assuming it is regular) are called the Cauchy characteristics of $\calI$.
\end{defn}

Now, by the Frobenius Theorem, there exist local coordinates $(x^1,\ldots,x^n,y^1,\ldots,y^s)$ on a neighborhood $U\subset M$ such that $\restr{\calC(\calI)}{U}=\<\dd y^1,\ldots,\dd y^s\>_{C^\infty(U)}$. The following theorem, which we provide without proof, shows that the same holds for $\calI$ itself.

\begin{thm}[{{\cite[Thm.~II.2.2]{Bryant}, \cite[Prop.~7.1.20]{Ivey}}}]\label{thm 2.2 Bryant}
    If $(M,\calI)$ is a finitely generated \gls{eds} whose retracting space $\calC(\calI)$ is regular of rank $s$, and $\dim M=n+s$, then there exists a local chart $(x^1,\ldots,x^n,y^1,\ldots,y^s)$ such that $\calI$ can be locally generated by forms that depend only on $\bf{y}$ and $\dd \bf{y}$.
\end{thm}

Note that for a generic \gls{eds}, $r=0$, because generally there are no nontrivial Cauchy characteristics (i.e., they are points). The above theorem allows us to locally reduce an \gls{eds} to another \gls{eds} (defined on the leaf space, called the \emph{quotient by the Cauchy characteristics}) in which there are no extraneous variables in the sense that all coordinates are needed to express $\calI$ in any coordinate system. The following is a useful application of this result to the study of submersions.

\begin{cor}[{{\cite[Cor.~II.2.3]{Bryant}}}]
    Let $\pi:E\to M$ be a submersion with connected fibers and \emph{vertical distribution} $\calV E\coloneqq \ker\pi_{\ast}<\T E$. Then a differential form $\alpha\in\Omega^{\smbullet}(M)$ is the pullback $\pi^\ast \alpha_M$ iff 
    \[i_X\alpha=i_X\dd\alpha=0\text{ for all }X\in \calV E.\]
\end{cor}
\begin{proof}
    Let $\dim E=N$. By the Rank Theorem, there are local coordinates such that 
    \[\pi(x^1,\ldots,x^p,x^{p+1},\ldots,x^N)=(x^1,\ldots,x^p).\]
    Then $\calV E$ is locally spanned by $\{\partial_{x^{p+1}},\ldots,\partial_{x^N}\}$. Now considering the \gls{eds} $\calI\coloneqq \<\alpha\>_{\mathrm{diff}}$, we see that $\calV\subset\calA(\calI)$. Therefore, by Theorem~\ref{thm 2.2 Bryant}, there is a generator for $\calI$ independent of $(x^{p+1},\ldots,x^N)$, and hence of the form $\pi^\ast \alpha_M'$ with $\alpha_M'\in \Omega^{\smbullet}(M)$. Thus, there is a function $\mu$ such that 
    \[\mu\alpha=\pi^\ast \alpha_M'.\]
    Since 
    \[0=i_X(\dd \mu\wedge\alpha_M'+\mu\dd\alpha_M')=(\Lie_X \mu)\alpha_M'\text{ for all }X\in\calV E,\]
    we see that $\mu$ is independent of $(x^{p+1},\ldots,x^N)$ as well, and hence $\mu=\pi^\ast\lambda=\lambda\circ \pi$ for some function $\lambda$ on $M$. Now $\alpha_M=\alpha_M'/\lambda$ is the required form.
\end{proof}

In what follows we work on a local neighborhood $U\subset M$ where everything above holds and we let $\Omega^{\smbullet}_\Delta$ denote the subalgebra of $\Omega^{\smbullet}(U)$ spanned by wedge products of (local) sections of $\Delta<\T^\ast U$ with each other. The following theorem characterizes the retracting space in a way that explains its name.

\begin{thm}[Retraction Theorem {{\cite[Prop.~7.1.18]{Ivey}},{\cite[Thm.~I.1.3]{Bryant}}}]
    The retracting space $\calC(\calI)<\T^\ast M$ is the smallest Frobenius system such that $\Omega^{\smbullet}_{\calC(\calI)}$ contains a set of algebraic generators of $\calI$.
\end{thm}
\begin{proof}
    Let $D<\T^\ast M$ be a Frobenius system such that there exist a finite collection of forms $\psi_1,\ldots,\psi_k\in \Omega^{\smbullet}_D$ which generate $\calI$ algebraically. Then any $\xi\in \calI$ can be written as
    \[\xi=\sum_{i=1}^k \beta_i\wedge \psi_i.\]
    Let $X$ be a vector field annihilated by $D$. Then $i_X \xi=\sum_i (i_X \beta_i)\wedge\psi_i$, which belongs to $\calI$. Hence $X\in\Gamma^\infty(\calA(\calI))$. Since $X$ and $\xi$ are arbitrary, we conclude that $\calC(\calI)\subset D$.

    Furthermore, the smallest such $D$ cannot be larger than $\calC(\calI)$. For, suppose $\calC(\calI)$ has co-rank $l>0$ within $D$, and let $\pi_1,\ldots,\pi_l$ be linearly independent $D$-valued forms with $\pi_i\notin \calC(\calI)$. Partition the generators for $\calI$ into $\varphi_1,\ldots,\varphi_k\in \Omega^{\smbullet}_{\calC(\calI)}$, plus generators $\psi_1,\ldots,\psi_n$ involving the $\pi_i$. If $X$ is any vector in $\calA(\calI)$, and $\psi_1$ has the lowest degree among the $\psi$, then $i_X\psi_1$ must be expressible in terms of the $\varphi_i$. In particular, any term in $\psi_1$ involving one of the $\pi_i$ may be omitted since that term already is generated by the $\varphi_j$. It follows that we may take all generators to be in $\Omega^{\smbullet}_{\calC(\calI)}$.
\end{proof}

This means that we can calculate the retracting space by finding a minimal set of algebraic generators for the ideal. This theorem has many applications involving finding normal forms of various classes of differential forms, see \cite[\S I.1]{Bryant} for examples.

\begin{xca}
    Consider an \gls{eds} generated by a single $\theta\in\Omega^1(M)$. Show that the rank of $\calC(\calI)$ is $2k+1$, where $k$ is the \emph{Pfaff rank}, i.e., the highest integer such that $\theta\wedge (\dd\theta)^k$ is not identically zero.\index{Pfaff rank}
\end{xca}


\begin{example}[First-order PDEs, method of characteristics]\index{Method of characteristics}
    Let $x^1,\ldots,x^n,u,p_1,\ldots,p_n$ be the usual coordinates on $\rmJ^1(\bbR^n,\bbR)$, and consider the PDE 
    \[F(\bf{x},u,\bf{p})=0.\label{eq 7.4 Ivey}\]
    Let $M\subset  \rmJ^1$ be the subset defined by this equation. To ensure that $M$ is a smooth manifold, and the equation is genuinely of first order, assume that $\partial_{p_i}F\neq 0$ for some $i$ at each point of $M$.

    Let $\theta$ be the pullback to $M$ of the contact form $\dd u-p_1\dd x^1-\cdots-p_n\dd x^n$. The solutions of the PDE are in 1-to-1 correspondence with integral $n$-manifolds $N\subset M$ of the Pfaffian system generated by $\theta$ with the independence condition $\dd x^1\wedge \cdots\wedge\dd x^n\neq 0$.

    Because $\dim M=2n$, $\theta\wedge (\dd\theta)^n=0$. Differentiating (\ref{eq 7.4 Ivey}) gives 
    \[0=\dd F=F_{x^i}\dd x^i+F_{p_j}\dd p_j+F_u\dd u\equiv (F_{x^i}+F_up_i)\dd x^i+F_{p_j}\dd p_j\mod\theta.\]
    It follows that $\theta\wedge (\dd\theta)^{n-1}\neq 0$ at each point (see the exercise below). By the Pfaff normal form, cf.\ Theorem~\ref{thm pfaff normal form}, there are local coordinates on $M$ such that $\theta$ is a nonzero multiple of 
    \[\dd y^1+y^2\dd y^3+\cdots +y^{2n-2}\dd y^{2n-1}.\label{eq 7.5 Ivey}\]
    Thus, $X=\partial_{y^{2n}}$ gives a Cauchy characteristic. In coordinate-free language, it can be described as the unique vector field, up to multiple, such that $i_X(\theta\wedge(\dd\theta)^{n-1})=0$. It is an exercise to check that the integral curves of $X$ are the integral curves of the differential system 
    \[\frac{\dd x^i}{F_{p_i}}=-\frac{\dd p_i}{F_{x^i}+F_u p_i}=\frac{\dd u}{\sum_i p_i F_{p_i}},\label{eq 14 Bryant}\]
    where the subscripts on $F$ indicate partial derivatives.

    This fundamental fact, that first-order PDEs have one-dimensional Cauchy characteristics, $\rank \calA(\calI)=1$, allows us to reduce the PDE to an ODE. We do this by choosing an integral $(n-1)$-manifold $L$ of $\calI$ (corresponding to some initial data), and then using the flow of $X$ to get an integral $n$-manifold. If $F$ may be solved for $p_n$, then $X$ is transverse to the hyperplanes $x^n=\const$. Thus, we obtain a starting manifold $L$ by letting $x^n=C$, $u=f(x^1,\ldots,x^{n-1})$ for an arbitrary function, and $p_i=\partial_{x^i}f$. To obtain a solution to the original PDE we only need to integrate the ODE system defining the flow of $X$.
\end{example}

\begin{xca}
    Relation~\ref{eq 7.5 Ivey} lets us locally solve for one of the $\dd p_i$ in terms of the others, $\dd x^j$, and $\theta$. Using this, compute $\dd\theta\mod \theta$ on $M$ of dimension $2n$ and conclude that $\theta\wedge(\dd\theta)^{n-1}\neq 0$.
\end{xca}


As a final example, we apply the Cauchy characteristics to prove the following important theorem.

\begin{thm}[{{\cite[Thm.~II.2.4]{Bryant}}}]
    On the Euclidean space $\bbE^n=\SE_n\slash \Or_n$ with the standard Euclidean norm $\lVert\cdot\rVert$, consider the eikonal equation \index{Equation!Eikonal}
    \[\sum_i \left(\frac{\partial u}{\partial x^i}\right)^2=1.\]
    If $u(x^1,\ldots,x^n)$ is a solution valid for all $\bf{x}\in \bbE^n$, then $u$ is a linear function, i.e.,
    \[u=\sum_i a_i x^i+b,\]
    where $\bf{a}$ and $b$ are constants satisfying $\lVert a\rVert=1$.
\end{thm}
\begin{proof}
    We will denote by $M$ the space of $(\bf{x},u)$ and identify $\bbE^n$ with the hyperplane $u=0$. The solution can be interpreted as the graph $\Gamma < M$ of a section $\bbE^n\to M$. For the eikonal equation the denominators in the middle of (\ref{eq 14 Bryant}) are zero, so the Cauchy characteristics satisfy 
    \[p_i=\const.\]
    The equations (\ref{eq 14 Bryant}) can be integrated and the Cauchy characteristic curves, when projected to $M$, are the straight lines 
    \[x^i=x^i_0+p_i t,\quad u=u_0+t,\label{eq 16 Bryant}\]
    where $x_0^i,p_i,u_0$ are constants. The graph $\Gamma$ must have the property that it is generated by these ``Cauchy lines'', whose projections to $\bbE^n$ form a foliation of $\bbE^n$.

    Changing the notation, we write the characteristic lines (\ref{eq 16 Bryant}) as 
    \[x^{\ast i}=x^i+\frac{\partial u}{\partial x^i}t,\]
    where $u(\bf{x})$ is a solution of the eikonal equation. For a given $t\in\bbR$  this can be interpreted as a diffeomorphism $f_t:\bbE^n\to \bbE^n$ defined by 
    \[f_t(\bf{x})=\bf{x}^\ast=(x^{\ast 1},\ldots,x^{\ast n}),\quad \bf{x},\bf{x}^\ast\in\bbE^n.\]
    Geometrically it maps $\bf{x}\in\bbE^n$ to the point $\bf{x}^\ast$ at a distance $t$ along the Cauchy line through $\bf{x}$; this makes sense because the Cauchy lines are oriented. Its Jacobian determinant is 
    \[\calJ(t)=\det\left(\delta^i_j+\frac{\partial^2 u}{\partial x^i\partial x^j}t\right)\]
    and is never zero. But this implies $\partial_{x^i}\partial_{x^j}u=0$, and hence that $u$ is linear. Indeed, if this were not true, the matrix $\partial_{x^i}\partial_{x^j}u$ would have a real nonzero eigenvalue $\lambda$, and then $\calJ(-1/\lambda)=0$, a contradiction.
\end{proof}

\begin{rem}
    Note that the above theorem is a global result. For example, the function $u(\bf{x})=\lVert\bf{x}\rVert$ (Euclidean norm) satisfies the eikonal equation except at $\bf{x}=0$. Thus, the hypothesis that the equation holds on all of $\bbE^n$ is crucial.
\end{rem}












\section{Integral elements}


In \S\ref{sec: frobenius ii} we saw that differentiating the forms that generate an \gls{eds} often reveals additional \emph{compatibility conditions} that integral manifolds must satisfy. These conditions are consequences of the fact that mixed partials must commute. What we did not see was a way of telling when one has differentiated enough to find all hidden conditions. In the case of Pfaffian systems, the Frobenius Theorem stated that if the system passes a first-order test, then there are no extra conditions. The general method emerging from this theory is called \emph{Cartan's test}.

Recall from \S\ref{sec: frobenius ii} that an integral manifold (or simply \emph{a solution}) of an EDS $\calI\subset\Omega^{\smbullet }(M)$ with independence condition $\omega\in\Omega^n(M)$ is an immersed $n$-manifold  $i:N\to M$ such that $i^\ast\alpha=0$ for all $\alpha\in \calI$ and $i^\ast \omega\neq 0$ everywhere. The ideal $\calI$ splits into a direct sum 
\[\calI=\calI^1\oplus\cdots\oplus \calI^{\dim M},\quad \calI^p\coloneqq \calI\cap \Omega^p(M),\]
of forms of different degrees. We can also perform \emph{pullbacks} of \glspl{eds} along smooth maps in the obvious way by pulling back all forms. Finally, we say that $\calI$ is \emph{locally generated} by forms with some property if every point has an open neighborhood such that the pullback of $\calI$ to that neighborhood is generated by forms with that property.

We now define ``infinitesimal solutions''. An important concept here will be that of the Grassmann bundle $\Gr_p(E)$ of a \gls{vb} $E\to M$ defined in Example~\ref{ex associated bundles}. The most important case is the tangent Grassmann bundle of a manifold, $\Gr_p(\T M)$.\index{Grassmann bundle!of a manifold}

Consider $E\in\Gr_n(\T_m M)$ and let $\dim M=n+s$. We can choose linear coordinates $(\bf{x},\bf{y})=(x^1,\ldots,x^n;u^1,\ldots,u^s)$ on $\T_m M$ so that the $x^i$ restrict to $E$ to be linear independent. Let $\Gr_n(\T_m M,\bf{x})\subset \Gr_n(\T_m M)$ be the set of points $\wt E\in\Gr_n(\T M)$ on which $\{x^i\}$ are linearly independent. Then there are unique numbers $p_i^a(\wt E)$ so that the defining equations of $\wt E$ are 
\[u^a=p^a_i(\wt E)x^i,\quad a=1,\ldots,s.\label{eq 18014}\]
The manifold structure of $\Gr_n(\T_m M)$  guarantees that the maps $(p^a_i):\Gr_n(\T_m M)\to \bbR^{ns}$ are smooth coordinate charts. 

Now we will allow $m$ to vary as well, so it is clear that $\Gr_n(\T M)$ has dimension $n+s+ns$. Let $(\bf{x},\bf{y}):U\to \bbR^{n+s}$ be a coordinate chart on $M$. Let $\Gr_n(\T U,\bf{x})\subset \Gr_n(\T M)$ denote the set of $n$-planes to which the differentials $\dd x^i$ restrict to be independent. Then each $E\in\Gr_n(\T U,\bf{x})$ satisfies a set of linear relations of the form 
\[\dd u^a=p^a_i(E)\dd x^i,\quad a=1,\ldots,s\]
for some unique smooth functions $p_i^a(E)$. Let $\bf{p}=(p^a_i):\Gr_n(\T U,\bf{x})\to \bbR^{ns}$. Then the map 
\[(\bf{x},\bf{u},\bf{p}):\Gr_n(\T U,\bf{x})\to \bbR^n\times\bbR^s\times\bbR^{ns}\]
embeds $\Gr_n(\T U,\bf{x})$ as an open subset of $\bbR^{n+s+ns}$. The coordinate chart $(\Gr_n(\T U,\bf{x}),(\bf{x},\bf{y},\bf{p}))$ is called the \emph{canonical extension} of $(U,(\bf{x},\bf{y}))$.

Any diffeomorphism $F:M\to M'$ naturally induces a diffeomorphism $F^{(1)}:\Gr_n(\T M)\to \Gr_n(\T M')$ defined by 
\[F^{(1)}(E)=F_\ast(E)\subset \T_{F(\pi(E))}M',\]
where $\pi:\Gr_n(\T M)\to M$ is the Grassmann bundle projection. 

Now $\Gr_n(\T M)$ comes endowed with a canonical \gls{eds} $\calC$ called the \emph{canonical system}. Abstractly, it is defined as follows: 

\begin{defn}[Canonical contact system]\index{Contact system}
    If $M$ is a manifold, there is a canonical rank $(n+ns)$ distribution $C< \T \Gr_n(\T M)$ defined by 
    \[C_E=\pi_\ast^{-1}(E)\subset \T_E\Gr_n(\T M).\]
    Then $\calC\subset\Omega^{\smbullet}(\Gr_n(\T M))$ is the ideal generated by the set of $1$-forms on $\Gr_n(\T M)$ that vanish on $C$. From the canonical nature by definition, it is clear that for any diffeomorphism $F:M\to M'$, the corresponding lift $F^{(1)}$ will identify the two contact systems.
\end{defn}

Why is $\calC$ called a ``contact'' system? Consider an immersion $i:N\to M$ where $N$ has dimension $n$. This has a canonical ``tangential'' lift $i^{(1)}:N\to \Gr_n(\T M)$ defined by 
\[i^{(1)}(p)=i_\ast(\T_p N)\subset \T_{i(p)}M,\quad p\in N.\]
Almost by construction, $i_\ast^{(1)}(\T_p N)\subset C_{i^{(1)}(p)}$, so that $(N,i^{(1)})$ is an integral manifold of $\calC$. Conversely, if $(N,i)$ is an integral manifold of $\calC$ that is transversal to the Grassmann fibration $\pi:\Gr_n(\T M)\to M$, i.e., $\pi\circ i$ is an immersion, then $i=(\pi\circ i)^{(1)}$.

\begin{xca}
    Prove the last statement.
\end{xca}

Thus, the contact system $\calC$ essentially distinguishes the tangential lifts of immersions of $n$-manifolds into $M$ from arbitrary immersions of $n$-manifolds into $\Gr_n(\T M)$. As for the adjective ``contact'', it comes from the interpretation that two different immersions $i,j:N\to M$ will satisfy $i^{(1)}(p)=j^{(1)}(p)$ iff $i(p)=j(p)$ and the two image submanifolds share the same tangent $n$-plane at $p$. Intuitively, the two image submanifolds $i(N), j(N)$ have ``first order contact'' at $p$.

\begin{xca}
    Show that, in canonically extended coordinates $(\bf{x},\bf{u},\bf{p})$ on $\Gr_n(\T M,\bf{x})$, 
    \[\calC_{\Gr_n(\T M,\bf{x})}=\<\dd u^a-p^a_i\dd x^i,a=1,\ldots,s\>,\]
    i.e., $\calC$ is locally generated by the \emph{contact forms} $\theta^a=\dd u^a-p^a_i\dd x^i$, $a=1,\ldots,s$, in any canonically extended coordinate system.
\end{xca}

As a consequence, the integral manifolds of $\calC$ in $\Gr_n(\T M,\bf{x})$ to which $\bf{x}$ restricts to be a coordinate system are described by equations of the form 
\[u^a=f^a(x^1,\ldots,x^n),\quad p^a_i=\partial_{x^i}f^a(x^1,\ldots,x^n)\]
for some smooth functions $f^a$ on an appropriate domain in $\bbR^n$.

Once the construction of the contact system $(\Gr_n(\T M),\calC)$ is in place, it can be used to construct other canonical systems and manifolds. For example, if $\dim M=n$ and $\dim U=s$, we can let $\rmJ^1(M,U)\subset\Gr_n(\T (M\times U))$ denote the open (dense) set of the $n$-planes $E\subset\T_{(m,u)}M\times U$ that are transversal to the subspace $0\oplus \T_u U\subset\T_{(m,u)}(M\times U)$. The graph $(\id,f):M\to M\times U$ of any smooth map $f:M\to U$ then has the property that $\rmj^1 f=(\id,f)^{(1)}$ lifts $M$ into $\rmJ^1(M,U)$. In fact, two maps $f,g:M\to U$ satisfy $\rmj^1 f(m)=\rmj^1 g(m)$ iff $f,g$ have the same $1$-jet at $m$. Thus, $\rmJ^1(M,U)$ is canonically identified with the space of $1$-jets of maps $M\to U$, justifying the notation. The contact system then restricts to $\rmJ^1(M,U)$ to be the usual contact system defined in the theory of jets, cf.\ Remark~\ref{rem canonical contact system}.

If $X$ is a manifold (typically some $\bbR^N$) with its canonical contact system $(\Gr_n(\T X),\calC)$ and one chooses a submanifold $M<\Gr_n(\T X)$ and lets $\calI$ be the differential ideal on $M$ generated by the pullbacks to $M$ of elements of $\calC$, then the integral manifolds of $(M,\calI)$ can be thought of as representing the $n$-dimensional submanifolds of $X$ whose tangent spaces lie in $M$. In other words, $M$ can be thought of as a system of first-order PDEs for submanifolds of $X$. 
 
\begin{defn}[Integral element]\label{def integral element}
    We say that $E\in \Gr_p(\T_m M)$ is an integral element of an \gls{eds} $\calI$ on $M$ if $\restr{\theta}{E}=0$ for all $\theta\in\calI$. We let $\calV(\calI)_m$ denote the set of all integral elements of $\calI$ at $m\in M$. The set of $p$-dimensional integral elements is denoted $\calV^p(\calI)_m=\calV(\calI)_m\cap \Gr_p(\T_m M)$. By varying $m$ we also have $\calV^p(\calI)\subset \Gr_p(\T M)$. $E$ is called \emph{maximal} if it is not contained in any larger integral elements.
\end{defn}

Obviously,  $p$-dimensional integral elements are completely defined by the vanishing of elements of $\calI^p$ only (because any lower degree form that doesn't vanish on $E$ would algebraically generate similar $p$-forms). It follows that $\calV^p(\calI)_m\cap \Gr_p (\T_m M)$ is an algebraic subvariety of $\Gr_p(\T_m M)$. Much of the Cartan-K\"ahler method will be devoted to understanding the structure of this variety by induction on $p$.

Integral elements are the potential tangent spaces to integral manifolds, in the sense that the integral manifolds of an \gls{eds} are the immersed submanifolds $N\subset M$ such that $\T_mN$ is an integral element for all $m\in N$. Our ultimate goal is to answer the question: when is a given integral element tangent to an integral manifold, and ``in how many ways''? As the following example shows, not every integral element is tangent to any integral manifolds at all.

\begin{example}[Non-existence]
    Consider $(M,\calI)=(\bbR,\<x\dd x\>)$. The whole tangent space $\T_0 \bbR$ is clearly a $1$-dimensional integral element of $\calI$, but there can't be any $1$-dimensional integral manifolds of $\calI$.
\end{example}

\begin{xca}\label{xca 3.1 Bryant lec}
    For a more sophisticated example of non-existence, show that on $\bbR^3$ with coordinates $(x,y,z)$ the ideal $\calI_1=\<\dd x\wedge\dd z,\dd y\wedge(\dd z-y\dd x)\>$ has exactly one $2$-dimensional integral element at each point, but that it has no $2$-dimensional integral manifolds. Compare this with the ideal $\calI_2=\<\dd x\wedge\dd z,\dd y\wedge\dd z\>$.
\end{xca}

\begin{example}[{{\cite[Example~1.2]{Bryant}}}]\label{ex 1.2 Bryant}
    Let $M=\bbR^5$ and let $\calI$ be generated by the two $1$-forms $\vartheta^1=\dd x^1+(x^3-x^4x^5)\dd x^4$ and $\vartheta^2=\dd x^2+(x^3+x^4x^5)\dd x^5$. Then $\calI$ os generated algebraically by $\vartheta^1,\vartheta^2,\dd\vartheta^1=\vartheta^3\wedge\dd x^4$ and $\dd\vartheta^2=\vartheta^3\wedge\dd x^5$, where $\vartheta^3\coloneqq \dd x^3+x^5\dd x^4-x^4\dd x^5$. For each $m\in M$, let 
    \[H_m\coloneqq \left\{v\in\T_m \bbR^5\mid \vartheta^1(v)=\vartheta^2(v)=0\right\}\subset \T_m \bbR^5.\]
    Then $H\subset\T\bbR^5$ is a rank $3$ distribution. A $1$-dimensional subspace $E\subset\T_m\bbR^5$ is an integral element of $\calI$ iff $E\subset H_m$. Thus, $\calV^1(\calI)\cong \bbP H$ and it is a smooth $7$-manifold. Now let 
    \[K_m\coloneqq \left\{v\in\T_m \bbR^5\mid \vartheta^1(v)=\vartheta^2(v)=\vartheta^3(v)=0\right\}.\]
    Then $K\subset H$ is a rank $2$ distribution on $\bbR^5$. It is easy to see that for each $m$, $K_m$ is the unique integral plane of $\calI$ at $m$. Thus, $\calV^2(\calI)\cong\bbR^5$. Moreover, $\calI$ has no integral elements of dimension higher than $2$.

    It is not difficult to describe the $1$-dimensional integral manifolds of $\calI$. Let $f(t)=(f^3(t),f^4(t),f^5(t))$ be an arbitrary smooth immersed curve in $\bbR^3$. There exist functions $f^1(t),f^2(t)$ (unique up to a choice of two constants) which satisfy the equations 
    \begin{gather}
        \dot f^1=-(f^3-f^4f^5)\dot f^4,\\
        \dot f^2=-(f^3+f^4f^5)\dot f^5.
    \end{gather}
    Then $F(t)=(f^1(t),f^2(t),f^3(t),f^4(t),f^5(t))$ is an integral manifold of $\calI$. Conversely, every $1$-dimensional integral manifold of $\calI$ is obtained this way. It is now easy to see that there exists an integral $1$-manifold tangent to each element of $\calV^1(\calI)$.

    On the other hand, by our calculation of $\calV^2(\calI)$ above, any integral $2$-manifold (surface) of $\calI$ is an integral manifold of the differential system $\calI_+$ generated by $\vartheta^i$, $i=1,2,3$. Using the fact that $\dd\vartheta^3=-2\dd x^4\wedge\dd x^5$, we see that $\calI_+=\<\vartheta^1,\vartheta^2,\vartheta^3,\dd x^4\wedge\dd x^5\>$. Hence $\calI_+$ has no integral planes, and thus no integral surfaces. Thus, $\calI$ has no integral surfaces either.
\end{example}

The infinitesimal analog of the classical Cauchy problem for extending initial data from an $p$-dimensional manifold to a $p+1$-dimensional one is the extension of a $p$-dimensional integral element $E\subset \T_m M$ to an $(p+1)$-dimensional integral element $E^+\subset \T_m M$. The space of all extensions is a (possibly empty) projective space $\bbP(H(E)\slash E)$ where $H(E)\subset T_m M$ is the \emph{polar space} of $E$, defined below.

\begin{xca}\label{xca 3.3 Bryant lec}
    Describe $\calV^1(\calI)$ and $\calV^2(\calI)$ for 
    \begin{enumerate}
        \item $(M,\calI)=\left(\bbR^4,\<\dd x^1\wedge\dd x^2+\dd x^3\wedge\dd x^4\>\right)$.
        \item $(M,\calI)=\left(\bbR^4,\<\dd x^1\wedge\dd x^2,\dd x^3\wedge\dd x^4\>\right)$.
        \item $(M,\calI)=\left(\bbR^4,\<\dd x^1\wedge\dd x^2+\dd x^3\wedge\dd x^4,\dd x^1\wedge\dd x^2-\dd x^3\wedge\dd x^4\>\right)$.
    \end{enumerate}
\end{xca}

There are some relations among the various $\calV^p(\calI)$. An easy one is that if $E$ belongs to $\calV^n(\calI)$, then every $p$-dimensional subspace of $E$ is also an integral element, i.e., $\Gr_p(E)\subset \calV^p(\calI)$. This follows because $\calI$ is an ideal. The point is that if $E'<E$ were a $p$-dimensional subspace and $\psi\in\calI^p$ did not vanish on $E'$, then there would exist an $(n-p)$-form $\alpha$ such that $\alpha\wedge\psi$ (which belongs to $\calI$ since the latter is an ideal) does not vanish on $E$.

\begin{xca}
    Prove the last statement.
\end{xca}

On the other hand, obviously not every extension of an integral element is an integral element. In fact, from the previous exercise, one can see that the topology of the space of integral elements of a given degree can be surprisingly complicated. However, describing the integral extensions one dimension at a time turns out to be reasonably simple.

\begin{defn}[Polar equations, polar spaces]\index{Polar equations}\index{Polar space}
    Let $E\in\calV(\calI)_m$ be an integral element of an \gls{eds} $\calI$ on $M$ at $m\in M$. The polar equations of $E$ are the linear functions ($1$-forms)
    \[ \theta(\_,e_1,\ldots,e_k): \T_mM\to \bbR,\quad \theta\in\calI^{k+1},\; e_1,\ldots,e_k\in E.\]
    They vanish on a vector $X_m$ just when the span of $E\cup \{X_m\}$ is an integral element. Since the forms of $\calI$ of degrees lower than $p=\dim E$ vanish on $E$, we can safely assume that $k=p$ and $\{e_1,\ldots,e_p\}$ form a basis of $E$. 
    
    The space of polar equations of $E$ is a linear subspace of $\T_m^\ast M$, denoted $\calE_m(E)$. Its annihilator $H_m(E)\coloneqq \Ann(\calE_m(E))<\T_mM$ is called the \emph{polar space},
    \[H_m(E)=\left\{X\in\T_m M\mid \vartheta(X,e_1,\ldots,e_p)=0\text{ for all }\vartheta\in\calI^{p+1}\right\}.\]
\end{defn}

Let $E\in\calV^p(\calI)_m$ and $E^+\in\Gr_{p+1}(\T_m M)$ such that $E<E^+$. The following general properties of polar spaces are easy to verify:
\begin{enumerate}
    \item $E\subset H(E)$.
    \item $E^+\subset H(E)$ iff $E^+\in \calV^{p+1}(\calI)$.
    \item If $X\in H(E)$, then $\restr{(i_X \psi)}{E}=0$ for all $\psi\in\calI$.
    \item If $E^+\in\calV^{p+1}(\calI)$, then $H(E^+)\subset H(E)$: larger integral elements have more polar equations and smaller polar spaces.
    \item If $\{\psi^\alpha\}_\alpha$ is a set of algebraic generators of $\calI$, then $X\in H(E)$ iff $\restr{(i_X\psi^\alpha)}{E}=0$ for all generators $\psi^\alpha$ of degrees $\geq p+1$.
\end{enumerate}

The following proposition explains the usefulness of polar spaces.

\begin{prop}[{{\cite[Prop.~1.6]{Bryant}}}]
    Let $E$ be an integral $p$-plane of $\calI$. Then a $(p+1)$-plane $E^+$ containing $E$ is integral for $\calI$ iff it satisfies $E^+\subset H(E)$.
\end{prop}
\begin{proof}
    Let $e_1,\ldots,e_p$ be a basis for $E$ and $X\in E^+\setminus E$ a complementary vector. $E^+$ is integral iff $\restr{\theta}{E^+}=0$ for all $\theta\in\calI^{p+1}$. By definition, this latter condition holds iff $X\in H(E)$.
\end{proof}

Suppose $E\in\calV^{p-1}(\calI)$. Since every direction in $H(E)\slash E$ corresponds to an extended integral element $E^+$ in which $E$ is a (codimension $1$) hyperplane, one might expect $\dim H(E)$ to be related to the dimensions of $\calV^{p-1}$ at $E$ and of $\calV^p$ at $E^+$. This relationship is made precise in the following lemma. By $\codim_x(X,Y)$ we denote the codimension of $X$ inside $Y$ at point $x\in X$. In the sequel, we will omit $Y$ for brevity.

\begin{lem}[{{\cite[Lem.~8.1.10]{Ivey}}}]\label{lem 8.1.10 Ivey}
    Let $E\in\calV^{p-1}(\calI)_m$ and $E^+\in \calV^p(\calI)_m$ be such that $E<E^+<\T_m M$. Then 
    \[\codim_{E^+}(\calV^p(\calI),\Gr_p(\T M))\geq \codim_E(\calV^{p-1}(\calI),\Gr_{p-1}(\T M))+\codim(H(E),\T_m M).\label{eq codim inequality}\]
\end{lem}
\begin{proof}
    Let $s=\dim M-p$, and take coordinates $(x^1,\ldots,x^p,y^1,\ldots,y^s)$ on $M$ centered at $m$ such that $E^+=\<\partial_{x^1},\ldots,\partial_{x^p}\>$, $\restr{\dd x^p}{E}=0$, and $H(E)$ is annihilated by the forms $\dd y^\alpha$, $1\leq\alpha\leq \codim H(E)$. Then there are linearly independent $p$-forms $\Phi^\alpha$ in $\calI$ such that 
    \[\dd y^\alpha(X)=\Phi^\alpha(X,\partial_{x^1},\ldots,\partial_{x^{p-1}})\text{ for all }X\in\T_m M.\label{eq 8.4 Ivey}\]
    For $\wt{E}^+\in\Gr_p(\T M)$ near $E^+$, define the functions $p^a_i$ by requiring that the vectors 
    \[X_i=\partial_{x^i}+p^a_i\partial_{y^a},\quad 1\leq i\leq p,\]
    form a basis for $\wt{E}^+$ (here we sum over $a=1,\ldots,s$). Similarly, for $\wt E\in\Gr_{p-1}(\T M)$ near $E$, define the functions $q^a_j$ and $u_j$ on $\Gr_{p-1}(\T M)$ by requiring that 
    \[Z_j=\partial_{x^j}+u_j\partial_{x^p}+q^a_j\partial_{y^a},\quad 1\leq j\leq p-1,\]
    span $\wt{E}$. The $p^a_i$ are, in fact, part of the local coordinate system on $\Gr_p(\T M)$, in which $E^+$ is the origin, that we defined before. Similarly, the $q^a_j$ and $u_k$ also complete a local coordinate system on $\Gr_{p-1}(\T M)$ near $E$, in which $E$ is the origin.

    By definition of the codimension, there are forms $\phi^\nu\in\calI^{p-1}$, $\nu=1,\ldots,\codim_E\calV^{p-1}$, such that the functions 
    \[F^\nu=\phi^\nu(Z_1,\ldots,Z_{p-1})\]
    have linearly independent differentials at $E$. Now let 
    \begin{align}
        G^\nu\coloneqq &\phi^\nu\wedge\dd x^p(X_1,\ldots,X_p),\\
        H^\alpha\coloneqq &\Phi^\alpha(X_1,\ldots,X_p).
    \end{align}
    Certainly, $\calV^p(\calI)$ must lie inside the common zero locus of the $\codim_E\calV^{p-1}+\codim H(E)$ functions $\{G^\nu,H^\alpha\}$ near $E^+$. We will show that they have linearly independent differentials at $E^+$.

    Note that $F^\nu$ is a polynomial in the $q^a_j$ and $u^j$ with coefficients depending on $\{x^i,y^a\}$, and $G^\nu$ is a polynomial in the $p^a_i$. In fact $G^\nu(p^a_i)=F^\nu(p^a_j,0)$, i.e., $G^\nu$ is obtained from $F^\nu$ by setting $q^a_j=p^a_j$ and $u_j=0$. (In particular, $G^\nu$ doesn't involve the $p^a_p$.) Furthermore, since any other codimension one subspace of $E^+$ is also in $\calV^{p-1}(\calI)$, $\restr{\dd F^\nu}{E}(\partial_{u^j})=0$. It follows that the $G^\nu$ have $\codim_E \calV^{p-1}(\calI)$ linearly independent differentials at $E^+$.

    Let $\Psi^\alpha=\Phi^\alpha-\dd y^\alpha\wedge\dd x^1\wedge\cdots\wedge\dd x^{p-1}$. Then (\ref{eq 8.4 Ivey}) shows that $\Psi^\alpha$ is a sum of terms that either vanish at $m$, or are wedge products of degree at least $2$ in $\{\dd x^p,\dd y^1,\ldots,\dd y^s\}$. Thus, $\Psi^\alpha(X_1,\ldots,X_p)$ will be a polynomial in the $p^a_i$ consisting of terms that either vanish at $p$, or are of degree two in the $p^a_i$, or, when they are of degree one, do not involve the $p^a_p$. It follows that 
    \[\restr{\dd H^\alpha}{E^+}\equiv \dd p^\alpha_p \pmod{\dd p^a_j,j<p}.\]
    Thus, $G^\nu$ and $H^\alpha$ have linearly independent differentials at $E^+$.
\end{proof}

% \begin{rem}[Overview of Cartan's method]
%     We will call points of a manifold that have some property \emph{generic} if the set on which the property fails is closed and nowhere dense. We will also call submanifolds with a property generic if the property holds for all submanifolds whose tangent spaces avoid some closed, nowhere dense subset of the Grassmann bundle.

%     Cartan's strategy for describing the integral manifolds of a general \gls{eds} is inductive: pick a point, find an integral curve through that point, then an integral surface through that curve, and so on up to some requested dimension. This process fails unless the current integral submanifold is \emph{extendable}. At every step, we will not try to find all integral submanifolds, but only generic ones, i.e., we will only analyze \emph{whether the generic integral curve, surface, etc., is extendable}.

%     The definitions below will formalize the following intuitive concepts. An integral element is called \emph{regular} if its polar equations have locally maximal rank. This is the same as locally constant rank since linearly independent polar equations remain linearly independent under small perturbations. Next, an integral element is called \emph{ordinary} if it contains a regular hyperplane. Regularity and ordinarity are difficult to test directly, so we will prove \emph{Cartan's Test}: an integral element is involutive iff it is ordinary. As a consequence, in each component of the space of integral elements, either none are involutive, or the generic one is involutive.

%     Thus, we should start with finding a regular $0$-dimensional element $E^0$, then look for a regular $1$-dimensional element $E^1$ which contains $E^0$. Then we look for a regular $2$-dimensional element $E^2$ that contains $E^2$, and so on. When we reach a point where no regular $E^p$ exists that contains $E^{p-1}$, Cartan's Test will tell us that there exists a local integral $p$-dimensional manifold tangent to any $E^p$ and $p$ is the highest dimension of such integral manifold. In practice, the dimension $p$ is usually fixed beforehand, so we only need to find a regular $E^{p-1}$.
% \end{rem}


% \begin{xca}
%     Assuming everything in the remark above, prove that an integral plane $E^2$ is ordinary iff for any integral line $E^1<E^2$, any other integral line sufficiently close to $E^1$ is also contained in an integral plane.
% \end{xca}


Now, $\calV^n(\calI)$ is a closed subset of $\Gr_n(\T M)$. To see why, let's see how the elements of $\calI$ can be used to get defining equations for $\calV^n(\calI)$ in local coordinates. Let $(\bf{x},\bf{u}):U\to\bbR^{n+s}$ be any local coordinate chart with the canonical extension $(\bf{x},\bf{u},\bf{p})$. Each $E\in\Gr_n(\T M,\bf{x})$ has a well-defined basis $(X_1(E),\ldots,X_n(E))$ where 
\[X_i(E)=\partial_{x^i}+p^a_i(E)\partial_{u^a}.\]
(This is the basis of $E$ that is dual to the basis $\dd x^1,\ldots,\dd x^n$ of $E^\ast$.) Using this basis, we can define a function $\psi_{\bf{x}}$ on $\Gr_n(\T M,\bf{x})$ associated to any $n$-form $\psi$ by the rule 
\[\psi_{\bf{x}}(E)=\psi(X_1(E),\ldots,X_n(E)).\]
It's not hard to see that $\psi_{\bf{x}}$ will be smooth as long as $\psi$ is smooth. Even more concretely, each $\psi\in\calI^n$ locally has the form 
\[\psi=\sum_{I,J}f_{IJ}(\bf{x},\bf{u})\dd \bf{u}^I\wedge \dd \bf{x}^J,\]
where $I$ and $J$ are multi-indices with components in increasing order, such that $|I|+|J|=n$, and $f_{IJ}$ are smooth functions. If $E\in\calV^n(\calI)$, then, by (\ref{eq 18014}), 
\[\restr{\psi}{\wt E}=\restr{\psi_{\bf x} \dd x^1\wedge\cdots \wedge\dd x^n}{\wt E},\] 
where $\psi_{\bf x}$ is a function polynomial in the $p^a_i$:
\[\restr{\psi}{\wt E}=\sum_{I,J,L}f_{IJ}(\bf{x},\bf{u})p^{i_1}_{l_1}\cdots p^{i_k}_{l_k}\dd \bf{x}^L\wedge \dd \bf{x}^J,\]
and $I=(i_1<\cdots<i_k)$, $L=(l_1<\cdots<l_k)$. Thus, $\calV^n(\calI)$ is locally defined by equations that are polynomial in the $p^a_i$, with coefficients that are local smooth functions on $M$. 

Note the similarity between $\psi_{\bf{x}}$ and the symbol of a differential operator, where $p^a_i$ are analogous to the coordinates on the cotangent spaces. Just like in the Cauchy-Kovalevskaya case, we will reduce the problem to the analysis of a system of algebraic equations.

With this notation, $\calV^n(\calI)\cap \Gr_n(\T M,\bf{x})$ is seen to be the common zero locus of the set of functions $\{\psi_{\bf{x}}\mid \psi\in \calI^n\}$. Thus, $\calV^n(\calI)\cap \Gr_n(\T M,\bf{x})$ is closed. It follows that $\calV^n(\calI)$ is a closed subset of $\Gr_n(\T M)$, as desired.






\section{Regularity of integral elements}

So far, we only have that $\calV^n(\calI)$ is a closed subset of $\Gr_n(\T M)$. We would like to find conditions under which it becomes a smooth submanifold, at least locally.

\begin{defn}[Ordinary zero]\index{Ordinary zero}
    Let $S\subset C^\infty(M)$ be a collection of smooth functions on a manifold $M$. Let the common zero locus be 
    \[Z_S\coloneqq \{m\in M\mid f(m)=0\text{ for all }f\in S\}.\]
    This is a closed set but not always a submanifold, which prompts the following. A point $z\in Z_S$ is called an ordinary zero of $S$ if there is an open $z$-neighborhood $U\subset M$ such that either $U$ is contained in $Z_S$ or else there is a finite set of functions $f_1,\ldots,f_c\in S$ so that $\dd f_1\wedge\cdots\wedge\dd f_c\neq 0$ on $U$\footnote{This means that the differentials $\dd f_i$ are linearly independent, which allows us to treat the $f_i$ as the complementary coordinate functions such that $(\bf{x},\bf{f})$ become slice coordinates.} while $Z_S\cap U=\{y\in U\mid f_1(y)=\cdots =f_c(y)=0\}$. Then by the \gls{immt}, $Z_S\cap U$ is an embedded submanifold of $U$ of codimension $c$. We denote by $Z^{\mathrm{o}}_S\subset Z_S$ the set of ordinary zeros of $S$.
\end{defn}

\begin{xca}
    Show that $Z_S$ and $Z_S^{\mathrm{o}}$ depend only on the ideal generated by $S$ in $C^\infty(M)$. Also show that for $z\in Z_S^{\mathrm{o}}$, the integer $c$ described above is well-defined, so that one can speak without ambiguity of the codimension of $Z_S^{\mathrm{o}}$ at $z$.
\end{xca}

This idea can now be applied to $\calV^n(\calI)$. We call $E\in\calV^n(\calI)$ a \emph{K\"ahler-ordinary} integral element if it is an ordinary zero of the set 
\[\calS_{\bf{x}}=\{\psi_{\bf{x}}\mid \psi\in\calI^n\}\]
for some local coordinate chart $(\bf{x},\bf{u}):U\to \bbR^{n+s}$ with $E\in\Gr_n(\T M,\bf{x})$.

From now on, we will always assume that $\calI$ contains no $0$-forms, otherwise we can immediately restrict to the submanifold $\calVo^0(\calI)$ of ordinary zeros of $\calI^0$. Recall that $\calV^n(\calI)_m\subset \Gr_n(\T_m M)$ denotes the space of $n$-dimensional integral elements in $\T_m M$ and $\calV^n(\calI)\subset \Gr_n(\T M)$ the space of all $n$-dimensional integral elements. 

\begin{xca}
    Explain why any integral element based at a point in $\calVo^0(\calI)$ must be tangent to $\calVo^0(\calI)$.
\end{xca}

To show existence of integral manifolds with tangent space $E$ at $m\in M$, we will need to study integral elements near $E$. We will generally restrict to integral elements that are ``smooth points'' of $\calV^n(\calI)$ in the following sense. The idea is that the differentials $\dd F_\psi$ should hopefully span the complement of $E^\ast$ in the cotangent space of $\calV^n(\calI)$ at $E$.

Now let us put this criterion for smoothness in coordinate-free terms. For $\omega\in\Omega^n(M)$, let $\Gr_n(\T M,\omega)$ be the open set consisting of those $E$ for which $\restr{\omega}{E}$ is non-vanishing (making it the analog of $\dd x^1\wedge\cdots \wedge\dd x^n$ above). If $\psi\in\Omega^n(M)$, we can define the function $\psi_\omega$ (the analog of $\psi_{\bf{x}}$) by $\restr{\psi}{E}=\psi_\omega(E)\restr{\omega}{E}$ for all $E\in\Gr_n(\T M,\omega)$. Then the set $\calV(\calI,\sfv)=\calV^n(\calI)\cap \Gr_n(\T M,\omega)$ is the common zero locus of the set of functions 
\[\calF_\omega(\calI)=\left\{\theta_\omega\mid \theta\in\calI^n\right\}.\]

\begin{defn}[K\"ahler-ordinary integral element]\index{K\"ahler-ordinary element}
    An integral element $E\in\calV^n(\calI)$ is called K\"ahler-ordinary if there exists a $n$-form $\omega\in\Omega^n(M)$ with $\restr{\omega}{E}\neq 0$ with the property that $E$ is an ordinary zero of the set of functions $\calF_\omega(\calI)$. This holds iff $\calV^n(\calI)$ is locally a smooth submanifold of $\Gr_n (\T M)$ near $E$. The subspace of K\"ahler-ordinary points is denoted $\calVo^n(\calI)\subset\calV^n(\calI)$.
\end{defn}

The choice of $\omega$ in this definition is not important. For any other $n$-form $\omega'$, the function $\omega'_{\omega}$ never vanishes on $\Gr_n(\T M,\omega)\cap\Gr_n(\T M,\omega')$, so $E$ is an ordinary zero of $\calF_\omega(\calI)$ iff it is an ordinary zero of $\calF_{\omega'}(\calI)$. Note that $\calVo^n(\calI)$ is an embedded submanifold of $\Gr_n(\T M)$ and is an open subset of $\calV^n(\calI)$. Before moving on, we demonstrate a few examples of smooth and non-smooth integral elements.

%%%%%%%%%%%%%%%%%%%%%

\begin{example}[Linear Pfaffian systems]
    Suppose linearly independent $1$-forms $\theta^a$, $1\leq a\leq s$, generate a Pfaffian system on $M$ with independence condition $\omega^1\wedge\cdots\wedge\omega^p\neq 0$, and satisfy the structure equations 
    \[\dd\theta^a\equiv \pi^a_i\wedge\omega^i\pmod{\theta^1,\ldots,\theta^s}.\]
    Complete $\{\theta^a,\omega^i\}$ to a coframe by adding some $1$-forms $\pi^\lambda$, $1\leq\lambda\leq r$. Then $\pi^a_i=A^a_{i\lambda}\pi^\lambda+C^a_{ij}\omega^j$ for some functions $A^a_{i\lambda}$, $C^a_{ij}$ on $M$.

    On any $p$-plane $E$ satisfying the independence condition, we have $\pi^\lambda=p^\lambda_i\omega^i$ (as above, the $p^\lambda_i$ form part of a local coordinate system on $\Gr_p(\T M)$). If $E$ is an integral element, then the $\theta^a$ must vanish on $E$, and the vanishing of $\dd\theta^a$ reduces to
    \[A^a_{i\lambda}p^\lambda_j-A^a_{j\lambda}p^\lambda_i+C^a_{ij}-C^a_{ji}=0.\label{eq 8.1 Ivey}\]
    Since these equations are linear in the $p^\lambda_i$, $\calV^p(\calI)$ is a smooth submanifold wherever the rank of the linear algebraic system (\ref{eq 8.1 Ivey}) is locally constant. Hence, if one point in $\calV^p$ is smooth, so are all the other points in the same fiber.
\end{example}


Non-smooth points of $\calV^p$ can occur in the fibers over points of $M$ where the generators of $\calI$ vanish or become linearly dependent. However, this is not the only way in which singular points arise, as the following example and exercise show.

\begin{example}
    On $M=\bbR^2$, let $\theta=y^2\dd x-x\dd y$ and let $\calI=\<\theta\>_{\mathrm{diff}}$. Over every point of $M$ except the origin, the fiber of $\calV^1(M)$ is a single point, and $\calV^1$ is smooth. Since $\theta$ vanishes at the origin, the fiber there is $\Gr_1(\bbR^2)=\RP^1\cong \bbS^1$. We can introduce a local fiber coordinate on $\Gr_1(\T M)$ such that $\restr{\dd y-p\dd x}{E}=0$. Then $\calV^1$ is defined by $y^2-xp=0$, and the integral $1$-plane with $p=0$ at the origin is a singular point of $\calV^1$. Although $\calV^1$ is smooth at all the other points in the fiber above the origin, only the directions along the coordinate axes of $\bbR^2$ are tangent to integral curves of $\calI$.
\end{example}

\begin{xca}[A degenerate $1$-form]
    On $M=\bbR^n$, let $\omega^1,\omega^2\in\Omega^1(M)$ be pointwise independent and let $\calI=\<\omega^1\wedge\omega^2\>_{\mathrm{alg}}$. Complete $\omega^1,\omega^2$ to a coframe $\{\omega^i\}_{i=1}^n$ with dual frame $\{e_i\}_{i=1}^n$. Fix a basepoint $m$ and show that $e_3\wedge e_4$ is a singular point of $\calV^2(\calI)_m$. Determine all singular points.
\end{xca}

\begin{rem}[Degenerate forms]
    More generally, we say that a form $\phi\in\Omega^k(M)$, $k\geq 2$, is \emph{degenerate} at $m\in M$ if its annihilator $\Ann(\phi_m)\subset \T_m^ M$ is nonzero. For $\calI=\<\phi\>_{\mathrm{alg}}$, there will be singular points of $\calV^k(\calI)$ in the fiber over every point, consisting of those $E\in\calV^k$ that, as subspaces of $\T_m M$, intersect $\Ann(\phi_m)$ nontransversely.
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%

Having now passed to the manifold of smooth points, $\calVo^p(\calI)$, we would like to find conditions under which the ability to solve an infinitesimal Cauchy problem (extending $E$ to $E^+$) implies the ability to solve the actual Cauchy problem. It turns out the the local constancy of the dimension of the polar space suffices. We formalize this condition in the following definition.

For a fixed $E\in\calV^{p-1}(\calI)$, the space of those $E^+\in\calV^{p}(\calI)$ which contain $E$ is a real projective space which is canonically isomorphic to $\bbP(H(E)\slash E)$. This motivates us to define a function $r:\calV^p(\calI)\to \bbZ$ by 
\[r(E)\coloneqq \dim H(E)-p,\quad E\in\calV^{p-1}(\calI).\]
Note that $r(E)\geq -1$ with equality holding iff $E$ lies in no $p$-dimensional integral element of $\calI$, i.e., $E$ is maximal. When $r(E)\geq 0$, the set of integral $p$-planes containing $E$ is a real projective space of dimension $r(E)$.

The codimension $c(E)\coloneqq \codim H(E)=\dim M-\dim H(E)$ is \emph{lower semicontinuous} on $\calV^n$ for the same reason the rank of a matrix is: if the codimension of $H(E)$ (i.e., the rank of the polar equations) is $k$, then by continuity of the coefficients of the polynomial equations defining rank, there is a neighborhood of $E$ on which the codimension is at least $k$. We will formalize the intuitive idea that if the codimension is locally constant near $E$, then not only $E$ itself, but actual integral manifolds tangent to $E$ can be extended to produce higher-dimensional integral manifolds.

\begin{defn}[K\"ahler-regular integral element]\index{K\"ahler-regular element}
    If $E$ is K\"ahler-ordinary and the function $r$ (or $c$) is locally constant around $E$ in $\calVo^p(\calI)$, then we call $E$ K\"ahler-regular. The set of all K\"ahler-regular elements is denoted $\calVr^p(\calI)\subset\calVo^p(\calI)$.
\end{defn}

 Since $r$ is an \emph{upper semicontinuous} function on $\calVo^n(\calI)$, $\calVr^n(\calI)$ is an open, dense subset of $\calVo^n(\calI)$:
\[\calVr^n(\calI)\mathring{\subset}\calVo^n(\calI)\sub \Gr_n(\T M).\]


\begin{example}
    Look back at system $\calI_1$ from Exercise~\ref{xca 3.1 Bryant lec}. There, $\calV^1(\calI_1)=\Gr_1(\T \bbR^3)$ because $\calI_1^1=\{0\}$. Now a $1$-dimensional integral element $E$ based at $(x,y,z)$ will be spanned by a nonzero vector $v_1=a\partial_x+b\partial_y+c\partial_z$. Using the definition of the polar space, we see that $v=f\partial_x+g\partial_y+h\partial_z$ lies in $H(E)$ iff 
    \[\dd x\wedge\dd z(v,v_1=(\dd y\wedge(\dd z-y\dd x)))(v,v_1)=0,\] 
    i.e., 
    \[cf-ah=-yb-f-(c-ya)g+bh=0.\]
    These two linear equations for $(f,g,h)$ will be linearly independent, forcing $H(E)=E$ and $r(E)=-1$, unless $c-ya=0$, in which case the two equations are linearly dependent and $\dim H(E)=2$, so $r(E)=0$. We see that the generic integral element has the lowest-dimensional polar space.
\end{example}

\begin{example}[\ref{ex 1.2 Bryant} continued]
    We will show that all integral planes of $\calI$ are K\"ahler-regular. Let $\omega=\dd x^4\wedge\dd x^5$. Then every element $E\in\Gr_2(\T \bbR^5,\omega)$ has a unique basis of the form 
    \begin{align}
        X_4(E)&= \partial_{x^4}+p_4^1(E)\partial_{x^1}+p_4^2(E)\partial_{x^2}+p_4^3(E)\partial_{x^3},\\
        X_5(E)&=\partial_{x^5}+p_5^1(E)\partial_{x^1}+p_5^2(E)\partial_{x^2}+p_5^3(E)\partial_{x^3}.
    \end{align}
    The functions $x^1,\ldots,x^5,p_4^1,\ldots,p_5^3$ form a coordinate system on $\Gr_2(\T \bbR^5,\omega)$. Computation gives 
    \begin{align*}
        (\vartheta^1\wedge\dd x^4)_\omega&=-p_5^1,\\
        (\vartheta^1\wedge\dd x^5)_\omega&=p_4^1+(x^3-x^4x^5),\\
        (\vartheta^2\wedge\dd x^4)_\omega&=-p_5^2-(x^3+x^4x^5),\\
        (\vartheta^2\wedge\dd x^5)_\omega&=p_4^2,\\
        (\vartheta^3\wedge\dd x^4)_\omega&=-p_5^3+x^4,\\
        (\vartheta^3\wedge\dd x^5)_\omega&=p_4^3+x^5.
    \end{align*}
    These $6$ functions are clearly independent on $\Gr_2(\T \bbR^5,\omega)$ and their common zeros are exactly $\calV^2(\calI)$. Thus, every point of $\calV^2(\calI)$ is K\"ahler-ordinary. Since none of these elements have any extension to an integral $3$-plane, it follows that $r(E)=-1$ for all $E\in\calV^2(\calI)$. Thus, every element of $\calV^2(\calI)$ is also K\"ahler-regular.

    Similarly, it is easy to see that every $E\in\calV^1(\calI)$ is K\"ahler-ordinary. However, not every element is K\"ahler-regular. To see this, note that any $E\in\calV^1(\calI)$ on which $\vartheta^3$ does not vanish cannot lie in any integral plane of $\calI$. Thus, $r(E)=-1$ for all $E\in\calV(\calI,\vartheta^3)$. On the other hand, each $E\in\calV^1(\calI)$ on which $\vartheta^3$ does vanish lies in a unique $E^+\in\calV^2(\calI)$ and hence has $r(E)=0$. Since $\calV(\calI,\vartheta^3)$ is clearly dense in $\calV^1(\calI)$, it follows that $\calVr^1(\calI)=\calV(\calI,\vartheta^3)$.
\end{example}

\begin{xca}[\ref{ex self-dual equations} continued]\label{xca self-dual equations 2}
    Back to the self-dual equations. Consider $\bf{u}$ as a free coordinate on $\bbR^3$ so that $(\bf{x},x^4,\bf{u})$ are coordinates on $M=\bbR^4\times\bbR^3$. Define the $3$-form 
    \begin{multline}
        \Phi=\dd u^1\wedge (\dd x^2\wedge\dd x^3+\dd x^1\wedge\dd x^4)+\\
        +\dd u^2\wedge(\dd x^3\wedge\dd x^1+\dd x^2\wedge\dd x^4)+\dd u^3\wedge (\dd x^1\wedge\dd x^2+\dd x^3\wedge\dd x^4).
    \end{multline}
    Explain why the $4$-dimensional integral manifolds in $M$ of $\calI=\<\Phi\>$ on which $\dd x^1\wedge\dd x^2\wedge\dd x^3\wedge\dd x^4\neq 0$ can be thought of locally as representing closed self-dual $2$-forms. Describe $\calV^4(\calI)\cap\Gr_4(\T M,(\bf{x},x^4))$. Are these K\"ahler-ordinary or K\"ahler-regular integral elements? What about $\calV^3(\calI)\cap \Gr_3(\T M,\bf{x})$?
\end{xca}


%%%%%%%%%%%%%%%%%%%%%%%%%

We need to understand the following incidence correspondences:
\begin{align}
    \calV^{p-1,p}(\calI)&=\left\{(E,E^+)\in\calV^{p-1}(\calI)\times\calV^{p}(\calI)\mid E<E^+\right\},\\
    \calVr^{p-1,p}(\calI)&=\left\{(E,E^+)\in\calVr^{p-1}(\calI)\times\calV^{p}(\calI)\mid E<E^+\right\}.
\end{align}
We let $\pi_{p-1}:\calV^{p-1,p}(\calI)\to \calV^{p-1}(\calI)$ and $\pi_{p}:\calV^{p-1,p}(\calI)\to \calV^{p}(\calI)$ denote the projections onto the two respective factors. The fibers of these maps are easy to described. If $E\in\calV^{p-1}(\calI)$ has $r(E)\geq 0$, then $\pi_{p-1}^{-1}(E)\cong \bbP(H(E)\slash E)\cong \RP^{r(E)}$. On the other hand, if $E^+\in\calV^{p}(\calI)$, then $\pi_{p}^{-1}(E^+)\cong\bbP(E^+)^\ast$, the space of hyperplanes in $E^+$. It is helpful to keep in mind the diagram 
\[
    \begin{tikzcd}
       & \calV^{p-1,p}(\calI) \arrow[dl,"\pi_{p-1}"]\arrow[dr,"\pi_{p}",swap] & \\
       \calV^{p-1}(\calI) & & \calV^{p}(\calI).
    \end{tikzcd}
\]
This ``double fibration'' fails, in general, to be surjective or submersive on either base. The next proposition, provided without proof, shows that the picture is better for $\calVr^{p-1,p}(\calI)$. In particular, as discussed above, it shows that near K\"ahler-regular points $\calV^p(\calI)$ is a manifold.

\begin{prop}[{{\cite[Prop.~1.8]{Bryant}}}]
    If $\calVr^{p-1,p}(\calI)$ is not empty, then it is a smooth manifold. Moreover, the image $\pi_{p}(\calVr^{p-1,p}(\calI))$ is an open subset of $\calVo^{p}(\calI)$ and both of the maps $\pi_{p-1}:\calVr^{p-1,p}(\calI)\to \calVr^{p-1}(\calI)$ and $\pi_{p}:\calVr^{p-1,p}(\calI)\to \pi_{p}(\calVr^{p-1,p}(\calI))$ are submersions.
\end{prop}

% The proof has an important corollary: if $(E,E^+)\in\calVr^{p-1,p}(\calI)$, then the inequality in (\ref{eq codim inequality}) is saturated. 
Lemma~\ref{lem 8.1.10 Ivey} gave an upper bound for the dimension of $\calV^p(\calI)$ at $E^+$ in terms of the polar space $H(E)$. The following one shows that this upper bound is achieved if $E$ is K\"ahler-regular.

\begin{lem}[{{\cite[Lem.~8.1.13]{Ivey}}}]\label{lem 8.1.13 Ivey}
    Let $E,E^+$ be as in Lemma~\ref{lem 8.1.10 Ivey}. Assume in addition that $E$ is K\"ahler-regular and let $\phi^\nu\in\calI^{p-1}$, $1\leq \nu\leq \codim_E \calV^{p-1}(\calI)$, be such that the corresponding functions $F^\nu$ on $\Fr_{p-1}(\T M)$ have linearly independent differentials at $E$. Let $\Phi^\alpha\in\calI^p$ be a collection of linearly independent $p$-forms that generate the polar equations for $E$, i.e.,
    \[H(E)=\{X\in\T_m M\mid \restr{i_X\Phi^\alpha}{E}=0\text{ for all }\alpha\}.\]
    Then there are a $1$-form $\theta$ such that each $\wt E^+$ in some neighborhood $U^+$ of $E^+$ in $\Gr_p(\T M)$ is K\"ahler-ordinary iff $\restr{\Phi^\alpha}{\wt E^+}=0$ and $\phi^\nu\wedge\restr{\theta}{\wt E^+}=0$ for all $\alpha,\nu$. Consequently, the inequality in (\ref{eq codim inequality}) is saturated.
\end{lem}
\begin{proof}
    Let $x^1,\ldots,x^p,y^1,\ldots,y^s$, $X_1,\ldots,X_p$, and $p_i^a$ be as in the proof of Lemma~\ref{lem 8.1.10 Ivey}. Let $\theta=\dd x^p$, and let $U^+$ be the neighborhood of $E^+$ in $\Gr_p(\T M)$ where the $p_i^a$ are defined.

    Since $E$ is K\"ahler-ordinary, the forms $\phi^\nu$ span $\calI^{p-1}$ in the vicinity of $m$. Since $E$ is K\"ahler-regular, there is a neighborhood $U$ of $E$ in $\Gr_{p-1}(\T M)$ such that the $\Phi^\alpha$ also generate the polar equations for any $\wt E\in U\cap \calV^{p-1}(\calI)$. If $\restr{\phi^\nu\wedge\theta}{\wt E^+}=0$, then 
    \[\phi^\nu\wedge \theta(X_1,\ldots,X_p)=\phi^\nu(X_1,\ldots,X_{p-1})\label{eq 8.5 Ivey}\]
    shows that the $(p-1)$-plane $\wt E<\wt E^+$ spanned by $X_1,\ldots,X_{n-1}$ is an integral plane. If $\restr{\Phi^\alpha}{\wt E^+}=0$ as well, then $\wt E^+<H(\wt E)$, and so $\wt E^+\in\calV^p(\calI)$.

    Now it is clear that $\codim_{E^+}\calV^p(\calI)\leq \codim_E\calV^{p-1}(\calI)+\codim H(E)$, and this upper bound holds for all nearby integral $p$-planes. Then the lower bound (\ref{eq codim inequality}) and the lower semi-continuity of codimension show that $\wt E^+$ is K\"ahler-ordinary.
\end{proof}





\section{Cartan-K\"ahler theorem}


It is important to note that, much like the Cauchy-Kovalevskaya theorem, the Cartan-K\"ahler theorem and Cartan's Test only apply to systems generated by real-analytic differential forms on an analytic manifold $M$. (However, a version of the theorem in the $C^\infty$ category holds for ``involutive hyperbolic'' systems.)

\begin{thm}[Cartan-K\"ahler I {{\cite[Thm.~8.3.1]{Ivey}}}]\label{thm 8.3.1 Ivey}
    Assume $\calI$ is an analytic \gls{eds} on $M$ and $P^p<M$ is an analytic immersed submanifold whose tangent spaces are K\"ahler-regular integral elements such that, at each $m\in P$, $H(T_m P)$ has dimension $p+1$ (i.e., $r(\T_m P)=0$). Then, for each $m\in P$, there is an open neighborhood $U\subset M$ of $m$ and an $(p+1)$-manifold $N<U$ which is the unique analytic integral manifold containing $P\cap U$ (unique in the sense that any other such integral manifold must match $N$ on an open neighborhood of $P$).
\end{thm}
\begin{proof}
    We will reduce the problem to solving a system using the Cauchy-Kovalevskaya theorem.

    Choose analytic coordinates $x^0,x^1,\ldots,x^p,y^1,\ldots,y^s$ centered at $m$, such that $\T_m P=\<\partial_{x^1},\ldots,\partial_{x^p}\>$ and $\partial_{x^0}\in H(\T_m P)$. As in Lemma~\ref{lem 8.1.13 Ivey}, let $\{\phi^\nu\}$ be a basis for $\calI^p$ near $m$, and let the $(p+1)$-forms $\Phi^\alpha$, $1\leq \alpha\leq s$, generate the polar equations in a neighborhood of $\T_m P$.

    If $N^{p+1}$ is an integral manifold containing $P$, then $\T_m N=H(\T_m P)$, and the $x^i$ serve as local coordinates on $N$. If $N$ is to be defined by $y^\alpha=F^\alpha(x^0,x^1,\ldots,x^p)$, where the functions $F^\alpha$ are to be determined, then $\T N$ will be spanned by $X_0=\partial_{x^0}+\partial_{x^0}F^\alpha\partial_{y^\alpha}$ and the vectors $X_i=\partial_{x^i}+\partial_{x^i}F^\alpha\partial_{y^\alpha}$ for $1\leq i\leq p$. 
    
    We will now show that the $F^\alpha$ satisfy a system of PDEs of Cauchy-Kovalevskaya type. Let $1\leq \alpha,\beta,\gamma\leq s$ and define functions $A^\alpha_\beta(x^i,y^\gamma;p^\gamma_j)$ and $B^\alpha(x^i,y^\gamma;p^\gamma_j)$ by 
    \[\Phi^\alpha(\partial_{x^0}+q^\beta\partial_{y^\beta},\partial_{x^1}+p_1^\beta\partial_{y^\beta},\ldots,\partial_{x^p}+p^\beta_p\partial_{y^\beta})=A^\alpha_\beta q^\beta+B^\alpha.\]
    Since at point $m$, the equations \
    \[\Phi^\alpha(\partial_{x^0}+q^\beta\partial_{y^\beta},\partial_{x^1},\ldots,\partial_{x^p})=0\]
    coincide with the polar equations of $E$, they are of full rank $s$ in the $q^\beta$. Thus, we may assume that near the origin the $A^\alpha_\beta$ are the entries of an invertible matrix. For sufficiently small $p^\beta_j$, we can then define forms $\wt\Phi^\alpha=(A^{-1})^\alpha_\beta\Phi^\beta$. Let $C^\alpha(x^i,y^\beta;p^\beta_j)$ be defined by 
    \[C^\alpha=q^\alpha-\wt\Phi^\alpha(\partial_{x^0}+q^\beta\partial_{y^\beta},\partial_{x^1}+p^\beta_1\partial_{y^\beta},\ldots,\partial_{x^p}+p^\beta_p\partial_{y^\beta}).\]
    Then we construct $N$ by using Cauchy-Kovalevskaya to solve 
    \[\left\{\begin{array}{l}
        \partial_{x^0}F^\alpha=C^\alpha(x^0,x^1,\ldots,x^p,F^1,\ldots,F^s;\partial_{x^j}F^\beta),\\
        F^\alpha(0,x^1,\ldots,x^p)=0.
        \end{array}\right.
    \]
    It remains to be shown that the forms $\phi^\nu\wedge\dd x^0$, which by Lemma~\ref{lem 8.1.13 Ivey} span the rest of the $(p+1)$-forms in $\calI$, pull back to be zero on $N$. By (\ref{eq 8.5 Ivey}), this is equivalent to showing that $\phi^\nu(X_1,\ldots,X_p)=0$. On $N$,
    \[\partial_{x^0}\phi^\nu(X_1,\ldots,X_p)=\dd\phi^\nu(X_0,\ldots,X_p)-\sum_i\partial_{x^i}\left(\dd x^i\wedge \phi^\nu(X_0,\ldots,X_p)\right).\]
    However, since $\dd\phi^\nu\equiv 0$ and $\phi^\nu\wedge\dd x^i\equiv 0$ modulo $\<\Phi^\alpha,\phi^\nu\wedge\dd x^0\>$, the right hand side of this PDE is expressible in terms of analytic functions of the $\phi^\nu(X_1,\ldots,X_p)$ and their $x^i$-derivatives. Since $\phi^\nu(X_1,\ldots,X_p)=0$ along $x^0=0$, by the Cauchy-Kovalevskaya theorem the unique solution to this system of PDEs is $\phi^\nu(X_1,\ldots,X_p)\equiv 0$ for all $\nu$.
\end{proof}

\begin{example}[Importance of K\"ahler-regularity for existence]
    Consider the case of Exercise~\ref{xca 3.1 Bryant lec}. For either of the systems, the line $L$ defined by $x=z=0$ is an integral curve with the property that $r(\T_{\bf{x}} L)=0$ for all $\bf{x}\in L$. However, $\calI_1$ has no integral surfaces while $\calI_2$ has the integral surface $z=0$ containing $L$. In both cases, $L$ is a K\"ahler-ordinary integral manifold but not a K\"ahler-regular one, so the Cartan-K\"ahler Theorem doesn't apply.
\end{example}

\begin{example}[Importance of K\"ahler-regularity for existence]
    Consider the system from Exercise~\ref{xca 3.3 Bryant lec}(2). The line $L$ defined by $x^2=x^3=x^4-0$ is a non-K\"ahler-regular integral curve, and has $r(\T_{\bf{x}}L)=1$ for all $\bf{x}\in L$, with the polar space $H(\T_{\bf{x}}L)$ spanned by $\partial_{x^1},\partial_{x^3},\partial_{x^4}$ for all $\bf{x}\in L$. Taking $R$ to be the $3$-plane defined by $x^3=x^1$, we have that $\dim(\T_{\bf{x}}R\cap H(\T_{\bf{x}}L))=2$ for all $\bf{x}\in L$, but there is no integral surface $N$ of $\calI$ satisfying $L\subset N\subset R$, even though there are integral surfaces of $\calI$ that contain $L$. 
\end{example}


\begin{thm}[Cartan-K\"ahler II {{\cite[Thm.~8.3.2]{Ivey}}}]\label{thm 8.3.2 Ivey}
    Assume $M,\calI$, and the $p$-dimensional $P$ are as in Theorem~\ref{thm 8.3.1 Ivey}, but $H(\T_m P)$ has dimension $p+r+1$ for each $m\in P$ (i.e., $r(\T_m P)=r\geq 0$). Assume that $R<M$ is an analytic submanifold of codimension $r$ containing $P$, such that $\T_m R\pitchfork H(\T_m P)$ (that is, $\T_m R+ H(\T_m P)=\T_m M$). Then there is an open set $U\subset R$ containing $P$, and a $(p+1)$-dimensional submanifold $N<U$ which is the unique analytic integral submanifold in $U$ containing $P$.
\end{thm}
\begin{proof}
    The transversality assumption implies that $\T_m R\cap H(\T_m P)$ has dimension $p+1$. Thus, we can apply the previous version, with $M$ replaced by $R$, at any point $m\in P$. By applying Theorem~\ref{thm 8.3.1 Ivey} at points in $P$, we obtain a collection $\{U_\alpha\}$ of open sets $U_\alpha\subset R$ such that $\{P\cap U_\alpha\}$ is an open covering of $P$, and integral submanifolds $N_\alpha\subset U_\alpha$ with $P\cap N_\alpha\subset N_\alpha$.

    Suppose that $P\cap U_\alpha\cap U_\beta\neq \varnothing$. Then $N_\beta\cap U_\alpha$ is an analytic integral submanifolds with a nonempty intersection with $P\cap U_\alpha$, so by the uniqueness part of the Cauchy-Kovalevskaya theorem, $N_\beta\cap U_\alpha\subset N_\alpha$. We finish by letting $U=\bigcup_\alpha N_\alpha$ and $N=\bigcup_\alpha N_\alpha$.
\end{proof}


\begin{example}[Importance of restraining manifold for uniqueness]
    The manifold $R$ is needed when $r(P)>0$ because, in this case, the extension problem is underdetermined in a certain sense. Let's look at the system from Exercise~\ref{xca 3.3 Bryant lec}(1). There, all of the integral elements $E\in\calV^1(\calI)=\Gr_1(\T \bbR^4)$ are regular, with $r(E)=1$. Thus, every integral element has a $1$-dimensional family of possible extensions to a $2$-dimensional integral element. Suppose, for example, that one starts with the curve $P\subset \bbR^4$ defined by $x^2=x^3=x^4=0$. Then 
    \[H(\T_{\bf{x}}P)=\<\partial_{x^1},\partial_{x^3},\partial_x^4\>,\quad \bf{x}\in P.\]
    In particular, any real analytic hypersurface $R$ given by an equation $x^4=F(x^1,x^2,x^3)$ where $F(x^1,0,0)=0$ will satisfy the hypotheses of Theorem~\ref{thm 8.3.2 Ivey}. Pulling $\calI$ back to this hypersurface and using $x^1,x^2,x^3$ as coordinates on $R$, one finds that the resulting system on $R$ is generated by the single $2$-form 
    \[\dd x^1\wedge\dd x^2+\dd x^3\wedge(F_1\dd x^1+F_2\dd x^2)=(\dd x^1+F_2\dd x^3)\wedge(\dd x^2-F_1\dd x^3),\]
    where $F_i=\partial_{x^i} F$. Of course, this is a closed $2$-form on $R$, and its integral surfaces are swept out by integral curves of the vector field 
    \[X=-F_2\partial_{x^1}+F_1\partial_{x^2}+\partial_{x^3}.\]
    Thus, to get the integral surface $N$, one takes the union of these integral curves that pass through the initial curve $P$. The functions $x^1,x^3$ will be independent coordinates on a neighborhood of $P$ in $N$, so $N$ can be written locally as a graph 
    \[x^2=f(x^1,x^3),\quad x^4=g(x^1,x^2),\]
    where $f,g$ are functions satisfying $f(x^1,0)=g(x^1,0)=0$. The condition that these define an integral surface then turns out to be that there is another function $h$ so that 
    \[x^2=\partial_{x^1}h(x^1,x^3),\quad x^4=\partial_{x^3}h(x^1,x^3).\]
    Conversely, any such function $h$ defines an integral manifold containing $L$ as long as its first partials vanish along the line $x^3=0$. This shows that one doesn't get uniqueness without a restraining manifold.
\end{example}

Thus, the role of the ``restraining manifold'' $R$ is to convert the ``underdetermined'' Cauchy problem one would otherwise encounter in extending $P$ to a $(p+1)$-dimensional integral to a determined problem. The theorem can be applied inductively to obtain an integral manifold with a given integral $p$-plane $E$ as its tangent space. To do this, one needs a flag $0=E^0<E^1<\cdots <E^{p-1}<E^p=E$ of integral elements inside $E$ with $\dim E^k=k$, such that Theorem~\ref{thm 8.3.2 Ivey} can be applied at each step. The proof of the next result gives an idea of how this is done.


\begin{defn}[Integral flag]\index{Integral flag}
    An integral flag of an \gls{eds} $\calI$ on $M$ is a sequence of nested integral elements at a point $m\in M$ of incrementally increasing dimensions up to some dimension $n$:
    \[0=E^0< E^1< E^2< \cdots< E^n,\quad E^p\in\calV^p(\calI)_m.\]
    These subspaces have successively larger spaces of polar equations. The \emph{Cartan characters} $s_0,\ldots,s_n$ of the flag are the increments in dimension of the space of polar equations: $E^p$ has polar equations of rank $s_0+s_1+\cdots s_p$.
\end{defn}

Since the Cartan-K\"ahler Theorem requires the initial (non-extended) integral elements to be K\"ahler-regular, the following notions of regularity for integral flags are natural.

\begin{defn}[Ordinary/regular integral element/flag]\index{Integral element!Ordinary}\index{Integral element!Regular}\index{Flag!Regular}\index{Flag!Ordinary}
    Let $\calI$ be an \gls{eds} on a manifold $M$. An integral element $E\in\calV^n(\calI)$ is called \emph{ordinary} if its basepoint $m\in M$ is an ordinary zero of $\calI^0$ and moreover there exists an integral flag $0=E^0<E^1<\cdots <E^n=E$, where $E^n$ is K\"ahler-regular for $p\leq n-1$. This flag is then called an \emph{ordinary flag}. If $E$ is both ordinary and K\"ahler-regular, then we say that $E$ is \emph{regular} and the flag is a \emph{regular flag}.
\end{defn}

Note that each $E^p$, $p\leq n-1$, in an ordinary $n$-flag is itself regular. As we will see later, an ordinary $E$ is also K\"ahler-ordinary. For integral elements, we have the implications: regular $\implies$ K\"ahler-regular, ordinary $\implies$ K\"ahler-ordinary, and regular $\implies$ ordinary. 


\begin{thm}[Cartan-K\"ahler III {{\cite[Thm.~8.3.3]{Ivey}}}]\label{thm 8.3.3 Ivey}
    Let $E^n$ be an ordinary integral element at $m\in M$ for an analytic \gls{eds} $(M,\calI)$. Then there exists a smooth $n$-dimensional integral manifold $N$ whose tangent space at $m$ is $E^n$.
\end{thm}
\begin{proof}
    Let $0=E^0<\cdots<E^n$ be an ordinary integral flag for $E^n$. Let $c_p=\codim H(E^p)$, $0\leq p\leq n$; note that the $c_p$ are non-decreasing. Let $x^1,\ldots,x^n,y^1,\ldots,y^s$ be local coordinates centered at $m$, defined on an open set $U\subset M$, and chosen so that $E^p=\<\partial_{x^1},\ldots,\partial_{x^p}\>$ for $p\leq n$ and $H(E^p)$ is annihilated by $\dd y^1,\ldots,\dd y^{c_p}$ for $p<n$.

    Let $R_1\subset U$ be the submanifold given by setting $x^2=\cdots =x^n=0$ and $y^a=f_1^a(x^1)$ for $a>c_0$, where $f_1^a$ are some analytic functions with $f_1^a(0)=0$. By Theorem~\ref{thm 8.3.2 Ivey} with $R=R_1$, there exists a unique $1$-dimensional integral manifold $N_1\subset R_1$ tangent to $E^1$ at $m$.

    Next, let $R_2\subset U$ be the manifold given by $x^3=\cdots =x^n=0$ and $y^a=f_2^a(x^1,x^2)$ for $a>c_1$. To arrange that $R_2$ contains $N_1$, we require that $f_2^a(x^1,0)=f_1^a(x^1)$. By Theorem~\ref{thm 8.3.2 Ivey} with $R=R_2$, there exists a unique integral surface $N_2\subset R_2$ tangent to $E^2$ at $m$. (Note, however, that we may have to shrink $U$ to ensure that $H(\T_q N_1)$ is transversal to $\T_q R_2$ at every $q\in N_1$.)

    Proceeding this way, we eventually obtain an $n$-dimensional integral manifold tangent to $E_n$ at $m$. (At the last step, $R_n$ is defined by $y^a=f_n^a(x^1,\ldots,x^n)$ for $a>c_{p-1}$.)
\end{proof}

\begin{rem}\label{rem 8.3.4 Ivey}
    Note that, in constructing the successive restraining manifolds $R_1,R_2,\ldots$, we may choose the functions $f_1^a(x^1)$ for $c_0< a\leq c_1$ (subject to $f_1^a(0)=0$), but functions $f_1^a(x^1)$ are constrained to equal $f_2^a(x^1,0)$ for $a>c_1$. Similarly, functions $f_2^a(x^1,x^2)$ may be freely specified only for $c_1<a\leq c_2$. In this way, an $n$-dimensional integral manifold $N$ containing $m$ is specified by choosing $c_1-c_0$ functions of one variable, $c_2-c_1$ functions of two variables, and so on. (In the next \sect, these differences $c_p-c_{p-1}$ will be identified with the \emph{Cartan characters} of the flag.)
\end{rem}


\begin{rem}
    Relative to the same coordinate system, any `nearby' integral $p$-manifold $\wt N$ will contain a point $\wt m$ where $x^1=\cdots=x^n=0$ and $y^a=f_0^a$ for some constants $f_0^a$. Then $\wt N$ is obtained by successively applying Theorem~\ref{thm 8.3.2 Ivey} with $R_1$ specified by $x^2=\cdots=x^n=0$ and $y^a=f_1^a(x^1)$ for $a>c_0$ (subject to $f_1^a(0)=f_0^a$), then $R^2$ specified by $x^3=\cdots=x^n=0$ and $y^a=f_2^a(x^1,x^2)$ for $a>c_1$ (subject to $f_2^a(x^1,0)=f^a(x^1)$), and so on. Thus, near $N$ the space of integral $p$-manifolds is parametrized by $c_0$ constants, $c_1-c_0$ functions of one variable, and so on up to $s-c_{p-1}$ functions of $p$ variables, where $s=\dim M-p$.
\end{rem}









\section{Cartan's test}


The Cartan-K\"ahler Theorem shows that the ordinarity of an integral element is sufficient for the existence of an integral manifold. However, unlike the Frobenius Theorem, it does not provide a clear computable criterion for this. In fact, it's not even immediately clear how ordinarity arises in the Frobenius case. We also lack an easy algorithm for computing the codimensions of polar spaces. Hence, the true generalization of the Frobenius Theorem will be Cartan's Test, which establishes a relatively simple algebraic criterion (naturally also called \emph{involutivity}) for ordinarity.

Once again, any integral manifold constructed out of an ordinary flag lies in $\calVo^0(\calI)$, so we can, as usual, safely restrict ourselves to that subset and then assume that $\calI$ contains no zero-forms. To any integral flag $F=(E^0<\cdots<E^n)$ there corresponds a \emph{descending flag} of polar spaces
\[\T_m M\geq H(E^0)\geq \cdots \geq H(E^n)\geq E^n.\]
It will be convenient to keep track of the dimensions of these spaces in terms of their codimensions relative to $\T_m M$. For $p<n$, set 
\[c(E^p)\coloneqq \codim H(E^p)=\dim M-\dim H(E^p)=n+s-p-1-r(E^p),\quad p\leq n-1,\]
where $\dim M=n+s$. It works out best to make the special convention $c(E^n)\coloneqq s$. (In practice, it is usually the case that $H(E^n)=E^n$, so this definition of $c(E^n)$ agrees with the general formula if one puts $p=n$.) Since $\dim H(E^p)\geq \dim E^n=n$, we have $c(E^p)\leq s$. Because of the nesting of these spaces, we have 
\[0\leq c(E^0)\leq c(E^1)\leq\cdots \leq c(E^n)= s.\]
We also define $c(E^{-1})\coloneqq 0$ for convenience. 

\begin{defn}[Cartan characters]\index{Cartan characters}
    The Cartan characters of an integral flag $F=(E^0<\cdots<E^n)$ are the numbers 
    \[s_p(F)\coloneqq c(E^p)-c(E^{p-1})\geq 0,\quad p=0,\ldots,n.\]
    Note that $(s_0,\ldots,s_n)$ is an integer partition of $s$.
\end{defn}

The following shows that characters are ``invariant'' in that they are constant on connected components of the space of ordinary integral elements and independent of the choice of an ordinary flag.

\begin{prop}[{{\cite[Props.~III.1.13, III.2.4]{Bryant}}}]\label{prop iii.1.13, 2.4 Bryant}
    Let $\calI\subset \Omega^{\smbullet}(M)$ be an \gls{eds} containing no non-zero $0$-forms. Let $Z\subset\calV^n(\calI)$ be a connected component of the space of ordinary integral elements. Then there exists a unique sequence of codimensions $(c_0,\ldots,c_{n-1})$, and hence one of Cartan characters $(s_0,\ldots,s_{n-1})$, common for all ordinary flags of all integral elements $E^n\in Z$.
\end{prop}
\begin{proof}
    Let $\wt Z\subset \calVr^0(\calI)\times \calVr^1(\calI)\times\cdots\times \calVr^{n-1}(\calI)\times Z$ denote the space of ordinary integral flags $F=(E^0<\cdots<E^n)$ of $\calI$ with $E_n\in Z$. We endow $\wt Z$ with the topology and smooth structure it inherits from this product. Note that even though $Z$ is connected, $\wt Z$ may not be connected. However, if we define $c_p(F)=c(E^p)$, then the functions $c_p$ for $p<n$ are clearly locally constant on $\wt Z$. We must show that they are actually constant on $\wt Z$.

    To do this, suppose that for some $p<n$, $c_p$ is not constant on $\wt Z$. Then there would exist non-empty sets $\wt Z_1$, $\wt Z_2$ such that $c_p\equiv q$ on $\wt Z_1$ and $c_p\neq q$ on $\wt Z_2$. The images $Z_1,Z_2$ of these two sets under the submersion $\wt Z\to Z$ would then be an open covering of $Z$. By the connectedness of $Z$, they would have to intersect non-triviality. In particular, there would exist an $E\in Z$ and two $p$-planes $E_1,E_2\in\calVr^p(\calI)\cap\Gr_p(E)$ for which $e(E_1)=q\neq r(E_2)$.

    We shall now show that this is impossible. Since $E<\T_m M$ is an integral element, it follows that $\Gr_p(E)\subset \calV^p(\calI)$ and hence that $\calVr^p(\calI)\cap\Gr_p(E)$ is an open subset of $\Gr_p(E)$. Moreover, since the function $r$ is locally constant on $\calVr^p(\calI)$, it follows that $\calVr^p(\calI)\cap \Gr_p(E)$ is a subset of the open set $\Gr_p^\ast(E)\subset\Gr_p(E)$ on which $r$ is locally constant. This, it suffices to show that $r$ is constant on $\Gr_p^\ast(E)$.

    Let $\psi^1,\ldots,\psi^q\in\calI^{p+1}$ be such that a $(p+1)$-plane $E^{p+1}<\T_m M$ is an integral element of $\calI$ iff all of the $\psi^k$ vanish on $E^{p+1}$. (Since we are only considering elements based at $m$, such a finite collection of forms exists.) Then for any $E^p\in\Gr_p(E)$ with basis $e_1,\ldots,e_p$,
    \[H(E^p)=\{X\in\T_m M\mid \psi^a(X,e_1,\ldots,e_p)=0\text{ for }a=1,\ldots,q\}.\]
    By the usual argument involving the ranks of linear equations whose coefficients involve parameters, it follows that $\dim H(E^p)$ is locally constant on $\Gr_p(E)$ only on the open set where it reaches its minimum. Thus, $r$ is constant on $\Gr_p^\ast(E)$, as required.
\end{proof}


\begin{defn}[Involutive integral element]\index{Integral element!Involutive}
    Let $(M,\calI)$ be an \gls{eds} and let $Z\subset\calVo^n(\calI)$ be a connected open subset of the space of K\"ahler-ordinary elements. $Z$ is called involutive if every $E\in Z$ is ordinary. A given integral element $E\in\calV^n(\calI)$ is called involutive if it is contained in $\calV^n(\calI)$ along with an involutive open neighborhood, i.e., if $\calV^n(\calI)$ is a smooth manifold near $E$.
\end{defn}

Usually, the component $Z$ must be understood from the context whenever statements such as ``the system $\calI$ has Cartan characters $(s_0,\ldots,s_n)$'' are made. In fact, in most cases of interest, the space of ordinary integral $n$-planes has only one component anyway.

In order to check whether an integral flag is involutive, it seems that we would need to compute not only the dimensions of its polar spaces, but also those of all nearby integral elements. This is avoided by the following test.


\begin{thm}[Cartan's Test for Involutivity {{\cite[Thm.~8.4.1]{Ivey}}}]\label{thm cartan's test}
    If $F=(E^0<\cdots<E^n)$ is an integral flag of $(M,\calI)$ at $m\in M$ and $\dim M=n+s$, then 
    \[\codim_{E^n}\calV^n(\calI)\geq c(F), \quad\text{ or } \quad\dim_{E^n}\calV^n(\calI)\leq \dim M+s(F),\]
    where the \emph{character sums} $c(F),s(F)$ are defined by 
    \begin{align}
        c(F)&\coloneqq  c_0+c_1+\cdots+c_{n-1},\\
        s(F)&\coloneqq ns-c(F)=s_1+2s_2+\cdots+ns_n.
    \end{align}
    Moreover, $\calV^n(\calI)$ is a smooth submanifold of $\Gr_n (\T M)$ of codimension precisely $c(F)$ in a neighborhood of $E^n$ iff $F$ is ordinary. In other words, $E^n$ is involutive iff it is ordinary.
\end{thm}
\begin{proof}
    The inequality follows by successive applications of (\ref{eq codim inequality}). Furthermore, if all the $E^p$ are K\"ahler-regular, successive applications of Lemma~\ref{lem 8.1.13 Ivey} show that $\calV^n(\calI)$ is smooth at $E^n$, with the required codimension.

    Now suppose $\calV^n(\calI)$ is smooth at $E^n$ with the above codimension. We first show that $E^{n-1}$ is K\"ahler-ordinary. One might suspect this is the case because $\calV^n(\calI )$ cannot be so large without $\calV^{n-1}(\calI)$ being large. Consider the following heuristic argument: by the first part of this theorem, $\calV^{n-1}(\calI)$ has codimension at least $c_0+\cdots+c_{n-2}$ at $E^{n-1}$. On the other hand, for every $\wt{E}^n\in\calV^n(\calI)$ near $E^n$, all the hyperplanes inside $\wt{E}^n$ are in $\calV^{n-1}(\calI)$. In fact we may parametrize this set of hyperplanes and get a map from $\calV^n(\calI)\times\bbR^{n-1}$ to a neighborhood of $E^{n-1}$ in $\calV^{n-1}(\calI)$. But for $\wt{E}^{n-1}\in\calV^{n-1}(\calI)$ sufficiently close to $E^{n-1}$, $H(\wt{E}^{n-1})$ has codimension at least $c_{n-1}$. This means the map has fiber of dimension at most $s-c_{n-1}$. (Here we again set $s=\dim M-n$.) Since $\dim \Gr_n(\T M)=n+s+ns$,
    \[\dim \calV^n(\calI)=d=n+s+ns-(c_0+\cdots+c_{n-1}).\]
    So, we expect the image of this map to have dimension at least 
    \[d+n-1-(s-c_{n-1}-1)=n+s+(n-1)(s+1)-(c_0+\cdots+c_{n-2}),\]
    which is exactly the largest dimension it can be. We will now make this argument rigorous.

    Let $x^1,\ldots,x^n,y^1,\ldots,y^s$ be local coordinates such that $E^p=\<\partial_{x^1},\ldots,\partial_{x^p}\>$ and $H(E^p)$ is annihilated by $\dd y^1,\ldots,\dd y^{c_p}$. As in the proof of Lemma~\ref{lem 8.1.10 Ivey}, we define functions $p^0_i$ completing a coordinate system on $U\subset\Gr_n(\T M)$ centered at $E^n$, and also functions $X_i,q^a_j,u_j$ and $Z_j$ as before.  

    Let $F:U\times\bbR^{n-1}\to \Gr_{n-1}(\T M)$ take $(\wt{E}^n,(v_1,\ldots,v_{n-1}))$ to the subspace spanned by the vectors $X_j+v_j+X_n,j=1,\ldots,n-1$. In coordinates, this map is given by $u_j=v_j$ and $q^a_j=p^a_j+v_j p^a_n$. Differentiating these equations shows that the kernel of $F_\ast$ at $(E^n,(0,\ldots,0))$ is spanned by the vectors $\partial_{p^a_n}$.
    
    Let $f$ denote the restriction of $F$ to $(\calV^n(\calI)\cap U)\times\bbR^{n-1}$. We want to show that the rank of $f$ is at least $d-(s-c_{n-1})$ at $(E^n,(0,\ldots,0))$, or equivalently that the intersection of the kernel of $F_\ast$ with $\T_{E^n}\calV^n(\calI)$ has dimension at most $s-c_{n-1}$. Once this is known, the image of $f$ contains a smooth submanifold through $E^{n-1}$ with maximum codimension, and it follows that $E^{n-1}$ is K\"ahler-ordinary; in fact, the image of $f$ fills out $\calV^n(\calI)$ near $E^{n-1}$.

    We will need to look at the equations that cut out $\calV^n(\calI)$ near $E^n$ in coordinates. By the above inequality, $\codim_{E^{n-1}}\calV^{n-1}(\calI)\geq c_0+\cdots+c_{n-2}$. So, let $\phi^\nu,\nu=1,\ldots,c_0+\cdots+c_{n-2}$, and $\Phi^\alpha,\alpha=1,\ldots,c_{n-1}$, be defined as in the proof of Lemma~\ref{lem 8.1.10 Ivey}. We saw then that the $n$-forms $\phi^\nu\wedge\dd x^n$ and $\Phi^\alpha$ give rise to functions $G^\nu$ and $H^\alpha$ on $\Gr_n(\T M)$ with linearly independent differentials at $E^n$. Since $\calV^n(\calI)$ is smooth at $E^n$, and of exactly this codimension, the equations $G^\nu=H^\alpha=0$ define $\calV^n(\calI)$ near $E^n$.

    As before, $G^\nu$ is polynomial in the $p^a_i$ which does not involve the $p^a_n$, and  
    \[\restr{\dd  H^\alpha}{E^n}\equiv \dd p^\alpha_n\pmod{\dd p^a_i,i<n},\quad \alpha=1,\ldots,c_{n-1}.\label{eq 8.8 Ivey}\]
    Now, if some linear combination $\sum_{a=1}^st_a\partial_{p^a_n}$ is tangent to $\calV^n(\calI)$ at $E^n$, (\ref{eq 8.8 Ivey}) shows that $t_a=0,a=1,\ldots,c_{n-1}$. It follows that the kernel of $f_\ast$ at $E^n$ is as small as desired, and the rank of $f$ is as large as desired.

    Now it is easy to show that $E^{n-1}$ is K\"ahler-regular. For, suppose a nearby $\wt{E}^{n-1}\in\calV^{n-1}(\calI)$ has $\codim H(\wt{E}^{n-1})>\codim H(E^{n-1})$. This $\wt{E}^{n-1}$ will be in the image of $f$, and so is contained in an $\wt{E}^n\in \calV^n(\calI)$ near $E^n$. Now (\ref{eq 8.8 Ivey}) implies that the codimension of $\calV^n(\calI )$ at $\wt{E}^n$ is larger than it really is, a contradiction. To finish the proof, it remains to run this argument inductively to conclude that each $E^p$ is K\"ahler -regular.
\end{proof}

\begin{rem}[Generic flags]\index{Flag!generic}
    The characters $s_p$ calculate the increments of the ranks of polar equations: $E^p$ has polar equations of rank $s_0+\cdots+s_p$. A \emph{generic} flag is one with locally maximal rank of polar equations, i.e., with locally maximal $s(F)$. Since $s(F)$ is an upper semicontinuous function of the flag, generic flags form a dense open subset of the space of flags. Thus, before applying Cartan's Test, it is important to choose a generic flag inside $E^n$, otherwise the test will fail. If the test fails even on a generic flag, the system needs to be \emph{prolonged}, which we will discuss in later \sect s.
\end{rem}


This is a powerful result because it allows one to test for the ordinarity of a flag by simple linear algebra, computing the polar spaces $H(E^p)$ for a generic flag in $E^n$ and checking that $\calV^n(\calI)$ is smooth near $E^n$ and of the highest possible dimension, namely the \emph{predicted dimension} $\dim M+s(F)$. Then the Cartan-K\"ahler Theorem~\ref{thm 8.3.3 Ivey} guarantees the existence of an integral $n$-manifold tangent to $E^n$. Moreover, Remark~\ref{rem 8.3.4 Ivey} shows that all integral $n$-manifolds tangent to $E^n$ are parametrized by $s_0$ constants, $s_1$ functions of one variable, $s_2$ functions of two variables, etc. Unlike the Frobenius Theorem, which established a direct link between integrability and involutivity, Cartan's method involves the intermediate concept of ordinarity:
\begin{center}
    Involutive $\overset{\mathrm{C.~Test}}{\Leftrightarrow}$ Ordinary $\overset{\mathrm{C-K\ Thm.}}{\implies}$ Integrable.
\end{center}

% \begin{defn}[Generic flag]
%     Consider all flags inside a given integral element $E^n$. Polar equations remain linearly independent under small perturbations of the flag. A generic flag is one with locally maximal rank polar equations, i.e., locally maximal character sums. Generic flags form a dense open subset of flags, as we will see. The \emph{characters of the integral element} $E^n$ are those of its generic flag. 
% \end{defn}

% All integral elements of maximum possible dimension $p$ of an \gls{eds} $\calI$ on $M$ form a subset of the Grassmann bundle $\Gr_p M$. The fundamental problem in the theory of PDEs is whether this subset is a submanifold, and to predict its dimension $p$.

% \begin{defn}[Involutive integral element]\index{Involutive integral element}
%     An integral flag $E^0<\cdots <E^p$ of integral elements of an \gls{eds} $\calI$ on $M$ \emph{predicts} the dimension $\dim M+s_1+2s_2+\cdots+p s_p$. A maximal integral element \emph{predicts} the dimension predicted by its the generic flag, and it does so \emph{correctly} if the nearby integral elements form a submanifold of the Grassmann bundle of the predicted dimension. (We will see that they always sit in a submanifold of that dimension.) A maximal-dimensional integral element which correctly predicts the dimension is \emph{involutive}. An \gls{eds} is \emph{involutive} if the generic maximal integral element is involutive.
% \end{defn}

The following example explains how we can recover the (analytic version of the) Frobenius Theorem from Cartan's Test and the Cartan-K\"ahler Theorem.

\begin{example}[Frobenius Theorem]
    Let $\dim M=n+s$ and let $\calI$ be generated algebraically by a Pfaffian system $I<\T^\ast M$ (defined as a subbundle) of rank $s$. Then at each $m\in M$, there is a unique integral element of dimension $n$, namely $\Ann(I_m)<\T_m M$. In fact, every integral element at $m$ must be a subspace of $\Ann(I_m)$, since $H(\{0\}_m)=\Ann(I_m)$. Thus, if $0<E^1<\cdots<E^n=\Ann(I_m)$ is an integral flag, then we have $H(E^p)=\Ann(I_m)$ for all $p\leq n$. Thus, $c_p=s$ for all dimensions $p$. It follows by Cartan's Test that $\calV^n(\calI)$ must have codimension at least $ns$ in $\Gr_n(\T M)$. On the other hand, since there is a unique integral element at each point, it follows that $\calV^n(\calI)$ is a smooth manifold of dimension $n+s$ while $\dim\Gr_n(\T M)=n+s+ns$. Thus, $\calV^n(\calI)$ is a smooth submanifold of codimension $ns$ in $\Gr_n(\T M)$. By Cartan's Test, it follows that all of the elements of $\calV^n(\calI)$ are ordinary. If we now assume that $\calI$ is analytic, then the Cartan-K\"ahler Theorem~\ref{thm 8.3.3 Ivey} applies to show that there exists an $n$-dimensional integral manifold passing through each point of $M$. The characters are $(s_0,s_1,\ldots,s_n)=(s,0,\ldots,0)$. Thus, according to Remark~\ref{rem 8.3.4 Ivey}, the local integral $n$-manifolds depend on $s$ constants. This is in accordance with the usual theory of foliations: these $s$ constants locally parametrize the leaf space.
\end{example}

Since it is not obvious whether a given \gls{eds} is a Pfaffian system or not (i.e., whether it can be generated by $1$-forms), we can restate the Frobenius Theorem~\ref{prop 4.7.10 RS1} in the form of a criterion on a general \gls{eds}.

\begin{thm}[Frobenius III]\index{Theorem!Frobenius}\label{thm frobenius iii}
    Suppose $\calI$ is an \gls{eds} on a manifold $M$. \gls{tfae}, and when they hold we call $\calI$ \emph{Frobenius}:
    \begin{enumerate}[label=(\arabic*)]
        \item Every integral element of $\calI$ lies in a unique $p$-dimensional integral element.
        \item There is an integer $s$ such that $\calI$ has an $n$-dimensional integral element at each point of $M$ with characters $(s_0,s_1,\ldots,s_n)=(s,0,\ldots,0)$.
        \item $\calI$ has an involutive $n$-dimensional integral element at each point of $M$ and is locally generated by $\dim M-n$ linearly independent $1$-forms.
        \item $\calI$ is locally generated as an algebraic ideal by $\dim M-n$ linearly independent $1$-forms.
        \item $\calI$ is locally generated by linearly independent $1$-forms $\theta^1,\ldots,\theta^s$ with $\dd\theta^i=\sum_j \gamma_j^i\wedge\theta^j$ for some local $1$-forms $\gamma^i_j$.
        \item $\calI$ is locally generated by linear independent $1$-forms. The vector fields on which all $1$-forms in $\calI$ vanish are closed under Lie bracket and span a $n$-dimensional linear subspace in each tangent space of $M$.
        \item Each point of $M$ has coordinates $x^1,\ldots,x^n,u^1,\ldots,u^s$ so that $\calI$ is locally generated by $\dd u^1,\ldots,\dd u^s$.
        \item The $n$-dimensional $\calI$-integral manifolds form the leaves of a foliation of $M$, and $\calI$ is locally generated by the $1$-forms vanishing along the leaves.
    \end{enumerate}
\end{thm}


We conclude this discussion with a technical proposition which provides an effective method of computing the codimensions $c_p$ and also generalizes the Frobenius Theorem in the form of item (5) above. We use multi-index notation $J=(j_1,\ldots,j_p)$, where $1\leq j_k\leq n$, and define $\sup J$ as the largest of the indices in $J$. For $J=\varnothing$, we put $\sup J\coloneqq 0$.


\begin{prop}[{{\cite[Prop.~III.1.15]{Bryant}}}]\label{prop III.1.15 Bryant}
    Let $\calI\subset\Omega^{\smbullet}(M)$ be an \gls{eds} containing no non-zero $0$-forms. Let $E\in\calV^n(\calI)$ be based at $m\in M$ and $\dim M=n+s$. Let $\omega^1,\ldots,\omega^n,\pi^1,\ldots,\pi^s$ be a coframe on some $m$-neighborhood such that $E=\ker\pi^1\cap\cdots\cap\ker\pi^s$. For each $p\leq n$, define $E^p\coloneqq \ker\omega^{p+1}\cap\cdots\cap \ker\omega^n$. Let $\{\vartheta^\lambda\}_{\lambda=1}^r$ be a set of forms that generate $\calI$ algebraically, and $\deg \vartheta^\lambda=1+d_\lambda$.

    Then, for each $\lambda=1,\ldots,r$, there exists a \emph{structure equation}\index{Equation!Structure}
    \[\vartheta^\lambda=\sum_{|J|=d_\lambda}\pi_J^\lambda\wedge\omega^J+\wt\vartheta^\lambda,\label{eq prop III.1.15 Bryant}\]
    where the $1$-forms $\pi_J^\lambda$ are (pointwise) linear combinations of the $\pi^\lambda$ and the terms in $\wt\vartheta^\lambda$ are of degree $\geq 2$ in the $\pi^\lambda$, or else vanish at $m$.

    Moreover, we have 
    \[H(E^p)=\bigcap_{\begin{smallmatrix}
        \lambda=1,\ldots,r\\
        \sup J\leq p
    \end{smallmatrix}}\ker\vartheta^\lambda.\label{eq flag}\]
    In particular, for the integral flag $F=(E^0<\cdots<E^n)$ of $\calI$, $c_p$ is the number of linearly independent $1$-forms in the set $\{(\pi_J^\lambda)_m\mid \sup J\leq p\}$.
\end{prop}
\begin{proof}
    The existence of the expansion cited for $\vartheta^\lambda$ is an elementary exercise in exterior algebra using the fact that $E$ is an integral element of $\calI$. The `remainder' $\wt\vartheta^\lambda$ has the property that $\wt\vartheta^\lambda(X,e_1,\ldots,e_{d_\lambda})=0$ for all $X\in\T_m M$ and all $\{e_1,\ldots,e_{d_\lambda}\}\subset E$. If $e_1,e_2,\ldots,e_n$ is the basis of $E$ which is dual to the coframing $\omega^1,\ldots,\omega^n$ and $K=(k_1,\ldots,k_{d_\lambda})$ is a multi-index with $\deg K=d_\lambda$, we have the formula $\vartheta^\lambda(X\wedge e_K)=\pi^\lambda_K(X)$. The stated formulas for $H(E^p)$ and $c_p$ follow immediately.
\end{proof}

This result is very handy because it means that we can completely forego thinking about integral flags and computing their polar spaces manually, and instead just decompose the (algebraic) generators of the \gls{eds} w.r.t.\ a chosen coframe and look at the linearly independent components of the ``matrix of $1$-forms'' $\pi^\lambda_J$. In particular, if we scan this matrix starting from lower $p$ up, then $s_p$ is the number of ``new'' linearly-independent $1$-forms appearing in the ``grade'' $\sup J=p$.









\section{Cartan's test in practice}



Note that any $1$-forms among the generators of $\calI$  automatically satisfy an expansion of the form (\ref{eq prop III.1.15 Bryant}) with \emph{no remainder term}, because $\omega^{\varnothing}$ are $0$-forms and indeed, each generator of $\calI^1$ must be a combination of the $\pi^\lambda$. To further simplify, one usually chooses a set of generators $\{\theta^1,\ldots,\theta^{s_0}\}$ for $\calI^1$, so that they can be completed to a coframe $\{\theta^1,\ldots,\theta^{s_0},\omega^1,\ldots,\omega^n,\pi^1,\ldots,\pi^t\}$ in $\T^\ast_m M$. Next, if we apply Cartan' Test via $s(F)$, then we don't need to know $c_0=s_0$, which is simply the number of generators of $\calI^1$. Thus, we can ignore grade $0$ in most of the analysis. 

Moreover, Proposition~\ref{prop III.1.15 Bryant} presumes that the intersection of $\ker\pi^\lambda$ defines an integral element. In practice it takes some work to choose the $\pi^\lambda$ in this way. Thus, usually we proceed by choosing an \emph{arbitrary} coframe, defining a flag via (\ref{eq flag}), and then manually adjusting the coframe until the flag becomes integral, assuming this is possible (otherwise there are no integral $n$-planes). This implies that the expansion (\ref{eq prop III.1.15 Bryant}) may now contain additional terms that don't vanish when the $\pi^\lambda$ vanish, i.e., terms that involve only products of the $\omega^i$. These terms will be named in item 5 below. The procedure becomes as follows:
\begin{enumerate}
    \item Looking for $n$-dimensional integral elements, let $\calI_m=\{\vartheta_m\mid\vartheta\in\calI\}\subset \bigwedge\T^\ast_m M$ and work modulo the ideal $\<\calI^1_m\>_{\mathrm{alg}}\subset \calI_m$.
    \item Pick a basis $\omega^i,\pi^\lambda$ for $\T^\ast_m M\slash\calI^1_m$.
    \item Write a set of algebraic generators of $\calI_m\slash\calI^1_m$ as a column:
    \[\vartheta^{\smbullet}=\begin{pmatrix}
        \vartheta^1\\\vdots \\ \vartheta^r
    \end{pmatrix}.\]
    \item Use multi-index notation $\omega^{ij}=\omega^i\wedge\omega^j$, and so on. Compose all of these into a standard column vector arranged by ``grades'' (the maximum index in the multi-index):
    \[
        \omega^{\smbullet}=\left(\begin{array}{c}
        \omega^1\\ \hline 
        \omega^2 \\
        \omega^{12}\\ \hline 
        \omega^3\\
        \omega^{13}\\
        \omega^{23}\\
        \omega^{123}\\\hline 
        \vdots \\\hline 
        \omega^n \\
        \vdots \\
        \omega^{1\ldots n}
    \end{array}\right).
    \]
    Any entry that doesn't appear in the expansions of the generating set $\vartheta$ in this basis can be dropped.
    \item Write out an expansion (structure equation) 
    \[\vartheta^{\smbullet}=\varpi\wedge\omega^{\smbullet}+\cdots\] 
    for some matrix $\varpi$, called the \emph{tableau}, so that each entry of $\varpi$ is a linear combination of the $\pi^\lambda$, and the $\cdots$ consists of 
    \begin{enumerate}
        \item terms containing no $\pi^\lambda$ (only the $\omega^i$, e.g., $T_{ij}\omega^{ij}$), called the \emph{(apparent) torsion}. To be able to construct an integral flag we will need to choose the $\pi^\lambda$ in such a way that there is no torsion.
        \item terms with at least $2$ of the $\pi^\lambda$ wedged into them, called the \emph{nonlinearity}. This is what we called $\wt\vartheta$ in Proposition~\ref{prop III.1.15 Bryant}.
    \end{enumerate}
    The matrix $\varpi$ is also separated by vertical lines into grades. We assign grade $n$ to the nonlinearity.
    \item A \emph{polar} (equation) is an entry of $\varpi$ that is linearly independent of all entries found in the grades and columns to the left of it (including its own column). Highlight all polars. In practice, we will often arrange the $\pi^\lambda$ in such a way that the each polar is precisely a $\pi^\lambda$.
    \item Choose any basis of $\calI^1_m$ and declare the basis elements to be the polars of grade $0$. A \emph{character} $s_p'$ of the tableau $\varpi$ is the number of polars in grade $p$. (We will show below that under proper conditions the $s'_p$ coincide with the Cartan characters of the system.)
    \item We may call a tableau \emph{adapted} to the flag defined as in Proposition~\ref{prop III.1.15 Bryant}:
    \[E^p=\bigcap_a \ker \theta^a\cap \bigcap_\lambda \ker \pi^{\lambda} \cap \bigcap_{j=p+1}^n\ker \omega^{j}.\]
    (A single flag has many tableaux adapted to it.) This flag is integral iff the torsion vanishes. A \emph{generic} integral flag is such that, for each $p=1,\ldots,n$, $s_p'$ is the greatest among all integral flags with the same $s_1',\ldots,s_{p-1}'$. The \emph{Cartan characters} $\{s_p\}$ of the system are the characters of the generic integral flag. The method for finding a generic integral flag will be described below.
 \end{enumerate}

At the end of this procedure, assuming torsion vanishes, one can perform Cartan's Test. We will discuss what to do with torsion below.

\begin{xca}
    \begin{enumerate}
        \item Prove that the polars defined by a tableau, indeed, form a basis of the polar equations.
        \item Prove that the apparent torsion vanishes iff the flag is integral.
    \end{enumerate}
\end{xca}

\begin{example}
    We begin with a contrived but simple example. Start with a coframe $\{\theta^1,\theta^2,\theta^3,\omega^1,\omega^2,\omega^3,\pi^1,\pi^2,\pi^3\}$ on $\bbR^9$ and consider an \gls{eds} spanned by 
    \begin{align}
        1\text{-forms} &\; \theta^1,\theta^2,\theta^3,\\
        2\text{-forms} &\; \theta^1\wedge\omega^3+\omega^1\wedge\pi^1+\omega^2\wedge\pi^2+\omega^3\wedge\pi^3,\\
        3\text{-forms} &\; \pi^{123}-\omega^{12}\wedge\pi^3+\omega^{13}\wedge\pi^2-\omega^{23}\wedge\pi^1,
    \end{align}
    where we use the multi-index notation as in the proposition above, so $\omega^{12}=\omega^1\wedge\omega^2$, $\pi^{123}=\pi^1\wedge\pi^2\wedge\pi^3$, and so on. Thus, the generators of $\calI\slash\calI^1$ read
    \begin{multline}
        \vartheta^{\smbullet}= \begin{pmatrix}
            \omega^1\wedge\pi^1+\omega^2\wedge\pi^2+\omega^3\wedge\pi^3\\
            -\omega^{12}\wedge\pi^3+\omega^{13}\wedge\pi^2-\omega^{23}\wedge\pi^1+\pi^{123}
        \end{pmatrix}= \\
        = -\left(
            \begin{array}{c|cc|ccc}
                \boxed{\pi^1}& \boxed{\pi^2} & 0 & \pi^3 & 0 & 0\\
                0 & 0 & \boxed{\pi^3} & 0 & -\pi^2 & \pi^1
            \end{array}
        \right)
        \wedge 
        \left(
            \begin{array}{c}
                \omega^1 \\
                \hline \omega^2 \\
                \omega^{12}\\
                \hline \omega^3 \\
                \omega^{13}\\
                \omega^{23}
            \end{array}
        \right)
        +\begin{pmatrix}
            0 \\ \pi^{123}
        \end{pmatrix}.
    \end{multline}
    Here we draw lines to separate the ``grades'' $\sup J$.  The $\pi^\lambda$ in grade $p$ encode the polar equations for $E^p$. The highlighted ones are the new linearly independent polars in each new grade starting from the left.  By counting the highlighted forms in each grade we read off $(s_1,s_2,s_3)=(1,2,0)$.
\end{example}



\begin{example}[Cauchy-Riemann equations]\index{Equation!Cauchy-Riemann}\label{example cauchy-riemann eds}
    Recall from Remark~\ref{rem holomorphic functions} that a holomorphic function $f:\bbC^n\supset U\to\bbC$ is a real-differentiable function satisfying the Cauchy-Riemann equations
    \[f_{x^i}=-\i f_{y^i},\quad i=1,\ldots,n,\]
    where $x^i,y^i$ are the real and imaginary parts of the standard complex coordinate $z^i$ on $\bbC^n$. If $f=u+\i v$ with real $u,v$, then this becomes 
    \[u_{x^i}=v_{y^i},\quad v_{x^i}=-u_{y^i}.\]
    Let $M\coloneqq \bbR^{2n+2+2n}$ be the space parametrized by $(\bf{x},\bf{y},u,v,\bf{p},\bf{q})$ and take the canonical contact system restricted to the manifold defined by these equations:
    \[\theta^1\coloneqq \dd u-p_i\dd x^i-q_k\dd y^j,\quad \theta^2\coloneqq \dd v+q_i\dd x^i-p_j \dd y^j.\]
    The only algebraic generators of degree above $1$ are $\dd\theta^k$, so the structure equation is
    \[
    \begin{pmatrix}
        \dd\theta^1\\\dd \theta^2
    \end{pmatrix}=
    -\begin{pmatrix}
        \boxed{\dd p_1} & \cdots & \boxed{\dd p_n} & \dd q_1 & \cdots & \dd q_n\\
        \boxed{-\dd q_1} & \cdots & \boxed{-\dd q_n} & \dd p_1 & \cdots & \dd p_n
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \dd x^1\\
        \vdots \\
        \dd x^n\\
        \dd y^1\\
        \vdots \\
        \dd y^n
    \end{pmatrix}.
    \]
    The characters are $(s_1,\ldots,s_n,s_{n+1},\ldots,s_{2n})=(2,\ldots,2,0,\ldots,0)$, and the predicted dimension is 
    \[\dim M+s_1+2 s_2+\cdots +2n s_{2n}=4n+2+n(n+1).\]
    Integral elements at each point $(\bf{x},\bf{y},u,v,\bf{p},\bf{q})$ have 
    \[\begin{pmatrix}
        \dd p_i\\
        \dd q_i
    \end{pmatrix}=\begin{pmatrix}
        r_{ij} & -s_{ij}\\
        s_{ij} & r_{ij}
    \end{pmatrix}
    \begin{pmatrix}
        \dd x^j \\
        \dd y^j
    \end{pmatrix},
    \]
    with $(r_{ij}),(s_{ij})$ symmetric matrices. So the space of integral elements has dimension $4n+2+n(n+1)$ and we conclude involution. The general holomorphic function depends on $2$ functions of $n$ variables. For example, it suffices to provide arbitrary (real analytic) values of the function on an $n$-dimensional analytic submanifold, and then they will have a unique complex analytic continuation to an open neighborhood of that manifold.

    This is even easier in complex notation. Let $\omega^i\coloneqq \dd x^i+\i \dd y^i$, $\theta\coloneqq \theta^1+\i \theta^2$, $\pi_i\coloneqq \dd p_i+\i \dd q_i$ and $\wb\omega^i\coloneqq \dd x^i-\i \dd y^i$. In general, a tableau in complex forms will have terms expressed in wedge products with $\omega^i$ and $\wb\omega^i$. But the Cauchy-Riemann equations give 
    \[\dd\theta=-\begin{pmatrix}
        \boxed{\pi^1} & \cdots &\boxed{\pi^n}
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \omega^1\\\vdots \\ \omega^n
    \end{pmatrix}\]
    with no $\wb\omega^i$ terms. The characters count complex polars, so we double them to count real and imaginary parts, giving the same characters. Integral elements are described by $\pi_i=p_{ij}\omega^j$ with some complex matrix $p_{ij}=p_{ji}$, which is $n(n+1)/2$ complex numbers or $n(n+1)$ real ones, as before.
\end{example}



\begin{example}[Self-dual equations]\label{example self-dual equations 3}
    Look back to Exercise~\ref{xca self-dual equations 2}. Any integral element $E\in \calV^4(\calI)\cap \Gr_4(\T \bbR^7,\dd^4 x)$ is defined by linear equations of the form 
    \[\pi^a=\dd u^a-p_i^a(E)\dd x^i=0.\]
    In order that $\Phi$ vanish on such a $4$-plane, it suffices that the $p^a_i(E)$ satisfy four equations 
    \[p_1^1+p_2^2+p_3^3=p_4^1-p_3^2+p_2^3=p_4^2-p_1^3+p_3^1=p_4^3-p_2^1+p_1^2=0.\]
    It's clear from this that $\calV^4(\calI)\cap\Gr_4(\T\bbR^7,\dd^4 x)$ is a smooth manifold of codimension $4$ in $\Gr_4(\T\bbR^7)$. On the other hand, if we let the flag subspaces $E^p<E$ be defined by the equation $\dd x^{p+1}=\dd x^{p+2}=\cdots =\dd x^4=0$ for $0\leq p< 4$, then it is easy to observe the following sets of polar equations for this flag:
    \begin{center}
        \begin{tabular}{l r r r} 
         Flag & Polar equations & Codimension & Character \\ [0.5ex] 
         \hline
         $E^0=\{0\}$ & $\{0\}$ & $c_0=0$ & $s_0=0$ \\ 
         $E^1=\<\partial_{x^1}\>$ & $\{0\}$ & $c_1=0$ & $s_1=0$ \\ 
         $E^2=\<\partial_{x^1},\partial_{x^2}\>$ & $\<\pi^3\>$ & $c_2=1$ & $s_2=1$ \\ 
         $E^3=\<\partial_{x^1},\partial_{x^2},\partial_{x^3}\>$ & $\<\pi^1,\pi^2,\pi^3\>$ & $c_3=3$ & $s_3=2$ \\ 
         $E^4=\<\partial_{x^1},\ldots,\partial_{x^4}\>$ & $\<\pi^1,\pi^2,\pi^3\>$ & $c_4=3$ & $s_4=0$ \\ 
         \hline
        \end{tabular}
    \end{center}
    It is even easier to read off these characters from the tableau method described above (note that grade $1$ is empty):
    \[\Phi=
    \left(\begin{array}{|c|cc|ccc}
        \boxed{\dd u^3} & \boxed{\dd u^1} & \boxed{\dd u^2} & \dd u^1 &\dd u^2 & \dd u^3
    \end{array}\right)\wedge
    \left(\begin{array}{c}
        \hline
        \dd x^{12}\\\hline 
        \dd x^{23} \\
        \dd x^{31}\\\hline 
        \dd x^{14}\\
        \dd x^{24}\\
        \dd x^{34}
    \end{array}\right).
    \]
    So we have $c_0=c_1=0$, $c_2=1$, and $c_3=c_4=3$, so $c(F)=1+3=4$, which is indeed the codimension of $\calV^4(\calI)$ in $\Gr_4(\T \bbR^7)$. Cartan's Test is passed and the flag is ordinary, so we conclude involutivity and the solutions depend on $2$ functions of $3$ variables and $1$ function of $2$ variables, as we have already seen in Example~\ref{ex self-dual equations}.
\end{example}



\begin{example}[Lagrangian submanifolds]\index{Largangian submanifold}
    We can use the Cartan-K\"ahler Theorem to prove the existence of Lagrangian submanifolds of the complex Euclidean space $\bbC^n\cong \bbR^{2n}=\{\bf{x}+\i \bf{y}\mid \bf{x},\bf{y}\in\bbR^n\}$, whose K\"ahler form is 
    \[\theta= \dd x^1\wedge \dd y^1+\cdots +\dd x^n\wedge \dd y^n.\]
    Let $\calI$ be the \gls{eds} generated by $\theta$ on $\bbR^{2n}$. Writing spans of vectors in angle brackets, 
    \begin{center}
        \begin{tabular}{l r r} 
         Flag & Polar equations & Character \\ [0.5ex] 
         \hline
         $E^0=\{0\}$ & $\{0\}$ & $s_0=0$ \\ 
         $E^1=\<\partial_{x^1}\>$ & $\<\dd y^1\>$ & $s_1=1$ \\ 
         $\vdots $ & $\vdots $ & $\vdots $ \\ 
         $E^0=\<\partial_{x^1},\ldots,\partial_{x^n}\>$ & $\<\dd y^1,\ldots,\dd y^n\>$ & $s_n=1$ \\ 
         \hline
        \end{tabular}
        \end{center}
        Or, using the tableau method, 
        \[\theta=
            \left(\begin{array}{c|c|c|c}
                \boxed{\dd y^1} & \boxed{\dd y^2} & \cdots &\boxed{\dd y^n}
            \end{array}\right)\wedge 
            \left(\begin{array}{c}
                \dd x^1 \\\hline
                \dd x^2\\ \hline
                \vdots \\ \hline
                \dd x^n
            \end{array}\right).
        \]
        This flag predicts dimension 
        \[\dim \bbR^{2n}+s_1+2s_2+\cdots ns_n=2n+1+2\cdots +n.\]
        The nearby integral elements at a given point of $M$ are parametrized by $\dd \bf{y}=A\dd \bf{x}$, which we plug into $\theta=0$ to see that $A$ can be any symmetric matrix. Therefore the space of integral elements has the correctly predicted dimension
        \[\dim\bbR^{2n}+\frac{n(n+1)}{2}.\]
        The Cartan-K\"ahler Theorem proves the existence of Lagrangian submanifolds of $\bbC^n$, with (at least) one through each point, tangent to each subspace $\dd\bf{y}=A\dd\bf{x}$, for each symmetric real matrix $A$ close to $0$.
\end{example}


We always look for integral manifolds of a particular dimension $n$. For simplicity, we can assume that our \gls{eds} contains all differential forms of degree $n+1$ and higher, which doesn't change the set of $n$-dimensional integral elements. In particular, the $n$-dimensional integral elements are then maximal. The polar equations of any maximal integral element $E^n$ cut out precisely $E^n$, i.e., have rank $\dim M-n$ on $E^n$. We encounter $s_0,\ldots,s_n$ polar equations at each increment, so the rank also equals $s_0+s_1+\cdots +s_n$:
\[s_0+s_1+\cdots s_{n-1}+s_n=\dim M-n.\label{eq final character}\]
This allows us to find $s_n$ from the other characters. For even greater simplicity, we take this as a definition for the final character $s_n$; we only pretend that our \gls{eds} contains all differential forms of degree $n+1$ and higher.

Notably, the same PDE, or the same system of integral manifolds, can arise from different \glspl{eds} on different manifolds, and the Cartan characters will not necessarily be the same. However: 
\begin{nscenter}
    \emph{the top nonzero character is invariant}.
\end{nscenter}

\begin{defn}[Character, Cartan integer]
    If $\kappa=s_l$ is the top (i.e., highest $l$) nonzero Cartan character of a system, then $\kappa$ is called the Cartan integer and $l$ is called the character.
\end{defn}

\begin{example}\label{ex ux=vy 1}
    Consider the simple equation $u_x=v_y$ for two functions $u(x,y)$, $v(x,y)$. By integrating we can put it in the form 
    \[u(x,y)=u(0,y)+\int_0^x v_y(x',y)\dd z'.\]
    Therefore the general solution can be determined from an arbitrary function $v(x,y)$ and an initial condition $u(0,y)$. Let us try to obtain this information from the Cartan-K\"ahler analysis. Let $(x,y,u,v,p_u,q_u,p_v,q_v)$ be the coordinates on $\rmJ^2(\bbR^2,\bbR^2)$. The above equation defines a $7$-dimensional manifold $M<\rmJ^2(\bbR^2,\bbR^2)$ given by $p_u=q_v$. We use this equation to eliminate $q_v$. The canonical contact system restricted to $M$ reads 
    \[\theta^u=\dd u-p_u\dd x-q_u\dd y,\quad \theta^v=\dd v-p_v\dd x-p_u\dd y.\]
    A $1$-dimensional integral element $E^1$ is spanned by a vector $X\in \T M$ such that $\theta^u(X)=\theta^v(X)=0$. The first two characters read 
    \begin{center}
        \begin{tabular}{l r r} 
         Flag & Polar equations & Character \\ [0.5ex] 
         \hline
         $E^0=\{0\}$ & $\<\theta^u,\theta^v\>$ & $s_0=2$ \\ 
         $E^1=\<X\>$ & $\<\theta^u,\theta^v,i_X\dd\theta^u,i_X\theta^v\>$ & $s_1=2$ \\
         \hline
        \end{tabular}
    \end{center}
    Since we're looking for integral surfaces, so $n=2$, the final character is found from $s_0+s_1+s_2=\dim M-n$, which gives $s_2=1$.
    We find that the predicted dimension is $\dim M+s_1+2s_2=8+2+2=12$. 

    An integral plane $E^2$ is such that $\dd\theta_u$ and $\dd\theta_v$ vanish on it and $\dd x\wedge\dd y$ doesn't. Such a plane is described by $5$ linear relations that express each of $\dd u,\dd v,\dd p_u,\dd p_v,\dd q_u$ in terms of $\dd x,\dd y$. The space of solutions to such a linear system at a given point has $10-5=5$ dimensions. Thus, the manifold $\calV^2$ of integral planes has dimension $\dim M+5=12$. This matches the predicted dimension and we conclude involutivity. The solution depends on one function of $2$ variables, which matches the general solution that we've constructed. The lower characters are not invariants, so it is not surprising that $s_1$ doesn't match the number of functions of one variable in our general solution.
\end{example}

\begin{example}\label{ex ux=vy 2}
    Another way to write the equation $u_x=v_y$ as an \gls{eds} of lower dimension is to informally multiply it by $\dd x\wedge\dd y$ and get $\dd u\wedge\dd y-\dd v\wedge\dd x=0$. Thus we have the \gls{eds} $\calI=\<\Psi\>_{\mathrm{diff}}=\<\Psi\>$ on $M=\bbR^2\times\bbR^2$ spanned by a single $2$-form 
    \[\Psi=\dd u\wedge\dd y-\dd v\wedge\dd x.\]
    The characters are easy to read off: 
    \begin{center}
        \begin{tabular}{l r r} 
         Flag & Polar equations & Character \\ [0.5ex] 
         \hline
         $E^0=\{0\}$ & $\{0\}$ & $s_0=0$ \\ 
         $E^1=\<X\>$ & $\<i_X\Psi\>$ & $s_1=1$ \\
         \hline
        \end{tabular}
    \end{center}

    The final character is $s_2=\dim M-2-1=1$. We have the predicted dimension $\dim M+s_1+2s_2=7$. The same characters can be easily obtained from the tableau:
    \[\Psi=
    \begin{pmatrix}
        -\dd v & \dd u
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \dd x\\ \dd y
    \end{pmatrix}.
    \]
    Meanwhile, the space of integral planes at a single point is parametrized by $3$ parameters (expressing $\dd u,\dd v$ in terms of $\dd x,\dd y$ with a rank $1$ linear constraint $\restr{\Psi}{E^2}=0$), so $\dim\calV^2=\dim M+3=7$. We conclude involutivity again and the top character matches what we found before.
\end{example}


\begin{example}[Laplace equation]
    We will prove the existence of harmonic functions on the plane with given value and first derivatives at a given point. On the jet space $M=\rmJ^1(\bbR^2,\bbR)\cong\bbR^5$ with coordinates $\{x,y,u,p_x,p_y\}$, let $\calI$ be the \gls{eds} generated by 
    \[\theta=\dd u-p_x \dd x-p_y\dd y,\quad \Theta=\dd x\wedge \dd p_y-\dd y\wedge\dd p_x.\]
    Note that 
    \[\dd\theta=\dd x\wedge \dd p_x+\dd y\wedge \dd p_y\]
    must also belong to $\calI$ by definition of an \gls{eds} (and the equation $\dd \theta=0$ expresses the commutation of partials $u_{xy}=u_{yx}$). Any integral surface on which the independence condition $\dd x\wedge\dd y\neq 0$ is satisfied is locally the graph of a harmonic function $u(x,y)$ and its derivatives $u_x,u_y$.

    Each integral plane ($2$-dimensional element) $E^2$ on which $\dd x\wedge\dd y\neq 0$ is given by equations 
    \begin{align}
        \dd p_x=p_{xx}\dd x+p_{xy}\dd y,\\
        \dd p_y=p_{yx}\dd x+p_{yy}\dd y,
    \end{align}
    for a unique choice of constants $p_{xx},p_{xy},p_{yx},p_{yy}$ subject to the two conditions $p_{xy}=p_{yx}$ and $p_{xx}=-p_{yy}$ (these conditions come from substitution into $\Theta=0$). Hence, the space of integral planes at a point has dimension $2$. The space of all integral planes has dimension $\dim M+2=5+2=7$. Each vector inside the above integral plane has the form 
    \[v=\left(v^x,v^y,p_xv^x+p_yv^y,p_{xx}v^x+p_{xy}v^y,p_{yx}v^x+p_{yy}v^y\right).\]
    Each integral line $E^1$ is the span $E^1=\<v\>$ of a nonzero such vector. Compute 
    \[i_v \begin{pmatrix}
        \dd \theta \\
        \Theta
    \end{pmatrix}=
    \begin{pmatrix}
        v^x \dd p_x+v^y\dd p_y-(p_{xx}v^x+p_{xy}v^y)\dd x-(p_{yx}v^x+p_{yy}v^y)\dd y\\
        v^y\dd p_x-v^x\dd p_y+(p_{xx}v^x+p_{xy}v^y)\dd y+(p_{yx}v^x+p_{yy}v^y)\dd x
    \end{pmatrix}.
    \]
   These are the new polar equations in dimension $2$. The characters then read 
    \begin{center}
        \begin{tabular}{l r r} 
         Flag & Polar equations & Character \\ [0.5ex] 
         \hline
         $E^0=\{0\}$ & $\<\theta\>$ & $s_0=1$ \\ 
         $E^1=\<v\>$ & $\<\theta,i_v\dd\theta,i_v\Theta\>$ & $s_1=2$ \\
         \hline
        \end{tabular}
    \end{center}
    We are only interested in integral surfaces, so we set $p=2$ and compute the final character from (\ref{eq final character}). Since $\dim M=5$, the characters are $(s_0,s_1,s_2)=(1,2,0)$ with predicted dimension $\dim M+s_1+2s_2=5+2+2\cdot 0=7$. We conclude involutivity. By the Cartan-K\"ahler Theorem, harmonic functions exist near any point of the plane with prescribed value and first derivatives as that point. Moreover, these characters tell us that the general solution depends on $2$ functions of $1$ variable (e.g., a pair of boundary conditions on the value and the first derivatives).
\end{example}

\begin{example}[Wave equation]\index{Equation!Wave}
    The wave equation $u_{xy}=0$ can be obtained from the same \gls{eds} as the Laplace equation above, with the replacement $\Theta=\dd x\wedge\dd p_x-\dd y\wedge\dd p_y$. The rest of the procedure doesn't qualitatively change, the characters are the same, and we still find involution: solutions to the wave equation depend on $2$ functions of $1$ variable. This is expected from the general solution $u=\xi(x)+\eta(y)$, where $\xi$ and $\eta$ are arbitrary functions (see Example~\ref{ex wave eq kovalevskaya}).
\end{example}

\begin{example}[Complex curves in $\bbC^2$]\index{Complex curve}
    On $M=\bbC^2$ with coordinates $z=x+\i y$ and $w=u+\i v$, consider the \gls{eds} $\calI=\<\Re \phi,\Im \phi\>$, where 
    \[\phi =\dd z\wedge \dd w=(\dd x\wedge \dd u-\dd y\wedge\dd v)+\i (\dd x\wedge\dd v+\dd y\wedge \dd u).\]
    Since $\calI^1=\{0\}$, any \emph{real} curve in $\bbC^2$ is an integral manifold of $\calI$. Now consider an integral surface $N<\bbC^2$. If $\dd x$ and $\dd y$ are linearly independent in $N$, then $N$ can be locally written as a graph $(x,y,u(x,y),v(x,y))$, where $u$ and $v$ satisfy the Cauchy-Riemann system\index{Equation!Cauchy-Riemann}
    \[u_x=v_y,\quad u_y=-v_x.\]
    Thus, $N$ is an integral manifold of $\calI$ iff it is a \emph{complex curve}, i.e., locally a graph of a holomorphic function $f(z)=u+\i v$.
\end{example}


Let us briefly discuss what to do when torsion appears.
Any flag has many tableau adapted to it. Since the choice of the coframe elements $\pi^\lambda$ is up to us, we can add linear combinations of the $\omega^i$ to each $\pi^\lambda$ and potentially get rid of the torsion term. We call this \emph{absorbing} and illustrate the method in the next example.


\begin{example}[Absorbing torsion]\label{example absorbing torsion}
    Consider an \gls{eds} generated (differentially) by two $1$-forms $\theta^1,\theta^2$ with 
    \[\dd \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix}=-\begin{pmatrix}
        \boxed{\pi^1} & 0\\
        \boxed{\pi^2} & \boxed{\pi^3}
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \omega^1\\\omega^2
    \end{pmatrix}
    +\begin{pmatrix}
        \omega^{12}\\0
    \end{pmatrix}\pmod{\<\theta^1,\theta^2\>}.
    \]
    Note that $\dd\theta^1,\dd\theta^2$ generate $\calI\slash\calI^1$ algebraically. The term $\omega^{12}$ is the torsion. Let $\pi^{\prime 1}\coloneqq \pi^1+\omega^2$ and rewrite the system 
    \[\dd \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix}=-\begin{pmatrix}
        \boxed{\pi^{\prime 1}} & 0\\
        \boxed{\pi^2} & \boxed{\pi^3}
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \omega^1\\\omega^2
    \end{pmatrix}\pmod{\<\theta^1,\theta^2\>}.
    \]
    Therefore we have \emph{absorbed} the torsion by adding a combination of the $\omega^i$ to one of the $\pi^\lambda$. 
\end{example}

A given tableau can only examine integral elements coframed by the $\omega^i$. It is possible to absorb the torsion just when there exists such an integral element. Later, in systems with no integral elements we will identify the parts of torsion that can't be absorbed with \emph{intrinsic torsion}.


\begin{example}[\ref{example curl pde} continued]\label{example curl pde 2}
    Let us examine the equation $\curl \bf{u}+\bf{u}=\bf{f}$ again, this time using the Cartan-K\"ahler theory. As an equation on $\rmJ^1(\bbR^3,\bbR^3)$, it selects the submanifold $M$ given by 
    \[\epsilon^{ki}{}_j p^j_i+u^k=f^k,\quad k=1,2,3,\]
    where $p^j_i$ is the coordinate corresponding to $\partial_i u^j$ and $\epsilon^{ki}{}_j=\pm 1$ is the fully antisymmetric symbol with $\epsilon^{12}{}_3=1$. On $M$, we consider the canonical Pfaffian \gls{eds} generated by the pullbacks of the contact forms 
    \[\theta^\lambda=\dd u^\lambda-p^\lambda_i \dd x^i,\quad \lambda=1,2,3.\]
    We have $\dd\theta^\lambda=-\dd p^\lambda_i\wedge\dd x^i$. To obtain a tableau we need to pick a coframe and consider these equations modulo $I=\<\theta^1,\theta^2,\theta^3\>$. First we note that $M$ is $12$-dimensional and we already have $\theta^\lambda$ and $\dd x^i$, $\lambda,i=1,2,3$, as part of the coframe. We can include the first column of the tableau, $\dd p^1_1,\dd p^2_1,\dd p^3_1$, into the coframe as well. In the second column, the first element is 
    \[\dd p^1_2=\dd p^2_1+\dd u^3-\dd f^3\equiv \dd p^2_1+p^3_i\dd x^i-\dd f^3\pmod{I}.\]
    The last two terms contribute only to torsion and can be absorbed by distributing parts of them into the diagonal elements $\pi^i\coloneqq \dd p^i_i+\cdots$. Thus, this element is not a polar. The remaining two elements of the second column, $\dd p^2_2$ and $\dd p^3_2$, are independent. Finally, in the last column, $\dd p^1_3$ and $\dd p^2_3$ again contribute only to torsion and can be absorbed into the $\pi^i$, whereas $\dd p^3_3$ is also dependent because $\sum_i \dd p^i_i\equiv \dd f^3\pmod{I}$. We have 
    \[
    \begin{pmatrix}
        \dd\theta^1\\\dd\theta^2\\\dd \theta^3
    \end{pmatrix}\equiv -
    \begin{pmatrix}
        \boxed{\pi^1} & \dd p^2_1 & \dd p^3_1\\
        \boxed{\dd p^2_1} & \boxed{\pi^2} & \dd p^3_2\\
        \boxed{\dd p^3_1} & \boxed{\dd p^3_2} & \pi^3
    \end{pmatrix}\wedge\begin{pmatrix}
    \dd x^1\\\dd x^2\\ \dd x^3
    \end{pmatrix}\pmod{I}.
    \]
    The characters are $(s_1',s_2',s_3')=(3,2,0)$ and the predicted dimension of the space of integral elements at a point is $s_1'+2s_2'=7$. On the other hand, this space is parametrized by the $9$ numbers $p^i_j$ (coming from the vanishing of $\theta^\lambda$) subject to the vanishing of $\dd\theta^\lambda \pmod{I}$, which is only 2 extra equations, so the dimension is $7$. We find involution and the solutions depend on $2$ functions of $2$ variables and $3$ functions of $1$ variable (and also $3$ constants because $s_0'=3$). Notably, this is different from the characters we found in Example~\ref{example curl pde}. We see again that the top nonzero character, $s_2=2$, is the same no matter which method we use.
\end{example}

Now we discuss the method for constructing a generic tableau, which is necessary to find the true Cartan characters of the system unless one gets lucky and finds involution on the first try. This is called \emph{borrowing} because it is essentially a strictly triangular change of coframe that pushes (linearly independent) polars as far to the left of the tableau as possible by adding them to the elements already there:
\begin{enumerate}
    \item To construct a generic tableau, take a row which represents a $p$-form. Permuting the $\omega^i$, we can get any polar in that row to appear in grade $p-1$: $\pi^\lambda\wedge \omega^{1\ldots p-1}$. 
    \item If there is another polar in that row, say in grade $q$, add a multiple of $\omega^p$ to $\omega^q$ to \emph{borrow} it to grade $p$. 
    \item Continue this way: for each row representing a $p$-form in $\calI$, arrange polars in successive grades, starting at grade $p-1$, followed by any nonpolar entries in that row.
    \item Write wedge products $\omega^{i_1\ldots i_q}$ with $i_1<\cdots <i_q$. Order any two of them by the last entry (the grade) $i_q$, then by next to last, and so on. Borrow to have polars arising in sorted order before any other entries.
    \item Since this occurs for some linear transformation of the $\omega^i$, it also occurs for all linear transformations of the $\omega^i$ except for those with certain vanishing minors. We can thus borrow simultaneously in all rows by a generic linear transformation.
\end{enumerate}

In the end, polars are ``concentrated'' in the low grades of the tableau as much as it is possible, which guarantees that the flag determined by this tableau is generic, and so the tableau's characters are the Cartan characters, and Cartan's Test can be applied.


\begin{example}[Borrowing to produce a generic flag]
    The tableau 
    \[\left(\begin{array}{|c|c}
        \boxed{\pi^1} & 0 \\
        0 & \pi^1
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \hline \omega^{12}\\
        \hline \omega^3
    \end{array}\right)
    \]
    has a polar appearing in grade $2$. Permuting indices $1$ and $3$:
    \[\left(\begin{array}{c|c}
        0 & \pi^1 \\
        \boxed{\pi^1} & 0
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \omega^{1}\\
        \hline \omega^{23}
    \end{array}\right)
    \]
    puts it in grade $1$. Now the flag is generic.
\end{example}



\begin{example}[Borrowing]\label{example tableau of orthogonal 3-webs}
    Consider an \gls{eds} generated by $1$-forms $\theta^1,\theta^2,\theta^3$ and $3$-forms 
    \[\omega^{12}\wedge\pi^1,\quad \omega^{31}\wedge\pi^2,\quad \omega^{23}\wedge\pi^3,\]
    with coframe $\theta^a,\omega^i,\pi^\lambda$ (this system actually describes triply orthogonal webs on $3$-dimensional Riemannian manifolds, see Example~\ref{example orthogonal 3-webs}). The tableau is 
    \[
    \left(\begin{array}{|c|cc}
        0 & 0 & \boxed{\pi^1}\\
        0 & \boxed{\pi^2} & 0\\
        \boxed{\pi^3} & 0 & 0
    \end{array}\right)\wedge 
    \left(\begin{array}{c} \hline 
        \omega^{12}\\ \hline
        \omega^{13}\\
        \omega^{23}
    \end{array}\right),
    \]
    which gives $(s_1',s_2',s_3')=(0,1,2)$. It is not obvious whether this flag is generic (however, we will see that a generic flag must always have $s'_1\geq s'_2\geq\cdots\geq s'_n$). Let us try applying Cartan's Test right away. $3$-dimensional integral elements are described by 
    \[\begin{pmatrix}
        \pi^1\\\pi^2\\\pi^3
    \end{pmatrix}
    =\begin{pmatrix}
        0 & p^1_2 & p^1_3\\
        p^2_1 & 0 & p^2_3\\
        p^3_1 & p^3_2 & 0
    \end{pmatrix}
    \begin{pmatrix}
        \omega^1\\\omega^2\\\omega^3
    \end{pmatrix},
    \]
    so it's a $6$-dimensional space at each point. Meanwhile, $s_1'+2s_2'+3s_3'=8>6$, so this is not involutive. 

    It turns out that it is possible to borrow:
    \[\begin{pmatrix}
        \omega^1\\\omega^2\\\omega^3
    \end{pmatrix}=
    \begin{pmatrix}
        \omega^{\prime 1}\\
        \omega^{\prime 2}\\
        \omega^{\prime 1}+\omega^{\prime 2}+ \omega^{\prime 3}
    \end{pmatrix},
    \]
    yielding the new tableau 
    \[
        \left(\begin{array}{|c|cc}
            \boxed{-\pi^1} & 0 & \pi^3\\
            \boxed{-\pi^2} & \pi^2 & 0\\
            \boxed{\pi^3} & 0 & 0
        \end{array}\right)\wedge 
        \left(\begin{array}{c}
            \hline \omega^{\prime 12}\\
            \hline \omega^{\prime 13}\\
            \omega^{\prime 23}
        \end{array}\right).
    \]    
    Now $(s_1',s_2',s_3')=(0,3,0)$ and $s_1'+2s_2'+3s_3'=6$, making the system involutive: there are $3$-dimensional integral manifolds.
\end{example}


Borrowing can generate new torsion. The torsion is absorbable iff there exists an integral element $E$, on which there holds $\pi=P\omega$ with some (rectangular) matrix $P$. We can absorb the torsion by subtracting $P\omega$ from $\pi$. Thus, there is a torsion-free tableau iff there is a generic torsion-free tableau.


\begin{example}[Nonlinearity and borrowing]
    Consider the tableau 
    \[\left(\begin{array}{cc}
        \boxed{\pi^1} & 0 \\
        \boxed{\pi^2} & \boxed{\pi^3}
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \omega^1\\
        \omega^2
    \end{array}\right)+
    \left(\begin{array}{c}
        \boxed{\pi^4}\wedge\pi^2\\
        0
    \end{array}\right)
    \]
    with a polar in the nonlinearity (which always belongs to the highest grade, in this case $2$). We can borrow it into the tableau by adding $\omega^2$ to $\pi^2$: $\pi^{\prime 2}\coloneqq \pi^2+\omega^2$ and
    \[\left(\begin{array}{cc}
        \boxed{\pi^1} & \boxed{\pi^4} \\
        \boxed{\pi^{\prime 2}} & \boxed{\pi^3}
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \omega^1\\
        \omega^2
    \end{array}\right)-
    \left(\begin{array}{c}
        0\\
        \omega^{12}
    \end{array}\right)+
    \left(\begin{array}{c}
        \pi^4\wedge\pi^{\prime 2}\\
        0
    \end{array}\right).
    \]
    This produces torsion, but we can absorb it by redefining $\pi^1$ as in Example~\ref{example absorbing torsion}.
\end{example}

\begin{example}[Nonlinearity and absorption]
    \[\left(\begin{array}{cc}
        \boxed{\pi^1} & \boxed{\pi^2}     
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \omega^1\\
        \omega^2
    \end{array}\right)+\boxed{\pi^3}\wedge\pi^2
    \]
    has a polar in the nonlinearity, but we can absorb it by redefining $\omega^{\prime 2}\coloneqq \omega^2-\pi^3$.

    Some tableaux have non-absorbable polars in the nonlinearity:
    \[\left(\begin{array}{cc}
        \boxed{\pi^1} & \boxed{\pi^2}     
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \omega^1\\
        \omega^2
    \end{array}\right)+\boxed{\pi^3}\wedge\boxed{\pi^4}.
    \]
    Any polar in the nonlinearity can be demoted to a new $\omega^i$ $1$-form, but we won't need to do so.
\end{example}


\begin{example}[Integral elements]
    Consider the tableau 
    \[\left(\begin{array}{ccc}
        \boxed{\pi^1} & \boxed{\pi^4} & \boxed{\pi^6} \\
        \boxed{\pi^2} & \boxed{\pi^5} & \pi^1-\pi^5\\
        \boxed{\pi^3} & \pi^2 & \pi^1+\pi^2\\
        \pi^1-\pi^2 & 0 & \pi^3
    \end{array}\right)\wedge 
    \left(\begin{array}{c}
        \omega^1\\
        \omega^2\\
        \omega^3
    \end{array}\right).
    \]
    Take any $3$-dimensional linear tangent subspace $E$ coframed by $\omega^1,\omega^2,\omega^3$ and on which $\theta^a=0$. Then $E$ has some coefficients $\pi^\lambda=p^\lambda_j\omega^j$. Plug in to the tableau to find equations for integral elements. Since $\omega^{ij}=-\omega^{ji}$, each tableau entry in column $i$ has coefficient of $\omega^j$ exactly equal to the tableau entry in column $j$ coefficient of $\omega^i$:
    \begin{align}
        p^1_2 &= p^4_1, & p^1_3&=p^6_1, & p^4_3&=p^6_2,\\
        p^2_2 &= p^5_1, & p^2_3&=p^1_1-p^5_1, & p^5_3&=p^1_2-p^5_2,\\
        p^3_2&=p^2_1, & p^3_3&=p^1_1+p^2_1, & p^2_3&=p^1_2+p^2_2,\\
        p^1_2-p^2_2&=0, & p^1_3-p^2_3&=p^3_1, & 0&=p^3_2.
    \end{align}
\end{example}








\section{Linear \texorpdfstring{\glspl{eds}}{EDSs}}\label{sec: linear eds}


Although the methods demonstrated in the above \sect s may allow one to quickly establish the involutivity of a given system, they have several serious limitations. First of all, Cartan's Test requires us to directly compute the dimension of the space of integral elements, which can be quite difficult. Secondly, Cartan's Test may fail, which does \emph{not} mean that the system is not involutive. It turns out that by \emph{linearizing} a given system, one can define a relatively simple linear-algebraic procedure for addressing both of these issues.

First we bring back the extra ingredient that imposes a transversality condition on integral manifolds, because it will be essential for defining the concept of linearity.

\begin{defn}[Independence condition]
    Recall that an \gls{eds} with an independence condition is a tuple $(M,\calI,\sfv)$, where $(M,\calI)$ is an \gls{eds} and $\sfv$ is a decomposable $n$-form 
    \[\sfv=\omega^1\wedge\cdots\wedge\omega^n,\]
    where $\omega^i$ are $1$-forms (and are typically chosen to be part of the coframe for determining the tableau). We assume that $\sfv_m\notin \calI_m$ for any $m\in M$ and two independence conditions $\sfv,\sfv'$ are considered equivalent if $\sfv\equiv \lambda\sfv'\pmod{\calI}$ for some nonzero function $\lambda$.

    In intrinsic terms, under suitable constant rank assumptions, the degree one piece, $\calI^1$, is given by the sections of a subbundle $I<\T^\ast M$. There should be an additional subbundle $J<\T^\ast M$ with 
    \[\left\{\begin{array}{l}
        I<J<\T^\ast M\\\rank J\slash I=n,
    \end{array}\right.\]
    The $\omega^i$ above give local sections of $J$ that induce a framing of $J\slash I$ and $\sfv$ represents a non-vanishing section of $\bigwedge^n(J\slash I)$. We shall usually work locally and write $\sfv=\omega^1\wedge\cdots\wedge\omega^n$. An integral element for $(\calI,\sfv)$ is an $n$-dimensional integral element for $\calI$ on which $\sfv$ is non-vanishing, and integral manifolds are defined correspondingly. The space of (automatically $n$-dimensional) integral elements is denoted $\calV(\calI,\sfv)\subset\Gr_n(\T M)$. 
\end{defn}

The goal of Cartan's theory is to characterize criteria for involutivity of differential systems, i.e., the existence of ordinary integral elements. 


\begin{example}[A non-involutive system]
    On a $6$-dimensional manifold with coframe $\{\theta^1,\theta^2,\omega^1,\omega^2,\pi^1,\pi^2\}$, we consider a Pfaffian system $\theta^1=\theta^2=0$ with independence condition $\omega^1\wedge\omega^2\neq 0$ and structure equations 
    \begin{align}
        \dd\theta^1\equiv \pi^1\wedge\omega^1 \pmod{\calI},\\
        \dd\theta^2\equiv \pi^1\wedge\omega^2\pmod{\calI}.
    \end{align}
    We will denote the dual frame of vector fields by $\partial_{\theta^i}$ etc. A $1$-dimensional integral element of $\calI$ is a vector of the form 
    \[X=X^0\partial_{\pi^1}+X^1\partial_{\pi^2}+X^2\partial_{\omega^1}+X^3\partial_{\omega^2}.\]
    Using self-evident notation, the polar equations 
    \[\dd\theta^1(X\wedge\wt X)=0=\dd\theta^2(X\wedge\wt X)\]
    of the vector $X$ are 
    \[\left\{\begin{array}{l}
                X^0\wt X^2-X^2 \wt X^0=0,\\
                X^0\wt X^3-X^3 \wt X^0=0.        
    \end{array}\right.\]
    This linear system has rank $2$ if $X^0\neq 0$. The latter is therefore the condition for $E^1=\<X\>$ to be regular.

    On the other hand, any $2$-plane $E^2$ on which $\theta^1=\theta^2=0$ and $\omega^1\wedge\omega^2\neq 0$ is given by linear equations in the tangent space 
    \[\left\{\begin{array}{l}
        \pi^1=p_1^1\omega^1+p^1_2\omega^2,\\
        \pi^2=p^2_1\omega^1+p^2_2\omega^2.        
    \end{array}\right.\]
    The condition that this $2$-plane be integral is $p^1_1=p^1_2=0$. Thus, any $E^1<E^2$ will have a basis vector 
    \[\eta=X^1\partial_{\pi^2}+X^2\partial_{\omega^1}+X^3\partial_{\omega^2}.\]
    Since we found above that $X^0\neq 0$ is required for regularity, we see that $E^2$ contains no regular integral lines, and is therefore not ordinary. 

    This can also be seen more intuitively from the fact that the structure equations imply that on any integral manifold $\pi^1\wedge\omega^1=\pi^1\wedge\omega^2=0$, which, combined with the independence condition, implies $\pi^1=0$. Thus, $\pi^1$ and $\dd\pi^1$ must be added to the list of generators of the system, and integral manifolds must satisfy additional equations which result through differentiations and not just through algebraic operations. This is one of the simplest causes for failure of involution. We can also note that under the independence condition $\pi^1\wedge\pi^2\neq 0$ this system becomes involutive.
\end{example}

\begin{lem}
    On a vector space $V$ with a filtration $I<J<V^\ast$ with $\dim J\slash I=n$, the space of $n$-planes $E\in\Gr_n(V)$ which satisfy $E<\Ann(I)$ and $J\slash I\cong E^\ast$ carries a natural affine structure.
\end{lem}
\begin{proof}
    First let $I=\{0\}$. For this we use coordinates $(\bf{x},\bf{u})$ on $\bbR^{n+s}$ as usual. The $n$-planes on which $\dd x^1\wedge\cdots\wedge\dd x^n\neq 0$, i.e., $n$-planes that project isomorphically onto the $\bbR^n$ factor, are given by equations 
    \[u^\lambda=p^\lambda_i x^i.\]
    Under an invertible linear change 
    \begin{align}
        \wt x^i&=A^i_jx^j,\\
        \wt u^\lambda&=B^\lambda_\mu u^\mu +C^\lambda_ix^i,
    \end{align}
    we have 
    \[\wt p^\lambda_i A^i_j=B^\lambda_\mu p^\mu_j+C^\lambda_j\label{eq 11 Bryant}\]
    or, in matrix notation, $\wt{\bf{p}}=B\bf{p}A^{-1}+CA^{-1}$. It follows that $\bf{p}$ transforms affinely.

    To treat the general case when $I\neq \{0\}$, we consider $\bbR^{n+h+s}$ with coordinates $(\bf{x},\bf{y},\bf{u})$. Then the $n$-planes on which $\dd \bf{y}=0$ holds with the same independence condition are given by linear equations 
    \begin{align}
        y^a&=p^a_ix^i,\\
        u^\lambda&=p^\lambda_ix^i,\\
        p^a_i&=0.
    \end{align}
    Under an invertible linear change 
    \begin{align}
        \wt{\bf{y}}=D\bf{y},\quad \wt{\bf{x}}=A\bf{x}+E\bf{y},\quad \wt{\bf{u}}=B\bf{u}+C\bf{x}+F\bf{y},
    \end{align}
    it is easy to check that the $p^a_i$ and $p^\lambda_i$ transform \emph{quadratically}. However, when we impose the third equation ($p^a_i=0$), the remaining nonzero $p^\lambda_i$ transform by (\ref{eq 11 Bryant}) again. Taking $I$ to be spanned by the $y^a$ and $J\slash I$ by the $x^i$, by virtue of $\bf{y}=0$ on $E$ the restriction map $J\slash I\to E^\ast$ is well-defined and the condition that this be an isomorphism is $\dd x^1\wedge\cdots\wedge\dd x^n\neq 0$ on $E$.
\end{proof}

This implies that the fibers of the space $\Gr_n(\Ann(I),\omega)$ of tangent $n$-planes satisfying $\restr{\calI^1}{E}=\{0\}$ and $\restr{\omega}{E}\neq 0$ (non-vanishing) carry natural affine structures. Systems for which this property holds not just for $\Gr_n(\Ann(I),\omega)$ but for the space $\calV(\calI,\sfv)$ of true integral elements are named by the following definition.

\begin{defn}[Linear \gls{eds}]
    An \gls{eds} with independence condition $(\calI,\sfv)$ on a manifold $M$ is called linear if the fibers of $\calV(\calI,\sfv)\to M$ are affine linear subspaces of the fibers of $\Gr_n(\Ann(I),\sfv)\to M$.
\end{defn}

Crucially, the definition of linearity in this discussion requires an independence condition. For an \gls{eds} on a manifold the concept of linearity only makes sense infinitesimally. The integral elements of $(\calI,\sfv)$ are the infinitesimal solutions and the above definition is the corresponding concept of linear. We will see that many but not all \gls{eds} are linear. Moreover, given any \gls{eds} $\calI$ and an integral element $E$, we will define its linearization $(\calI_E,\sfv_E)$ at $E$, which will correspond to linearizing an arbitrary PDE at a solution. Before doing this we need to develop simpler criteria for linearity. In fact, both these criteria and the linearization are implicit in the above proofs of the results of Cartan-K\"ahler theory, e.g., Proposition~\ref{prop III.1.15 Bryant}.


Let us locally choose a coframe $\theta^1,\ldots,\theta^h;\omega^1,\ldots,\omega^n;\pi^1,\ldots,\pi^s$ adapted to the filtration $I<J<\T^\ast M$. Differential forms on $M$ can then be locally written, using multi-index notation, as 
\[\psi=\psi_{\Lambda KA}\pi^\Lambda\wedge\omega^K\wedge\theta^A.\label{eq iii.14 Bryant}\]

\begin{defn}[Linearly generated \gls{eds}]
    $(M,\calI,\sfv)$ is linearly generated if locally it is algebraically generated by forms $\psi$ which are of combined total degree one in the $\theta^a$ and $\pi^\lambda$. It follows that it is algebraically generated by $\{\theta^a,\psi_{\lambda K}\pi^\lambda\wedge\omega^K\}_{a,\lambda,K}$, and it is clear that this condition is intrinsic.
\end{defn}

Integral elements of this system are then defined by the equations 
\[\left\{
    \begin{array}{l}
        \theta^a=0,\\
        \pi^\lambda=p^\lambda_i\omega^i,\quad \text{where}\\
        \sum_{\lambda,K}\psi_{\lambda K}p^\lambda_i \omega^i\wedge\omega^K=0.
    \end{array}
\right.\]
Since these equations are linear in the $p_i^\lambda$, we conclude that \emph{linearly generated systems are linear}.

The following examples are generated by forms in degrees $p\geq 2$. The very important case of linear Pfaffian systems $(p=1)$ will be treated separately below. In these examples we denote by $\Omega^{\smbullet,1}(M)$ the forms (\ref{eq iii.14 Bryant}) that are  at most linear in the $\pi^\lambda$, i.e., that have $|\Lambda|\leq 1$. The system $(\calI,\sfv)$ is then linearly generated if it is algebraically generated by $\Omega^{\smbullet,1}(M)\cap \calI$.


\begin{example}[Lie III]\label{example Lie III EDS}
    We will now use the Cartan-K\"ahler Theorem to provide another proof of Lie's Third Fundamental Theorem~\ref{thm local Lie's third}. Let $\bbR^n$ be endowed with a Lie algebra structure $[~,~]$. It suffices to show that there exists a $0$-neighborhood  $U\subset\bbR^n$ and an $\bbR^n$-valued $1$-form $\theta$ on $U$ such that $\eta_0:\T_0\bbR^n\to\bbR^n$ is an isomorphism and $\dd \theta+\frac12[\theta,\theta]=0$. Then, Cartan's Fundamental Theorem can be employed to derive a local Lie group structure (by repeating parts of the proof of Theorem~\ref{thm 8.7 Sharpe}).

    Choose a basis $e_1,\ldots,e_n$ in $\bbR^n$ and let $c_{ij}^k$ be the structure constants in this basis. We need to find a $1$-form with components $\theta^i=\theta^i_j(\bf{x})\dd x^j$, with $\theta^i_j(\bf{x})$ an invertible matrix at each $\bf{x}(U)$. We want $\theta$ to satisfy $0=\dd\theta^i+\frac12 c^i_{jk}\theta^j\wedge\theta^k$. Let $M\coloneqq \bbR^n\times\GL_n(\bbR)$ with coordinates $x^i,\theta^i_j$. Take the \gls{eds} $(M,\calI)$ generated by the components $\vartheta^i$ of the form 
    \[\vartheta=\dd(\theta_j\dd x^j)+\frac12[\theta_j\dd x^j,\theta_i\dd x^i].\]
    It is easy to check, using the Jacobi identity, that $\dd\vartheta\equiv 0\pmod{\vartheta}$ is satisfied. This confirms that $\calI$ is a differential ideal. As independence condition, we take $J=\<\dd x^1,\ldots,\dd x^n\>$. Note that $\calI$ is linearly generated: we have $\vartheta^i=\dd p^i_j\wedge\dd x^j+(\text{terms quadratic in }\dd x^i)\in\Omega^{\smbullet,1}(M)$. More explicitly, we may write 
    \[\vartheta^i=\dd p^i_j\wedge\dd x^j+\frac12 T^i_{jk}\dd x^k\wedge\dd x^j=\pi^i_j\wedge\dd x^j,\]
    where $\pi^i_j=\dd\theta^i_j+\frac12 T^i_{jk}\dd x^k$ and $T^i_{jk}$ is some quadratic polynomial expression in the structure constants $c^k_{ij}$. Note that $\{\dd x^i,\pi^i_j\}$ form a coframe on $M$. We have 
    \[
        \begin{pmatrix}
            \vartheta^1\\
            \vdots\\
            \vartheta^n
        \end{pmatrix}=
        \begin{pmatrix}
            \pi^1_1 & \pi^1_2 & \cdots & \pi^1_n\\
            \vdots & & & \vdots \\
            \pi^n_1 & \pi^n_2 & \cdots & \pi^n_n
        \end{pmatrix} \wedge 
        \begin{pmatrix}
            \dd x^1\\ \vdots \\ \dd x^n
        \end{pmatrix}.
    \]
    All of the components of the tableau here are linearly independent, therefore we read off Cartan characters $s_1=\cdots=s_n=n$. The predicted dimension of the space of ordinary integral $n$-planes is thus $\dim M+\sum_p ps_p=\dim M+\frac{n(n+1)}{2}$. To apply Cartan's Test, we need to compute the actual dimension of the space of integral $n$-planes. They are described by the only equation $\pi^i_j=p^i_{jk}\dd x^k$ with $p^i_{jk}=p^i_{kj}$, so they are parametrized by $\dim_M + \frac{n(n+1)}{2}$. We conclude involution and the existence of a local Maurer-Cartan form.
\end{example}

\begin{example}[Closed self-dual forms: \ref{ex self-dual equations} and \ref{example self-dual equations 3} continued]
    Let $(X,\sfg)$ be an oriented Riemannian analytic $4$-manifold. Let $M=\bigwedge^2_+ X$ denote the bundle of self-dual $2$-forms on $X$. Let $\varphi\in\Omega^2(M)$ denote the tautological $2$-form on $M$ which satisfies $\varphi(X_1,X_2)=\alpha(\pi_\ast X_1,\pi_\ast X_2)$, where $X_i\in \T_\alpha M$ and $\pi:M\to X$ is the projection. Thus $\restr{\varphi}{\T_\alpha M}=\pi^\ast(\alpha)$. This form $\varphi$ has the ``reproducing'' property: if $\beta=\star\beta$ is a $2$-form on $X$, then when we regard it as a section of $M\to X$, we have $\beta^\ast\varphi=\beta$. Moreover, $\beta^\ast(\dd\varphi)=\dd\beta$. Let $\calI$ be the system algebraically generated by $\dd\varphi\in\Omega^3(M)$. Clearly $\calI$ is differentially closed. Let $\omega=\pi^\ast\sfv_\sfg$, where $\sfv_\sfg$ is the canonical volume form on $X$. The integrals of $(\calI,\sfv)$ are locally sections of $M\to X$ which are the graphs of local closed self-dual $2$-forms on $X$. 
    
    We claim that $(\calI,\sfv)$ is linearly generated and involutive. To see this, it suffices to work locally, so let $\omega^1,\ldots,\omega^4$ be an oriented orthonormal coframe on $U\subset X$. Of course, $\restr{M}{U}\cong U\times\bbR^3$ and there exist unique linear coordinates $p_2,p_3,p_4$ on the $\bbR^3$ factor so that, on $\restr{M}{U}$, we have 
    \[\varphi=p_2(\omega^{12}+\omega^{34})+p_3(\omega^{13}+\omega^{42})+p_4(\omega^{14}+\omega^{23}).\]
    Now $\omega=\omega^1\wedge\cdots\wedge\omega^4$, and 
    \[\dd\varphi=\dd p_2\wedge(\omega^{12}+\omega^{34})+\dd p_3\wedge(\omega^{13}+\omega^{42})+\dd p_4\wedge(\omega^{14}+\omega^{23})+T,\]
    where $T$ is a $3$-form which is cubic in the $\omega^i$. Clearly $\dd\varphi\in\Omega^{\smbullet,1}(M)$, so $(\calI,\sfv)$ is linearly generated. It is not difficult to show that there exist forms $\pi_2,\pi_3,\pi_4$ on $\restr{M}{U}$ so that 
    \[\dd\varphi=\pi_2\wedge(\omega^{12}+\omega^{34})+\pi_3\wedge(\omega^{13}+\omega^{42})+\pi_4\wedge(\omega^{14}+\omega^{23}),\]
    where $\pi_i\equiv \dd p_i\pmod{\omega^1,\ldots,\omega^4}$. Given this, it is easy to see that the dimension of the space of integral elements at a single point of $M$ is $8$. On the other hand, we easily compute that for any integral flag, the Cartan characters are $s_0=s_1=0$, $s_2=1$, $s_3=2$, $s_4=0$, and so the character sum is $\sum_p ps_p=8$. Thus, Cartan's Test is satisfied and the system is involutive. We conclude that \emph{analytic closed self-dual $2$-forms always exist locally on $(X,\sfg)$ and they are unique if initial data are specified in the form of a closed analytic $2$-form on a hypersurface ($3$-dimensional) $H<X$}.
\end{example}


In order to motivate the notion of linearity, we shall define the \emph{linearization} $\calI_E$ of an arbitrary \gls{eds} $\calI$ at an $n$-dimensional integral element $E<\T_m M$. The linearization will have the following properties:
\begin{enumerate}[label=(\roman*)]
    \item $(\calI_E,\sfv_E)$, where $\sfv_E=\restr{\sfv}{E}$, is an \gls{eds} with independence condition defined on the vector space $M_E\coloneqq E\oplus Q$ with $Q\coloneqq \T_m M\slash E$. 
    \item $(\calI_E,\sfv_E)$ is a \emph{constant coefficient}, linearly generated (and hence linear) \gls{eds}. That is, it is defined on a vector space and generated by translation-invariant forms. In theory we would need to take the resulting differential ideal in the set of all smooth forms, however it turns out that restricting to the translation-invariant ones, i.e., simply exterior forms, is sufficient. In particular, all exterior derivatives vanish.
    \item if $E$ is an ordinary integral element of $\calI$, then $(\calI_E,\sfv_E)$ is involutive and has the same Cartan characters as $E$. (In particular, this means that \emph{all} integral elements of $(\calI_E,\sfv_E)$ have the same Cartan characters.)
\end{enumerate}
An explicit coordinate construction of the linearization will be given below. For now, to define $\calI_E$, we let $\Ann(E)<\T^\ast_m M$ be the space of covectors annihilating $E$ and we denote by $\<\Ann(E)\>_{\mathrm{alg}}\subset \bigwedge\T^\ast_m M$ the exterior ideal generated by them. Then, because $E$ is an integral element, we have $\calI_m\subset \<\Ann(E)\>_{\mathrm{alg}}$. Note the natural isomorphisms $\T^\ast_m M\cong \Ann(E)\oplus E^\ast$ and $\Ann(E)\cong Q^\ast$. There is a canonical short exact sequence 
\[0\to \<\bigwedge^2 \Ann(E)\>_{\mathrm{alg}}\hookrightarrow \<\Ann(E)\>_{\mathrm{alg}}\to \Ann(E)\wedge \bigwedge E^\ast\cong Q^\ast\wedge\bigwedge E^\ast\to 0.\]
This describes the splitting of the space of all forms that contain at least one element of $\Ann(E)$ as a factor into the first space, consisting of forms that are of degree $2$ or more in $\Ann(E)$, and the third one, of forms that are strictly linear in $\Ann(E)$. The latter is exactly the space of ``linearized forms''.

\begin{defn}[Linearized \gls{eds}]\label{def linearized eds}
    We let $P_E\subset Q^\ast\otimes \bigwedge E^\ast\subset \bigwedge(Q^\ast\oplus E^\ast)$ denote the image of $\calI_m$ and define $\calI_E$ to be the ideal in $\bigwedge(Q^\ast\oplus E^\ast)$ generated by $P_E$. Then $\calI_E$ is an ideal of exterior forms on $M_E=E\oplus Q$. We let $\sfv_E$ be a volume form on $E$.
    $(M_E,\calI_E,\sfv_E)$ is the linearization of $\calI$ at $E$.
\end{defn}

When expressed in a set of linear coordinates on $E\oplus Q$, the elements of $\calI_E$ have constant coefficients and hence are closed forms. In order to see that $(\calI_E,\sfv_E)$ is linearly generated, it is instructive to see what this construction means in coordinates. For this we choose a local coframe $\omega^1,\ldots,\omega^n,\pi^1,\ldots,\pi^s$ on $M$ so that $\Ann(E)=\<\pi^1_m,\ldots,\pi^s_m\>$. We then choose linear coordinates $x^1,\ldots,x^n$ on $E$ and $u^1,\ldots,u^s$ on $Q$ such that $\restr{\omega^i_m}{E}=\dd x^i$ and $\restr{\pi^\lambda_m}{Q}=\dd u^\lambda$. Let $\psi\in\calI$ and write locally
\[\psi=f_I\omega^I+f_{\lambda J}\pi^\lambda\wedge\omega^J+f_{\lambda\mu K}\pi^\lambda\wedge\pi^\mu\wedge\omega^K+\cdots.\]
We note that, because $\restr{\psi}{E}=0$, $f_I(m)=0$, and we define 
\[\wb\psi\coloneqq (f_{\lambda J}\dd u^\lambda\wedge\dd x^J)_m\in Q^\ast \otimes \bigwedge E^\ast < \bigwedge(Q^\ast\oplus E^\ast).\label{eq iv.17 Bryant}\]
Intuitively, $\wb\psi$ is obtained by substituting $m$, i.e., by freezing coefficients, and ignoring higher order terms in the $\pi^\lambda$, that is, terms that vanish to second order on $E$. It is clear that 
\[P_E=\{\wb\psi\mid \psi\in\calI\}\label{eq iv.3.18 Bryant}\]
is the above set of algebraic generators of $\calI_E$. Thus, $(\calI_E,\sfv_E)$ is linearly generated. Moreover, the following is an immediate consequence of Proposition~\ref{prop iii.1.13, 2.4 Bryant}.


\begin{prop}[{{\cite[Prop.~IV.2.6]{Bryant}}}]\label{prop iv.2.6 Bryant}
    Let $E$ be an integral element of $\calI$. Let $E^p<E$ be any $p$-plane and let $H(E^p)<\T_m M$ be the polar space of $E^p$ as an integral element of $\calI$. Then, as an integral element of $\calI_E$, the polar space of $E^p$ is $E\oplus (H(E^p)\slash E)<E\oplus Q$.
\end{prop}
In other words, the dimensions of the polar spaces are unchanged by linearization. It remains to establish property (iii) of the linearization, and we will do so in \S\ref{sec: tableau of linearized eds}.








\section{Tableaux}\label{sec tableaux}

The rest of this \chap\ is concerned with understanding the relationship between the linearized system and the original system, as well as with what one should do when involutivity fails. We start by studying the \emph{constant-coefficient} systems obtained upon linearizing at a single point.


Throughout this \chap, $V$ is an $n$-dimensional vector space, and $W$ is an $s$-dimensional space. We use the index ranges $1\leq i,j,k\leq n$, $1\leq a,b,c\leq s$. $V$ has basis $\{v_i\}_{i=1}^n$ and $V^\ast$ the corresponding dual basis $\{v^i\}_{i=1}^k$; $W$ has basis $\{w_a\}_{a=1}^s$ and $W^\ast$ the dual basis $\{w^a\}_{a=1}^s$.
Let $x=x^iv_i$, $u=u^aw_a$ denote elements of $V$ and $W$, respectively. We will consider $\bf{x}=(x^1,\ldots,x^n)$, respectively $\bf{u}=(u^1,\ldots,u^s)$, as coordinate functions on $V$ and $W$ respectively, so that $v^i=\dd x^i$, $v_i=\partial_{x^i}$, and $w^a=\dd u^a$, $w_a=\partial_{u^a}$. Any first-order, constant-coefficient, homogeneous system of PDEs for maps $f:V\to W$ is given in coordinates by equations
\[B_a^{ri}\frac{\partial u^a}{\partial x^i}=0,\quad 1\leq r\leq R,\label{eq 5.1 Ivey}\]
where the $B_a^{ri}$ are constants. 
% For example, the Cauchy-Riemann system $u^1_{x^1}-u^2_{x^2}=0$, $u^1_{x^1}+u^2_{x^1}=0$ has $B_1^{11}=B_2^{21}=B_1^{22}=1$, $B_2^{12}=-1$, $B_1^{12}=B_2^{11}=B_1^{21}=B_2^{22}=0$.
To phrase (\ref{eq 5.1 Ivey}) in a coordinate-free manner, given a map $f:V\to W$, we define its linearization (or ``Gauss map'')
\begin{align}
    \gamma_f:V &\to W\otimes V^\ast\cong \Hom(V,W),\\
    x&\mapsto \frac{\partial f^a(x)}{\partial x^i}v^i\otimes w_a=\frac{\partial f^a(x)}{\partial x^i} \dd x^i\otimes \partial_{u^a},
\end{align}
where we identify $\T_xV\cong V$, $\T_{f(x)}W\cong W$ and translate the differential to the origin. In other words, we identify $\rmJ^1_x(V,W)\slash \rmJ^0_x(V,W)$ with $W\otimes V^\ast$. More generally, we will use the identification
\[\rmJ^k_x(V,W)\slash \rmJ^{k-1}_x(V,W)\cong W\otimes \bigodot^k V^\ast,\]
of the ``highest order terms of $k$-jets'' with the homogeneous $W$-valued polynomials of degree $k$ on $V$. Now, our system may be described as the $R$-dimensional (\gls{wlog} we can assume the equations are independent) subspace
\[B=\<B_a^{ri}\partial_{x^i}\otimes\dd u^a\mid 1\leq r\leq R\> < W^\ast\otimes V.\]
We think of $B$ as the space of equations. A map $f$ is a solution if $B$ annihilates $\gamma_f(x)$ for all $x\in V$, i.e., $b(\gamma_f(x))=0$ for all $x\in V,b\in B$.
$B$ is often called the space of \emph{symbol relations} (it generalizes the \emph{principal symbol} used in standard PDE terminology). We think of $B$'s annihilator $\Ann(B)\subset W\otimes V^\ast$ as the space of admissible first derivatives. In computations we will often use $\Ann(B)$ rather than $B$, so it has a special name.

\begin{defn}[Tableau]\index{Tableau}
    A tableau is a linear subspace $A\subset W\otimes V^\ast$. A tableau $A$ determines a first-order, constant-coefficient, homogeneous system of PDEs for maps $f:V\to W$, namely the system whose solutions are those maps $f$ satisfying $\gamma_f(V)\subset A$.
\end{defn}

Note that systems defined by a tableau always have linear solutions 
\[u(x)=u_0+A_0x,\quad u_0\in W,A_0\in A.\] 
We will be interested in what higher-order terms can appear in the Taylor series of an analytic solution.

\begin{example}
    The equation $u_x=v_y$ with $W=V=\bbR^2$ has symbol relations 
    \[B=\<\dd u\otimes \partial_{x}-\dd v\otimes \partial_{y}\>< W^\ast\otimes V\]
    and tableau 
    \[A=\Ann(B)=\<(\partial_{u}\otimes \dd x+\partial_{v}\otimes\dd y),\partial_{u}\otimes \dd y,\partial_{v}\otimes \dd x\>< W\otimes V^\ast.\label{eq 5.2 Ivey}\]
    Often it will be convenient to identify $V$ with $\bbR^n$ and $W$ with $\bbR^s$ using our fixed bases to write expressions in matrix form. For example, (\ref{eq 5.2 Ivey}) becomes 
    \[A=\left\{
    \begin{pmatrix}
        p_u&q_u\\p_v&-p_u
    \end{pmatrix}\middle| p_u,q_u,p_v\in\bbR
\right\}.\]
\end{example}

\begin{example}[\ref{ex ux=vy 1} continued]
    We revisit the canonical \gls{eds} for $u_x=v_y$. A coframe, aside from $\theta^u,\theta^v$, consists of $\omega^1=\dd x$, $\omega^2=\dd y$, and $\{\pi^\lambda\}=\{\dd p_u,\dd p_v,\dd q_u\}$. We can obtain the tableau by computing the derivatives of the generating $1$-forms $\theta^u,\theta^v$:
    \[\dd \begin{pmatrix}
        \theta^u\\\theta^v
    \end{pmatrix}=
    \begin{pmatrix}
        -\dd p_u & -\dd q_u\\
        -\dd p_v & \dd p_u
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \dd x\\ \dd y
    \end{pmatrix}.
    \]
    Note that the structure of this tableau matches the one found in the preceding example.
    The first column of the tableau contains $s_1=2$ independent entries, and the second contains $s_2=1$ more independent entry. These characters match our finding in Example~\ref{ex ux=vy 1}.
\end{example}


\begin{example}\label{ex tableau}
    \begin{enumerate}
        \item The Cauchy-Riemann system $u_{x}=v_{y}$, $u_{y}=-v_{x}$ has tableau 
        \begin{multline}
            A=\<(\partial_{u}\otimes\dd x+\partial_{v}\otimes\dd y),(-\partial_{v}\otimes \dd x+\partial_{u}\otimes\dd y)\>\cong\\
            \cong \left\{
                \begin{pmatrix}
                    a& -b\\b&a
                \end{pmatrix}\middle|a,b\in\bbR
            \right\}.
        \end{multline}
        \item  The tableau $A=\{0\}$ corresponds to a Pfaffian system. The equations are $u^a_{x^i}=0$ for all $i,a$. The only solutions to this system are constants. We say that \emph{solutions depend on $s$ constants}.
        \item When $A=W\otimes V^\ast$, there are no equations and any map is a solution. We say that \emph{solutions depend on $s$ functions of $n$ variables}.
        \item Let $L^\ast\subset V^\ast$ be a $k$-dimensional linear subspace and let $A=W\otimes L^\ast$. If $L^\ast=\<\dd x^1,\ldots,\dd x^k\>$, the equations are $u^a_{x^\rho}=0$, $k+1\leq \rho\leq n$, and the solutions are $u^a(x^1,\ldots,x^n)=f^a(x^1,\ldots,x^k)$, where $f^a$ are arbitrary functions. We say that \emph{solutions depend on $s$ functions of $k$ variables}. w.r.t.\ adapted bases we may write elements of $A$ in block form as $\left(\begin{smallmatrix}
            *&0
        \end{smallmatrix}\right)$, where the left block is free and the right block is zero.
        \item Let $A=Y\otimes V^\ast$, where $Y$ is a $p$-dimensional linear subspace of $W$. If $Y$ is spanned by $u^\lambda$, $1\leq \lambda\leq p$, the equations are $u^\xi_{x^i}=0$, where $p+1\leq \xi\leq s$. Solutions are 
        \begin{align}
            u^\lambda(x^1,\ldots,x^n)&=f^\lambda(x^1,\ldots,x^n),\\
            u^\xi(x^1,\ldots,x^n)&=f^\xi_0,
        \end{align}
        where $f^\lambda(x^1,\ldots,x^n)$ are arbitrary functions and the $f_0^\xi$ are constants; so, \emph{solutions depend on $p$ functions of $n$ variables and $s-p$ constants.} One may think of this tableau as a combination of the previous two. w.r.t.\ adapted bases we may write $A$ in block form as $\left(\begin{smallmatrix}
            *\\0
        \end{smallmatrix}\right)$.
    \end{enumerate}
\end{example}


In the rest of this \sect, we will develop a test for a tableau such that if it passes, we will know exactly what initial data one should specify to determine an analytic solution. Given a tableau $A$, we can try to look for an analytic solution in the form of a power series ansatz
\[u^a(x)=p^a+p^a_i x^i+ p^a_{ij}x^ix^j+p^a_{ijk}x^ix^jx^k+\cdots.\]
Since the system is homogeneous with constant coefficients, $u$ is a solution iff each term satisfies the system and the series converges. As we have seen, there is no restriction on the constant terms, and the coefficients of the linear term must satisfy $p^a_i\partial_{u^a}\otimes \dd x^i\in A$. Moving on to the coefficients of the quadratic term in the series, the quadratic term must be such that $\gamma_{p^a_{ij}x^ix^j}(x)\in A$ for all $x\in V$. Thus,
\[p^a_{ij}x^i\partial_{u^a}\otimes \dd x^j \; \in A,\text{ for all }x\in V, \]
so that 
\[p^a_{ij}\partial_{u^a}\otimes \dd x^j\otimes \dd x^i \;\in A\otimes V^\ast.\]
Since mixed partials commute, $p^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j$ is also an element of $W\otimes \bigodot^2 V^\ast$; in indices this means $p^a_{ij}=p^a_{ji}$. Combining these two conditions gives 
\[p^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j \; \in (A\otimes V^\ast)\cap (W\otimes \bigodot^2 V^\ast)\eqqcolon A^{(1)},\]
where the first factor is due to the equations and the second to the commuting derivatives. The space $A^{(1)}$ is called the \emph{(first) prolongation} of $A$. In geometric terms, \emph{$A^{(1)}$ is the space of integral elements at any point of the associated \gls{eds}}. We will later generalize this to all linear Pfaffian systems. Hence, we expect to be able to examine the involutivity of a system by studying its first prolongation. 

Similarly, the condition on the cubic term is 
\[p^a_{ijk}\partial_{u^a}\otimes \dd x^i\otimes\dd x^j\otimes\dd x^k\; \in(A\otimes V^\ast\otimes V^\ast)\cap (W\otimes \bigodot^3 V^\ast)\eqqcolon A^{(2)},\]
and so on for all $l$. In general, we define 

\begin{defn}[Prolongation]\index{Prolongation}
    Let $V,W$ be vector spaces and $A<W\otimes V^\ast$ a subspace (a tableau). The $l$-th prolongation of $A$ is the subspace $A^{(l)}<W\otimes \bigodot^{l+1}V^\ast$ defined as
    \[A^{(l)}\coloneqq (A\otimes V^{\ast\otimes l})\cap (W\otimes \bigodot^{l+1} V^\ast)=(A^{(l-1)}\otimes V^\ast)\cap (W\otimes \bigodot^{l+1} V^\ast).\]
    In terms of constant-coefficient first-order systems of PDEs, $A^{(l)}$ is the set of homogeneous polynomial solutions of degree $l+1$.
\end{defn}

\begin{xca}
    \begin{enumerate}
        \item Show that $A^{(l)}$ is naturally identified with the set of solutions to the system of PDEs defined by $A$ that are homogeneous polynomials of degree $l+1$.
        \item Show that if $A^{(l)}=0$ for some $l$, then solutions depend on a finite number of constants.
    \end{enumerate}
\end{xca}

% \begin{defn}
%     A tableau of order $p$ is a linear subspace $A<W\otimes\bigodot^p V^\ast$. It determines a homogeneous constant-coefficient system of PDEs of order $p$ for $W$-valued functions on $V$. In particular, the $(p-1)$-st prolongation of a tableau (of order one) is a tableau of order $p$. For a tableau $A$ of order $p$, we define its prolongations by $A^{(l)}=(A\otimes V^{\ast \otimes l})\cap (W\otimes \bigodot^{p+1}V^\ast)$.
% \end{defn}

% \begin{example}[Wave equation]
%     The wave equation $u_{xy}=0$ may be encoded as a tableau of order two for $V=\bbR^2=\<\partial_x,\partial_y\>$, $W=\bbR$ as (omitting tensor products again)
%     \[A=\{p_{11}\dd x\dd x+p_{22}\dd y\dd y\mid p_{11},p_{22}\in\bbR\}.\]
%     Then 
%     \[A\otimes\<\dd x,\dd y\>=\<(\dd x)^3,\dd x\dd x\dd y,\dd y\dd y \dd x,(\dd y)^3\>,\]
%     and the symmetric elements of this space are spanned by $(\dd x)^3$ and $(\dd y)^3$, so $\dim A^{(1)}=\dim A=2$. Clearly this continues in the same way for higher prolongations, so $\dim A^{(l)}=2$ for all $l$. This system is not involutive and no number of prolongations make it involutive. Nevertheless, it is known that the general solution is $u=\xi(x)+\eta(y)$, where $\xi$ and $\eta$ are arbitrary functions of one variable. The wave equation belongs to a special class of systems called \emph{Monge-Amp\`ere equations}, and we will need another method, called \emph{Darboux integrability}, to construct its solutions geometrically.
% \end{example}





\begin{example}\label{ex first example Ivey}

Consider the tableau $A=(p_1,0,\ldots,0)$, where $p_1$ an arbitrary column vector (this is Example~\ref{ex tableau}(4) with $\dim L=1$). This tableau corresponds to equations $\partial_{x^p}u^a=0$, $2\leq \rho\leq n$. Its solutions are $u^a(x^1,\ldots,x^n)=f^a(x^1)$. In particular, specifying the values $u^a(x^1,0,\ldots,0)$ uniquely determines a solution, and all solutions are obtained this way.

We generalize to the tableau 
\begin{align}
    A&=\{(p_1^a\dd x^1+C_{2b}^a p_1^b\dd x^2+\cdots +C^a_{nb}p^b_1\dd x^n)\otimes \partial_{u^a}\mid p_1^a\in\bbR,1\leq a\leq s\}= \notag\\
    &= \{(p_1,C_2p_1,\ldots,C_np_1)\mid p_1\in\bbR^s\},\label{eq 5.5 Ivey}
\end{align}
where the $C_\rho$ are fixed $s\times s$ matrices. The symbol relations corresponding to this are 
\[B=\{\dd u^a\otimes \partial_{x^\rho}-C^a_{\rho b}\dd u^b\otimes\partial_{x^1}\mid 2\leq \rho\leq n,1\leq a\leq s\},\]
and the corresponding differential equations are 
\[u^a_{x^\rho}-C^a_{\rho b}u^b_{x^1}=0,\quad \rho=2,\ldots,n.\label{eq 5.6 Ivey}\]
We saw that when $C_\rho= 0$ for all $\rho$, any convergent series with coefficients $p_1^a,p_{11}^a,p^a_{111},\ldots $ determines a solution $u$. The hope is that under some conditions the solutions to (\ref{eq 5.6 Ivey}) can be given in terms of $s$ arbitrary functions of one variable, and we will see that this is the largest space of solutions one could hope for.

Assume we are given constants $p_1^a,p_{11}^a,p^a_{111},\ldots $. Then we may determine the remaining $p^a_I$ for any multi-index $I=(i_1,\ldots,i_k)$ as follows: to have $(p^a_i \partial_{u^a}\otimes \dd x^i)\in A$, the terms $p^a_\rho$ must be given by $p^a_\rho=C^a_{\rho b}p^b_1$. To have $(p^a_{ij}\partial_{u^a}\otimes \dd x^i\dd x^j)\in A^{(1)}$, the other terms are determined by the $p^a_{11}$:
\begin{align}
    p^a_{\rho 1}&=C^a_{\rho b}p^b_{11},\\
    p^a_{\rho\sigma}&=C^a_{\rho b}p^b_{\sigma 1}=C^a_{\rho b}C^b_{\sigma c}p^c_{11},\quad 2\leq \sigma\leq n.
\end{align}
These equations imply $\dim A^{(1)}\leq s$. They may lead to conflicting equations because it is also necessary that $p^a_{\rho\sigma}=p^a_{\sigma\rho}$, i.e., tat $C^a_{\rho b}C^b_{\sigma c}p^c_{11}=C^a_{\sigma b}C^b_{\rho c}p^c_{11}$. In other words, to ensure that no choice of the $p^a_{11}$ leads to a conflict, it is necessary that 
\[[C_\rho,C_\sigma]=0,\quad 2\leq \rho,\sigma\leq n.\]
If these commutators vanish, we are free to specify not only $p^a_{11}$ but in fact any convergent series for $u^a(x^1,0,\ldots,0)$.
\begin{prop}
    If the matrices $C_\rho$ in tableau (\ref{eq 5.5 Ivey}) commute, then there exists a unique solution to the initial value problem 
    \[\gamma_u(x)\in A\]
    with initial condition $u^a(x^1,0,\ldots,0)=f^a(x^1)$ where the $f^a$ are analytic.
\end{prop}
\begin{proof}
    The proof is immediate by majorants: each $k$-th order coefficient in the resulting power series is a product of $k$ matrices from the list $\{C_\rho\}$ and $1/k!$, so the magnitude of the term is bounded by $c^k/k!$ for some constant $c$, leading to convergence.
\end{proof}

In summary, the largest space of solutions one could hope for in a system of this form is that solutions depend on $s$ functions of $1$ variable, and whether or not this is the case can be determined just by computing $A^{(1)}$. One always has $\dim A^{(1)}\leq s$, and solutions depend on $s$ functions of one variable iff $\dim A^{(1)}=s$.
\end{example}

\begin{example}[Model involutive tableau]
    Now suppose that the tableau $A$ consists of matrices of the form 
    \[
        \begin{pmatrix}
            p^1_1  &  p_2^1 & \cdots & p^1_k & 0&\cdots &0\\
            \vdots & \vdots & \vdots & \vdots & 0 & \cdots & 0\\
            \vdots & \vdots & \vdots & p^{s_k}_k & 0 &\cdots & 0\\
            \vdots & \vdots & \vdots & 0 & 0 & \cdots &0\\
            \vdots & p_2^{s_2}& 0    & \vdots & 0 &\cdots & 0\\
            \vdots & 0 & \vdots      & \vdots & 0 &\cdots & 0\\
            p_1^{s_1}& \vdots &\vdots &\vdots &0 &\cdots &0\\
            0& \vdots & \vdots & \vdots  & 0& \cdots & 0\\
            \vdots & \vdots &\vdots &\vdots & 0 &\cdots &0\\
            0& \vdots & \vdots &\vdots & 0 &\vdots & 0
        \end{pmatrix}\label{eq 5.16 Ivey}
    \]
    Then $\dim A^{(1)}=s_1+2s_2+\cdots +ks_k$, since an element of $A^{(1)}$ is determined by a choice of $s_1$ constants $p^1_{11},\ldots,p^{s_1}_{11}$, then $2s_2$ constants $p^1_{12},\ldots,p^{s_2}_{12}, p^1_{22},\ldots,p^{s_2}_{22}$, and so on.

    The general solution of the corresponding system of PDEs is 
    \begin{align*}
        u^a=f^a(x^1,\ldots,x^k),&\quad 1\leq a\leq s_k,\\
        u^a=f^a(x^1,\ldots,x^{k-1}),&\quad 1+s_k\leq a\leq s_{k-1},\\
        \vdots &\\
        u^a=f^a(x^1),&\quad 1+s_2\leq a\leq s_1,\\
        u^a=f^a=\const,&\quad 1+s_1\leq a\leq s,
    \end{align*}
    If we generalize $A$ by inserting  linear combinations of the entries occurring above and to the left of each zero, we obtain a tableau of the same dimensions that satisfies the inequality
    \[\dim A^{(1)}\leq s_1+2s_2+\cdots +ks_k\]
    with equality iff any choice of the $s_1+2s_2+\cdots +ks_k$ constants $p^a_{ij}$ for a point in $A^{(1)}$ determines the other $p^a_{ij}$ without conflict. Moreover, in this case $A^{(k)}$ has its maximum possible dimension for all $k$ as well, i.e., commutation of all second-order derivatives implies commutation of all higher-order derivatives.
\end{example}


These examples motivate the following general definition.

\begin{defn}[Characters]
    Given a tableau $A<W\otimes V^\ast$, each choice of bases $b=(\dd x^1,\ldots,\dd x^n)$ of $V^\ast$ and $q=(\partial_{u^1},\ldots,\partial_{u^s})$ of $W$, determines a (co)flag $F=(F_0>\cdots >F_n)$ of subspaces of $V^\ast$ induced by the basis $b$, which we denote by 
    \[F_j=\Ann\<\partial_{x^1},\ldots,\partial_{x^j}\>=\<\dd x^{j+1},\ldots, \dd x^n\>,\]
    with $F_0=V^\ast$ and $F_n=\{0\}$. This allows us to define the characters of the flag by 
    \begin{align*}
        s'_1(F)&=\; \#\text{ of independent entries in the first column of }A,\\
        s'_1(F)+s'_2(F)&=\; \#\text{ of independent entries in the first 2 columns of }A,\\
        \vdots &\\
        s'_1(F)+\cdots +s'_n(F)&=\; \#\text{ of independent entries in }A=\dim A.\\
    \end{align*}
    Thus, $s'_k(F)$ is the number of new independent variables in the $k$-th column.
\end{defn}

To mimic the original definition of Cartan characters, we will now need to ensure that the flag $F$ is \emph{generic}. We define 
\[A_k(F)\coloneqq (W\otimes F_k)\cap A\]
and observe that 
\[\dim A_k(F)=s'_{k+1}(F)+\cdots s'_n(F).\label{eq 5.17 Ivey}\]
One can visualize $A_k(F)$ as the subspace of matrices in $A$ for which the first $k$ columns are zero, when we use the basis $b$ for $V$. In Example~\ref{ex first example Ivey}, $A_1=\{0\}$.

\begin{defn}[Reduced characters]
    Let $A<W\otimes V^\ast$ be a tableau. Define 
    \[s'_k(A)\coloneqq \max\{s'_k(F)\mid F\text{ flags with }s'_j(F)=s'_j(A),j=1,\ldots,k-1\}.\]
    (The maximization of $s'_k$ ensures that $F$ is generic.) The $s'_k$ are called the \emph{(reduced) characters} of $A$. They are invariants of $A$ w.r.t.\ the action of $\GL(V)\times\GL(W)$. We will call a flag $F$ an \emph{$A$-generic flag} when $s'_k(F)=s'_k(A)$ for all $k$ (it exists by definition). We will write $s_k$ instead of $s'_k(A)$ when there is no risk of confusion. Note that 
    \[\dim W=s\geq s'_1\geq \cdots \geq s'_n\geq 0.\]
\end{defn}

We fix an $A$-generic flag $F$ induced by a basis $b$, and will suppress further reference to it. Given $U< W\otimes \bigodot^d V^\ast$, we define 
\[U_k\coloneqq U\cap (W\otimes \bigodot^{n-k}\<\dd x^{k+1},\ldots,\dd x^n\>).\]
Note that 
\[(A_k)^{(1)}=(A^{(1)})_k.\]

\begin{prop}[{{\cite[Prop.~5.5.3]{Ivey}},\cite[Prop.~IV.3.6]{Bryant}}]\label{prop 5.5.3 Ivey}
    \[\dim A^{(1)}\leq s'_1+2s'_2+3s'_3+\cdots +ns'_n. \label{eq 5.18 Ivey}\]
\end{prop}
\begin{proof}
    We have the exact sequence 
    \[0\to A_k{}^{(1)}\to A_{k-1}{}^{(1)}\to A_{k-1},\]
    in which the last map is $p\mapsto i_{\partial_{x^k}}p$ (contraction with the first component of $\bigodot^{n-k}V^\ast$). Thus, 
    \[\dim A_{k-1}{}^{(1)}-\dim A_k{}^{(1)}\leq \dim A_{k-1}.\]   
    Summing for $1\leq k\leq n$ (and recalling that $A_0=A$), we have 
    \[\dim A^{(1)}\leq \dim A+\dim A_1+\cdots +\dim A_{n-1},\]
    which, along with (\ref{eq 5.17 Ivey}), gives the result.
\end{proof}
\begin{defn}[Involutive tableau]\label{def involutive tableau}
    A tableau $A<W\otimes V^\ast$ is said to be involutive if equality holds in (\ref{eq 5.18 Ivey}).
\end{defn}

\begin{prop}[{{\cite[Prop.~IV.3.8]{Bryant}}}]\label{prop iv.3.8 Bryant}
    The involutivity of the tableau $A$ is equivalent to the involutivity of the PDE system (\ref{eq 5.1 Ivey}) associated to $A$.
\end{prop}
\begin{proof}
    Let us detail the \gls{eds} $(\calI_A,\sfv_A)$ associated to the PDE system (\ref{eq 5.1 Ivey}). In the space $\rmJ^1(V,W)$ we have the submanifold (in fact, linear subspace) $M$ defined by the equations $B^{r i}_ap^a_i=0$. Then $(\calI_A,\sfv_A)$ is the \gls{eds} with independence condition $\sfv_A=\dd x^1\wedge\cdots\wedge\dd x^n$ obtained by restricting the contact system to $M$. Recall that the contact system is generated algebraically by the forms 
    \[\theta^a=\dd u^a-p^a_i\dd x^i,\quad \dd \theta^a=-\dd p^a_i\wedge\dd x^i.\label{eq iv.23 Bryant}\]
    The restriction to $M$ of the $1$-forms $\dd x^i,\theta^a,\dd\theta^a$ span the cotangent spaces and are subject to the relations 
    \[B^{r i}_a \dd p^a_i=0,\quad r=1,\ldots,R\label{eq iv.24 Bryant}\]
    that define $\T_m M <\T_m \rmJ^1(V,W)$ for $m\in M$.

    If $E<\T_m M$ is any integral element of $(\calI_A,\sfv_A)$, then since $\restr{\sfv_A}{E}\neq 0$, it follows that the $\restr{\dd x^i}{E}$ form a basis for $E^\ast$, and consequently $E$ is defined by a set of linear equations 
    \[\theta^a=0,\quad \dd p^a_i=p^a_{ij}\dd x^j\label{eq iv.25 Bryant}\]
    subject to the conditions that $\restr{\dd \theta^a}{E}=0$ and that the linear relations (\ref{eq iv.24 Bryant}) are satisfied on $E$. Substituting these $\dd p^a_i$ into the second equations of (\ref{eq iv.23 Bryant}) gives 
    \[p^a_{ij}=p^a_{ji},\]
    and then the linear relations (\ref{eq iv.24 Bryant}) give 
    \[B^{ri}_a p^a_{ij}=0.\]
    Taken together, these two equations are equivalent to the condition that 
    \[P=p^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes\dd x^j\in A^{(1)}.\]
    This simply confirms the identification of $A^{(1)}$ with the space of integral elements at a point. The space $\calV(\calI_A,\sfv_A)$ of integral elements of $(\calI_A,\sfv_A)$ is a fiber bundle over $M$ with each fiber being a linear space naturally isomorphic to $A^{(1)}$. To apply Cartan's Test~\ref{thm cartan's test} it will thus suffice to work in the space of integral elements lying over the origin in $M$.

    We next set 
    \[\omega^i\coloneqq \restr{\dd x^i}{M},\quad \pi^a_i\coloneqq -\restr{\dd p^a_i}{M}\]
    so that the structure equations (\ref{eq iv.23 Bryant}-\ref{eq iv.24 Bryant}) of $(\calI_A,\sfv_A)$ become 
    \[\dd \theta^a=\pi^a_i\wedge\omega^i,\quad B^{ri}_a\pi^a_i=0.\label{eq iv.34 Bryant}\]
    A substitution 
    \[\pi^a_i\mapsto \pi^a_i-p^a_{ij}\omega^j,\quad p^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j\in A^{(1)}\]
    leaves these structure equations unchanged. By means of such a substitution the integral element (\ref{eq iv.25 Bryant}) in $\calV(\calI_A,\sfv_A)$ is now defined by the equations 
    \[\theta^a=0,\quad \pi^a_i=0,\label{eq iv.35 Bryant}\]
    and is subject to the requirement that the $\dd\theta^a=0$ on this $n$-plane. Calling this $n$-plane $E$, we will determine the circumstances such that $E$ satisfies the conditions of Cartan's Test.

    For this we let $e_1,\ldots,e_n\in\T_0 M$ be the basis for $E$ defined by the equations 
    \[\theta^a(e_k)=\pi^a_i(e_k)=0,\quad \omega^i(e_k)=\delta^i_k.\]
    Then $e_1,\ldots,e_k$ span a subspace $E_k<E$ and we will prove that:
    \begin{gather}
        \text{The rank of the polar equations associated to }E_k \notag\\ 
        \text{is }s+s_1'+\cdots+s_k',\text{ where }s=\dim W.\label{eq iv.36 Bryant}
    \end{gather}
    From here, the proposition is easy to prove: $\dim A=\sum_{i=1}^n s_i'$ and (\ref{eq 5.17 Ivey}) with (\ref{eq iv.36 Bryant}) imply that the inequality in Cartan's Test~\ref{thm cartan's test} is just (\ref{eq 5.18 Ivey}). Moreover, the condition for equality in (\ref{eq 5.18 Ivey}) is just the condition that the integral element defined by (\ref{eq iv.35 Bryant}) be ordinary. In fact the inequality there is $\codim(\calV^n(\calI),\Gr_n(\T M))\geq c_0+\cdots +c_{n-1}$. We have shown that 
    \[c_k=s+s'_1+\cdots+s'_k,\quad \dim A^{(1)}=\dim \calV^n(\calI)_m,\]
    and combining these three relations and unwinding the arithmetic gives (\ref{eq 5.18 Ivey}).

    Now it remains to prove (\ref{eq iv.36 Bryant}). The space $\T_0^\ast M$ is spanned by $\omega^i,\theta^a,\pi^a_i$, and the only relations between them are the second set of equations in (\ref{eq iv.34 Bryant}). We can decompose $\T_0 M=R\oplus S$ by 
    \[R=\bigcap_{a,i}\ker \pi^a_i,\quad S=\bigcap_{i}\ker \omega^i\cap\bigcap_{a}\ker\theta^a. \]
    The mapping $S\to W\otimes V^\ast$ defined by 
    \[v\mapsto \pi^a_i(v)\partial_{u^a}\otimes \dd x^i\]
    is injective, and by the second equation in (\ref{eq iv.34 Bryant}) the image of this mapping is the tableau $A<W\otimes V^\ast$. Thus, we can identify $S$ with $A$ and denote by $S_k<S$ the subspace corresponding to $A_k$:
    \[S_k=\{v\in S\mid \pi^a_i(v)=0,\; i=1,\ldots,k\}.\]
    We will now show that the polar equations for $E_k=\<e_1,\ldots,e_k\>$ are given by 
    \[\theta^a=0,\quad \pi^a_i=0,\quad i=1,\ldots,k.\label{eq iv.38 Bryant}\]
    This is immediate from (\ref{eq iv.34 Bryant}), since for $v\in\T_0 M$ and $i=1,\ldots,k$,
    \[\dd\theta^a(e_i,v)=(\pi^a_j\wedge\omega^j)(e_i,v)=-\pi^a_i(v).\]
    Since the rank of the equations $\pi^a_i(v)=0$ clearly depends only on the projection of $v$ onto $S$, we see that the rank of the equations (\ref{eq iv.38 Bryant}) is given by 
    \[s+\dim(S\slash S_k)=s+\dim A-\dim A_k=s+s'_1+\cdots+s'_k\]
    by definition of the characters. This completes the proof of (\ref{eq iv.36 Bryant}).
\end{proof}


For the ``model'' involutive tableau (\ref{eq 5.16 Ivey}), solutions are uniquely determined by specifying $u^\sigma(x^1,\ldots,x^p,0,\ldots,0)$ for $\sigma\leq s'_p$. This motivates the following.

\begin{defn}[Level]
    Let $s_p'$ be the characters of a tableau. For an integer $\sigma$ in the range $1\leq \sigma\leq s$, define the level of $\sigma$ as the largest $0\leq p\leq n$ such that $\sigma\leq s'_p$. If $\sigma>s'_1$, its level is defined to be $0$.
\end{defn}

For any tableau, the largest set of initial data one could hope to specify is 
\[u^\sigma(x^1,\ldots,x^p,0,\ldots,0),\text{ where }\mathrm{level}(\sigma)=p,\label{eq 5.19 Ivey}\]
with an integral manifold obtained by solving a sequence of Cauchy problems. In fact, since we have shown that the tableau's involutivity guarantees the passage of Cartan's Test, we get the following simple version of the Cartan-K\"ahler Theorem.

\begin{thm}[Cartan-K\"ahler for tableaux {{\cite[Thm.~5.5.7]{Ivey}}}]\label{thm 5.5.7 Ivey}
    Let $A<W\otimes V^\ast$ be a tableau. Choose $A$-generic bases of $V$, $W$ which induce coordinates $x^i$ on $V$ and $u^a$ on $W$. If $A$ is involutive, then any choice of analytic functions (\ref{eq 5.19 Ivey}) determines a unique integral manifold of the system of PDEs represented by $A$ in some neighborhood of the origin.
\end{thm}

According to Theorem~\ref{thm 5.5.7 Ivey}, a solution is determined by specifying 
\begin{align*}
    s'_l &\text{ functions of }l\text{ variables },\\
    s'_{l-1}-s'_l& \text{ functions of }l-1\text{ variables},\\
    \vdots &\\
    s'_1-s'_2&  \text{ functions of }1\text{ variable},\\
    s-s'_1 & \text{ constants.}
\end{align*}

The freedom of the functions of $l$ variables is more significant than all the other choices in the sense that it provides the overwhelming majority of the Taylor coefficients at high orders. Thus we usually say that for an involutive \gls{eds} with character $s_l$ the integral manifolds \emph{depend on $s_l$ functions of $l$ variables}, and ignore the rest.


\begin{example}[Cauchy-Riemann system]
    We already know that the Cauchy-Riemann system is involutive (cf.\ Example~\ref{example cauchy-riemann eds}), but we can nevertheless compute its prolongations our of curiosity. Continuing Example~\ref{ex tableau}(1), we see that the space $A\otimes \bbR^2$ has the basis (omitting tensor products)
    \begin{multline}
        \{\partial_{u^1}\dd x^1\dd x^1+\partial_{u^2}\dd x^2\dd x^1,-\partial_{u^2}\dd x^1\dd x^1+\partial_{u^1}\dd x^2\dd x^1,\\
        \partial_{u^1}\dd x^1\dd x^2+\partial_{u^2}\dd x^2\dd x^2, -\partial_{u^2}\dd x^1\dd x^2+\partial_{u^1}\dd x^2\dd x^2\}.
    \end{multline}
    By collecting terms containing $\partial_{u^1}$ or $\partial_{u^2}$, we can write 
    \begin{multline}
        A\otimes\bbR^2=\{\partial_{u^1}(a\dd x^1\dd x^1+b \dd x^2\dd x^1+c\dd x^1\dd x^2+d\dd x^2\dd x^2)+\\
        +\partial_{u^2}(a\dd x^2\dd x^1-b \dd x^1\dd x^1+c\dd x^2\dd x^2-d\dd x^1\dd x^2)\mid a,b,c,d\in\bbR\}.
    \end{multline}
    To find the prolongation, we need the terms inside the parentheses to be symmetric tensors, i.e., $b=c$ and $a=-d$. Thus,
    \[A^{(1)}\cong \left\{
        \begin{pmatrix}
            a&b\\b&-a
        \end{pmatrix}\middle| a,b\in\bbR
    \right\}.\]
    Since we had $s_1=2$ and $s_2=0$, we conclude involutivity because $\dim A^{(1)}=s_1+2s_2$ holds. Thus, solutions of the Cauchy-Riemann system depend on two functions of one variable. Indeed, in complex analysis an analytic function is determined uniquely by its real and imaginary parts along a smooth curve. Continuing, it is similarly easy to check that the second prolongation is one-dimensional:
    \begin{align}
        A^{(2)}=\<t\>,\text{ where }
        t&=(\partial_{u^1}+\partial_{u^2})(111)+(-\partial_{u^1}+\partial_{u^2})(112)+\\
        &\quad +(-\partial_{u^1}-\partial_{u^2})(122)+(\partial_{u^1}-\partial_{u^2})(222),
    \end{align}
    where $(ijk)$ stands for the sum of $\dd x^i\dd x^j\dd x^k$ over all distinct permutations if $i,j,k$. One more iteration confirms that $A^{(3)}=\{0\}$, so all higher prolongations vanish.
\end{example}






\section{Tableau of the linearization}\label{sec: tableau of linearized eds}

Let $\calI$ be an \gls{eds} on a manifold $M$. Let $E<\T_{m_0}M$ be an $n$-dimensional integral element of $\calI$ and let $Q=\T_{m_0}M\slash E$. We will canonically associate to $E$ a tableau 
\[A_E<\Hom(E,Q)\]
with a number of important properties. 

We use coordinates $x^i,u^a$ on $E,Q$ as in the discussion following Definition~\ref{def linearized eds} of the linearization $(\calI_E,\sfv_E)$. Recall that $\calI_E$ is defined on $M_E=E\oplus Q$ and is algebraically generated by the constant coefficient differential forms 
\[\wb{\psi}=f_{a J}\dd u^a\wedge\dd x^J\]
that are linear in the $\dd u^a$, and that the independence condition is given by $\sfv_E=\dd x^1\wedge\cdots\wedge\dd x^n$. It follows that the integral elements $\wt E$ of $(\calI_E,\sfv_E)$ lying over the origin are given by graphs of linear mappings 
\[p:E\to Q\]
satisfying the following conditions:
\[\left\{
    \begin{array}{l}
        \dd u^a-p^a_i\dd x^i=0,\\
        f_{a J}p^a_i\dd x^i\wedge\dd x^J=0.
    \end{array}
\right.\label{eq iv.4.40 Bryant}\]
Here the first equation expresses $p$ in coordinates, and the second expresses the condition that $\restr{\wb{\psi}}{\wt E}=0$ for all $\wb{\psi}\in P_E$, where $P_E$ given by equation (\ref{eq iv.3.18 Bryant}).

\begin{defn}[Tableau associated to an integral element]
    The tableau $A_E$ associated to $E\in\calV^n(\calI)$ is the linear subspace of $\Hom(E,Q)$ defined by (\ref{eq iv.4.40 Bryant}).
\end{defn}

\begin{rem}
    Recall that the space of integral elements at a point is actually identified with the \emph{prolongation} of the original tableau. In particular, $A_E$ is \emph{not} the tableau of the original system $\calI$, but rather of its prolongation, as we will see in the following \sect s. Thus, its reduced characters should not be confused with those of $\calI$.
\end{rem}

It is clear that $A_E$ is canonically associated to $E$. Our geometric interpretation is that $A_E$ is canonically identified with the set of integral elements lying over the origin of the linearization of $\calI$ at $E$. Another geometric interpretation of $A_E$ is as follows: we consider the $n$-dimensional integral elements of $\calI$ lying over $m_0$ as a subset $\calV^n(\calI)_{m_0}\subset \Gr_n(\T_{m_0} M)$. It is well known that there is a canonical isomorphism 
\[\T_E(\Gr_n(\T_{m_0}M))\cong \Hom(E,Q),\]
and we will show the following.

\begin{prop}[{{\cite[(IV.41)]{Bryant}}}]\label{prop (iv.3.41) Bryant}
    If $E(t)\subset \Gr_n(\T_{m_0} M)$ is a smooth arc of integral elements of $\calI$ lying over $m_0$ with $E(0)=E$, then $\dot E(0)\in A_E$.
\end{prop}
\begin{proof}
    We let $v_i=\partial_{x^i},w_a=\partial_{u^a}$ be the basis of $\T_{m_0}M$ dual to $\dd x^i,\dd u^a$ and we extend the $\partial_{x^i}$ to a smoothly varying basis $v_i(t)$ for $E(t)$. Setting 
    \[\dot v_i(0)=\alpha^j_iv_j+\beta^a_iw_a,\]
    then by definition 
    \[\dot E(0)=\beta^a_i[w_a]\otimes \dd x^i\in Q\otimes E^\ast,\]
    where $[w_a]\in Q$ is the equivalence class defined by $w_a\in\T_{m_0}M$. On the other hand, as in the discussion following the Definition~\ref{def linearized eds} of the linearization, we consider $\psi\in \calI$ of degree $n$ and set 
    \[\psi(m_0)=f_{aJ}\dd u^a\wedge\dd x^J+f_{abK}\dd y^a\wedge\dd y^b\wedge\dd x^K+\cdots.\]
    Then, setting $\sfv_t\coloneqq v_1(t)\wedge\cdots\wedge v_n(t)$ and using that $E(t)\in\calV^n(\calI)_{m_0}$, we have 
    \[
        0=\psi(m_0)(\sfv_t)=f_{aJ}\dd y^a\wedge\dd x^J(\sfv_t)+f_{abK}\dd y^a\wedge\dd y^b\wedge\dd x^K(\sfv_t)+\cdots.
    \]
    Taking the derivative of this equation at $t=0$ gives 
    \[f_{aJ}\beta^a_i\dd x^i\wedge\dd x^J=0,\]
    and comparing with (\ref{eq iv.4.40 Bryant}) gives our assertion.
\end{proof}

When we defined the linearization $(\calI_E,\sfv_E)$ of a \gls{eds} at $E\in\calV^n(\calI)_{m_0}$, we said that $\calI_E$ was obtained by setting $m=m_0$ (freezing coefficients) and by throwing out forms in $\calI$ that vanish to second order or higher on $E$. This is now explained by the proof of the above proposition. From here, we have the following geometric interpretation of the tableau $A_E$:

\begin{cor}[{{\cite[Prop.~IV.4.2]{Bryant}}}]\label{prop iv.4.2 Bryant}
    If the set $\calV^n(\calI)_{m_0}$ of $n$-dimensional integral elements of $\calI$ over $m_0\in M$ is a smooth manifold near $E$, then its tangent space is the tableau $A_E$ associated to $E$.
\end{cor}

In general, $\calV^n(\calI)_{m_0}$ is an algebraic subvariety of $\Gr_n(\T_{m_0}M)$ and $A_E$ is its \emph{Zariski tangent space} at $E$, which is simply the span of the tangent vectors to smooth arcs contained in the variety.

\begin{thm}[{{\cite[Thm.~IV.4.3]{Bryant}}}]\label{thm iv.4.3 Bryant}
    If $E$ is an ordinary integral element of $\calI$, then the linearization $(\calI_E,\sfv_E)$ is involutive and has the same Cartan characters.
\end{thm}
\begin{proof}
    Let $0<E^1<\cdots<E^n=E$ be an ordinary integral flag of $E<\T_{m_0}M$ as an integral element of $\calI$. Let $c_p$ be the codimension of the polar space of $E^p$. By Proposition~\ref{prop iv.2.6 Bryant}, this number is the same whether we regard $E^p$ as an integral element of $\calI$ or $\calI_E$. By the proof of Cartan's Test~\ref{thm cartan's test}, the fact that $E$ is ordinary implies that $\calV^n(\calI)_{m_0}$ is a smooth submanifold of $\Gr_n(\T_{m_0}M)$ of codimension $c_0+\cdots+c_{n-1}$. By Proposition~\ref{prop iv.4.2 Bryant} above, the vector space $\T_E(\calV^n(\calI)_{m_0})$ is isomorphic to $A_E$. Thus, $A_E$ has codimension $c_0+\cdots+c_{n-1}$ in $\T_E(\Gr_n(E\oplus Q))\cong Q\otimes E^\ast$. Since by the argument given above, $\calV(\calI_E,\sfv_E)\cong (E\oplus Q)\times A_E$, it follows that $\calV(\calI_E,\sfv_E)$ is a smooth submanifold of codimension $c_0+\cdots+c_{n-1}$ in the space of all $n$-dimensional tangent planes at points of $E\oplus Q$. By Cartan's Test~\ref{thm cartan's test}, it follows that $E$ is an ordinary integral element of $\calI_E$. The equality of characters is now obvious.
\end{proof}

Another interpretation of the tableau was seen in the previous \sect: $A_E$ is the space of homogeneous $1$-jets of solutions to the associated constant coefficient PDE
\[f_{aJ}\partial_{x^i}u^a(\bf{x})\dd x^i\wedge\dd x^J=0,\]
and the $q$'th prolongation $A_E^{(q)}$ is the space of degree $q+1$ homogeneous polynomial solutions. Now, suppose we clear out the exterior algebra and write this system as a regular PDE
\[B^{\lambda i}_a \partial_{x^i}u^a(\bf{x})=0.\label{eq iv.4.43 Bryant}\]
As we have seen in Proposition~\ref{prop iv.3.8 Bryant}, the condition that the tableau $A_E$ be involutive is that the canonical \gls{eds} in $(\bf{x},\bf{u},\bf{p})$ space given by 
\[\dd u^a-p^a_i\dd x^i=0,\quad B^{\lambda i}_a p^a_i=0,\quad \dd x^1\wedge\cdots\wedge\dd x^n\neq 0\label{eq iv.44 Bryant}\]
associated to (\ref{eq iv.4.43 Bryant}) is involutive. As we have also seen in \S\ref{sec tableaux}, integral elements of this system are identified with elements of $A_E^{(1)}$, i.e., are given by the equations 
\[\dd p^a_i-p^a_{ij}\dd x^j=0,\]
where $p=p^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j\in A^{(1)}_E$. Thus, the following result, which by Theorem~\ref{thm iv.4.3 Bryant} relates a property of the integral elements of $(\calI_E,\sfv_E)$ lying over the origin (these are just $A_E$) to a property of the integral elements of (\ref{eq iv.44 Bryant}) lying over the origin (these are just $A_E^{(1)}$) is by no means obvious:

\begin{thm}[{{\cite[Thm.~IV.4.4]{Bryant}}}]\label{thm iv.4.4 Bryant}
    If $E\in \calV^n(\calI)$ is an ordinary integral element, then the associated tableau $A_E$ is involutive.
\end{thm}
\begin{proof}
    We retain the notations of the preceding two \sect s. We are given that $E$ is an ordinary integral element of $\calI$, and we want to show that equality holds in the inequality for $\dim A_E^{(1)}$ in Proposition~\ref{prop 5.5.3 Ivey}.

    Now, by Theorem~\ref{thm iv.4.3 Bryant}, the condition that $E$ be ordinary for $\calI$ implies that it is ordinary for the linearization $(\calI_E,\sfv_E)$, and we shall prove that 
    \[E\text{ ordinary for }(\calI_E,\sfv_E)\implies \dim A^{(1)}_E=s_1'+2s_2'+\cdots+ns_n'.\]
    This is a purely algebraic statement, and although it is possible to give a purely algebraic argument, here we will use the Cartan-K\"ahler Theorem, which is an analytic result. Recalling that $A^{(1)}_E$ may be identified with the homogeneous $2$-jets of integral manifolds of $(\calI_E,\sfv_E)$, in outline the analytic proof goes as follows:
    \[(\calI_E,\sfv_E)\text{ involutive}\implies \text{``enough'' integral mfds.\ of }(\calI_E,\sfv_E)\implies \text{lower bound on }\dim A^{(1)}_E.\]

    Here is the formal argument. As note above, we may assume that $E\in \calV(\calI_E,\sfv_E)$ is an ordinary integral element of $\calI_E$. For the rest of the proof, we shall work with the \gls{eds} $\calI_E$ on $E\oplus Q$. We may assume that our linear coordinate systems $x^1,\ldots,x^n$ on $E$ and $u^1,\ldots,u^s$ on $Q$ have been chosen so that the subspaces $E^p=\{v\in E\mid \dd x^j(v=0),j>p\}$ form an ordinary flag, and so that $H(E^p)=E\oplus \{w\in Q\mid \dd u^a(w)=0,a>s-c_p\}$ for $p<n$. Here we are using the notations from the proof of Cartan's Test and recall our convention that $c_n=s$ and $c_{-1}=0$.

    By definition, there exist $R$ forms $\varphi^1,\ldots,\varphi^R\in\calI$ so that the forms $\wb{\varphi}^r$, $r=1,\ldots,R$, generate $\calI_E$ algebraically. Here, $\wb{\varphi}^r$ refers to the construction given by (\ref{eq iv.17 Bryant}). These forms have expansions 
    \[\wb{\varphi}^r=\sum_{a,|J|=p_r}f^r_{aJ}\dd u^a\wedge\dd x^J,\quad r=1,\ldots,R,\]
    where $\deg\wb{\varphi}^r=p_r+1$ and $f^r_{aJ}$ are some constants. Clearly, $\calI_E$ is real analytic and moreover, as a differential form on $E\oplus Q$ each $\wb{\varphi}^r$ is closed. By Theorem~\ref{thm iv.4.3 Bryant}, the Cartan-K\"ahler Theorem applies.

    Recall that each character $s_p$ of $\calI$ at $E$ is defined as the number of integers $a$ in the range $1,\ldots,s$ such that $s-c_p\leq a\leq s-c_{p-1}$, and by the Cartan-K\"ahler Theorem, the real analytic integral manifolds of $(\calI_E,\sfv_E)$ are given in a neighborhood of $\bf{x}=0$ by equations of the form $u^a=F^a(x^1,\ldots,x^n)$ where $F^a$ are real analytic and moreover are uniquely specified by knowing the following data:
    \begin{align*}
        &s_0\text{ constants} & f^a&=F^a(0,\ldots,0), & \mathrm{level}(a)=0,\\
        &s_1\text{ functions} & f^a(x^1)&=F^a(x^1,0,\ldots,0), & \mathrm{level}(a)=1,\\
        &s_2\text{ functions} & f^a(x^1,x^2)&=F^a(x^1,x^2,0,\ldots,0), & \mathrm{level}(a)=2,\\
        &\vdots &&\\
        &s_n\text{ functions} & f^a(x^1,\ldots,x^n)&=F^a(x^1,\ldots,x^n), & \mathrm{level}(a)=n.
    \end{align*}

    Note that due to the fact that $\wb{\varphi}^r$ have constant coefficients, it follows that if $u^a=F^a(x^1,\ldots,x^n)$ is a real analytic solution in a  neighborhood of $\bf{x}=0$ and we let $F^a_p$ be the homogeneous term of degree $p$ in the Taylor series of $F^a$, then $u^a=F^a_p$ is also an integral manifold of $\calI_E$. It follows that if the $f^a$ are each chosen to be homogeneous polynomials of degree $p$ in the appropriate variables, then the corresponding $F^a$ will also be homogeneous polynomials of degree $p$. If we regard the collection $F_p=(F^a_p)$ as a $Q$-valued polynomial on $E$, then we see that the subspace $\calS^p<Q\otimes \bigodot^p(E^\ast)$ consisting of those polynomial maps of degree $p$ whose graphs in $E\oplus Q$ are integral manifolds of $\calI_E$ is a vector space whose dimension for $p\geq 1$ is given by the formula expressing the number of Taylor coefficients:
    \[\dim \calS^p=s_1+s_2\binom{p+1}{1}+s_3\binom{p+2}{2}+\cdots +s_n\binom{p+n-1}{n-1}.\]
    Note that $\calS^1=A_E$ by definition. Moreover, we plainly have that $\calS^p=A_E^{(p-1)}$ for all $p\geq 1$.

    We now claim that the characters $s_1,\ldots,s_n$ of $\calI$ in a neighborhood of $E$ and $s'_1,\ldots,s'_n$ of the tableau $A_E$ are related by 
    \[\boxed{s'_k=s_k+s_{k+1}+\cdots+s_n=s-c_{p-1}.}\tag{$\ast$}\]
    Once we establish this we are done, since it follows that the dimension $A_E^{(1)}\cong\calS^2$ is given by 
    \begin{multline}
        s_1+s_2\binom{3}{1}+s_3\binom{4}{2}+\cdots+s_n\binom{n+1}{n-1}=\\
        =(s_1+\cdots+s_n)+2(s_2+\cdots +s_n)+\cdots +ns_n=\\
        =s'_1+2s'_2+\cdots+ns'_n
    \end{multline}
    by ($\ast$). To establish ($\ast$), we have from (\ref{eq 5.17 Ivey})  that 
    \[\dim (A_E)_p=s'_{p+1}+\cdots+s'_n,\]
    and we also have from the definition that $(A_E)_p$ consists of the $Q$-valued linear functions on $E$ that lie in $A_E<Q\otimes E^\ast$ and that do not depend on $x^1,\ldots,x^p$. Thus, $(A_E)_p$ is isomorphic to the space of linear integral manifolds $u^a=F^a(x^{p+1},\ldots,x^n)$ of $(\calI_E,\sfv_E)$ as described above and which do not depend on $x^1,\ldots,x^p$. By the count of the number of such solutions there are (starting from the top)
    \begin{align*}
        &(n-p)s_n &\text{dimensions for linear functions }\notag\\&& f^a(x^{p+1},\ldots,x^n),\;\mathrm{level}(a)=n,\\
        &(n-p-1)s_{n-1} &\text{dimensions for linear functions }\notag\\&&f^a(x^{p+1},\ldots,x^{n-1}),\;\mathrm{level}(a)=n-1,\\
        & &\vdots\notag\\
        &s_{p+1} &\text{dimensions for linear functions }\notag\\&&f^a(x^{p+1}),\;\mathrm{level}(a)=p+1.
    \end{align*}
    Thus, 
    \[\dim(A_E)_p=s_{p+1}+2s_{p+2}+\cdots +(n-p)s_p.\]
    This gives the equations 
    \[s'_{p+1}+\cdots+s'_n=s_{p+1}+2s_{p+2}+\cdots+(n-k)s_n,\quad p=0,\ldots,n-1,\]
    which may then be solved to give ($\ast$).
\end{proof}

Note that since we have found that the characters $s'_p$ of $A_E$ are related to the Cartan characters $s_p$ of the original system by $s_p=s'_p-s'_{p+1}$, the initial data listed above match those listed following Theorem~\ref{thm 5.5.7 Ivey}. As we noted before, these $s'_p$ should not be confused with the characters of the tableau of $\calI$ itself. Rather, they are the characters of the prolongation. In the next \sect\ we will show that the characters of the tableau of a \emph{linear Pfaffian system} (which prolonged systems always are) match its Cartan characters.







\section{Linear Pfaffian systems}\label{sec: lin Pfaffian systems}


In this \sect\ we study \emph{linear Pfaffian systems}, which are generated only by $1$-forms $\{\theta^1,\ldots,\theta^{s_0}\}$ and have the additional property that the variety of integral elements through a point $m\in M$ is an affine space. This class includes all systems of PDEs expressed as \glspl{eds} on jet spaces. One way in which a linear Pfaffian system is simpler than a general \gls{eds} is that an integral element $E\in\calV^n(J,\omega)_m$ passes Cartan's Test iff all integral elements at $m$ do. Meanwhile the general local analytic solvability criteria for the linearization of an arbitrary  nonlinear analytic \gls{eds} coincide with those of the full system by the implicit function theorem, which ultimately justifies the above process of linearization.

Recall that a Pfaffian system is an \gls{eds} on $M$ generated by $1$-forms $\theta^a\in \Omega^1(M)$, $a=1,\ldots,s_0$, i.e., 
\[\calI=\<I\>_{\mathrm{diff}}, I=\<\theta^1,\ldots,\theta^{s_0}\>.\]
We also specify $n$ independent $1$-forms $\{\omega^1,\ldots,\omega^n\}$,  which induce our independence condition $\sfv=\omega^1\wedge\cdots\wedge\omega^n\neq 0$. We describe this problem by the pair 
\[(I,J),\quad J\coloneqq \<I\cup\{\omega^i\}_{i=1}^n\>.\]
We now establish the criterion for when a Pfaffian system is linear in the sense of \S\ref{sec: linear eds}.

\begin{prop}[{{\cite[Prop.~IV.5.2]{Bryant}}}]
    A Pfaffian system $(\calI,\sfv)$ described by $(I,J)$ as above is linear iff 
    \[\dd I\equiv 0\pmod{J},\]
    i.e., $\theta^a$ are closed modulo $\theta^a$ and $\omega^i$. Here, by $\dd I$ we mean the ideal generated by the derivatives of sections of $I$.
\end{prop}
\begin{proof}
    Since $J$ is pointwise linearly independent, it can be locally completed to a local frame for $\T^\ast M$ by a set of $1$-forms $\{\pi^\lambda\}_{\lambda=1}^t$, where $t=\dim M-n-s_0$. Then, modulo $I$ (which is equivalent to the imposition of the Pfaffian equations), $\Omega^2(M)$ is locally spanned by the $2$-forms $\pi^\lambda\wedge \omega^i$, $\omega^i\wedge\omega^j$, and $\pi^\lambda\wedge\pi^\rho$. This means that, locally,
    \[\dd\theta^a\equiv A^a_{\lambda j}\pi^\lambda\wedge\omega^j+T^a_{ij}\omega^i\wedge\omega^j +N^a_{\lambda\rho}\pi^\lambda\wedge\pi^\rho \pmod{I},\label{eq iv.48 Bryant}\]
    for some unique set of smooth local functions $A^a_{\lambda i}$, $T^a_{ij}$ and $N^a_{\lambda\rho}$, where we can suppose that $T^a_{ij}=T^a_{ji}$ and $N^a_{\lambda\rho}=N^a_{\rho\lambda}$. Integral elements are defined by $\theta^a=0$ together with the linear equations 
    \[\pi^\lambda-p^\lambda_i\omega^i=0\]
    where by (\ref{eq iv.48 Bryant})
    \[(A^a_{\lambda i}p^\lambda_j-A^a_{\lambda j}p^\lambda_i)+T^a_{ij}+N^a_{\lambda\rho}(p^\lambda_ip^\rho_j-p^\lambda_jp^\rho_i)=0.\label{eq iv.50 Bryant}\]
    These equations are linear in $p^\lambda_i$ iff $N^a_{\lambda\rho}=0$, which is equivalent to 
    \[\boxed{\dd\theta^a\equiv A^a_{\lambda j}\pi^\lambda\wedge\omega^j+T^a_{ij}\omega^i\wedge\omega^j \pmod{I},}\label{eq def tableau+torsion}\]
    which is exactly the condition that $(\calI,\sfv)$ by linearly generated. This is also exactly $\dd I\equiv 0\pmod{J}$ written out in bases.
\end{proof}


\begin{defn}[Linear Pfaffian system]
    The pair $(I,J)$ is called a linear Pfaffian system if $\dd \theta^a\equiv 0\pmod{J}$ (as an algebraic ideal) for all $a=1,\ldots,s_0$.
\end{defn}

\begin{example}
    Consider the canonical contact system of any PDE, say a second order system
    \[\theta=\dd u-p_i\dd x^i=0,\quad \theta_i=\dd p_i-p_{ij}\dd x^j=0\]
    with independence condition $\dd x^1\wedge\cdots\wedge\dd x^n\neq 0$ in the space $(x^i,u,p_i,p_{ij})$ with $p_{ij}=p_{ji}$. Clearly $\dd\theta$ and $\dd\theta_i$ belong to the algebraic ideal generated by the $\dd x^i,\theta,\theta_i$, so this Pfaffian system is linear. More generally, all contact systems on jet spaces are linear, and the restriction of any linear Pfaffian system to a submanifold (not breaking the independence condition) gives a linear Pfaffian system.
\end{example}


 We will also use the notation 
\[\dd\theta^a\equiv \pi^a_j\wedge\omega^j\pmod{I},\quad \pi^a_j\coloneqq A^a_{\lambda j}\pi^\lambda+T^a_{ij}\omega^i.\]
Importantly, since the coframe $\{\theta^a,\omega^i,\pi^\lambda\}$ is defined up to invertible changes of the form $\theta\mapsto A\theta$, $\omega\mapsto \omega+B\theta$ and $\pi\mapsto \pi+C\omega+D\theta$ (where $A,B,C,D$ are matrices), the forms $\pi^a_j$ are well defined as sections of $\T^\ast M\slash J$. The term with $A^a_{\lambda j}$ determines the \emph{tableau} (see below). The term with $T^a_{ij}$ not containing any of the $\pi^\lambda$ is called \emph{apparent torsion}.\index{Torsion!apparent}

\begin{rem}
    In general nonlinear \glspl{eds} $\calI$, we can perform a similar construction by letting the $\pi^\lambda$ be a pointwise completion of $\{\omega^i\}$ to a basis for $\T_m^\ast M\slash \calI^1_m$. We can also let  $\{\vartheta^q\}_{q=1}^r$  be a set of (algebraic) generators for $\calI_m\slash \calI^1_m$ -- these are necessarily of degree at least $2$. Therefore there exists a decomposition 
    \[\vartheta^q=A^q_{\lambda j}\pi^\lambda\wedge\omega^j+T^q_{ij}\omega^i\wedge\omega^j + A^q_{\lambda\mu j}\pi^\lambda\wedge\pi^\mu\wedge \omega^j + T^q_{ijk}\omega^i\wedge\omega^j\wedge\omega^k+\cdots. \]
    In this case the first term $A^q_{\lambda j}\pi^\lambda$ is the tableau, whereas all the remaining terms break up into \emph{apparent torsion} consisting of terms with none of the $\pi^\lambda$ in them, and \emph{nonlinearity} consisting of terms with two or more $\pi^\lambda$ wedged into them. Since in the Pfaffian case $\calI\slash \calI^1\cong \<\dd\theta^a\>_{\mathrm{alg}}$, we can pick $\vartheta^a=\dd\theta^a$, and then this description agrees with the above definitions.
\end{rem}


\begin{example}\label{ex linear pfaff}
    Let $i:M\hookrightarrow \rmJ^1(V,W)\cong V\oplus W\oplus (W\otimes V^\ast)$ be defined by a constant-coefficient homogeneous system as in the previous \sect. Let $\rmJ^1(V,W)$ have coordinates $(x^i,u^a,p^a_i)$ and let $\theta^a=\dd u^a-p^a_i \dd x^i$, $\omega^i=\dd x^i$. As usual, we omit the pullback $i^\ast$ in notation. The pullback of the contact system to $M$ is still denoted 
    \[I=\<\theta^a\>,\quad J=\<\theta^a,\omega^i\>,\]
    and we have 
    \[\dd\theta^a\equiv -\dd p^a_j\wedge \omega^j\pmod{I}.\label{eq 6.2 Ivey}\]
    However, $\dd p^a_i$ pulled back to $M$ are not all independent. Say we choose forms $\pi^\lambda$, $\lambda=\rank J+1,\ldots,\dim M$, such that $\{\theta^a,\omega^i,\pi^\lambda\}$ are a local coframe for $M$. Since $M$ is defined by homogeneous equations $B^{ri}_a p^a_i=0$, we may choose  $\pi^\lambda$ so that 
    \[\dd p^a_i=-A^a_{\lambda i}\pi^\lambda\]
    for some constants $A^a_{\lambda i}$ such that $B^{ri}_a A^a_{\lambda i}=0$. Thus we may write (\ref{eq 6.2 Ivey}) as 
    \[\dd\theta^a\equiv A^a_{\lambda i}\pi^\lambda\wedge\omega^i \pmod{I}.\]
    Observe that $(J\slash I)_m\cong V^\ast$  and $I_m\cong W^\ast$. When we work with general linear Pfaffian systems, these will be the definitions for $V$ and $W$. The tableau is recovered by taking 
    \[A\coloneqq \<A^a_{\lambda i}\partial_{u^a}\otimes \dd x^i\mid \lambda=\rank J+1,\ldots,\dim M\>< W\otimes V^\ast.\]
    As we saw in the last \sect, if the tableau $A$ is involutive, we have local existence of integral manifolds, roughly depending on $s_l$ functions of $l$ variables, where $l$ is the Cartan integer and $s_l$ is the final character of the tableau. For an arbitrary linear Pfaffian system with no intrinsic torsion, we will define a tableau at a general point $m\in M$, and if this tableau is involutive, we will again have local existence of integral manifolds.
\end{example}


\begin{rem}\label{rem 6.3.1 Ivey}
    We can consider the more general case of \emph{non-homogeneous} constant-coefficient linear systems. Let there be constants $C^r_i$ such that the equations are of the form 
    \[B^{ri}_a p^a_i=C^r_i x^i.\]
    Then we must have $\dd p^a_i=-A^a_{\lambda i}\pi^\lambda+T^a_{ij}\omega^j$, where $A^a_{\lambda i}$ are as before, and $T^a_{ij}$ are constants which satisfy $C^r_i=B_a^{rj}T^a_{ij}$. Now we have nonzero apparent torsion:
    \[\dd\theta^a\equiv A^a_{\lambda i}\pi^\lambda \wedge \omega^i+T^a_{ij}\omega^i\wedge\omega^j\pmod{I}.\]
    It might be possible to modify the $\pi^\lambda$ by adding multiples of the $\omega^j$ to absorb the apparent torsion. We will examine this below.
\end{rem}

\begin{example}[\ref{ex linear pfaff} continued]
    If $A$ is not involutive, we need to examine third-order information. The test will be to compare a naive estimate for the dimension of $\dim A^{(2)}$ with its actual dimension (recall that $A^{(2)}$ can be interpreted as the space of admissible third-order terms in the Taylor series of a solution). 

    We start with a new system, which is the pullback of the tautological linear Pfaffian system on the second order jet space 
    \[\rmJ^2(V,W)\cong V\oplus W\oplus (W\otimes V^\ast)\oplus (W\otimes \bigodot^2 V^\ast)\]
    to $\wt{M}\cong V\oplus W\oplus A\oplus A^{(1)}$. This new system is called the \emph{(first) prolongation} of $(I,J)$ on $M$.

    Recall that, in coordinates $(x^i,u^a,p^a_i,p^a_{ij})$, the contact system on $\rmJ^2(V,W)$ is generated by 
    \[\theta^a=\dd u^a-p^a_i\dd x^i,\quad \theta^a_i=\dd p^a_i-p^a_{ij}\dd x^j.\]
    We omit pullbacks $i^\ast$ along the inclusion $i:\wt{M}\hookrightarrow \rmJ^2(V,W)$ as before. In particular, note that on $\wt{M}$, only $\dim A$ of the forms $\theta^a_i$ are independent. 

    Writing our new system as $I=\<\theta^a,\theta^a_i\>$, we observe that $\dd\theta^a\equiv 0\mod{I}$, so our $(s+\dim A)\times n$ tableau, when represented by a matrix, will always have the first $s\times n$ block zero. We now apply Cartan's test for involutivity to this tableau. If it is involutive, then local integral manifolds exist; if not, then further prolongation is necessary.
\end{example}


Let us return to general definitions. Let $(I,J)$ be a linear Pfaffian system as above with $I=\<\theta^a\>$, $J=\<\theta^a,\omega^i\>$ and $\{\pi^\lambda\}$ such that the tableau and the torsion are defined by (\ref{eq def tableau+torsion}). Let $\Ann(J_m)<\T_m M$ be, as usual, the annihilator of the $\theta^a$ and $\omega^i$. Then the subspaces 
\[A_m\coloneqq \pi^a_i(\Ann(J_m))<I_m^\ast\otimes (J\slash I)_m\] 
are well defined. More precisely, the choice of framing $\theta^a$ for $I$ and $\omega^i$ for $J\slash I$ induce bases $\partial_{u^a}=\theta^a_m$ and $\dd x^i=\omega^i_m$ for $I_m^\ast$ and $J_m\slash I_m$, respectively. Then $A_m$ is spanned by the images of the map
\[\pi:\Ann(J)\to I^\ast\otimes J\slash I,\quad \pi(v)=\pi^a_i(v)\partial_{u^a}\otimes\dd x^i,\quad v\in \Ann(J_m).\label{eq iv.60 Bryant}\]

\begin{defn}[Tableau bundle, reduced characters]
    Assuming $\dim A_m$ is locally constant on $M$, the fibers $A_m$ comprise the tableau bundle $A<I^\ast\otimes J\slash I$. In intrinsic terms, it is the image $\pi(\Ann(J))$. For each $m\in M$, the characters $s'_p(m)$ of $A_m$ are defined, and if they are locally constant, we call them the \emph{reduced characters} of the linear Pfaffian system $(I,J)$.
\end{defn}

\begin{rem}
    The map $\pi:\Ann(J_m)\to I_m^\ast\otimes J_m\slash I_m$ is injective iff there are no nonzero $v$ such that $i_v(\calI_m)\subset \calI_m$, i.e., no Cauchy characteristics in $\Ann(J_m)$. In particular, if $\calI$ has no Cauchy characteristics, then the tableau $A_m$ has as basis the matrices $A_\lambda=(A^a_{\lambda i})$, $\lambda=1,\ldots,t$. In general, they span $A_m$ but may not be a basis.
\end{rem}

Similarly, we can define the \emph{symbol bundle} as the annihilator of $A$: 
\[B=\Ann(A)=\<B^{ri}_a \dd u^a\otimes \partial_{x^i}\>< I\otimes (J\slash I)^\ast.\] 
If $\dd\theta^a\equiv \pi^a_i\wedge \omega^i\pmod{I}$, then the \emph{symbol relations} of $A$ are the equations
\[B^{ri}_a\pi^a_i\equiv C^r_j \omega^j\pmod{I},\quad r=1,\ldots,\codim A.\]


\begin{example}[PDEs]
    Consider a first-order PDE system $F^r(x^i,u^a,u^a_{x^i})=0$ (recall that any PDE system can be represented by a first-order one) as a Pfaffian system 
    \[\theta^a=\dd u^a-p^a_i\dd x^i=0,\quad \omega=\dd x^1\wedge\cdots\wedge\dd x^n\neq 0\label{eq pfaffian pde}\]
    on the submanifold $M$ defined by $F^r(\bf{x},\bf{u},\bf{p})=0$. The structure equations are $\dd \theta^a\equiv \pi^a_i\wedge\omega^i\pmod{I}$, where $\pi^a_i=-\restr{\dd p^a_i}{M}$ and $\omega^i=\restr{\dd x^i}{M}$. From $F^r=0$, the $\pi^a_i$ are subject to the relations 
    \[F^r_{p^a_i}\pi^a_i=0\pmod{J}.\]
    It follows from the above discussion that at each point $m=(\bf{x},\bf{u},\bf{p})$ of $M$ the fiber of the symbol bundle is spanned by the matrices 
    \[B^r=\left(F^r_{p^a_i}(m)\right)_i^a.\]
    Thus, the symbol of the Pfaffian system associated to a PDE agrees with the classical definition of the symbol.

    More generally, it is easy to show that \emph{a linear Pfaffian system is locally equivalent (via a diffeomorphism) to the canonical Pfaffian system (\ref{eq pfaffian pde}) of some PDE system iff the Frobenius condition $\dd J\equiv 0\pmod{J}$ is satisfied}.
\end{example}

As we already know, a PDE system may have compatibility conditions obtained from the equality of mixed partials, and we can find the expression for these conditions for a general linear Pfaffian system. Consider the compatibility conditions for the affine linear system (\ref{eq iv.50 Bryant}),
\[\left(A^a_{\lambda i}(m)p^\lambda_j-A^a_{\lambda j}(m)p^\lambda_i\right)+T^a_{ij}(m)=0\label{eq iv.65 Bryant}\]
whose solutions give the integral elements $\calV(\calI,\sfv)_m$ lying over a point $m\in M$. The compatibility conditions for this system in the $p^\lambda_i$ may lead to relations on the $A^a_{\lambda i}(m)$ and $T^a_{ij}(m)$, called \emph{integrability conditions}. Their presence means that the set $\calV(\calI,\sfv)$ of integral elements of $(\calI,\sfv)$ projects onto a \emph{proper subset} of $M$, and we should restrict our consideration to this subset.

As the following simple example shows, the presence of integrability conditions is an important phenomenon for over-determined systems of PDEs, and usually imposes strong restrictions on the solution.

\begin{example}
    In the $(x,y,z)$-space consider the system 
    \[z_x=A(x,y,z),\quad z_y=B(x,y,z).\]
    This is equivalent to the \gls{eds} $\theta=\dd z-A\dd x-B\dd y=0$ with independence condition $\dd x\wedge\dd y\neq 0$. In the above notation we have $\rank I=1$, $\rank J=3$ and thus $J=\T^\ast M$, and at each point of $M$ there is a unique integral $2$-plane satisfying the independence condition. The condition that this plane be an integral element is that the $2$-form
    \[\dd\theta=-\dd A\wedge\dd x-\dd B\wedge\dd y\]
    restrict to zero on it. Working this out gives 
    \[A_y+A_z B=B_x+B_z A,\label{eq iv.68 Bryant}\]
    which is the usual integrability condition. If it is not identically satisfied, there are two cases: a) relation (\ref{eq iv.68 Bryant}) does not involve $z$ and is therefore a relation between $x,y$, so that the system has no integral manifold satisfying the independence condition; b) relation (\ref{eq iv.68 Bryant}) gives $z$ as a function of $x,y$, which is then the only possible solution, and thus the equation has a solution or not depending on whether it i satisfied or not by this function.
\end{example}

\begin{example}[Poincar\'e's Lemma]
    We approach Poincar\'e's Lemma~\ref{lem poincare classic} for a $2$-form as an \gls{eds}. In an open subset of $\bbR^n,n\geq 2,$ with coordinates $x^1,\ldots,x^n$, we assume given a smooth $2$-form $\varphi=\frac12\varphi_{ij}\dd x^i\wedge\dd x^j$, where $\varphi_{ij}=-\varphi_{ji}$, and consider the equation 
    \[\dd\eta+\varphi=0\]
    for a $1$-form $\eta$. When written as a PDE, it has the form 
    \[\partial_{x^j}\eta_i-\partial_{x^i}\eta_j+\varphi_{ij}=0.\]
    The associated \gls{eds} es defined on the submanifold $M$ of the $(x^i,\eta_i,p_{ij})$ space by the equations 
    \[p_{ij}-p_{ji}+\varphi_{ij}=0,\quad \theta_i=\dd \eta_i-p_{ij}\dd x^j=0,\quad \dd x ^1\wedge\cdots\wedge\dd x^n\neq 0.\]
    We seek an integral element $E<\T_m M$ defined by 
    \[\dd p_{ij}-p_{ijk}\dd x^k=0,\quad \restr{\dd \theta_i}{E}=0,\quad \restr{(\dd p_{ij}-\dd p_{ji}+\dd\varphi_{ij})}{E}=0.\]
    The middle equation gives $p_{ijk}=p_{ikj}$, and the remaining two become 
    \[p_{ijk}-p_{jik}+\partial_{x^k}\varphi_{ij}=0.\]
    This is equivalent to $\dd\varphi=0$. In other words, our Pfaffian system has an integral element over each point iff $\dd\varphi=0$, which of course is exactly Poincar\'e's Lemma.
\end{example}

The above examples illustrate our assertion that the compatibility conditions for the equations (\ref{eq iv.65 Bryant}) are integrability conditions; more precisely, they are \emph{first order integrability conditions}, since these conditions, upon being added to the system, might generate their own (second order) compatibility conditions, and so on. We will now demonstrate how these integrability conditions are reflected in the structure equations of a linear Pfaffian system.

We say that apparent torsion $T^a_{\lambda i}$ is \emph{absorbable} if it can be made zero by a proper choice of frame $\{\pi^\lambda\}$ for $\T^\ast M\slash J$. If this is not possible, we say that there is \emph{intrinsic torsion} $[T]\neq 0$, where $[T]$ is the equivalence class consisting of all possible apparent torsion $1$-forms. Note that $[T]$ depends only on the space spanned by the $\pi^\lambda$ modulo $I$, so this space needs to be changed if one hopes to absorb apparent torsion. In other words, the $\pi^\lambda$ need to be modified by adding multiples of the $\omega^j$.\index{Torsion!intrinsic}

In the presence of intrinsic torsion, it is impossible to choose a complement to $J_m<\T^\ast_mM$ such that the apparent torsion at $m$ vanishes. In this case there are no integral elements at $m$. In fact, an integral element over $m$ exists iff $[T]_m=0$. Let us now compute the space of integral elements over $m$.

For this \sect, we fix a point $m\in M$ and define 
\[V\coloneqq  (J\slash I)_m^\ast,\quad W\coloneqq I_m^\ast.\] 
We will speak of $A<W\otimes V^\ast$ as \emph{the tableau} of $(\calI,\sfv)$ without references to the point $m\in M$.
A change of complement $\wt{\pi}^\lambda-\pi^\lambda=e^\lambda_i \omega^i$, called a \emph{contorsion}, leads to a change in apparent torsion equal to
\[\wt{T}^a_{ij}-T^a_{ij}=\frac12(A^a_{\lambda j}e^\lambda_i-A^a_{\lambda i}e^\lambda_j)\eqqcolon E^a_{ij}.\]
This motivates us to define the antisymmetrization operator
\[\delta:W\otimes V^\ast\otimes V^\ast\to W\otimes \bigwedge^2V^\ast.\]
Given a contorsion, it computes the corresponding change in apparent torsion. Therefore, $\ker\delta$ can be (non-naturally) identified with the set of contorsions that do not change a given apparent torsion. Also note that its kernel is exactly the set of symmetric elements of $A\otimes V^\ast$, which is $A^{(1)}$. This provides a useful method for computing $A^{(1)}$ in practice using the following proposition.

\begin{prop}[{{\cite[Prop.~6.7.1]{Ivey}},{\cite[Prop.~IV.5.7]{Bryant}}}]\label{prop 6.7.1 Ivey}\label{prop iv.5.7 Bryant}
    If $(\calI,\sfv)$ is a linear Pfaffian system with a non-empty set of integral elements over $m\in M$, then $\calV(\calI,\sfv)_m$ is an affine space modeled on the prolongation $A_m^{(1)}$ of the tableau $A_m$.
\end{prop}
\begin{proof}
    First we note that $\calV(\calI,\sfv)_m$ can be identified with the space of all possible sets $\{\pi^\lambda\}\pmod{I}$ of $1$-forms such that $\dd\theta^a\equiv \pi^a_i\wedge\omega^i\pmod{I}$. Indeed, each such set of forms satisfies $\pi^\lambda=p^\lambda_i\omega^i$ for some $p^\lambda_i$ satisfying the affine equations (\ref{eq iv.65 Bryant}) which describe integral elements. It now suffices to show that this space is an affine space modeled on the prolongation $A^{(1)}$. The space of solutions to (\ref{eq iv.65 Bryant}) is obviously an affine space modeled on the space of solutions to the corresponding homogeneous system 
    \[A^a_{\lambda i}p^\lambda_j=A^a_{\lambda j}p^\lambda_i,\]
    but let us now identify this space with $A^{(1)}$ at the level of forms.
    
    The space of integral elements is identified with the space of possible sets of $1$-forms $\{\wt{\pi}_i^\lambda\}$ such that $\dd\theta^a\equiv\wt{\pi}^a_i\wedge \omega^i\pmod{I}$. We need only to identify each element of $\ker\delta$ relative to a given $\{\pi^a_i\}$ with a unique element of $A^{(1)}$. Let $\wt{\pi}^a_i\equiv\pi^a_i+p^a_{ij}\omega^j \pmod{I}$. The $\wt{\pi}^a_i$ must satisfy the symbol relations $B^{ri}_a\wt{\pi}^a_i\equiv 0\pmod{I}$. But 
    \[B^{ri}_a \wt{\pi}^a_i\equiv B^{ri}_a(\pi^a_i+p^a_{ij}\omega^j)\equiv B^{ri}_a(p^a_{ij}\omega^j)\pmod{I},\]
    since $\pi^a_i$ also satisfies the symbol relations. This implies $B^{ri}_ap^a_{ij}=0$ for all $j$, since the $\omega^j$ are independent, so $p^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j\in A\otimes V^\ast$. But we also need 
    \[\wt{\pi}^a_i\wedge \omega^i\equiv \pi^a_i\wedge\omega^j+p^a_{ij}\omega^i\wedge\omega^j\equiv 0\pmod{I}.\] 
    We already have $\pi^a_i\wedge \omega^i\equiv 0\pmod{I}$, so this forces $p^a_{ij}\omega^i\wedge \omega^j=0$, which implies $p^a_{ij}=p^a_{ji}$.
\end{proof}


Since $E\coloneqq E^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j$ lies in $\delta(A\otimes V^\ast)$, the space of all possible apparent torsions attainable from a given one is $\delta(A\otimes V^\ast)$. Then the \emph{intrinsic torsion} of $(I,J)$ at $m$ is defined as the equivalence class of apparent torsions differing by an action of contorsions, i.e., modulo the image of $\delta$:\index{Torsion!intrinsic}
\[[T]_m\coloneqq \left[T^a_{ij}\partial_{u^a}\otimes \dd x^i\otimes \dd x^j\right]\in \coker\delta =\bigslant{\left(W\otimes \bigwedge^2V^\ast\right)}{\delta(A\otimes V^\ast)}.\]
We thus have the defining \emph{kernel-cokernel exact sequence} for $\delta$ restricted to $A\otimes V^\ast<W\otimes V^\ast\otimes V^\ast$:
\[0\to A^{(1)}=\ker\delta \hookrightarrow \underbrace{A\otimes V^\ast}_{\text{contorsions}}\overset{\delta}{\to}\underbrace{W\otimes\bigwedge^2 V^\ast}_{\text{app.\ torsions}}\to \underbrace{\coker\delta}_{\text{int.\ torsions}}\to 0.\]
For future reference, we introduce the notation for the space of intrinsic torsions
\[\rmH^{0,2}(A)\coloneqq \coker\delta.\]
If $[T]_m= 0$, then any apparent torsion terms we have for a specific choice of coframe are absorbable and the set of integral elements at $m$ is an affine copy of $A^{(1)}_m$. For the purposes of Cartan's Test, actually carrying out the absorption is not necessary because the tableau is independent of it. If $[T]_m$ is not identically zero, we need to restrict our system to the subset (hopefully submanifold) $M'\subset M$ on which $[T]\equiv 0$. On this subset we may then obtain new symbol relations resulting from $\dd [T]=0$.

It is possible that $\dd[T]=0$ forces a relation among the $\omega^i$ on an open subset of $M'$. If this happens, we must restrict further to the subset $M''\subset M'$ where the $\omega^i$ are independent. If $M''$ is empty, there are no integral manifolds and we are done. In any event, restricting to $M'$ and $M''$ will in general introduce new (second order) symbol relations, which in turn could introduce more apparent torsion, and so we must repeat the above process. We have almost proven the following.

\begin{thm}[Cartan-K\"ahler for linear Pfaffian systems {{\cite[Thm.~6.5.6]{Ivey}},\cite[Thm.~IV.5.16]{Bryant}}]\label{thm 6.5.6 Ivey}\label{thm iv.5.16 Bryant}
    Let $(I,J)$ be an analytic linear Pfaffian system on a manifold $M$, let $m_0\in M$ have a neighborhood $U$ such that, for all $m\in U$,
    \begin{enumerate}
        \item $[T]_m=0$;
        \item The tableau $A_m$ is involutive.
    \end{enumerate}
    Then solving a series of Cauchy problems yields integral manifolds to $(I,J)$ passing through $m_0$ that depend (in the sense discussed in the last \sect) on $s_l$ functions of $l$ variables, where $s_l$ is the final character of the system.
\end{thm}
It remains only to check that the involutivity of the tableau is equivalent to that of the system itself. Thus, we will have reduced the study of the integral elements of a linear Pfaffian system to its tableau and torsion. In particular, the following proof expresses Cartan's Test for involution in terms of these invariants.
\begin{proof}
    Since the vanishing of torsion means that integral elements exist over $U$, we have 
    \[\dim \calV(\calI,\sfv)=\dim M+\dim A_m^{(1)}.\]
    On the other hand, using the structure equations 
    \[\theta^a=0,\quad \dd\theta^a\equiv \pi^a_i\wedge\omega\pmod{I},\quad B^{\lambda i}_a\pi^a_i\equiv 0\pmod{I},\quad \sfv\neq 0,\]
    we see that the equations 
    \[\theta^a(m)=0,\quad \pi^a_i(m)=0\]
    define an integral element $E<\T_m M$ having a basis $e_i$ where $\omega^j_m(e_i)=\delta_i^j$, and secondly the proof of (\ref{eq iv.36 Bryant}) shows that the rank of the polar equations of $E^p=\<e_1,\ldots,e_p\>$ is given by 
    \[s_0+s'_1+\cdots +s'_p.\label{eq iv.84-1 Bryant}\]
    On the other hand, the Cartan characters $c_p$ and $s_k$ associated to $E$ in terms of $\codim H(E^p)=\dim M-\dim H(E^p)$ are given for $p\geq 0$ by
    \[\codim H(E^p)=c_p,\quad s_p=c_p-c_{p-1}.\]
    By comparing this with (\ref{eq iv.84-1 Bryant}), we find
    \[c_p=s_0+s'_1+\cdots+s'_p,\implies \boxed{s_p=s'_p,\quad p=1,\ldots,n-1.}\]
    Thus, \emph{for any integral element $E$, the characters $s_p=s_p(E)$ are equal to the reduced characters $s'_p$ of the linear Pfaffian system}. In particular, the $s_p$ are the same for all integral elements $E$ over a given point $m\in M$. The inequality in Cartan's Test~\ref{thm cartan's test} is then 
    \[\dim A_m^{(1)}\leq s'_1+2s'_2+\cdots +ns'_n,\]
    and by Definition~\ref{def involutive tableau}, equality holds iff $A_m$ is involutive.
\end{proof}


We interpret the Cartan-K\"ahler Theorem as saying: if there is no obstruction to having an integral element at a general point $m\in M$, then the space of integral manifolds passing through $m$ is of the same dimension as the space of integral manifolds for the corresponding linearized problem. In other words, if the linear algebra works out at the infinitesimal level, it also works out locally.

When a linear Pfaffian system $(I,J)$ satisfies the conditions of Theorem~\ref{thm 6.5.6 Ivey} at $m$, we say it is \emph{involutive} at $m$. Note that if conditions 1 and 2 are satisfied at $m$, then they are automatically satisfied in some neighborhood of $m$.






\section{Prolongation}

Let us formalize the process of prolongation. Let $\calI$ be an arbitrary \gls{eds} on a manifold $M$. Denote the points of the $n$-th Grassmann bundle $\pi:\Gr_n(\T M)\to M$ by $(m,E)$, where $m\in M$ and $E<\T_mM$ is an $n$-dimensional subspace. Much like the contact system on the space of $k$-jets, $\Gr_n(\T M)$ carries a canonical linear Pfaffian system $\calL$ on it, whose integral manifolds are exactly the lifts $\wt{N}$ of immersed $n$-submanifolds $N\subset M$ to $\Gr_n(\T M)$ defined by $\wt{m}=(m,\T_m N)$.

\begin{defn}[Canonical system on $\Gr_n(\T M)$]
    The canonical \gls{eds} $\calL$ on $\Gr_n(\T M)$ is defined as a linear Pfaffian system by the pair
    \[I_{(m,E)}\coloneqq \pi^\ast(\Ann (E)),\quad J_{(m,E)}\coloneqq \pi^\ast(\T_m^\ast M).\]
\end{defn}
Now let $\calV^n(\calI)\subset \Gr_n(\T M)$ be the subset (more precisely, subsheaf) of $n$-dimensional integral elements to $\calI$, whose fiber over a point $m$ is $\calV^n(\calI)_m$ as defined in Definition~\ref{def integral element}.

\begin{defn}[Prolongation of an \gls{eds}]\index{Prolongation!of an \gls{eds}}
    The \emph{prolongation} $\calI^{(1)}$ of an \gls{eds} $\calI$ (for $n$-dimensional integral manifolds) is the restriction of the above canonical system $\calL$ on $\Gr_n(\T M)$ to $\calV^n(\calI)$. If $\calI$ comes with an independence condition $\sfv$, then we define the prolongation $(\calI^{(1)},\sfv)$ to be the restriction of the canonical system $(\calL,\pi^\ast\sfv)$ to $\calV(\calI,\sfv)$.
\end{defn}

In other words, the integral $n$-manifolds of the prolonged system project onto the integral $n$-manifolds of the original system, and the prolonged system has the extra benefit of being a linear Pfaffian system. Let us denote the manifold carrying $\calI^{(1)}$ by $M^{(1)}\coloneqq \calV(\calI,\sfv)$. By induction, we define $\calI^{(q)}$ and $M^{(q)}$ for all $q\geq 1$. The three basic properties of prolongation are informally stated thus:
\begin{enumerate}
    \item The integral manifolds of $(\calI,\sfv)$ and $(\calI^{(1)},\sfv)$ are locally in one-to-one correspondence.
    \item If $(\calI,\sfv)$ is involutive, then so is $(\calI^{(1)},\sfv)$.
    \item (Cartan-Kuranishi Prolongation Theorem) There exists an integer $q_0$ such that for $q\geq q_0$, $(\calI^{(q)},\sfv)$ is involutive (including the possibility that $M^{(q)}=\varnothing$, when there are no integral manifolds).
\end{enumerate}
The second property follows intuitively from Theorem~\ref{thm iv.4.4 Bryant}, but in full generality is proven in \cite[Prop.]{Bryant}. We will not attempt to prove the Prolongation Theorem here, since it is mostly of purely theoretical importance, and we direct the reader to \cite[Thm.~VI.3.2]{Bryant} for details. The first and the last property together imply that \emph{every integral manifold of an \gls{eds} is an integral manifold of an involutive \gls{eds}}.

\begin{rem}
    To see what prolongation looks like in coordinates, we use coordinates $(\bf{x},\bf{u})$ on $M$ as usual so that $\sfv=\dd x^1\wedge\cdots\wedge\dd x^n$. The canonical system $\calL$ is generated (differentially) by the contact forms 
    \[\theta^a=\dd u^a-p^a_i\dd x^i.\]
    Tangent $n$-planes are parametrized by the numbers $p^a_i$, so $(\bf{x},\bf{u},\bf{p})$ give a coordinate system on $\Gr_n(\T M)$. The equations $\restr{\psi}{E}=0$ for $\psi\in \calI$ that define integral elements become 
    \[F_\psi(\bf{x},\bf{u},\bf{p})=0,\quad \restr{\psi}{E}=F_\psi\cdot \sfv.\]
    Our assumption is that these equations regularly define a submanifold in $\Gr_n(\T M)$, and then $(\calI^{(1)},\sfv)$ is the restriction of the canonical system to this submanifold. It is manifest that this system is a linear Pfaffian one.
\end{rem}

\begin{rem}
    If $\psi\in\calI^1$ and $\pi:M^{(1)}\to M$ is the canonical projection, then the condition that $\psi$ vanish on the integral element $\dd u^a=p^a_i\dd x^i$ implies that $\pi^\ast \psi$ is a sum of multiples of $\theta^a$, i.e., $\pi^\ast\psi=f_a\theta^a$. Thus, $\pi^\ast\calI^1\subset\calI^{(1)}$. In particular, if $\calI$ is a Pfaffian system, then $\pi^\ast\calI\subset\calI^{(1)}$. In notation, the pullback $\pi^\ast$ is usually omitted.
\end{rem}

\begin{example}[Prolongation of a linear Pfaffian system {{\cite[Example~IV.6.2]{Bryant}}}]
    Let $(\calI,\sfv)$ be a linear Pfaffian system with no torsion, whose structure equations are
    \[\theta^a=0,\quad \dd\theta^a\equiv \pi^a_i\wedge\omega^i\pmod{I},\quad B^{\lambda i}_a\pi^a_i\equiv 0\pmod{I},\quad \sfv\neq 0\]
    as usual. Integral elements are defined by 
    \[\theta^a=0,\quad \theta^a_i\coloneqq \pi^a_i-p^a_{ij}\omega^j=0,\]
    where $p^a_{ij}=p^a_{ji}$ and $B^{\lambda i}_a(m)p^a_{ij}=0$. By the preceding remark, $\calI^{(1)}$ is generated differentially by the $1$-forms $\theta^a,\theta^a_i$ (recall we are omitting $\pi^\ast$). Let $I^{(1)}=\<\theta^a,\theta^a_i\>$. It is an exercise to prove that the structure equations of $\calI^{(1)}$ are 
    \[\dd\theta^a\equiv 0\pmod{I^{(1)}},\quad \dd\theta^a_i\equiv \pi^a_{ij}\wedge\omega^j\pmod{I^{(1)}},\]
    where 
    \[\pi^a_{ij}\equiv \pi^a_{ji}\pmod{I^{(1)}},\quad B^{\lambda i}_a\pi^a_{ij}\equiv C^\lambda_{jk}\omega^k\pmod{I^{(1)}}.\]
    All six of these equations together are the structure equations for $(\calI^{(1)},\sfv)$. This proves, as expected, that \emph{$(\calI^{(1)},\sfv)$ is a linear Pfaffian system whose tableau over $y\in M^{(1)}$ is the prolongation $A_m^{(1)}$ of the tableau of $(\calI,\sfv)$ over $m=\pi(y)$}.
\end{example}

\begin{example}[Prolongation of a PDE {{\cite[Example~IV.6.3]{Bryant}}}]
    Consider a first-order PDE system $F^r(x^i,u^a,\partial_{x^i}u^a)=\const$ (with unspecified constant). On $M=\rmJ^1(\bbR^n,\bbR^{s_0})$ with coordinates $(x^i,u^a,p^a_i)$ this PDE system corresponds to the \gls{eds} $(\calI,\sfv)$ generated by the $1$-forms 
    \[\dd F^r(\bf{x},\bf{u},\bf{p}),\quad \theta^a=\dd u^a-p^a_i\dd x^i\]
    and with independence condition $\sfv=\dd x^1\wedge\cdots\wedge\dd x^n$. In PDE theory, the prolongation of this PDE is usually defined by introducing new variables $p^a_i$ for $\partial_{x^i}u^a$ and differentiating $F^r=0$. We get the new first-order PDE system for unknown functions $u^a,p^a_i$:
    \[\left\{
        \begin{array}{l}
            p^a_i=\partial_{x^i}u^a,\\ 
            F^r_{x^i}+F^r_{u^a}p^a_i+F^r_{p^a_j}\partial_{x^i}p^a_j=0, \quad i=1,\ldots,n.
        \end{array}
    \right.\]
    Obviously the solutions of the original system and this one are in one-to-one correspondence (this is the reason for the unspecified constant). It is an exercise to check that $(\calI^{(1)},\sfv)$ is exactly the contact system corresponding to the prolonged PDE system.
\end{example}

\begin{xca}
    Carry out the checks in the above two examples.
\end{xca}


\begin{example}
    The following system describes the classical (Newtonian) theory of matter and gravitation:
    \begin{gather}
        \curl \bf{X}=0,\quad \div \bf{X}=-4\pi \rho,\\
        \dot{\bf{u}} +\div(\rho \bf{u})=0,\\
        \dot{\bf{u}}+(\bf{u}\cdot \nabla)\bf{u}=\bf{X},\quad i,j=1,\ldots,3.
    \end{gather} 
    Here, $\bf{x}=(x^1,x^2,x^3)$ are the spatial coordinates, $\dot\rho$ and $\dot{\bf{u}}$ are derivatives w.r.t.\ the time $t$, $\bf{u}$ and $\bf{X}$ are the velocity and acceleration vectors respectively, and $\rho$ is the density of matter. This is a system of $8$ equations in $4$ independent variables and $7$ unknowns, hence it is overdetermined. This system is involutive. 

    For clarity, consider the simpler time-independent system 
    \[\curl \bf{X}=0,\quad \div\bf{X}=-4\pi\rho,\]
    where $\bf{X}$ and $\rho$ are functions of $\bf{x}$ and $\rho$ is given. We will show that this system is involutive. Write it as a Pfaffian system 
    \[\dd X_i=\sum_j X_{ij}\dd x^j,\quad \sum_i X_{ii}=-4\pi \rho,\]
    where $X_{ij}=X_{ji}$ are six new variables. The exterior derivatives give 
    \[\sum_j \dd X_{ij}\wedge\dd x^j=0,\quad \sum_i \dd X_{ii}=-4\pi \dd \rho.\]
    Consider the admissible $3$-dimensional integral elements $E^3$ defined by 
    \[\dd X_{ij}=\sum_k X_{ijk}\dd x^k,\quad X_{ijk}=X_{jik}.\]
    To show the involutivity of the system it suffices to find in $E^3$ a regular integral flag $E^1<E^2<E^3$, such that $E^1$ and $E^2$ are defined respectively by $\dd x^2=\dd x^3=0$ and $\dd x^3=0$. The condition for $E^1$ to be integral is 
    \[\sum_i X_{ii1}=-4\pi \partial_{x^1}\rho.\]
    The conditions for $E^2$ to be integral are, in addition to the above one, 
    \[X_{i12}=X_{i21},\quad \sum_i X_{ii2}=-4\pi \partial_{x^2}\rho ,\quad i=1,\ldots,3.\label{eq iv.141b Bryant}\]
    These equations can be solved in terms of $X_{ij2}$, so that $E^1$ is regular.
    
    To see whether $E^2$ is regular we consider the conditions for $E^3$ to be integral, which are 
    \[X_{i13}=X_{i31}, \quad X_{i23}=X_{i32},\quad \sum_i X_{ii3}=-4\pi \partial_{x^3}\rho.\label{eq iv.141c Bryant}\]
    The first two equations imply 
    \[X_{231}=X_{132}.\]
    But this is the first equation of (\ref{eq iv.141b Bryant}) with $i=3$. Hence it is satisfied, and we see that (\ref{eq iv.141c Bryant}) are compatible as linear equations in $X_{ij3}$. Thus $E^2$ is regular, and so is the integral flag $E^1<E^2<E^3$. This proves the involutivity of the system.

    The proof of the involutivity of the original time-dependent system is exactly the same. It is only suggested that one take as the starting $E^1$ the one defined by $\dd x^1=\dd x^2=\dd x^3=0$ and $\dd t\neq 0$. In 1953 Cartan proved the involutivity of the equations of Einstein's highly overdetermined unified field theory of teleparallelism (1925-1930), which was an early attempt to unify General Relativity with electromagnetism.
\end{example}

One of the main theorems about prolongation is the following strengthening of Theorem~\ref{thm iv.4.4 Bryant}. We provide it without proof.

\begin{thm}[Matsushima (1953) {{\cite[Thm.~VI.2.1]{Bryant}}}]\label{thm vi.2.1 Bryant}
    Let $\calI$ be an \gls{eds} with $\calI^1=\{0\}$. Let $Z\subset\calV^n(\calI)$ be a connected component of the space of ordinary integral elements. Let $(s_p)_{p=0}^n$ be the Cartan characters of $Z$. Then the prolongation $(\calI^{(1)},\sfv)$ is linear and involutive on $Z$. Moreover, the Cartan characters of $\calV^n(\calI^{(1)},\sfv)$ are given by $s_p^{(1)}=s_p+s_{p+1}+\cdots+s_n$ for $p=0,\ldots,n$.
\end{thm}

The full process for describing the integral manifolds of a system is thus summarized by \emph{Cartan's algorithm}, illustrated by the flow chart in Figure~\ref{fig cartan algorithm} for linear Pfaffian systems (it is essentially the same for all systems). 

\begin{figure}[tp]
    \centering
    \includegraphics[scale=0.7]{figures/algorithm.pdf}
    \caption{Flow chart of Cartan's algorithm for linear Pfaffian systems. From \cite{Ivey}.}
    \label{fig cartan algorithm}
\end{figure}


\begin{rem}
    \begin{enumerate}
        \item The Cartan algorithm will not necessarily yield all integral manifolds of the original system, only the integral manifolds arising from well-posed Cauchy problems at general points.
        \item Each time one prolongs, there may be many different connected components of $\calV^n(\calI)$ to which one can restrict. To find all possible integral manifolds, one must carry out the algorithm on each component. The Cartan-Kuranishi Prolongation Theorem says in effect that this process terminates eventually, but gives no hint of how long it may take.
        \item How many prolongations it may take for the algorithm to terminate will generally depend on the component one is working with.
    \end{enumerate}
\end{rem}







\section{(*) Cartan-Poincar\'e Lemma}


This \sect\ will be easier to read having some familiarity with homological algebra. First we prove a very basic lemma from exterior algebra, and later generalize it and explain its significance.


\begin{lem}[Cartan]\label{lem cartan}\index{Lemma!Cartan}
    Let $v_1,\ldots,v_k\in V$ be linearly independent elements of a $\bbK$-vector space $V$ and let $w_1,\ldots,w_k\in V$. Then the equation
    \[v_1\wedge w_1+\cdots v_k\wedge w_k=0\]
    holds iff there exists a unique set of scalars $h_{ij}=h_{ji}$, $1\leq i,j\leq k$, such that $w_i=\sum_j h_{ij}v_j$.
\end{lem}
\begin{proof}
    If $V$ is of dimension $n>k$, then let $v_{k+1},\ldots,v_n\in V$ be such that $\{v_i\}_{i=1}^n$ is a basis. Then every $w_j$ can be uniquely written as 
    \[w_i=\sum_{i=1}^n h_{ij}v_j\]
    with some scalars $h_{ij}$, $1\leq i\leq k$, $1\leq j\leq n$. Then, by assumption,
    \[\sum_{i=1}^k\sum_{j=1}^n h_{ij}v_i\wedge v_j=0\]
    By virtue of the antisymmetry of the wedge product, this is equivalent to
    \[\sum_{1\leq i<j\leq k}(h_{ij}-h_{ji})v_i\wedge v_j+\sum_{j=k+1}^n\sum_{i=1}^k h_{ij}v_i\wedge v_j=0.\]
    Since all terms here are linearly independent, this is equivalent to $h_{ij}=0$ for $j>k$, and $h_{ij}=h_{ji}$ for $1\leq i,j\leq k$.
\end{proof}


Let $V,W$ be vector spaces and consider a linear map $\Omega:V\to W$ with dual $\Omega^\ast:W^\ast\to V^\ast$. We set 
\[C^{p,q}\coloneqq \bigodot^p W^\ast\otimes \bigwedge^q V^\ast.\]
In short, $C^{p,q}$ consists of polynomial exterior forms having polynomial degree $p$ and exterior degree $q$. We now define the \emph{boundary operator}
\begin{gather}
    \delta_\Omega:C^{p,q}\to C^{p-1,q+1},\\
    \delta_\Omega(w_1^\ast\otimes\cdots\otimes w_p^\ast\otimes \psi)=\sum_{i=1}^p w_1^\ast\otimes\cdots\otimes \wh{w}_i^\ast\otimes\cdots\otimes w_p^\ast \otimes \Omega^\ast(w_i^\ast)\wedge\psi,
\end{gather}
where $w_i^\ast\in W^\ast$ and $\psi\in \bigwedge^q V^\ast$. As we will see below, this operator is nothing but a the usual exterior derivative which differentiates the $W$-valued coefficients via the map $\Omega$. It is clear that $\delta_\Omega^2=0$, which allows us to define the resulting \emph{cohomology spaces} (quantifying the non-exactness of the sequence) by 
\[\rmH^{p,q}=\bigslant{\ker\left(C^{p,q}\overset{\delta_\Omega}{\to}C^{p-1,q+1}\right)}{\im \left(C^{p+1,q-1}\overset{\delta_\Omega}{\to}C^{p,q}\right)}.\]
The following important result is, as we will see, a generalization of both the Poincar\'e Lemma~\ref{lem poincare classic} and of the Cartan Lemma~\ref{lem cartan}.

\begin{prop}[Cartan-Poincar\'e Lemma {{\cite[Prop.~VIII.2.1]{Bryant}}}]\index{Lemma!Cartan-Poincar\'e}
    There are isomorphisms
    \[\rmH^{p,q}(\Omega)\cong \bigodot^p(\ker \Omega^\ast)\otimes \bigwedge^q(\coker\Omega^\ast).\]
\end{prop}
\begin{proof}
    \emph{Step One.} First suppose that $\Omega$ is an isomorphism and use it to identify $V$ with $W$. If we choose linear coordinates $x^1,\ldots,x^n$ on $V$, the elements in $C^{p,q}$ are 
    \[\varphi=\sum_{i_1<\cdots<i_q}\varphi_{i_1\ldots i_q}\dd x^{i_1}\wedge\cdots\wedge\dd x^{i_q},\]
    where $\varphi_{i_1\ldots i_q}(\bf{x})\in \bigodot^p W^\ast$ is a polynomial of degree $p$. For polynomials, we will simply write $x^i$ instead of $\dd x^i$ because then the commutative product is automatically implied. Thinking of $\Omega$ as the identity map, we have 
    \[\delta_\Omega(x^{j_1}\cdots x^{j_p}\dd x^{i_1}\wedge\cdots\wedge\dd x^{i_q})=\sum_\alpha x^{j_1}\cdots \wh{x}^{j_\alpha}\cdots x^{j_p}\dd x^{j_\alpha}\wedge \dd x^{i_1}\wedge\cdots \wedge\dd x^{i_q}.\]
    This implies that
    \[\delta_\Omega(\varphi)=\dd\varphi\]
    is the usual exterior derivative. We must show that 
    \[\rmH^{p,q}(\Omega)=\begin{cases}
        0, & p+q>0,\\
        \bbR, & p=q=0.
    \end{cases}\label{eq viii.13 Bryant}\]
    Let 
    \[e\coloneqq \sum_i x^i \partial_{x^i}\]
    be the Euler vector field (its flow simply scales vectors by $\bf{x}\mapsto t\bf{x}$). For $\varphi\in C^{p,q}$, Euler's theorem on homogeneous forms implies that 
    \[\Lie_e \varphi=(p+q)\varphi,\]
    where $\Lie_e$ is the Lie derivative along $e$. Combining this with Cartan's magic formula gives the \emph{homotopy formula}
    \[(p+q)\varphi=i_e\dd\varphi+\dd i_e \varphi,\]
    and this implies (\ref{eq viii.13 Bryant}).

    \emph{Step Two.} In the general case, we may choose bases for $V,W$ so that $\Omega$ is a matrix whose top left block is an identity matrix and the rest is zero. Thus, in suitable linear coordinates $(x^i,y^\alpha)$ on $W$ and $(u^\alpha,w^\lambda)$ on $V$ we have 
    \[\Omega^\ast(\dd x^i)=0,\quad \Omega^\ast(\dd y^\alpha)=\dd u^\alpha.\]
    Using multi-index notations, we may write a typical element in $C^{p,q}$ as 
    \[\wt\varphi=\sum_{I,A}\varphi_{IA}(\bf{x},\bf{y})\dd \bf{u}^I\wedge\dd \bf{w}^A,\]
    where $\varphi_{IA}(\bf{x},\bf{y})$ is a polynomial such that $\deg\varphi_{IA}=p$ and $\deg I+\deg A=q$. We shall identify $\wt\varphi$ with the expression 
    \[\varphi=\sum_{I,A}\varphi_{IA}(\bf{x},\bf{y})\dd \bf{y}^I\wedge\dd \bf{w}^A.\]
    When this is done, 
    \[\delta_\Omega(\varphi)=\sum_{I,A}\partial_{y^\alpha}\varphi_{IA}(\bf{x},\bf{y})\dd y^\alpha\wedge\dd \bf{y}^I\wedge\dd \bf{w}^A.\]
    In other words, $\delta_\Omega$ is the exterior derivative w.r.t.\ the $\bf{y}$ variables, treating $\bf{x}$ and $\bf{w}$ as parameters. This suggests that we set 
    \[C^{r,s,\rho,\sigma}\coloneqq \{\varphi\mid \deg_{\bf{x}}\varphi_{IA}=r,\deg_{\bf{y}}\varphi_{IA}=s,\deg I=\rho,\deg A=\sigma\}.\]
    Then $\delta_\Omega:C^{r,s,\rho,\sigma}\to C^{r,s-1,\rho+1,\sigma}$ and with the obvious notation, 
    \[\rmH^{p,q}(\Omega)\cong \bigoplus_{
        \begin{smallmatrix}
            r+s=p\\
            \rho+\sigma=q
        \end{smallmatrix}}\rmH^{r,s,\rho,\sigma}(\Omega).\]
        On the other hand, the proof of Step One gives 
        \[\rmH^{r,s,\rho,\sigma}(\Omega)=\begin{cases}
            0, & \text{unless }s=\rho=0,\\
            C^{r,s,\rho,\sigma}, & \text{when }s=\rho=0.
        \end{cases}\]
        Combining the last two formulas gives the result.
\end{proof}

We will use the Cartan-Poincar\'e Lemma in the following form, which makes it a clear extension of Poincar\'e's Lemma.

\begin{cor}[Cartan-Poincar\'e Lemma {{\cite[Cor.~VIII.2.2]{Bryant}}}]
    Suppose that $\omega^1,\ldots,\omega^n\in V^\ast$ are linearly independent $1$-forms on a vector space $V$ and that $\varphi_{i_1\ldots i_q}\in \bigwedge^r V^\ast$ are $r$-forms ($r>0$) that satisfy the conditions 
    \[\left\{
        \begin{array}{l}
            \varphi_{i_1\ldots i_q} \text{ is symmetric in }i_1,\ldots,i_q,\\
            \sum_i \varphi_{i_1\ldots i_{q-1} i}\wedge \omega^i=0.
        \end{array}
    \right.\]
    Then there exist $\psi_{j_1\ldots j_{q+1}}\in \bigwedge^{r-1}V^\ast$ that satisfy 
    \[\left\{
        \begin{array}{l}
            \psi_{j_1\ldots j_{q+1}} \text{ is symmetric in }j_1,\ldots,j_{q+1},\\
            \sum_i \varphi_{j_1\ldots j_q j}\wedge \omega^j=\varphi_{j_1\ldots j_q}.
        \end{array}
    \right.\]
\end{cor}
\begin{proof}
    In this case $W=\bbR^n$ and $\Omega:V\to W$ is given by $\Omega(v)=(\omega^1(v),\ldots,\omega^n(v))$, which is surjective. In particular, by the Cartan-Poincar\'e Lemma,
    \[\rmH^{q,r}(\Omega)=0,\quad r>0.\label{eq viii.21 Bryant}\]
    The assumptions of the corollary are 
    \[\delta_\Omega(\varphi)=0,\quad \varphi\in \bigodot^q W^\ast\otimes \bigwedge^r V^\ast,\]
    and the assertion is that 
    \[\delta_\Omega (\psi)=\varphi,\quad \psi\in \bigodot^{q+1}W^\ast\otimes \bigwedge^{r-1}V^\ast.\]
    Thus, the corollary is equivalent to (\ref{eq viii.21 Bryant}).
\end{proof}

When $r=q=1$, this corollary is the usual \emph{Cartan Lemma}~\ref{lem cartan}. When $\Omega$ is an isomorphism, it is the Poincar\'e Lemma for polynomial forms.

We now discuss a variant of the lemma relevant to prolongation theory. Let us redefine the spaces $C^{p,q}$ as 
\[C^{p,q}\coloneqq W\otimes \bigodot^k V^\ast\otimes \bigwedge^q V^\ast.\]
Choosing bases $\{w_a\}$ for $W$ and $\{x^i=\dd x^i\}$ for $V^\ast$ we may think of $\varphi\in C^{k,q}$ as a $W$-valued polynomial form 
\[\varphi=\sum_{\deg I=k,\deg J=q}w_a\otimes \varphi^a_{IJ}\bf{x}^I \dd \bf{x}^J.\]
We define $\delta:C^{k,q}\to C^{k-1,q+1}$ to be the usual exterior derivative treating the $w_a$ as constants. Denoting the resulting cohomology by $\rmH^{k,q}$, we have from Cartan-Poincar\'e Lemma, namely (\ref{eq viii.13 Bryant}), 
\[\rmH^{k,q}=\begin{cases}
    W,& k=q=0,\\
    0, & \text{otherwise}.
\end{cases}\]

Now let $A<W\otimes V^\ast$ be a tableau with prolongations $A^{(q)}<W\otimes \bigodot^{p+1}V^\ast$, and define $C^{k,q}(A)<C^{k,q}$ by 
\[C^{k,q}(A)\coloneqq \begin{cases}
    A^{(k-1)}\otimes\bigwedge^q V^\ast,& k\geq 1,\\
    W\otimes\bigwedge^q V^\ast,& k=0.
\end{cases}\]
The defining property of prolongations, which is that the \emph{total prolongation} $\bf{A}=\bigoplus_{k\geq 0} A^{(k)}$ is the largest graded subspace of the maximal ideal $W\otimes \bigodot^{>0}V^\ast$ that is closed under differentiation and satisfies \[\bf{A}\cap (W\otimes \bigodot^{p+1}V^\ast)=A,\quad \bf{A}\cap (W\otimes\bigodot^q V^\ast)=0,\quad q\leq p,\]
implies that $\delta$ maps
\[\delta:C^{k,q}(A)\to C^{k-1,q+1}(A),\]
and we denote by $\rmH^{k,q}(A)$ the resulting \emph{Spencer cohomology}:
\[\rmH^{k,q}(A)\coloneqq \bigslant{\ker\left(C^{k,q}(A)\overset{\delta}{\to}C^{k-1,q+1}(A)\right)}{\im \left(C^{k+1,q-1}(A)\overset{\delta}{\to}C^{k,q}(A)\right)}.\]

\begin{rem}
    More explicitly, the Spencer cohomology groups $\rmH^{i,j}(A)$ of a tableau $A<W\otimes V^\ast$ are defined as follows. Let 
    \[\delta_j:(W\otimes \bigodot^iV^\ast)\otimes \bigwedge^j V^\ast\to W\otimes \bigodot^{i-1}V^\ast\otimes \bigwedge^{j+1}V^\ast\]
    be defined by 
    \[\delta_j(f\otimes \alpha)=\dd f\wedge \alpha,\]
    where, for $f\in W\otimes \bigodot^i V^\ast$, $\alpha\in \bigwedge^j V^\ast$, we define $\dd f$ by considering $f$ as an element of $\Hom(V^{\otimes i},W)$, and extend $\delta_j$ by linearity. In simpler terms, $\delta_j$ takes the last index of $f$ and antisymmetrizes over the union of that index with the indices of $\alpha$. Note that $\delta_j(A^{(i)}\otimes \bigwedge^j V^\ast)\subset A^{(i-1)}\otimes\bigwedge^{j+1}V^\ast$.

    Then 
    \[\rmH^{i,j}(A)= \frac{\ker\restr{\delta_j}{A^{(i-1)}\otimes \bigwedge^jV^\ast}}{\im \restr{\delta_{j-1}}{A^{(i)}\otimes \bigwedge^{j-1}V^\ast}}.\]
\end{rem}

The main theorem about Spencer cohomology and prolongation, whose proof we omit, is the following.

\begin{thm}[{{\cite[Thm.~VIII.2.4]{Bryant}}}]
    A tableau $A$ is involutive iff $\rmH^{k,q}(A)=0$ for $k\geq 1$, $q\geq 0$.
\end{thm}

From here, it is easy to see that the prolongations of an involutive tableau are involutive. Let $\wt W=A\oplus W$. Then $A^{(1)}$ can be considered as a tableau in $\wt W\otimes V^\ast$ with the $W\otimes V^\ast$ block zero. Consider:
\begin{align}
    \rmH^{0,2}(A^{(1)})&= \frac{\wt W\otimes \bigwedge^2 V^\ast}{\delta\left(A^{(1)}\otimes V^\ast\right)}\\
    &= \frac{W\otimes V^\ast\otimes \bigwedge^2 V^\ast}{\delta\left(\left((A\otimes V^\ast)\cap (W\otimes \bigodot^2 V^\ast)\right)\otimes V^\ast\right)}\\
    &=\rmH^{1,2}(A).
\end{align}
Since prolongations can be defined iteratively, this easily implies that 
\[\rmH^{0,2}(A^{(p)})\cong \rmH^{p,2}(A).\]
In fact, the same argument gives more generally that 
\[\rmH^{k,q}(A^{(p)})\cong \rmH^{k+p,q}(A),\quad k\geq 1.\]
The above theorem then implies that prolongations preserve involutivity. This can be immediately used to show that the prolongation of an involutive linear Pfaffian system is involutive. This is based on the facts, established in \S\ref{sec: lin Pfaffian systems}, that the intrinsic torsion of a linear Pfaffian system  $(\calI,\sfv)$ naturally takes values in $\rmH^{0,2}(A_m)$ and the intrinsic torsion of $(\calI^{(1)},\sfv)$ takes values in $\rmH^{0,2}(A_m^{(1)})\cong \rmH^{1,2}(A_m)$, and if the former vanishes, then so does the latter.

\begin{rem}
    The \emph{Cartan-Kuranishi Prolongation Theorem (1957)}, originally conjectured by Cartan based on numerous examples, implies that after a finite number of prolongations a tableau will become involutive (perhaps by becoming empty, in which case there are no integral manifolds). This implies that, for a linear Pfaffian system on an analytic manifold $M$, if $\rmH^{p,2}(A_m)=0$ for all $p$, then there exist integral manifolds through $m$. This statement is the \emph{Goldschmidt version of Cartan-K\"ahler Theorem}. It is useful because sometimes one can show the vanishing of all groups $\rmH^{p,2}$ without having to compute the prolongations.
\end{rem}







\section{Characteristic variety}



In the Cartan-K\"ahler Theorem~\ref{thm 8.3.3 Ivey} we do not necessarily obtain all solutions to an involutive system by a choice of analytic functions as specified in the theorem. We only obtain those that can be obtained by specifying \emph{noncharacteristic} initial data, that is, initial data based on a choice of a \emph{generic} flag. If we choose a nongeneric flag, the corresponding Cauchy problem may not have any solutions or be undetermined, with an infinite number of solutions. In this \sect\ we formalize this connection between generic flags and characteristic varieties.

Let $M$ be a manifold and denote its tautological $n$-plane bundle by $U\coloneqq \gamma_n(\T M)\to \Gr_n(\T M)$ (cf.\ Definition~\ref{def tautological bundles}). We shall consider the projectivization $\bbP U^\ast$ of the dual bundle $U^\ast$. A point in the fiber $\bbP U^\ast_E$ over some $n$-plane $E\in \Gr_n(\T_m M)$ will be written as $[\xi]$, where $\xi\in E^\ast\setminus\{0\}$ is a nonzero covector and $[\xi]=\<\xi\><E^\ast$ is the corresponding line. By projective duality, $[\xi]$ determines a hyperplane $[\xi]^\perp\coloneqq \Ann(\xi)<E$, and geometrically we may think of $\bbP U^\ast_E$ as being the set of hyperplanes in $E<\T_m M$.

Let $\calI$ be an \gls{eds} on $M$ and assume it has no Cauchy characteristics. This assumption is made merely for convenience and will be eliminated below. Associated to each hyperplane $[\xi]^\perp<E$ is the polar space 
\[H(\xi)\coloneqq H([\xi]^\ast)=\{X\in\T_m M\mid \<\{X\}\cup [\xi]^\perp\>\in\calV(\calI)\},\]
which describes all the ways of extending $[\xi]^\perp$ to an integral $n$-plane.

\begin{defn}[Characteristic variety]\index{Characteristic variety}\label{def char variety eds}
    The (real) characteristic variety of an \gls{eds} $(M,\calI)$ is the subset $\Xi\subset \bbP U^\ast$ defined fiberwise by 
    \[\Xi_E=\{[\xi]\in \bbP E^\ast:E\subsetneqq H(\xi)\},\quad E\in\Gr_n(\T M).\label{eq char variety}\]
    Note that this is non-empty only over integral elements $E$. Thus, $\Xi$ consists of all hyperplanes in integral $n$-planes whose extension to an integral $n$-plane fails to be unique. An integral $(n-1)$-plane $E^{n-1}\in\calV^n(\calI)$ is called \emph{non-characteristic} if $\dim H(E^{n-1})=n$, i.e., if its extension to an integral $n$-plane is unique.
\end{defn}

To the extent that we think of integral elements as infinitesimal solutions to an \gls{eds}, the characteristic variety corresponds to non-uniqueness of an initial value problem, in close analogy to the classical notion. However, unlike in the classical context of differential operators, this definition doesn't require linearization. There is a commuting square 
\[\begin{tikzcd}
    \Xi\arrow[r,hookrightarrow]\arrow[d] & \bbP U^\ast\arrow[d] \\
    \calV^n(\calI)\arrow[r,hookrightarrow] & \Gr_n(\T M).
\end{tikzcd}\]
It is easy to see that the fiber $\Xi_E$ is an algebraic subvariety of $\bbP E^\ast$, i.e., it is defined by polynomial equations. This is because the polar equations are linear in $X\in \T_m M$, and $\Xi_E$ consists of hyperplanes $[\xi]^\perp$ for which the ranks of these equations jump suitably; this condition is expressed by homogeneous polynomial equations in $\xi$. This allows us to also define the \emph{complex characteristic variety} $\Xi^\bbC$ as the set of complex solutions to the same equations. Equivalently, one only needs to replace $E$ in (\ref{eq char variety}) with a complex integral element and $[\xi]^\perp$ with a complex hyperplane in $E$, and $\calV(\calI)$ in the definition of $H(\xi)$ with the space of complex integral elements. Of course, it may happen that $\Xi$ is empty but $\Xi^\bbC$ is not.

The reason we assumed no Cauchy characteristics is that $X\in H(\xi)$ for any Cauchy characteristic vector $X$. Thus, the characteristic variety should only be defined for integral elements that contain all Cauchy characteristic vectors. Equivalently, we may consider the \gls{eds} that is the quotient by the Cauchy characteristics and define the characteristic variety of this reduced system. For linear Pfaffian systems this annoyance will be circumvented.

\begin{example}
    \begin{enumerate}
        \item A \emph{Frobenius system} when $\calI$ is generated by $\dd u^1,\ldots,\dd u^s$ in $\bbR^{n+s}$ with coordinates $(x^1,\ldots,x^n,u^1,\ldots,u^s)$. Then $\Xi^\bbC=\varnothing$. A converse of this for involutive systems will be discussed below.
        \item A \emph{Darboux system} when $\calI$ is generated by $\Theta=\sum_i\dd x^i\wedge\dd y^i$ in $\bbR^{2n}$ with coordinates $(x^1,\ldots,x^n,y^1,\ldots,y^n)$. In this case $\Xi_E=\bbP E^\ast$ is everything.
    \end{enumerate}
\end{example}
\begin{rem}
    Given a differential ideal on a $(2n+1)$-dimensional manifold generated by a single $1$-form $\theta$ satisfying $\theta\wedge(\dd\theta)^{\wedge n}\neq 0$, the Pfaff-Darboux local normal form shows that the maximal integral manifolds $N$, called \emph{Legendre manifolds}, are of dimension $n$ and are given by one arbitrary function of $n$ variables. Here we may think of $\theta=\dd u-\sum_i y_i\dd x^i$ and $N$ given by $(\bf{x},\partial_{\bf{x}}u(\bf{x}))$, where $u(\bf{x})$ is an arbitrary function.
\end{rem}


The most important case is that of linear Pfaffian systems, so we will now show how to define the characteristic variety of such systems in terms of the tableau and the symbol. Recall that a linear Pfaffian system is given by a pair of subbundles $I<J<\T^\ast M$ such that 
\[\dd I\subset \<J\>_{\mathrm{alg}}.\]
(Here we are abusing notation by using the same symbol for a bundle and the space of its sections.) We set $L\coloneqq J\slash I$ so that the exterior derivative induces a bundle map 
\[\wb{\delta}:I\to (\T^\ast M\slash J)\otimes L\]
given in the usual coframe $(\theta^a,\omega^i,\pi^\lambda)$ by the tableau:
\[\wb{\delta}(\theta^a)=A^a_{\lambda i}\pi^\lambda\otimes \omega^i,\]
where the $\omega^i$ are viewed as sections of $L$ and the $\pi^\lambda$ are viewed as sections of $\T^\ast M\slash J$.

Dualizing and using that $(\T^\ast M\slash J)^\ast\cong \Ann(J)<\T M$, giving $\wb\delta$ is equivalent to giving the tableau mapping $\pi$ (cf.~\ref{eq iv.60 Bryant}):
\[\pi:\Ann(J)\to I^\ast\otimes L.\]
The relations on its image, i.e., the tableau bundle $A=\im \pi$, are given by the \emph{symbol map} $\sigma$, which is just the induced quotient map 
\[\sigma:I^\ast\otimes L\to (I^\ast\otimes L)\slash A.\]
Now $\im \pi=\ker\sigma$.

We now define the characteristic variety of a linear Pfaffian system.

\begin{defn}[Characteristic variety of a linear Pfaffian system]
    For each $m\in M$ and $\xi\in L_m\setminus\{0\}$ we let $[\xi]\in \bbP L_m$ be the corresponding line and define the \emph{symbol map at $\xi$} by
    \[\sigma_\xi:I^\ast_m \to (I^\ast \otimes L)_m\slash A_m,\quad w\mapsto \sigma(w\otimes \xi).\]
    The characteristic variety $\Xi\subset\bbP L$ is given fiberwise by 
    \[\Xi_m=\{[\xi]\in \bbP L_m\mid \ker \sigma_\xi\neq \{0\}\}.\]
    In other words, $[\xi]$ is characteristic if there exists a nonzero $w\in I^\ast_m$ such that $w\otimes\xi\in A_m$.
\end{defn}

As we have seen, the symbol map in the usual basis is given by the symbol relations $B^{\lambda i}_a$ defined by the dualized structure equations 
\[B^{\lambda i}_a\pi^a_i\equiv 0\pmod{J}.\]
More precisely, for $\xi=\xi_i\omega^i(m)\in L_m$ as above, $\sigma_\xi$ is given by the matrix
\[\sigma_\xi=\left(B^{\lambda i}_a \xi_i\right)\in \Hom(I^\ast_m,(I^\ast \otimes L)_m\slash A_m).\]
Then 
\begin{align}
    \Xi_m&=\{[\xi]:B^{\lambda i}_a(m)\xi_i w^a=0\text{ for some }w\neq 0\}=\\
    &=\{[\xi]:\rank\left(B^{\lambda i}_a \xi_i\right)<s_0\},
\end{align}
where $s_0=\rank I$. It is clear that $\Xi_m$ is defined by homogeneous polynomial equations in the $\xi_i$, so that each fiber $\Xi_m$ is an algebraic variety.

\begin{rem}
    The way to remember this definition is as follows: associated to a PDE system $F^\lambda(x^i,u^a,u^a_{x^i})=0$ is the canonical contact system $I=\<\theta^a=\dd u^a-p^a_i\dd x^i\>$ on the submanifold in the $(\bf{x},\bf{u},\bf{p})$ space given by $F^\lambda(x^i,u^a,p^a_i)=0$. Differentiating the defining equations of $M$ gives the symbol relations 
    \[F^\lambda_{p^a_i}\dd p^a_i\equiv 0\pmod{J},\quad J=\<\theta^a,\dd x^i\>.\]
\end{rem}

\begin{rem}
    To compare this definition to the more general Definition~\ref{def char variety eds}, recall that Cauchy characteristics are the vector fields $X$ satisfying 
    \[i_X \theta^a=0,\quad i_X\dd\theta^a\equiv 0\pmod{\calI}.\]
    If the $1$-forms $\theta^a,\omega^,\pi^a_i$ fail to span $\T^\ast_m M$ for some $m$, then by our constant rank assumption this will be true in a neighborhood and we can find a vector field satisfying $i_X\theta^a=i_X\omega^i=i_X\pi^a_i=0$. By the structure equation $\dd\theta^a\equiv\pi^a_i\wedge\omega^i\pmod{I}$, this vector field will be a Cauchy characteristic. Thus, under the assumption of no Cauchy characteristics we have 
    \[\T^\ast_m M=\<\theta^a,\omega^i,\pi^a_i\>.\]
    For any integral element $E$ at $m$, the independence condition implies that the restriction map $L_m\to E^\ast$ is an isomorphism. It is now not difficult to show that \emph{under this isomorphism, $\Xi_m\subset \bbP L_m$ corresponds exactly to $\Xi_E\subset \bbP E^\ast$}. See \cite[p.~183]{Bryant} for a proof.
\end{rem}

\begin{rem}
    There is a very simple relation between the Cauchy characteristics and the characteristic variety of a linear Pfaffian differential systems. Let $\calA(\calI)<\T M$ denote the Cauchy characteristic subbundle. Since $\calA(\calI)<\Ann(I)$ the map 
    \[\calA(\calI)\to L^\ast,\quad X\to \left(\omega^1(X),\ldots,\omega^n(X)\right)\]
    is well-defined, and we denote its image by $S<L^\ast$. Then $\Ann(S)<L$ and we shall show that 
    \[\Xi \subset\bbP \Ann(S).\label{eq v.19 Bryant}\]
    In particular, if $S\neq 0$ then it follows that the fibers $\Xi_m$ of the characteristic variety lie in the proper linear subspaces $\bbP \Ann(S_m)\subset \bbP L_m$. Clearly, (\ref{eq v.19 Bryant}) also remains valid when we complexify. In the involutive case, there is a converse to the complex version of (\ref{eq v.19 Bryant}), so $\Xi^\bbC=\bbP\Ann(S^\bbC)$ for involutive systems.

    To prove (\ref{eq v.19 Bryant}), choose a basis $\omega^1,\ldots,\omega^n$ for $L$ so that $\omega^1,\ldots,\omega^k$ is a basis for $\Ann(S)$. Then for $\rho=k+1,\ldots,n$ there is a Cauchy characteristic vector $X_\rho$ satisfying 
    \[i_{X_\rho}\omega^\sigma=\delta^\sigma_\rho,\quad \rho,\sigma=k+1,\ldots,n.\]
    From 
    \[i_{X_\rho}\dd\theta^a\equiv 0\pmod{\calI}\]
    we infer that 
    \[\pi^a_i\equiv 0\pmod{J}.\]
    Thus the tableau matrix looks like 
    \[\begin{pmatrix}
        \pi^1_1 & \cdots & \pi^1_k & 0 & \cdots & 0\\
        \vdots & & & \vdots & & \vdots \\
        \pi^{s_0}_1 & \cdots & \pi^{s_0}_k & 0 & \cdots & 0
    \end{pmatrix}\pmod{J}.\label{eq v.20 Bryant}\]
    In particular, among the symbol relations we have 
    \[\pi^a_\rho \equiv 0\pmod{J},\quad \rho=k+1,\ldots,n.\]
    From this it is easy to see that a characteristic vector $\xi=\xi_i\omega^i$ must have $\xi_{k+1}=\cdots=\xi_k=0$. This proves (\ref{eq v.19 Bryant}).

    We remark that whenever we may choose bases so that the tableau matrix has the block form (\ref{eq v.20 Bryant}), then the zeros correspond to the image $S< L^\ast$ of Cauchy characteristics as described above. We also note that the map $\calA(\calI)\to S$ may not be injective; using the structure equations $\dd\theta^a\equiv \pi^a_i\wedge\omega^i\pmod{I}$ it is easy to see that this is the case exactly when $\theta^a,\omega^i,\pi^a_i$ fail to span $\T^\ast M$. Examples of this arise by adding extra dummy variables to any Pfaffian system.
\end{rem}


\begin{example}[\ref{ex 5.6.1 Ivey} continued]
    The tableau of (\ref{eq 5.20 Ivey}) consists of matrices of the form $\left(\begin{smallmatrix}
        a&b\\b&a
    \end{smallmatrix}\right)$. This has characters $s'_1=2=\dim A$ and $s'_2=0$. A line in $V$ spanned by $\left(\begin{smallmatrix}
        x\\ y
    \end{smallmatrix}\right)$ is characteristic iff the system $ax+by=0$, $bx+ay=0$ on $a,b$ has rank below $2$. Of course, this happens only for the two lines $y=\pm x$. Thus $\Xi_A=\{[1:1],[1:-1]\}$. 
\end{example}

\begin{defn}[Elliptic system]\index{Elliptic!linear Pfaffian system}
    A linear Pfaffian system is called elliptic if its real characteristic variety is empty, $\Xi=\varnothing$.
\end{defn}

\begin{example}[Cauchy-Riemann equations]\label{example cauchy-riemann char variety}
    In $\bbR^{2n}=\bbC^n$ consider the Cauchy-Riemann system 
    \[u_{x^i}-v_{y^i}=0,\quad u_{y^i}+v_{x^i}=0,\quad i=1,\ldots,n.\]
    As we have seen, the symbol matrix of the Pfaffian system corresponding to this PDE is given by its symbol matrix as a PDE:
    \[\begin{pmatrix}
        \xi_1 & \xi_2 & \xi_3 & \xi_4 & \cdots & \xi_{2n-1} & \xi_{2n}\\
        -\xi_2 & \xi_1 & -\xi_4 & \xi_3 & \cdots & -\xi_{2n}& \xi_{2n-1} 
    \end{pmatrix}.\]
    The real characteristic variety is, as expected, empty, so this system is elliptic. However, for each $z\in\bbC^n$ the complex characteristic variety $\Xi^\bbC_z$ is given by the vanishing of all $2\times 2$ minors of this matrix. It is easy to the verify that 
    \[\Xi_z^\bbC=\CP_+^{n-1}\cup \CP^{n-1}_-\subset \CP^{2n-1},\]
    where 
    \[\CP^{n-1}_\pm =\{\xi_2=\pm \i \xi_1,\ldots,\xi_{2n}=\pm \i \xi_{2n-1}\}.\]
    For example, when $n=2$, we may picture $\Xi_z^\bbC$ as two purely imaginary conjugate skew lines in $\CP^3$.
\end{example}


\begin{defn}[Determined system]
    A tableau $A<W\otimes V^\ast$ is called determined if $\dim \Ann(A)=\dim W=s$, i.e., the number of equations is the same as the number of unknowns. A linear Pfaffian system is determined if its symbol matrices are square. 
\end{defn}

\begin{prop}[{{\cite[p.~188]{Bryant}}}]
    Suppose the linear Pfaffian system $(I,J)$ is determined. If for some $\xi\in L_m\setminus\{0\}$, $\det\sigma_\xi\neq 0$, i.e., if the complex characteristic variety is not everything, then the system is involutive at $m$.  
\end{prop}
\begin{proof}
    Writing the symbol relations of a determined system as 
    \[B^{bi}_a\pi^a_i\equiv 0\pmod{J},\]
    we may assume that the characteristic direction is along the $n$'th axis, so $\det\left(B^{bn}_a\right)\neq 0$, and then by a change of basis in the space of relations that 
    \[B^{bn}_a=-\delta^b_a.\]
    The symbol relations become 
    \[\pi^a_n\equiv B^{a\rho }_b\pi^b_\rho\pmod{J},\quad \rho,\sigma=1,\ldots,n-1.\]
    It follows that the characters of the tableau matrix are given by 
    \[s'_1=s_0,\;\ldots,\;s'_{n-1}=s_0,\;s'_n=0.\]
    Now write the symbol relations out as 
    \[\pi^a_n\equiv B^{a\rho }_b \pi^b_\rho +B^a_i\omega^i\pmod{I}.\]
    Integral elements are given by linear equations 
    \[\theta^a=0,\quad \pi^a_i-p^a_{ij}\omega^j=0,\]
    where 
    \[p^a_{ij}=p^a_{ji},\quad p^a_{nj}=B^{a\rho}_bp^b_{nj}+B^a_j.\]
    Choose $p^a_{\rho\sigma}=p^a_{\sigma\rho}$ arbitrarily and use the second relation for $j=1,\ldots,n-1$ to determine the $p^a_{n\sigma}=p^a_{\sigma n}$. Then use the same relation for $j=n$ to determine $p^a_{nn}$. It follows that the $s_0n(n-1)/2$  quantities $p^a_{\rho\sigma}$ specify the integral elements uniquely. We find that 
    \[s_0n(n-1)/2=s'_1+2s'_2+\cdots+ns'_n,\]
    so Cartan's Test is satisfied and the system is involutive.
\end{proof}

% \begin{defn}[Symbol mapping, Characteristic variety]\label{def symbol map}
%     Let $A<W\otimes V^\ast$ be a tableau. For $\alpha\in V^\ast$, define the \emph{symbol mapping} at $\alpha$ by 
%     \[\sigma_\alpha:W\to (W\otimes V^\ast)\slash A,\quad w\mapsto w\otimes\alpha + A.\]
%     Define the \emph{characteristic variety} of $A$, $\Xi_A\subset \bbP V^\ast$ (where $\bbP$ stands for the projectivization functor $V\mapsto V\slash \bbK^\times$ for $\bbK$-vector spaces), to be the set of all \emph{characteristic hyperplanes} (codimension $1$ subspaces) in $V$:
%     \[\Xi_A\coloneqq \{[\alpha]\in \bbP V^\ast\mid \ker \sigma_\alpha\neq 0\}.\]
%     We interpret $\Xi_A$ is the set of hyperplanes in $\bbP V$ for which the extension of an $(n-1)$-dimensional integral element to an $n$-dimensional one is not unique, see Theorem~\ref{thm 6.7.7 Ivey}.
% \end{defn}


% Even when we are only interested in real solutions of the underlying PDE, it is useful to consider the \emph{complex characteristic variety}
% \[\Xi^\bbC_A\coloneqq \{[\alpha]\in \bbP (V^\ast)^\bbC\mid \ker \sigma_\alpha^\bbC\neq 0\},\]
% where $\sigma^\bbC_\alpha:W^\bbC\to (W^\bbC\otimes (V^\ast)^\bbC)\slash A^\bbC$ is the complexification of $\sigma_\alpha$ (see Definition~\ref{def complexification}).





\section{Properties of the characteristic variety}

We now discuss some key properties of the characteristic variety. In doing so, we will omit many proofs, referring the reader to \cite[Ch.~V]{Bryant} instead.

\paragraph{(i) The first derived system and $\Xi$.} The first property deals with a natural subsystem that will turn out being irrelevant to the computation of the characteristic variety.

\begin{defn}[Derived system]
    Let $I<\T^\ast M$ be a Pfaffian system of constant rank. The derived system $I_{(1)}$ of $I$ is the subbundle spanned by $I$-valued forms whose exterior derivatives modulo $I$ vanish. More explicitly, let $\delta:\Gamma^\infty(I)\to \Gamma^\infty\left(\bigwedge^2(\T^\ast M\slash I)\right)$ be defined by \[\delta(\theta)=\dd\theta\mod I.\] 
    
    Because $\delta$ is $C^\infty(M)$-linear, it is induced by a \gls{vb} morphism $\delta:I\to \bigwedge^2(\T^\ast M\slash I)$. Since the coefficients of $\delta$, when expressed in matrix form, are smooth, its rank is upper semicontinuous, so we may restrict to an open set in $M$ on which it has constant rank. On this open set, we define $I_{(1)}\coloneqq \ker\delta$. We have the exact sequence 
    \[0\to I_{(1)}\to I\overset{\delta}{\to}\dd I\slash \<I\>_{\mathrm{alg}}\to 0.\]
    
    If $I_{(1)}=I$, then $I$ is Frobenius; otherwise, $I_{(1)}$ is smaller. In that case, we define a sequence of systems iteratively by $I_{(k+1)}=(I_{(k)})_{(1)}$, until $I_{(N)}$ is either Frobenius ($I_{(N+1)}=I_{(N)}$) or rank zero. The \emph{derived flag} is 
    \[I=I_{(0)}> I_{(1)}>\cdots >I_{(N)},\]
    and $N$ is the \emph{derived length}.
\end{defn}

For an adapted basis $(\theta^1,\ldots,\theta^p;\theta^{p+1},\ldots\theta^{s_0})=(\theta^\rho,\theta^\epsilon)$ for $I_{(1)}<I$ (here $\rho,\sigma=1,\ldots,p$ and $\epsilon,\delta=p+1,\ldots,s_0$) we have 
\[\dd \theta^\rho\equiv 0\pmod{I},\quad \dd\theta^\epsilon\equiv \pi^\epsilon_i\wedge\omega^i\pmod{I}.\]
The symbol relations are of the form 
\[\pi^\rho_i\equiv 0\pmod{J},\quad B^{\lambda i}_\epsilon\pi^\epsilon_i\equiv 0\pmod{J},\]
and the tableau matrix is 
\[\begin{bmatrix}
    0\\\pi^\epsilon_i
\end{bmatrix}.\]
In intrinsic terms, we have the dualized exact sequence 
\[0\to (I\slash I_{(1)})^\ast\to I^\ast\to I^\ast_{(1)}\to 0.\]
The tableau corresponding to the above matrix is given by a subbundle $A<I^\ast\otimes L$ with the property that $A$ projects to zero in $I^\ast_{(1)}\otimes L$, i.e.,
\[A<(I\slash I_{(1)})^\ast \otimes L<I^\ast\otimes L.\]
For $\xi\in L\setminus\{0\}$ the symbol map $\sigma_\xi:I^\ast\to (I^\ast\otimes L)\slash A$ restricts to 
\[\sigma_{(1),\xi}:(I\slash I_{(1)})^\ast\to (I^\ast\otimes L)\slash A,\]
and from the definitions it follows that 
\[\ker\sigma_\xi=\ker\sigma_{(1),\xi}.\]
Thus the characteristic variety is the same as if we consider only the bottom non-zero block in the tableau matrix, i.e., we consider only the ``smaller'' symbol matrices $\left(B^{\lambda i}_\epsilon \xi_i\right)$. Informally, 
\begin{quote}
    \emph{In computing the characteristic variety, we can ignore the derived system.}
\end{quote}
This property is a generalization of the fact that the symbol and the characteristic variety of a PDE depend only on its highest order terms.

\paragraph{(ii) Characteristic variety of the prolongation.}

Recall that the first prolongation $(\calI^{(1)},\sfv)$ is defined on the manifold $M^{(1)}$, which is a connected component of the space of ordinary integral elements of $(\calI,\sfv)$, and as a Pfaffian system $I^{(1)}$ is generated by the equations 
\[\theta^a=0,\quad \theta^a_i=\pi^a_i-p^a_{ij}\omega^j=0,\quad B^{\lambda i}_ap^a_{ij}=0.\label{eq v.76 Bryant}\]
The exterior derivatives of these equations give, using the original structure equations, 
\[\dd\theta^a\equiv 0\pmod{I^{(1)}},\quad\dd\theta^a_i\equiv \pi^a_{ij}\wedge\omega^j\pmod{I^{(1)}},\label{eq v.77 Bryant}\]
where locally $\<I^{(1)}\>=\<\theta^a,\theta^a_i\>$ and 
\[\pi^a_{ij}=-\dd p^a_{ij}+(\text{pullbacks of forms on $M$ to }M^{(1)}).\]
Comparing (\ref{eq v.76 Bryant}) and (\ref{eq v.77 Bryant}) we see as before that the original Pfaffian system is contained in the first derived system of the prolongation, and hence, by  property (i), when computing the characteristic variety of $\calI^{(1)}$ we need only consider the tableau $\left(\pi^a_{ij}\right)$. Differentiating the last equation in (\ref{eq v.76 Bryant}) and using that pullbacks of forms on $M$ are spanned by $\<\theta^a,\omega^i,\pi^a_i\>=\<\theta^a,\omega^i,\theta^a_i\>$, it follows that the symbol relations on the $\pi^a_{ij}$ are 
\[\pi^a_{ij}\equiv \pi^a_{ji}\pmod{\theta^b,\theta^b_i,\omega^i},\quad B^{\lambda i}_a\pi^a_{ij}\equiv 0\pmod{\theta^b,\theta^b_i,\omega^i}.\]
Note that the second set of relations is indexed by $(\lambda,j)$. Thus, we should write these relations as 
\[B^{(\lambda,j)ik}_a \pi^a_{ik}\equiv 0 \pmod{\theta^b,\theta^b_a,\omega^i},\]
where 
\[B^{(\lambda,j)ik}_a=\delta^i_k B^{\lambda i}_a.\]
If $\xi=(\xi_i)$ is characteristic for $(\calI^{(1)},\sfv)$, then there exists a $w=(w^a_i)$ satisfying 
\[w^a_i\xi_j=w^a_j\xi_i,\quad B^{(\lambda,j)ik}_aw^a_i\xi_k=0.\]
From the first relation we have $w^a_i=w^a\xi_i$, and from the second $B^{\lambda i}_aw^a\xi_i\xi_j=0$, $j=1,\ldots,n$. It follows that 
\[B^{\lambda i}_aw^a\xi_i=0,\]
which says that $\xi$ is characteristic for $(\calI,\sfv)$. Since the converse is obviously true, we have established that under the projection $\pi:M^{(1)}\to M$,
\[\text{\emph{There is a natural isomorphism }} \Xi^{(1)}_q\cong \Xi_{\pi(q)}\text{ for all } q\in M^{(1)}.\]
In other words, in the absence of integrability conditions (i.e., if the intrinsic torsion is identically zero), the characteristic variety doesn't change upon prolongation. If there are integrability conditions $[T]=0$, then they will contribute additional symbol relations to the prolonged system, so the characteristic variety may get smaller: $\Xi^{(1)}_q\subset \Xi_{\pi(q)}$.


\paragraph{(iii) Characteristic variety and the Cartan-K\"ahler Theorem.} The remaining properties are more substantial and require involutivity. We discuss them briefly without derivation. Recall that if $\kappa=s_l$ is the top nonzero Cartan character of the system, then it integral manifolds depend on $\kappa$ functions of $l$ variables. To an algebraic geometer, $l$ resembles a transcendence degree and $\kappa$ a field extension degree -- this analogy will turn out to be precise. We will state results that express $l,\kappa$ and the condition to be a regular flag in terms of algebro-geometric properties of the complex characteristic variety $\Xi^\bbC$. In practice these theorems usually allow one to determine $l,\kappa$ and regular flags without going through the sometimes laborious procedure of calculating the $s'_p$. 

If $\Xi^\bbC=\bigcup_\alpha \Xi^{\bbC,\alpha}$ is the unique (fiberwise) decomposition of $\Xi^\bbC$ into irreducible components (i.e., each component is defined by an irreducible system of polynomials), then we define 
\[d^\alpha\coloneqq \dim_\bbC\Xi^\bbC_m,\quad \delta^\alpha(m)\coloneqq \deg \Xi_m^{\bbC,\alpha},\quad \mu^\alpha(m)\coloneqq \dim\ker\sigma_{m,\xi},\]
where $[\xi]\in \Xi^\bbC_m$ is a general point. As a consequence of involutivity, all of these integers are independent of $m\in M$. We further define 
\[d\coloneqq \max_\alpha d^\alpha,\quad \delta(m)\coloneqq \sum{}'\delta^\alpha(m),\quad\mu(m)\coloneqq \sum{}'\mu^\alpha(m),\]
where $\sum{}'$ denotes the sum over components of the maximal dimension, $d$. Again, $d$, $\delta$, and $\sum{}'\mu^\alpha(m)\delta^\alpha(m)$ will be independent of $m$. The main result is the following.

\begin{thm}[{{\cite[Thm.~V.3.6]{Bryant}}}]\label{thm v.3.6. Bryant}
    Let $(\calI,\sfv)$ be an involutive Pfaffian system of character $l$ and Cartan integer $\kappa=s_l$. Then, with the above notation, 
    \[l=d+1,\quad \kappa=\sum{}'\mu^\alpha(m)\delta^\alpha(m).\]
\end{thm}

\begin{cor}[{{\cite[Cor.~V.3.7]{Bryant}},{\cite[Thm.~5.6.12]{Ivey}}}]
    Suppose that all $\mu^\alpha(m)=1$ (this is often the case). Then 
    \[l=\dim_\bbC \Xi^\bbC_m+1,\quad \kappa=\deg \Xi^\bbC_m.\]
\end{cor}

If we omit reference to the point $m$, we may rephrase this as 
\begin{quote}
    \emph{The integral manifolds of an involutive, analytic Pfaffian system locally depend on $\deg\Xi^\bbC$ functions of $\dim_\bbC\Xi^\bbC+1$ variables.}
\end{quote}

\begin{example}[\ref{example cauchy-riemann char variety} continued]
    The characteristic variety of the Cauchy-Riemann system has $\delta^1=\delta^1=\mu^1=\mu^2=1$, so 
    \[d=n-1,\quad \kappa=2,\]
    so we get the familiar result that holomorphic maps of $n$ complex variables depend on $2$ functions of $n$ real variables.
\end{example}

\begin{cor}[{{\cite[Cor.~V.3.11]{Bryant}}}]\label{cor v.3.11 Bryant}
    Let $(\calI,\sfv)$ be a smooth involutive linear Pfaffian system whose complex characteristic variety is empty, $\Xi^\bbC=\varnothing$. Then $\calI$ is completely integrable: through each point of $m$ there passes a unique integral manifold of $\calI$.
\end{cor}
\begin{proof}
    By Theorem~\ref{thm v.3.6. Bryant}, $l=1$ and $\kappa=0$, so we have $s_1=\cdots=s_n=0$, and since there are no integrability conditions, the structure equations are $\dd\theta^a\equiv 0\pmod{\theta^b}$. Thus, the Frobenius condition $\dd I\equiv 0\pmod{I}$ is satisfied.
\end{proof}

A final theorem following from this result is the following.

\begin{thm}[{{\cite[Thm.~V.3.12]{Bryant}}}]
    Let $(\calI,\sfv)$ be an \gls{eds} and assume that:
    \begin{enumerate}[label=(\roman*)]
        \item $\Xi^\bbC=\varnothing$;
        \item the process of prolongation is well-behaved: at each stage we get a locally finite union of manifolds (this is automatic for real analytic systems).
    \end{enumerate}
    Then some prolongation of $(\calI,\sfv)$ is either empty or is a Frobenius system. In particular, for a suitable $q$ each connected integral manifold of $(\calI,\sfv)$ is uniquely determined by its $q$-jet at one point.
\end{thm}
\begin{proof}
    Based on Theorem~\ref{thm vi.2.1 Bryant}, a suitable prolongation $(\calI^{(q)},\sfv)$ is either empty or involutive. Since integral manifolds of $(\calI^{(q)},\sfv)$ are in local one-to-one correspondence with those of $(\calI,\sfv)$, we may focus on the involutive case.  Since prolongation preserves the characteristic variety, $\Xi^{\bbC,(q)}$ is empty. By Corollary~\ref{cor v.3.11 Bryant}, $(\calI^{(q)},\sfv)$ is Frobenius and its integral manifolds are uniquely specified by a choice of a single point of $M^{(q)}$, i.e., by the $q$-jet of the corresponding integral manifold of $(\calI,\sfv)$.
\end{proof}

Informally, we may say that \emph{in the case $\Xi^\bbC=\varnothing$ the integral manifolds depend on a finite number of constants}, which is a generalization of the concept of complete integrability.

\paragraph{(iv) Characteristic variety and K\"ahler-singular elements.} We have defined the characteristic variety in terms of the characteristic, or singular, hyperplanes in $n$-dimensional integral elements. On the other hand, if $(\calI,\sfv)$ is an involutive Pfaffian system of character $l$, then the uniqueness of extensions in the Cauchy problem for $n$-dimensional integral manifolds occurs along $l$-dimensional submanifolds. Thus, we may expect that the characteristic variety should consist of singular $l$-dimensional integral elements. In other words, when $l<n-1$ (roughly speaking, this is the \emph{overdetermined case}), there are two possible characteristic varieties, and it is obviously important to relate them.

Recall that an integral element $E\in\calV^n(\calI)$ is K\"ahler-regular if the rank of the polar equations is locally constant near that element in $\calV^n(\calI)$. Otherwise we call it \emph{K\"ahler-singular}. In terms of the characters, singularity is equivalent to being \emph{non-generic}: a $p$-plane $E^p$ is singular if the total number $s(E^p)$ of polars in a tableau adapted to $E^p$ (this number depends only on $E^p$ itself) is strictly less than the character sum (which characterizes the generic integral $p$-plane). We define 
\[\Lambda_p\coloneqq \{E\in \calV^p(\calI)\subset \Gr_p(L^\ast)\mid s(E)<s'_1+\cdots+s'_p\}.\]
If the character of the system is $l$, then $\Lambda\coloneqq \Lambda_l$ is called the \emph{Cartan characteristic variety}. 

If there are no integrability conditions, i.e., the symbol relations may be assumed to be 
\[B^{\lambda i}_a \pi^a_i\equiv 0\pmod{I},\]
then $\Lambda_p$ us the set of integral $p$-planes whose polar equations have lower rank than the generic integral $p$-plane. In particular, in the absence of integrability conditions, $\Lambda_{n-1}=\Xi$.

According to the Cartan-K\"ahler Theorem, the Cartan characteristic variety determines the set of integral elements that are characteristic for the last Cauchy-Kovalevskaya system in which there is any freedom in assigning initial data. It is clear how to define $\Lambda_p^\bbC$ and $\Lambda^\bbC$. The main result relating the Cartan characteristic variety to the usual characteristic variety is the following.

\begin{thm}[{{\cite[Thm.~V.3.15]{Bryant}}}]\label{thm v.3.15 Bryant}
    If $(\calI,\sfv)$ is involutive and of character $l$, then 
    \begin{align}
        \Lambda^\bbC&=\{E\in \Gr_l(L^{\ast,\bbC})\mid E\in [\xi]^\perp \text{ for some characteristic }[\xi]\in\Xi^\bbC\},\\
        \Xi^\bbC&=\{[\xi]\in\bbP L^\bbC\mid E\in \Lambda^\bbC \text{ for all subspaces }E<[\xi]^\perp\}.
    \end{align}
\end{thm}

Note that since we may have $\Xi=\varnothing$ but $\Lambda\neq \varnothing$, the analogous statement is false over $\bbR$. What we can say is that the \emph{real} Cartan characteristic variety $\Lambda$ is given in terms of the \emph{complex} usual characteristic variety by 
\[\Lambda=\{E\in\Gr_l(L^\ast)\mid E<[\xi]^\perp \text{ for some characteristic }[\xi]\in\Xi^\bbC\}.\label{eq v.102 Bryant}\]
Similarly, the second assertion in Theorem~\ref{thm v.3.15 Bryant} gives $\Xi^\bbC$ in terms of $\Lambda^\bbC$ as follows: an $(n-1)$-plane is characteristic iff \emph{every} $l$-plane contained in it is Cartan characteristic.

\begin{example}[\ref{example cauchy-riemann char variety} continued]
    Consider again the Cauchy-Riemann system on $\bbR^{2n}\cong \bbC^n$, now with the standard complex structure $\sfJ:\bbR^{2n}\to \bbR^{2n}$ given by 
    \[\sfJ(\partial_{x^i})=\partial_{y^i},\quad \sfJ(\partial_{y^i})=-\partial_{x^i}.\]
    We've already seen that this system is elliptic, so $\Xi=\varnothing$. To describe the Cartan characteristic variety, since the system is translation invariant it will suffice to describe the fiber $\Lambda_0$ of $\Lambda$ over the origin, and using (\ref{eq v.102 Bryant}) this is given by 
    \[\Lambda_0=\{E\in\Gr_n(\bbR^{2n}):E\cap \sfJ(E)\neq \{0\}\}.\]
    In other words, $\Lambda_0$ consists of real $n$-planes that contain at least one \emph{complex line} (i.e., a \emph{real} $\sfJ$-invariant $2$-plane). 

    It is, of course, well known that real $n$-dimensional submanifolds $Y^n\subset \bbC^n$ such that $\T_y Y\cap \sfJ(\T_y Y)=\{0\}$ for every $y\in Y$ are locally determining sets for holomorphic functions. 

    In general we have 
    \[\Lambda_{p,0}=\{E\in\Gr_p(\bbR^{2n})\mid \dim E\cap \sfJ(E)\geq \max(1,2(p-m)+1)\}.\]
    For instance, $\Lambda_{2m-1,0}=\Gr_{2m-1}(\bbR^{2n})$ contains no information.
\end{example}

\paragraph{(v) Integrability of the characteristic variety.} Let us define the concept of involutivity for the characteristic variety.

\begin{defn}[Eikonal equation I]
    Let $N$ be a manifold and $\Sigma\subset \bbP \T^\ast N$ a subset. The associated eikonal equation $E_\Sigma\subset C^\infty(N)$ is defined as follows: a function $\varphi\in C^\infty(N)$ is a solution of $E_\Sigma$ if $[\dd \varphi(x)]\in \Sigma_x$ for all $x\in N$ such that $\dd \varphi(x)\neq 0$.
\end{defn}

For another description, let $\wt\Sigma\subset\T^\ast N$ be defined by 
\[\wt\Sigma=\pi^{-1}(\Sigma)\cup \{0\}\subset \T^\ast N,\]
where $\pi:\T^\ast N\setminus \{0\}\to \bbP \T^\ast N$ is the projectivization map and $\{0\}\subset \T^\ast N$ denotes the zero section. Then $\wt\Sigma$ is a \emph{conical subvariety} of $\T^\ast N$, i.e., it is invariant under scaling of the fibers. Moreover, any conical subvariety is of this form. Then solutions to the eikonal equation are characterized by $\dd\varphi(x)\in \wt\Sigma$. 

If $x^1,\ldots,x^n$ are local coordinates on $N$ with induced coordinates $(x^i,\xi_i)$ on $\T^\ast N$, then we shall always assume that $\Sigma$ is a subset with the property that $\wt\Sigma$ is defined by equations 
\[F^\lambda(y^i,\xi_i)=0,\quad \lambda=1,\ldots,R,\]
where the $F^\lambda$ are either smooth or analytic depending on the category in which we are working.

\begin{defn}[Eikonal equation II]
    The eikonal differential equation is a PDE for functions $\varphi\in C^\infty(N)$ of the form
    \[F^\lambda\left(\bf{y},\partial_{\bf{y}}\varphi(\bf{y})\right)=0,\quad \lambda=1,\ldots,R.\]
\end{defn}

\begin{rem}
    The functions $F^\lambda$ need only be defined \emph{microlocally}, i.e., in open sets $U\subset \T^\ast N$ invariant under scaling. In the cases of interest to us the fibers $\Sigma_x$ of $\Sigma\to N$ will be algebraic varieties, so that the $F^\lambda(x^i,\xi_i)$ may be chosen to be homogeneous polynomials in the $\xi_i$, whose coefficients are functions of the $x^i$. In this case, the complexifications 
    \[\Sigma^\bbC\subset \bbP \T^{\ast,\bbC}N,\quad \wt{\Sigma}^\bbC\subset \T^{\ast,\bbC}N\]
    are naturally defined, and so the complex eikonal equation makes sense by allowing the function $\varphi$ to have complex values and requiring that $\dd\varphi\in\wt{\Sigma}^\bbC$. We remark that we may have $\Sigma=\varnothing$ but $\Sigma^\bbC\neq\varnothing$. \emph{From now on we assume that the $F^\lambda$ may be chosen to be homogeneous polynomials in the $\xi_i$}.
\end{rem}

\begin{defn}[Involutive conical subvariety]
    The subset $\Sigma^\bbC\subset \bbP \T^{\ast,\bbC}N$ is called involutive in case the eikonal equation $E_{\Sigma^\bbC}$ is involutive.
\end{defn}

To state the main result, we let $\calI$ be a different system on a manifold $M$ with complex characteristic variety $\Xi^\bbC\subset \bbP U^{\ast,\bbC}$ (cf.~the definitions at the start of this \sect). For any integral manifold $i:N\to M$ of $\calI$ there is the \emph{induced characteristic variety}
\[\Xi_N^{\bbC}\subset \bbP \T^{\ast,\bbC}N\]
defined as follows. We have the diagram 
\[\begin{tikzcd}
     & \bbP U^{\ast,\bbC} \arrow[dl,dashed]\arrow[d,"\wt\pi"]\\
     \bbP \T^{\ast,\bbC}N\arrow[d] \arrow[r,"\wh{i}_\ast"] & \Gr_n(\T M)\arrow[d]\\ 
     N\arrow[r,hookrightarrow,"i"] & M,
\end{tikzcd}\]
where 
\[\wh{i}_\ast(x)=i_\ast(\T_x N),\quad \wt{\pi}^{-1}(m,E)=\bbP E^{\ast,\bbC}.\]
The condition that $N$ be an integral manifold of $\calI$ is that 
\[\wt{\pi}^{-1}(\wt{i}_\ast(N))\to \bbP \T^{\ast,\bbC}N.\]
By definition, $\Xi^\bbC_N$ is the image of $\Xi^\bbC\cap \wt{\pi}^{-1}(\wt{i}_\ast(N))$ under this mapping. Informally, $\Xi^\bbC_N$ \emph{is induced from the characteristic variety $\Xi^\bbC$ in each of the integral elements $i_\ast(\T_x N)\in \Gr_n(\T M)$}.

\begin{defn}[Involutive characteristic variety]
    The characteristic variety $\Xi^\bbC$ is called \emph{involutive} if the eikonal equation $E_{\Xi^\bbC_N}$ is involutive for any integral manifold $N$ of $\calI$.
\end{defn}

The following fundamental result essentially states that \emph{if $\calI$ is involutive, then its characteristic variety is involutive}. 

\begin{thm}[Cartan, Guillemin, Quillen, Sternberg, Gabber (1953-1981) {{\cite[Thm.~V.3.20]{Bryant}}}]
    Let $E\in \calV_n(\calI)$ be an ordinary integral element. Then $\Xi^\bbC$ is involutive in an open neighborhood $V$ of $E$.
\end{thm}
What this means is that $\Xi^\bbC_N$ is involutive for all integral manifolds $i:N\to M$ satisfying $\wt{i}_\ast(N)\subset V$.

% Let us now \emph{work over $\bbC$ and drop $\bbC$ from the notation}. We estimate the dimension of $\Xi_A$ and a modification of the degree of $\Xi_A$ in terms of the characters of $A$. We use the convention that the empty set has dimension $-1$, and denote the modified degree defined below by $\widetilde{\deg}$.

% Now suppose $(I,J)$ has no intrinsic torsion and let $E\in\calV^n(I,J)_m$. Let $H<E$ be a hyperplane, i.e., $\dim H=n-1$. We address the following question: under what circumstances is $E$ the only integral $n$-plane that contains $H$?

% \begin{defn}[Characteristic hyperplane]
%     A hyperplane $H<E<\T_mM$ is said to be characteristic if it has more than one extension to an $n$-dimensional integral element.
% \end{defn}

% With notation as above, we may choose the coframe so that 
% \[\restr{\theta^a}{E}=\restr{\pi^a_i}{E}=0.\]
% Assume moreover that $E$ is uniquely defined by these equations, that is, $\{\theta^a,\omega^i,\pi^a_i\}$ span $\T_m^\ast M$ (so there are no Cauchy characteristics).

% We can also choose frames so that $\restr{\omega^n}{H}=0$. Let $e_1,\ldots,e_n$ be a basis for $E$ dual to $\{\omega^i\}$. Then $v\in \T_mM\setminus H$ completes $H$ to an integral $n$-plane iff 
% \[\forall\Phi \in\calI^n\quad \Phi (v,e_1,\ldots,e_{n-1})=0.\label{eq 6.17 Ivey}\]
% In fact, it is sufficient to require that $i_v \theta^i=0$ and to verify (\ref{eq 6.17 Ivey}) for $\Phi=\pi^a_i\wedge \omega^J$, where $J$ is any multi-index of length $n-1$ containing the index $i$. Since $i_{e_i}\pi^\lambda=0$, (\ref{eq 6.17 Ivey}) becomes 
% \[i_v\pi^a_i=0,\quad  \forall a, i=1,\ldots,n-1.\label{eq 6.18 Ivey}\]
% Now recall the symbol mapping from Definition~\ref{def symbol map}, defining the characteristic variety $\Xi_A$ for $A=A_m$. If $\alpha_H\in \bbP E^\ast$ corresponds to $H<E$, then $\alpha_H\in \Xi_A$ iff 
% \[B^{rn}_a w^a=0\]
% for some nonzero $w\in W$. In other words, $\alpha_H\in\Xi_A$ iff the tableau contains a matrix with the first $n-1$ columns zero and the last column nonzero, or equivalently, some linear combination of the $\pi^a_n$ is linearly independent from the forms in the first $n-1$ columns, so that $v$ is not uniquely determined by (\ref{eq 6.18 Ivey}). We have now proved 
% \begin{thm}
%     A hyperplane $H<E<\T_mM$ is characteristic iff the corresponding element $\alpha_H\in\bbP E^\ast$ is in $\Xi_A$.
% \end{thm}








\section{Hyperbolic second-order \texorpdfstring{\glspl{eds}}{EDSs}}\label{sec: hyperbolic EDS}

We wrap up the chapter by considering some special systems, related to second-order PDEs, that we will encounter in the study of surfaces in the next \chap. A general classification of second-order PDEs based on the geometry of their integral manifolds is possible but is quite lengthy, so we direct the reader to \cite[\S VII.1]{Bryant} for that. Instead, we will focus on a specific method developed for \emph{hyperbolic second-order equations}, which are distinguished by the fact that their characteristic variety is given by a quadratic equation with two distinct real roots.

We consider a general second-order PDE for a function of two variables as an \gls{eds}. We use the coordinates $(x,y,z,p,q,r,s,t)$ on $\rmJ^2(\bbR^2,\bbR)$ and contact forms 
\[\theta_0=\dd z-p \dd x-q\dd y,\quad \theta_1=\dd p-r\dd x-s\dd y,\quad \theta_2=\dd q-s\dd x-t\dd y.\]
Suppose the PDE takes the form 
\[F(x,y,z,p,q,r,s,t)=0\label{eq 7.10 Ivey}\]
and that this equation defines a smooth submanifold $M^7<\rmJ^2(\bbR^2,\bbR)$, and that at least one of the partial derivatives $F_r,F_s,F_t$ is nonzero at each point of $M$, and say that $F$ is \emph{regular} when these assumptions hold. Regularity ensures that $\theta_0,\theta_1,\theta_2$ restrict to be linearly independent on $M$, and that the projection $\pi:M\to \rmJ^1(\bbR^2,\bbR)$ is a smooth submersion at each point. 

Let $I$ be the Pfaffian system spanned by the restrictions of $\theta_1,\theta_2,\theta_3$ to $M$. Since $\dd\theta_0\equiv 0\pmod{I}$, the ideal $\calI=\<I\>_{\mathrm{diff}}$ is generated algebraically by $I$ and the $2$-forms 
\[\dd\theta_1=-(\dd r\wedge \dd x+\dd s\wedge \dd y),\quad \dd\theta_2=-(\dd s\wedge\dd x+\dd t\wedge\dd y).\]
We could write down the tableau immediately, but before doing so it is useful to find a coframe in which the symbol relation has the simplest form. Near any point in $M$, one can obtain $1$-forms $\pi_1,\pi_2,\pi_3$ such that 
\begin{align}
    \dd\theta_1& \equiv -(\pi_1\wedge \dd x+\pi_2\wedge\dd y )\pmod{I} \\
    \dd\theta_2& \equiv -(\pi_2\wedge\dd x+\pi_3\wedge\dd y) \pmod{I}
\end{align}
and such that they satisfy the symbol relation 
\[F_r\pi_1+F_s\pi_2+F_t\pi_3\equiv 0\pmod{I}.\label{eq 6.15 Ivey}\]
For example, if $F_r\neq 0$, we may choose 
\begin{align}
    \pi_1&= \dd r+\frac{F_rD_xF-F_sD_yF}{F_r^2}\dd x+\frac{D_y F}{F_r}\dd y,\\
    \pi_2&=\dd s+\frac{D_y F}{F_r}\dd x,\\
    \pi_3&=\dd t.
\end{align}
where $D_xF=F_x+pF_z+rF_p+sF_q$ and $D_yF=F_y+qF_z+sF_p+tF_q$.

Let $u\in M$ and let $E\in \calV^2(\calI)$ be an integral $2$-plane at $u$. If we use the bases $\{\theta_0,\theta_1,\theta_2\}$ for $W^\ast=I_u$ and $\{\dd x,\dd y\}$ for $E^\ast\cong V^\ast=(J\slash I)_u$, then (\ref{eq 6.15 Ivey}) shows that the tableau has the form 
\[A_u=
    \left\{
\begin{pmatrix}
    0 & 0\\
    a & b\\
    b& c
\end{pmatrix}
    \middle| aF_r(u)+bF_s(u)+cF_t(u)=0
    \right\}<W\otimes V^\ast.
\]

Applying Cartan's Test to the tableau shows that such systems are involutive with solutions depending locally on $s_1=2$ functions of one variable. Although there is usually no explicit way to describe the solutions in terms of these functions, we will see several examples where such description exists when we discuss Darboux's method.

A nonzero covector $\xi=\xi_1\dd x+\xi_2\dd y$ belongs to the characteristic variety of $\calI$ iff 
\[ F_r\xi_1^2+F_s\xi_1\xi_2+F_t\xi_2^2=0.\label{eq 7.11 Ivey}\]
Thus, the characteristic directions are the null lines of this quadratic form.

\begin{defn}[Elliptic, hyperbolic, parabolic PDE]
    The PDE (\ref{eq 7.10 Ivey}) is called elliptic, hyperbolic or parabolic according  to whether the determinant $F_rF_t-\frac{1}{4}F_s^2$ of the quadratic form is positive, negative or zero, respectively.
\end{defn}


In this section we assume that $\calI$ is hyperbolic, and the elliptic case can be dealt with similarly by using complex-valued forms. Note that (\ref{eq 7.11 Ivey}) implies that a linear combination of the system's $2$-forms is congruent, modulo $I$, to a decomposable $2$-form with $\xi$ as one of the factors. (A form is called \emph{decomposable} if it is a wedge product of $1$-forms; note that not every form is decomposable even locally.)\index{Decomposable form} Therefore, when the PDE is hyperbolic, there are two linearly independent decomposable $2$-forms in the ideal that are independent of the $\theta^a$. We may choose linearly independent forms $\pi_1,\pi_2,\omega_1,\omega_2$ that are not in $\calI^1$, such that $\pi_1\wedge\omega_1$ and $\pi_2\wedge\omega_2$ are these decomposable forms in $\calI^2$, and $\omega_1\wedge\omega_2\neq 0$ is the independence condition. In order to simplify the tableau, we may also choose new forms $\wt\theta_1,\wt\theta_2$ in $\calI^1$ so that 
\[\dd\wt\theta_1\equiv -\pi_1\wedge\omega_1,\quad \dd\wt\theta_2\equiv -\pi_2\wedge\omega_2\pmod{I}.\label{eq 7.12 Ivey}\]
(However, this is not immediately necessary.)

At each point of an integral surface for $\calI$, the tangent vectors to the surface that are annihilated by $\omega_1$ and $\omega_2$ are characteristic in the sense defined above. Moreover, since each $\pi_i$ pulls back to the surface to be a multiple of $\omega_i$, each such vector is annihilated by all of the forms of one of the following two \emph{characteristic systems}:
\[\calM_1\coloneqq \<\theta_0,\theta_1,\theta_2,\pi_1,\omega_1\>,\quad \calM_2\coloneqq \<\theta_0,\theta_1,\theta_2,\pi_2,\omega_2\>.\]
Each integral surface is foliated by integral curves of $\calM_1$ and by integral curves of $\calM_2$. In order to distinguish them from Cauchy characteristics, these curves are sometimes called \emph{Monge characteristics}.

\begin{rem}
    If $F_r\neq 0$, then $\xi=\dd y-m\dd x$ belongs to the characteristic variety iff $m$ is a root of the quadratic equation 
    \[F_rm^2-F_sm+F_t=0.\label{eq 7.13 Ivey}\]
    Assuming that this has distinct roots $m_1,m_2$, the decomposable $2$-forms in $\calI$ are 
    \[(\dd y-m_1\dd x)\wedge (\pi_2+m_2\pi_3),\quad (\dd y-m_2\dd x)\wedge (\pi_2+m_1\pi_3),\]
    where $\pi_i$ are as above.
    If the PDE (\ref{eq 7.10 Ivey}) is \emph{quasilinear} (i.e., the highest-order derivatives enter linearly), then the equation (\ref{eq 7.13 Ivey}) only involves $x,y,z,p,q$. More generally, we say that a second-order PDE for one function of two variables has \emph{first-order characteristics} if there exists a rank $3$ Pfaffian system on $\rmJ^1(\bbR^2,\bbR)$ whose pullback to $M$ is contained in one of the characteristic systems of $\calI$. This is the case when (\ref{eq 7.10 Ivey}) is a Monge-Amp\`ere equation, which we will consider below. The existence of first-order characteristics is intrinsic to the system, since $\rmJ^1(\bbR^2,\bbR)$ is the quotient of $M$ by the foliation dual to the retracting space of $I$'s first derived system.
\end{rem}
As a final remark, we can generalize the notion of Monge characteristics to systems which have structure equations similar to (\ref{eq 7.12 Ivey}).

\begin{defn}
    An \gls{eds} is hyperbolic of class $k$ if near any point it is algebraically generated by $k$ independent $1$-forms and two decomposable $2$-forms with no common factors.
\end{defn}

Thus, the retracting space of such a system has dimension $k+4$. For this reason, a hyperbolic \gls{eds} of class $k$ may be assumed to be defined on a $(k+4)$-dimensional manifold. This generalization will be useful for studying hyperbolic PDEs because the prolongation of a hyperbolic system of class $k$ is hyperbolic of class $k+2$. Hyperbolic systems of even class arise when we consider PDEs for two functions of two variables.









\section{Darboux's method}

We now turn to \emph{Darboux's method}, which gives a recipe for solving certain second-order PDEs using ODE techniques. If the equation passes a certain test, we may specify two arbitrary functions of one variable, and construct (some) solutions by solving systems of ODE's. The test is carried out by calculating the derived flag for each of the characteristic systems defined above. The dimensions of the spaces in the derived flag are differential invariants that classify Pfaffian systems. These dimensions satisfy certain systems of inequalities, see \cite{Bryant}.

\begin{example}
    On $\bbR^4$ with coordinates $(u,v,x,y)$ let $I$ be spanned by 
    \[\theta_1\coloneqq \dd y-v\dd x,\quad \theta_2\coloneqq \dd v+x\dd u.\]
    Since $\dd\theta_1\equiv x\dd u\wedge \dd x\pmod{I}$ and $\dd\theta_2=\dd x\wedge\dd u$, then $I_{(1)}$ is spanned by 
    \[\omega\coloneqq \theta_1+x\theta_2=\dd y+x\dd v-v \dd x+x^2\dd u.\]
    Since $\dd\omega=2\dd x\wedge\theta_2$, $I_{(1)}$ is not Frobenius. Hence the derived flag terminates in $I_{(2)}=0$.
\end{example}

The generic Pfaffian system of rank $2$ on a $4$-dimensional manifold has derived length $2$. Such systems are said to define an Engel structure. Engel's normal form shows that all such systems are locally diffeomorphic (see \S\ref{sec: monge equations}). By contrast, a generic Pfaffian system of rank $3$ in $5$ variables has derived length two but contains no Frobenius system. Unlike Engel structures, such systems are not all locally diffeomorphic to each other. Their classification was the subject of Cartan's ``five variables'' paper. 

Let $\calI$ be the \gls{eds} we constructed for the PDE (\ref{eq 7.10 Ivey}) for one function of two variables. On any integral surface of $\calI$ satisfying the independence condition, the Monge characteristic curves form two foliations which are transverse at each point of the surface. Suppose one characteristic system $\calM_i$ happens to contain two linearly independent $1$-forms that are exact derivatives:
\[\dd W,\dd X\in\calM_i.\]
Then $W$ and $X$ are both constant along the integral curves of $\calM_i$ (such functions are called \emph{Riemannian invariants} for the PDE). It follows that $W,X$ are functionally dependent on the integral surface. If we suppose that $\<\dd W,\dd X\>\subset \calM_i$ is linearly independent from $I$, we can assume that, say, $\dd X$ restricts to be nonzero on an open set in the integral surface. Then $W$ must be some function of $X$ on the surface. When both characteristic systems have these properties, the functions may be arbitrarily specified and used to construct a solution.


\begin{example}[Hyperbolic Liouville equation]\label{ex 7.3.6 Ivey}
    For the hyperbolic Liouville equation $z_{xy}=\rme^z$ ((\ref{eq liouville general}) with $K=-1$ and $\Delta$ replaced by the wave operator in ``lightcone coordinates'' $(x,y)\mapsto (x+y,x-y)$), the Pfaffian system $I$ is defined by \index{Equation!Liouville}
    \[
    \begin{matrix}
        \theta_0=\dd z-p\dd x-q\dd y,\\
        \theta_1=\dd p-r\dd x-\rme^z\dd y,\\
        \theta_2=\dd q-\rme^z\dd x-t\dd y,
    \end{matrix}    
    \;\;\text{with}\;\;
    \begin{matrix}
        \dd\theta_1\equiv -(\dd r-p\rme^z \dd y)\wedge \dd x\\
        \dd\theta_2\equiv -(\dd t-q\rme^z \dd x)\wedge \dd y
    \end{matrix}\pmod{I}.
    \]
    The characteristic system $\calM_1$ contains two exact derivatives, $\dd x$ and $\dd (r-\frac12 p^2)$, the latter obtained by adding multiples of $\dd x$ and $\theta_1$ to $\dd r-p\rme^z\dd y$. Similarly, $\dd y$ and $\dd(t-\frac12 q^2)$ are in $\calM_2$. Hence, 
    \[r-\frac12 p^2=f(x),\quad t-\frac12 q^2=g(y)\label{eq 7.14 Ivey}\]
    for some functions that depend on the particular solution of Liouville's equation defining our integral surface. Again, we may use these functions to determine the solution. For, if we choose $f$ and $g$ arbitrarily, and then restrict $\calI$ to the codimension-two submanifold defined by (\ref{eq 7.14 Ivey}), then the restriction is a Frobenius system. This means that we can solve for $z(x,y)$ by solving systems of ODE's. In this example, we can solve the system 
    \[z_x=p,\quad p_x=f(x)+\frac12 p^2\label{eq 7.15 Ivey}\]
    and a similar system in the $y$-direction, and be guaranteed by the Frobenius condition that we have generated a solution to the original PDE.
\end{example}

\begin{defn}[Darboux-integrable system]\index{Darboux integrability}
    A hyperbolic \gls{eds} $\calI=\<I\>_{\mathrm{diff}}$ is said to be Darboux-integrable if each characteristic system $\calM_i$ contains a Frobenius system $\Delta_i$ of rank two that is independent from $I$.
\end{defn}

\begin{prop}[{{\cite[Prop.~7.3.8]{Ivey}}}]\label{prop 7.3.8 Ivey}
    Let $\calI$ be a Darboux-integrable \gls{eds} on $M$. Let $W_1,W_2,X_1,X_2$ be functions defined on an open set $U\subset M$ such that $\dd W_i,\dd X_i\in \Delta_i$ for $i=1,2$. Let $f_1,f_2$ ve arbitrary smooth functions and let $N\subset U$ be the codimension-$2$ submanifold defined by $W_i=f_i(X_i)$. Then $\restr{\calI}{N}$ is Frobenius.
\end{prop}
\begin{proof}
    Since $\calM_i=I\oplus\Delta_i$, then on $U$ the image $\delta(I)$ is spanned by $\dd W_1\wedge\dd X_1$ and $\dd W_2\wedge \dd X_2$.
\end{proof}


\begin{example}[\ref{ex 7.3.6 Ivey} continued]
    We saw that the hyperbolic Liouville equation is Darboux-integrable. Now, to obtain a solution, it seems that we must solve Ricatti differential equations (\ref{eq 7.15 Ivey}) for $p$ and $q$. There is no general formula for solutions of Ricatti equations in quadratures. However, since $f(x)$ is arbitrary, we may make convenient choices for the form of $f(x)$. In particular, if we set $f(x)=F'(x)-\frac12 F(x)^2$, then $F(x)$ is another solution of the Ricatti equation that $p$ satisfies. The standard trick is to notice that $v=1/(p-F(x))$ satisfies a linear differential equation. Solving that equation using an integrating factor leads to 
    \[p=\frac{X''}{X'}-\frac{2X'}{X+Y'},\]
    where $X$ and $Y$ are arbitrary functions of $x$ and $y$, respectively, and $F(x)=X''/X'$. Integrating gives 
    \[z=\ln \frac{2X(x)'Y(y)'}{(X(x)+Y(y))^2.}\label{eq Liouville general solution}\]
    This is the general solution to Liouville's equation $z_{xy}=\rme^z$.
\end{example}

Note that the definition of Darboux integrability applies to hyperbolic of arbitrary rank. For example, a second-order PDE for $z(x,y)$ may become Darboux-integrable after prolonging $k$ times. Then, as before, the Pfaffian system becomes a Frobenius system of rank $2k+3$ when restricted to submanifolds of the form $U=f(X)$, $V=g(Y)$, where $\{\dd U,\dd X\}$ and $\{\dd V,\dd Y\}$ are the rank $2$ systems described in the definition. 

The problem of classifying which second-order PDEs become Darboux-integrable after a finite number of prolongations has a long history and is still a subject of current research. One of the earliest results in this area is Lie's proof that the only equations of the form $z_{xy}=f(z)$ that are Darboux-integrable after a finite number of prolongations are those with $f(z)=\exp(az+b)$. Another significant early result was Goursat's classification of quasilinear equations $z_{xy}=f(x,y,z,p,q)$ that are Darboux-integrable without prolongation. 









\section{(*) Theorems of Pfaff and Darboux}\label{sec: pfaff darboux thms}

This \sect\ summarizes, without proof, a few classical results about specific Pfaffian systems which can be seen as a result of the classification of a certain class of systems up to diffeomorphism. Each differential system is described by a set of \emph{differential invariants}, which are quantities that remain invariant under diffeomorphisms (changes of coordinates). Among them are Cartan characters, ranks of derived systems, and so on. If two systems have a differing set of differential invariants, they can't be \emph{equivalent} (i.e., related by a diffeomorphism). By a \emph{normal form} we mean a specific differential system such that any other differential system in the same class (i.e., with the same values of some specified differential invariants) is equivalent to it. \emph{Cartan's problem of equivalence} is, broadly speaking, the problem of finding the differential invariants that describe various classes of differential systems, and explicitly establishing the equivalences between different systems.

In this \sect\ we deal with Pfaffian systems on a manifold $M$ generated by a single $1$-form. The integrability condition from Proposition~\ref{prop 4.7.6 RS1 pfaffian rank 1} in the special case of $\dim M=3$ was first obtained by Euler in 1755. It was Pfaff who posed, in 1814-1815, the general problem of studying PDEs of the form $\theta=0$ for $\theta\in\Omega^1(M)$ in any number of dimensions.

Let $\theta\in\Omega^1(M)$ and consider the $2$-form $\dd\theta\in\Omega^2(M)$. In local coordinates its matrix has a rank which is independent of the choice of coordinates, i.e., it is a differential invariant of the Pfaffian system spanned by $\theta$. First let us assume that this rank is even and equal to $2k$. The integer $k$ is called the \emph{Pfaff rank} of $\theta$. We denote by $(\dd\theta)^l\coloneqq \dd\theta\wedge\cdots\wedge\dd\theta$ the $l$-th exterior power of $\dd\theta$. Then it is easy to see that 
\[\theta\wedge(\dd\theta)^{k}\neq 0,\quad \theta\wedge(\dd\theta)^{k+1}=0,\]
that is, $k$ is the highest integer such that $\theta\wedge(\dd\theta)^{k}$ is not identically zero. 

The integer $2k+1$ is called the \emph{class of the Pfaffian equation} $\theta=0$. Note that it is well-defined as a property of the equation because any form $f\theta$, $f\in C^\infty(M)$, has the same Pfaff rank as $\theta$. Proposition~\ref{prop 4.7.6 RS1 pfaffian rank 1} can then be restated as saying that the Pfaffian equation $\theta=0$ has integral manifolds iff $\theta$ has Pfaff rank $0$.

However, it is still useful to study equations of nonzero Pfaffian rank $k>0$. Darboux showed that instead of having true integral manifolds $S$ with $\T S=\ker\theta$, such a system will have non-unique integral manifolds of dimension at most $n-k-1$ such that $\T S<\ker\theta$. Darboux showed this by bringing any $1$-form to a certain \emph{normal form} (this can be seen as an analog of the Rectification Theorem for $k$-frames). The proofs of the theorems in this \sect{} are rather algebraic and unenlightening, so we direct the reader to \cite{Bryant} for details.

\begin{thm}[Pfaff normal form, odd class, Darboux 1882]
    Let $\dim M=n$ and let $\theta\in\Omega^1(M)$ have Pfaff rank $k\geq 0$. Denote the class of $\theta$ by $p\coloneqq 2k+1$. Then at any point in $M$ where $\theta\wedge(\dd\theta)^k\neq 0$ there exist local coordinates $\{x^1,\ldots,x^n\}$ and a non-vanishing smooth local function $f$ such that in the case $k>0$,
    \[\theta=f\cdot (\dd x^{n-p+1}\underbrace{-x^{n-p+2}\dd x^{n-p+3}-x^{n-p+4}\dd x^{n-p+5}-\cdots -x^{n-1}\dd x^n}_{k\text{ terms}}),\]
    and in the case $k=0$, $\theta=f \dd x^n$. The maximum possible dimension of an integral manifold through $m$ is $(n-k-1)$, and for each such manifold the above coordinates can be adjusted so that it is described by 
    \[x^{n-p+1}=x^{n-p+2}=x^{n-p+4}=\cdots=x^{n-1}=0.\]
\end{thm}

The non-uniqueness of integral manifolds in the case $k>0$ can another significant consequence. Let $S$ be the integral manifold described by $x^{n-p+1}=x^{n-p+2}=x^{n-p+4}=\cdots=x^{n-1}=0$. Then any other integral manifold $S'$ near $S$ on which the $n-k-1$ functions $x^1,\ldots,x^{n-p},x^{n-p+3},x^{n-p+5},\ldots,x^n$ form a coordinate system can be described by equations of the form 
\begin{align}
    x^{n-p+1}&=f(x^{n-p+3},x^{n-p+5},\ldots,x^{n}),\\
    x^{x-p+2l}&=\partial_l f(x^{n-p+3},x^{n-p+5},\ldots,x^{n}),\quad 1\leq l\leq k,
\end{align}
for some suitable function $f(y^1,\ldots,y^k)$, where $\partial_l f$ denotes the partial derivative w.r.t.\ the $l$-th argument. Thus, we can informally say that the integral manifolds of the maximal dimension $n-k-1$ are locally parametrized by arbitrary functions of $k$ variables. This implies, in particular, that there is a continuous family of local diffeomorphisms of $M$ that take integral manifolds to integral manifolds, and thus preserve the Pfaffian equation $\theta=0$ itself. Clearly they must comprise a group, and in fact this is roughly how Lie groups were originally discovered.

It is also possible that the matrix of $\dd\theta$ has odd rank, in which case the normal form is slightly different.

\begin{thm}[Pfaff normal form, even class, Darboux 1882]\label{thm pfaff normal form}
    Let $\dim M=n$ and let $\theta\in\Omega^1(M)$ be such that the class of the Pfaffian equation $\theta=0$ is even and equal to $p=2k>0$. Then at any point $m\in M$ there exist local coordinates $\{x^1,\ldots,x^n\}$ and a non-vanishing smooth local function $f$ such that 
    \[\theta=f\cdot (\underbrace{x^{n-p+2}\dd x^{n-p+3}+x^{n-p+4}\dd x^{n-p+5}+\cdots +x^{n-1}\dd x^n}_{k\text{ terms}}).\]
\end{thm}

Another important theorem by Darboux provides a normal form for \emph{closed $2$-forms}. In fact, it is equivalent to the theorem about the normal (block-diagonal) form of an antisymmetric matrix.

\begin{thm}[Darboux]
    Let $\omega\in\Omega^2(M)$ be closed, $\dd\omega=0$, and let $k$ be the highest integer such that the $k$-the exterior power of $\omega$ is not identically zero:
    \[\omega^k\neq 0,\quad \omega^{k+1}=0.\]
    Then at every point where $\omega^k\neq 0$ there exist local coordinates $\{x^1,\ldots,x^n\}$, $n=\dim M$, such that 
    \[\omega=\dd x^1\wedge \dd x^2+\cdots \dd x^{2k-1}\wedge\dd x^{2k}.\]
\end{thm}

We will later prove the symplectic case of this theorem, which is just the case of $2k=n$, i.e., when $\omega$ is non-degenerate. By combining the three theorems above, one can further simplify the normal form for $\theta$.

\begin{thm}[Darboux]
    Let $\theta\in\Omega^1(M)$ have Pfaff rank $k$ near $m\in M$. Necessarily either $(\dd\theta)^{k+1}$ vanishes at $m$ or it is nonzero near $m$. Then there exist local coordinates $\{w^0,\ldots,w^n\}$ near $m$ such that $\<\theta\>_{\mathrm{diff}}$ is locally generated by 
    \[\wt\theta=\dd w^0+w^{k+1}\dd w^1+\cdots +w^{2k}\dd w^k\]
    (i.e., $\theta$ is locally a nonzero multiple of $\wt\theta$). Moreover, there exist local coordinates $\{x^0,\ldots,x^{n-1}\}$ near $m\in M$ such that
    \begin{align}
        \theta&= x^0 \dd x^1+\cdots +x^{2k}\dd x^{2k+1}, &\text{ if }(\dd\theta)^{k+1}\neq 0\text{ at }m,\\
        \theta&= \dd x^1+ x^2\dd x^3+\cdots +x^{2k} \dd x^{2k+1}, &\text{ if }(\dd\theta)^{k+1}=0 \text{ at }m.
    \end{align}
\end{thm}

Lastly, the following intuitive application of the Pfaffian normal form plays a crucial role in the foundations of thermodynamics, and now in control theory.

\begin{thm}[Caratheodory]
    Let $\theta=0$ be a Pfaffian equation on $M$ of constant Pfaff rank. Then every $m\in M$ has a neighborhood $U$ such that every point $p\in U$ is connected to $m$ by an integral curve of $\theta=0$ iff it is not fully integrable, i.e.,
    \[\theta\wedge\dd\theta\neq 0.\]
\end{thm}






\section{(*) Monge equations}\label{sec: monge equations}

Here we present an application of the derived flag of Pfaffian systems to demonstrate Engel's and Goursat's normal forms for certain PDEs. Consider again a Pfaffian system defined by $I=\<\theta^1,\ldots,\theta^s\>$ (where the $\theta^a$ are pointwise linearly independent) on a $n$-dimensional manifold $M$. If $s=n-1$, then this system is completely integrable. In fact, on the choice of an independent variable, it becomes a system of ODE's describing the integral curves of some vector field (determined up to multiplication by a scalar function).

In this section we study the case $s=n-2$, which is already a rich subject with diverse phenomena. The case $n=5,s=3$ is the content of Cartan's 1910 ``five variables'' paper and the general case has barely been touched.

Let us complete the forms $\theta^a$ to a coframe by adding two $1$-forms $\theta^{n-1},\theta^{n}$ (previously we would name them $\pi^1$ and $\pi^2$). We will assume that the independence condition is $\theta^1\wedge\cdots\wedge\theta^n$. Then the torsion form has only one component for each $a$ and we have 
\[\dd\theta^a\equiv T^a \theta^{n-1}\wedge\theta^n \pmod{I}, \; 1\leq a\leq s.\]
If $T^a=0$, the system is integrable and the derived system is $\calI_{(1)}=\calI$. We discard this case and suppose that torsion is not vanishing. The $\theta^a$ are defined up to the non-singular linear transformation 
\[
\begin{pmatrix}
    \theta^1 \\
    \vdots \\
    \theta^n
\end{pmatrix}\to 
\begin{pmatrix}
    u^1_1 & \cdots & u^1_s & 0 & 0\\
    \vdots & \cdots & & &\\
    u^s_1 & \cdots & u^s_s & 0 & 0\\
    u^{n-1}_1 & \cdots & u^{n-1}_s & u^{n-1}_{n-1}& u^{n-1}_n\\
    u^n_1 & \cdots & u^n_s & u^n_{n-1} & u^n_n
\end{pmatrix}
\begin{pmatrix}
    \theta^1 \\
    \vdots \\
    \theta^n
\end{pmatrix}.
\]
By choosing the above matrix properly, we can suppose that 
\[T^1=\cdots =T^{s-1}=0,\quad T^s=1,\]
so that 
\[\dd \theta^1\equiv \cdots \dd\theta^{s-1}\equiv 0,\quad \dd\theta^s\equiv \theta^{n-1}\wedge\theta^n \pmod{I}.\label{eq 31 Bryant}\]
Under this choice, $\calI_{(1)}$ is generated by $\theta^1,\ldots,\theta^{n-1}$ and $\rank I_{(1)}=s-1$. In the case $s=2,n=4$ we have the theorem:

\begin{thm}[Engel's normal form {{\cite[Thm.~5.1]{Bryant}}}]\label{thm 5.1 Bryant}
    Let $\calI=\<I\>_{\mathrm{diff}}$ be a Pfaffian system of two equations in four variables with derived flag satisfying $\rank I_{(1)}=1, I_{{(2)}}=0$. Then locally there are coordinates $x,u,p_1,p_2$ such that 
    \[I=\<\dd u-p_1\dd x,\dd p_1-p_2\dd x\>.\]
\end{thm}

If the system is put into Engel normal form, then the general solution of this Pfaffian problem with the independence condition $\dd x$ is clearly given by 
\[u=f(x),\quad p_1=f_x(x),\quad p_2=f_{xx}(x),\]
where $f$ is an arbitrary function of one variable.

Engel's normal form is they key tool in the theory of the \emph{Monge equation}\index{Equation!Monge}
\[F(x,u,v,p,q)=0,\quad p=u_x,\quad q=v_x,\label{eq monge}\]
which is an under-determined first order equation for two unknown functions $u,v$ of one variable $x$. (In fact, the general Monge equation on $\bbR^3$ has the form $F(x,y,z,\dd x,\dd y,\dd z)=0$, where the differentials will be replaced by partial derivatives depending on how one chooses independent variables, but it reduces to the above form if the independence condition is just $\dd x$.) The Pfaffian equivalent of this problem is 
\[I=\<\dd u-p \dd x,\dd v-q\dd x\>.\]
The integral manifold in question is a 2-dimensional surface in the $5$-dimensional jet manifold $\rmJ^1(\bbR,\bbR^2)$ parametrized by $(x,u,v,p,q)$. The equation $\dd F=0$ expands to give 
\[F_{p}\dd p+F_q \dd q+F_u(\dd u-p\dd x)+F_v(\dd v-q\dd x)+\frac{\dd F}{\dd x}\dd x=0,\]
where $\frac{\dd F}{\dd x}\coloneqq F_x+F_u p+F_v q$ denotes the ``total derivative''. To achieve the form of (\ref{eq 31 Bryant}), we suppose that 
\[F^2_p +F^2_q\neq 0\]
and set 
\begin{align}
    \theta^1\coloneqq F_p(\dd u-p\dd x)+F_q(\dd v-q \dd x),\\
    \theta^2\coloneqq -F_q(\dd u-p\dd x)+F_p(\dd v-q\dd x).
\end{align}
Then 
\[\dd \theta^1\equiv 0 \pmod{I},\quad \dd\theta^2\equiv (F_q \dd p-F_p \dd q)\not\equiv 0\pmod{I}.\]
Now the conditions of Theorem~\ref{thm 5.1 Bryant} are satisfied and we get the following corollary.

\begin{cor}
    If the Monge equation (\ref{eq monge}) satisfies the condition $F_p^2+F_q^2\neq 0$, it has a general solution depending on one function of one variable (and its first two derivatives).
\end{cor}

\begin{example}
    Consider the eikonal equation
    \[y'^2+z'^2=1.\]
    This can be interpreted either as the equation for unit speed curves in the plane or as null curves in the Lorentzian $3$-dimensional space with metric $\dd x^2-\dd y^2-\dd z^2$. It can be parametrized by 
    \[y'=\sin\varphi ,\quad z'=\cos\varphi,\]
    which leads to the system 
    \[I=\<\dd y-\sin\varphi \dd x,\dd z-\cos\varphi \dd x\>.\]
    The first derived system is given by 
    \[I_{(1)}=\<\dd x-\sin\varphi \dd y-\cos\varphi \dd z\>=\<\dd (x-y\sin\varphi-z\cos\varphi)+(y\cos\varphi-z\sin\varphi)\dd\varphi\>.\]
    Following the general theory we set 
    \begin{align}
        f(\varphi)&\coloneqq x-y\sin\varphi-z\cos\varphi,\\
        f'(\varphi)&=-y\cos\varphi+z\sin\varphi,\\
        f''(\varphi)&=y\sin\varphi+z\cos\varphi
    \end{align} 
    and solve for $x,y,z$ to find the general solution
    \begin{align}
        x&= f''(\varphi)+f(\varphi),\\
        y&= \sin\varphi f''(\varphi)-\cos\varphi f'(\varphi),\\
        z&=\cos\varphi f''(\varphi)+\sin\varphi f'(\varphi),
    \end{align}
    where $f(\varphi)$ is an arbitrary function.
\end{example}

The applications to ODE's of higher order lead to the Pfaffian contact system 
\[\theta_1=\dd u-p\dd x,\quad \theta_2=\dd p-p_1\dd x,\quad\cdots,\quad \theta_{s}=\dd p_{s-1}-p_s\dd x,\]
the jet space being parametrized by $(x,u,p_1,\ldots,p_s)$. This system is of corank two. It satisfies the relations 
\begin{align}
    \dd \theta_i&=-\theta_{i+1}\wedge\dd x,\quad 1\leq i\leq s-1,\\
    \dd \theta_s&\not\equiv 0 \pmod{I}.
\end{align}
It turns out that this system provides the unique normal form for the following class of Pfaffian systems.

\begin{thm}[Goursat normal form {{\cite[Thm.~5.3]{Bryant}}}]\label{thm goursat}
    Let $I=\<\theta^1,\ldots,\theta^s\>$ be a Pfaffian system of corank two on a manifold of dimension $n=s+2$. Suppose there exists a Pfaffian form $\pi\not\equiv 0\pmod{I}$ that satisfies 
    \[\dd\theta^i\equiv -\theta^{i+1}\wedge \pi \pmod{\<\theta^1,\ldots,\theta^i\>},\; 1\leq i\leq s-1,\quad \dd\theta^s\not\equiv 0\pmod{I}.\label{eq 34 Bryant}\]
    Then there is a local coordinate system $(x,u,p_1,\ldots,p_s)$ such that 
    \[I=\<\dd u-p_1 \dd x,\dd p_1-p_2\dd x,\ldots, \dd p_{s-1}-p_s\dd x\>.\]
\end{thm}

To understand the significance of this normal form we return to the general case. Suppose the $\theta^a$ are chosen so that the equations (\ref{eq 31 Bryant}) are satisfied. They are determined up to a transformation of the form
\[
\begin{pmatrix}
    \theta^1 \\
    \vdots \\
    \theta^n
\end{pmatrix}\mapsto 
\begin{pmatrix}
    u^1_1 & \cdots & u^1_{s-1} & 0 & \cdots & 0\\
    \vdots & \cdots & & &\\
    u^{s-1}_1 & \cdots & u^{s-1}_{s-1} & 0 & \cdots & 0\\
    u^s_1 & \cdots & u^s_{s-1} & u^s_s & 0 & 0\\
    u^{n-1}_1 & \cdots & & u^{n-1}_s & u^{n-1}_{n-1}& u^{n-1}_n\\
    u^n_1 & \cdots & & u^n_s & u^n_{n-1} & u^n_n
\end{pmatrix}
\begin{pmatrix}
    \theta^1 \\
    \vdots \\
    \theta^n
\end{pmatrix}.\label{eq 35 Bryant}
\]
Let 
\[\dd\theta^a\equiv R^a \theta^s\wedge\theta^{n-1}+S^a \theta^s\wedge\theta^n \pmod{\<\theta^1,\ldots,\theta^{s-1}\>},\;1\leq a\leq s-1.\]
Under transformation (\ref{eq 35 Bryant}) the rank of the tableau 
\[\begin{pmatrix}
    R^1 & \cdots & R^{s-1}\\
    S^1 & \cdots & S^{s-1}
\end{pmatrix}\label{eq 36 Bryant}
\]
is invariant. In fact, $\rank I_{(2)}=s-2$ or $s-3$ if this rank is $1$ or $2$, respectively. Comparing with (\ref{eq 34 Bryant}), we see that a necessary condition for $I$ to be in the Goursat normal form is $\rank I_{(2)}=s-2$.


\begin{example}[Second order Monge equation]\index{Equation!Monge}
    Consider the second-order Monge equation 
    \[\frac{\dd z}{\dd x}=F(x,y,z,p,q),\; p=y_x, \; q=y_{xx},\quad F_q\neq 0.\label{eq 37 Bryant}\]
    This can be studied as a Pfaffian system of corank two in the space of $(x,y,z,p,q)$ ($s=3,n=5$), namely 
    \[I=\<\dd y-p\dd x,\dd p-q\dd x,\dd z-F\dd x\>.\]
    To achieve equations (\ref{eq 31 Bryant}), we set 
    \begin{align}
        \theta^1=\dd y-p\dd x,\quad \theta^2=\dd z-F\dd x-F_q (\dd p- q\dd x),\\
        \theta^3=\dd p-q\dd x,\quad  \theta^4=\dd x,\quad \theta^5=\dd q.
    \end{align}
    An easy calculation gives 
    \[\dd\theta^1=\dd x\wedge\dd p=\theta^4\wedge\theta^3,\quad \dd\theta^2\equiv c\theta^4\wedge\theta^4+F_{qq}\theta^3\wedge\theta^5\pmod{\<\theta^1,\theta^2\>},\]
    where $c$ is some function. Hence, $I$ can be put in the Goursat normal form iff $F_{qq}=0$, i.e., if $F$ is linear in $q$.
    
    Consider the system $J=\<\beta^1,\beta^2,\beta^3\>$ in the Gousat normal form:
    \[\beta^1=\dd w-w_1\dd t,\beta^2=\dd w_1-w_2\dd t, \beta^3=\dd w_2-w_3\dd t.\]
    If $F_{qq}\neq 0$, there is no local diffeomorphism $(t,w,w_1,w_2,w_3)\mapsto (x,y,z,p,q)$, which maps $I$ into $J$. In other words, the ``general'' solution of $I$ of (\ref{eq 37 Bryant}) cannot be expressed in terms of an arbitrary function $w(t)$ and its derivatives. This was proved by Hilbert for the equation 
    \[\frac{\dd z}{\dd x}=(y_{xx})^2.\]
    On the other hand, for the equation 
    \[\frac{\dd z}{\dd x}=y^m y_{xx},\]
    which is linear in $y_{xx}$, Cartan gave the solution 
    \begin{align}
        x&= -2tf''(t)-f'(t),\\
        y^{m+1}&=(m+1)^2 t^3 f''(t)^2,\\
        z&=(m-1)t^2 f''(t)-mtf'(t)+mf(t),
    \end{align}
    where $f(t)$ is an arbitrary function of $t$. 
\end{example}

We continue with the case $s=3,n=5$ represented by the second-order Monge equation. Its generic situation is when the rank of the tableau (\ref{eq 36 Bryant}) is $2$. Then the $\theta^a$ can be chosen so that (\ref{eq 36 Bryant}) becomes the $2\times 2$ identity matrix, i.e., 
\[\dd\theta^1\equiv \theta^3\wedge\theta^4,\quad\dd\theta^2\equiv \theta^3\wedge\theta^5 \pmod{\<\theta^1,\theta^2\>}.\]
By (\ref{eq 31 Bryant}) we also have 
\[\dd\theta^3\equiv \theta^4\wedge\theta^5 \pmod{\<\theta^1,\theta^2,\theta^3\>}.\]
This generic case is very interesting. A complete system of invariants was found in Cartan's 1910 ``five variables'' paper using his method of equivalence. The fundamental invariant is a ternary quartic (symmetric) differential form. If it vanishes identically, the Pfaffian system is invariant under the exceptional $14$-dimensional Lie group $\rmG_2$. In particular, this means that $\rmJ^1(\bbR^2,\bbR^1)$ is a locally homogeneous space of (the real form of) $\rmG_2$ (the actual homogeneous space is $\bbS^2\times\bbS^3$). This is clearly a very natural way that the split real form of $\rmG_2$ is geometrically realized. The general case, also detailed by Cartan, involves tensorial invariants and consists of sub-cases.













\chapter{Curves and Surfaces}\label{chap curves and surfaces}


This \chap\ is a short introduction into Cartan's \emph{method of moving frames} and will work as motivation for the development of the theory of connections. It can be broadly seen as the application of Cartan's Fundamental Theorem~\ref{thm 6.1 Sharpe fundamental local} to submanifolds of a homogeneous space that carries some group of motions (e.g.,  the Euclidean group on the real affine space). Such submanifolds can be described by a finite collection of \emph{differential invariants} that can be found by pulling back the Maurer-Cartan form along a certain canonically chosen \emph{moving frame}. Conversely, the Fundamental Theorem shows that these differential invariants describe the submanifold (locally) uniquely, up to a global motion of the space. 

Instead of delving into the general theory of submanifolds of homogeneous spaces, we use this \chap\ as an opportunity to introduce the most classical part of Riemannian geometry, namely the theory of surfaces, first developed by Riemann's teacher, Gauss. This approach, better than general theory, demonstrates the sheer diversity of difficult problems that arise even in the simplest cases.

Thus, after outlining the general theory of surfaces in terms of Cartan's moving frames, we will then restate it in terms of \glspl{eds} and apply the Cartan-K\"ahler theory developed in the last \chap\ to solve a number of classical problems. In doing so, we will naturally come across such fundamental objects as complex geometry (Riemann surfaces), completely integrable systems, solitons, and some of the earliest global results in differential geometry and differential topology. Much of our exposition here closely follows \cite{Ivey}.




\section{Curves}

A fundamental problem in Cartan geometry will be the lifting problem for a map into a homogeneous space, which is the problem of finding a map $\wt{f}$ that makes the following diagram commute:
\[\begin{tikzcd}
                                    & G\arrow[d]\\
    S\arrow[r,"f"]\arrow[ur,"\wt{f}",dashed]& G\slash H.
\end{tikzcd}\]
Suppose $f:S\to G\slash H$ is an immersion. Then, in the case of a first-order Klein geometry $(G,H)$, the choice of a lift $\wt{f}:S\to G$ is equivalent to a choice of frames of $G\slash H$ along the submanifold $S$. In specific examples we will demand that these frames be \emph{adapted} to some structure on $S$ to make the lift unique, e.g., that $\T_mS$ get mapped by the corresponding frame to a fixed subspace $V\subset \frakg\slash\frakh$ for all $m\in S$. This is the basis of \emph{Cartan's method of moving frames} (``rep\`ere mobile'').\index{Rep\`ere mobile|see {Moving frames}}\index{Moving frames!Cartan's method of} Its power is in the fact that the frame is determined only by the value $f(s)\in G\slash H$, and not by any specific way the map $f$ is parametrized. Therefore, this method provides an extremely powerful way for finding \emph{intrinsic} geometric quantities of submanifolds, called \emph{differential invariants}.\index{Differential invariant} In this section we demonstrate the method in action in a few elementary examples, and in the next \sect\ we apply it to the classical problem of characterizing surfaces in three-dimensional Euclidean space up to congruence. These examples will be useful to us as motivation for the general theory of connections. The general characterization of submanifolds with structure is a subject of Cartan geometry.

Before diving into the more sophisticated examples, let walk through the classical Galilean principle of relativity in this language, which has to do with affine structures on manifolds.

\begin{example}[Galilean Principle of Relativity]
    Recall that an affine real space of dimension $n$ is a Klein geometry of type $(\Aff_n(\bbR),\GL_n(\bbR))$. Its space is denoted by $\bbA(\bbR^n)$. Now let $M$ be a manifold with an \emph{affine structure},\index{Affine structure} i.e., a maximal atlas $\calA=\{(U_\alpha,\varphi_\alpha)\}$ consisting of maps $\varphi_\alpha:U_\alpha\to \bbA(\bbR^n)$ such that the transition maps $\varphi_{\beta\alpha}=\varphi_\beta\circ\varphi_\alpha^{-1}$ are equivalent to actions on $\bbA(\bbR^n)$ by elements of $\Aff_n(\bbR)$, say $\varphi_{\beta\alpha}=g_{\beta\alpha}\in\Aff_n(\bbR)$. The pair $(M,\calA)$ is called an \emph{affine manifold}. We would like to find all differential invariants characterizing an affine structure on $M$.

    Let $\bf{x},\bf{y}:U\to \bbA(\bbR^n)$ be two (not necessarily affine-related) maps on $U\subset M$. We would like to compute a differential invariant that quantifies the difference between the affine structures induced by these two charts. Denote by $\psi\coloneqq \bf{y}\circ \bf{x}^{-1}$ the transition map. Since it is a diffeomorphism between subsets of $\bbA(\bbR^n)$, its derivative $\psi_\ast$ at any point $\bf{x}$ of its domain is naturally an element of $\GL_n(\bbR^n)$, so we can construct a local \emph{affine frame} corresponding to $\psi$. Following the conventional abuse of notation, we will denote the transition map by $\bf{y}(\bf{x})$, its derivative by $\bf{y}'(\bf{x})$, and define
    \[\frake(\bf{x})\coloneqq \begin{pmatrix}
        \bf{y}'(\bf{x}) & \bf{y}(\bf{x}) \\
        \bf{0}_n^T & 1
    \end{pmatrix}\quad \in \Aff_n(\bbR),\]
    where $\bf{y}'$ is the $n\times n$ Jacobi matrix, $\bf{y}$ is a column-vector, and $\bf{0}_n^T$ is the zero row-vector. We now pull back the Maurer-Cartan form along this frame:
    \begin{multline}
        \frake^{-1}\dd\frake(\bf{x})=\begin{pmatrix}
            \bf{y}'(\bf{x})^{-1} & -\bf{y}'(\bf{x})^{-1}\cdot \bf{y}(\bf{x}) \\
            \bf{0}_n^T & 1
        \end{pmatrix}
        \begin{pmatrix}
            \bf{y}''(\bf{x})\cdot \dd \bf{x} & \bf{y}'(\bf{x})\cdot \dd \bf{x} \\
            \bf{0}_n^T & 0
        \end{pmatrix}=\\=
        \begin{pmatrix}
            \bf{y}'(\bf{x})^{-1}\cdot \bf{y}''(\bf{x})\cdot \dd \bf{x} & \dd \bf{x} \\
            \bf{0}_n^T & 0
        \end{pmatrix}.
    \end{multline}
    We see that the only nontrivial quantity involved here is the $\frakgl_n(\bbR)$-valued $1$-form $(\bf{y}')^{-1} \bf{y}'' \dd \bf{x}$. By Cartan's Fundamental Theorem (or, indeed, by elementary calculus), the map $\bf{y}(\bf{x})$ is determined uniquely up to post-composition with a global affine transformation by $(\bf{y}')^{-1} \bf{y}'' \dd \bf{x}$. In particular, this quantity vanishes iff $\bf{y}$ and $\bf{x}$ induce the same affine structures on $U$. 
    
    Now consider an arbitrary smooth map $f:M\to \bbA(\bbR^n)$. By another abuse of notation, we will denote its local representatives in affine charts $\bf{x}:U\to \bbA(\bbR^n)$ by $f(\bf{x})$. We can then define local $1$-forms $f'(\bf{x})^{-1}\cdot f''(\bf{x})\dd \bf{x}$ and view them as $1$-forms on $U\subset M$ (i.e., a pullback along $\bf{x}$ is implied).  Now let $\bf{y}$ be another local chart and let us compare these $1$-forms defined w.r.t.\ $\bf{x}$ and $\bf{y}$. For simplicity, we take $n=1$ since the higher-dimensional case is analogous:
    \[(\partial_x f(x))^{-1}\partial_x^2 f(x)\dd x=(\partial_y f(x(y)))^{-1}\partial_y^2 f(x(y))\dd y-(\partial_y x(y))^{-1}\partial_y^2 x(y)\dd y.\]
    The last term on the right is exactly the Galilean invariant of $y$ relative to $x$. We conclude that the local $1$-forms induced by $f$ via $x$ and $y$ agree with each other iff $x$ and $y$ differ by an affine transformation. Thus, given an affine structure on $M$, each map $f:M\to \bbA(\bbR^n)$ gives rise to a globally defined $1$-form $G(f)\in \Omega^1(M;\frakgl_n(\bbR))$, whose local representatives in affine charts $\bf{x}$ are $(f')^{-1}f''\dd \bf{x}$. Note that $f$ needs to be an immersion for this object to be well-defined.

    We can also define $G(f)$ for maps $f:M\to \wt{M}$ between any two affine manifolds. For this, we pick local affine charts $\bf{z}$ on $\wt M$ and compute $G(\bf{z}\circ f)$ as above. The result is independent of the choice of $\bf{z}$ by construction, so again it defines a $1$-form $G(f)$ on $M$.

    This allows us to compare different affine structures. Let $\calA$ and $\wt\calA$ be two affine structures on $M$. Then $G(\id_M)$ is a $1$-form that vanishes iff the structures are equivalent. Moreover, each $1$-form $\omega$ of this kind defines a unique deformation of the affine structure: indeed, Cartan's Fundamental Theorem~\ref{thm 6.1 Sharpe fundamental local} guarantees that local representatives of $\omega$ match the Galilean invariants of local diffeomorphisms between subsets of $\bbA(\bbR^n)$ (that is, changes of coordinates on $M$) unique up to global affine transformations. Thus, the set of all affine structures is naturally an affine space modeled on the space $\Omega^1(M;\frakgl_n(\bbR))$.
    
    This is the content of the \emph{Galilean Principle of Relativity}: given an affine structure with local affine coordinate $\bf{x}$, there is a bijection between all affine structures and elements of $\Omega^1(M;\frakgl_n(\bbR))$, where locally a chart $\bf{y}$ is identified with $\bf{y}'(\bf{x})^{-1}\bf{y}''(\bf{x})\dd \bf{x}$. In physics, an affine structure on the spacetime corresponds to a choice of inertial observers at each point, and the Galiliean principal says that two observers are inertial relative to each other iff the coordinate transformation between them is linear. Note that in physics, a Galilean affine structure is usually of type $(\SE_n,\SO_n)$, where $\SE_n=\SO_n\ltimes\bbR^n$ is the Euclidean group, i.e., one deals with orthonormal frames w.r.t.\ a spacetime metric. In fact, the Galilean group is even smaller because it should act trivially on one more vector (the time axis). However, the results are similar after a proper normalization of the derivative $\bf{y}'$ to make it orthogonal (e.g., by rescaling each column).
\end{example}

The next two examples deal with curves in Euclidean space of dimension $2$ and higher.

\begin{example}[Curves in the Euclidean plane]\label{ex curves in E2}
    Consider two parametrized curves $\gamma,\gamma':\bbR\to \bbE^2$, where $\bbE^2=\SE_2\slash\SO_2$ is the Euclidean plane. The basic question of Euclidean geometry (which is a type of Cartan geometry) is: what are the necessary and sufficient conditions for the existence of a Euclidean motion $g\in\SE_2$ such that $\gamma'(\bbR)=g\cdot \gamma(\bbR)$ as sets? Further, when are there $g\in\SE_2$ and $t_0\in\bbR$ such that $\gamma'(t+t_0)=g\cdot \gamma(t)$ for all $t$?

    To solve this problem, we introduce an \emph{adapted frame} along each curve $\gamma$. That is, for each $t$ we pick an orthonormal frame in $\T_{\gamma(t)}\bbE^2$ such that it maps the direction tangent to $\gamma$ to the first axis of $\bbR^2=\frakse_2\slash\frakso_2$. Namely, assuming $\dot\gamma$ is non-vanishing (so $\gamma$ is an immersion), we put 
    \[e_1(t)=\dot\gamma(t)\slash \lVert\dot\gamma(t)\rVert,\] 
    and we let $e_2(t)$ be the unit normal to $\gamma$, namely the unique unit vector such that $\frake(t)\coloneqq (e_1(t),e_2(t))\in\SO_2$. Therefore we have constructed exactly the lift we needed:
    \[\wt{\gamma}:\bbR\to \SE_2,\quad t\mapsto\begin{pmatrix}
        \frake(t)&\gamma(t) \\
        0&  1
    \end{pmatrix}.\]
    By Corollary~\ref{cor immersions into G}, two curves $\gamma,\gamma'$ differ by a global Euclidean transform iff their logarithmic derivatives coincide. Denote the speed by $v(t)\coloneqq \lVert\dot\gamma(t)\rVert$, so that $\dot\gamma(t)=v(t)e_1(t)$. There also exists a function $\lambda(t)\in\bbR$ such that 
    \[\dot e_1(t)=\lambda(t)e_2(t),\quad \dot e_2(t)=-\lambda(t)e_1(t).\]
    This way, the acceleration $\ddot{\gamma}(t)$ decomposes into longitudinal and normal components:
    \[\ddot\gamma=a_{\parallel}e_1+a_{\perp}e_2=\dot ve_1+\lambda ve_2.\]
    Now we compute the logarithmic derivative:
    \[\delta\wt\gamma(t)=\wt\gamma(t)^{-1}\dot{\tilde\gamma}(t)=
    \begin{pmatrix}
        \frake^T & -\frake^T\cdot\gamma\\
        0 & 1
    \end{pmatrix} 
    \begin{pmatrix}
        \dot\frake & \dot\gamma\\
        0 & 0
    \end{pmatrix}
    =
    \begin{pmatrix}
        \lambda\cdot\epsilon & ve_1\\
        0 & 0
    \end{pmatrix},
    \]
    where $\epsilon=\left(\begin{smallmatrix}
        0&-1\\
        1&0
    \end{smallmatrix}\right)$. Therefore, two paths are congruent with fixed parametrizations iff their velocities and normal components of acceleration coincide. 
    
    To compare curves regardless of their parametrization, it suffices to pick natural parametrizations. Namely, we take the unit vector $\partial_t$ on $\bbR$ and require that both $\gamma$ and $\gamma'$ map it to unit vectors in $\T\bbE^2$. This is equivalent to requiring that $t$ coincide with the \emph{arclength parameter} $s$, w.r.t.\ which the speed is $1$, and then $\frac{\dd}{\dd s} \gamma=e_1$. The scalar function $\lambda(s)$ in this case has a special name -- it is called the curvature of the curve:
    \[\frac{\dd}{\dd s}e_1=\frac{\dd^2}{\dd s^2}\gamma=\kappa(s)e_2.\]
    In terms of the original parametrization, we have $\dd s/\dd t=v$ (or $\partial_t=v\partial_s$), therefore 
    \[\kappa=\frac{\lambda}{v}=\frac{a_{\perp}}{v^2}=\frac{\lVert\dot\gamma\times \ddot\gamma\rVert}{\lVert\dot\gamma\rVert^3}.\]
    Thus, two curves are congruent irrespective of their parametrization iff their curvatures coincide up to a shift of the arclength parameter $s\mapsto s+s_0$.
\end{example}

\begin{xca}
    \begin{enumerate}
        \item Show that the circle that most closely approximates a curve $\gamma:\bbR\to \bbE^2$ at a given point has radius $1/\kappa$.
        \item  Show that a curve has constant curvature iff it is a segment of a straight line or a circle.
    \end{enumerate}
\end{xca}

\begin{example}[Curves in $\bbE^n$]\label{ex serret-frenet}
    It is clear how to generalize the description of curves to higher dimensions. To produce a frame of $n$ vectors, we need to construct $n-1$ natural vectors associated with a curve $\gamma$. For this we use its $n$-th jet, i.e., the first $n+1$ terms of the Taylor series. Namely we take the vectors 
    \[\left(\frac{\dd}{\dd s}\gamma,\frac{\dd^2}{\dd s^2}\gamma,\ldots,\frac{\dd^{n-1}}{\dd s^{n-1}}\gamma\right),\] assume that they are linearly independent (such curves are called \emph{regular}) and apply the Gram-Schmidt process to them to get $\{e_1,\ldots,e_{n-1}\}$ (note that the Gram-Schmidt process doesn't change the differential order of these vectors). The final vector is then uniquely defined as $e_n=e_1\times\cdots\times e_{n-1}$. Now we define the \emph{generalized curvatures}
    \[\kappa_i\coloneqq \<\frac{\dd}{\dd s}e_i,e_{i+1}\>,\quad i=1,\ldots,n-1.\] 
    In particular, in three dimensions, $\tau\coloneqq \kappa_2$ is called the \emph{torsion}\index{Torsion!of a curve} of $\gamma$ since it describes the ``twisting'' of the frame around the curve and vanishes iff the curve is planar. The formula for the logarithmic derivative of the frame $\frake:\bbR\to \SO_n$ is given by the \emph{Frenet-Serret equation}\index{Equation!Frenet-Serret}
    \[\frac{\dd}{\dd s}\frake^T=\begin{pmatrix}
        0 & \kappa_1 & &\\
        -\kappa_1 &\ddots & \ddots&\\
         & \ddots &0 &\kappa_{n-1}\\
         0 & &-\kappa_{n-1} & 0
    \end{pmatrix}\cdot \frake^T,\quad 
    \frake^T=\begin{pmatrix}
        e_1 \\e_2 \\ \vdots \\ e_n
    \end{pmatrix}.
    \]
    Therefore, regular curves in $\bbE^n$ are determined by their generalized curvatures $\{\kappa_1,\ldots,\kappa_{n-1}\}$ up to a rigid motion. We say that the generalized curvatures provide a \emph{complete set of differential invariants}.
\end{example}

\begin{example}[Curves in $\bbA^n$]\index{Equi-affine geometry}
    Another interesting example deals with curves in the \emph{equi-affine space} $\bbA^n\coloneqq \SAff_n(\bbR)\slash\SL_n(\bbR)$, where $\SAff_n(\bbR)=\SL_n(\bbR)\ltimes\bbR^n$ is the subgroup of the affine group consisting of unimodular transformations, also called the \emph{equi-affine group}. This is exactly the affine group preserving the standard volume form on $\bbR^n$. Thus, for each curve $\gamma:\bbR\to \bbA^n$ we are looking for a lifting in the form of a unimodular frame $\frake:\bbR\to \SL_n(\bbR)$. Since orthonormality is no longer required, the notion of regularity for these curves needs to be adjusted. Clearly we need to start with the same set of $n$ derivatives
    \[\left(\frac{\dd}{\dd t}\gamma,\frac{\dd^2}{\dd t^2}\gamma,\ldots,\frac{\dd^{n}}{\dd t^{n}}\gamma\right)\]
    and assume that they are linearly independent. This is the new notion of regularity. Now we can define the determinant
    \[d(t)\coloneqq \det\left(\frac{\dd}{\dd t}\gamma,\frac{\dd^2}{\dd t^2}\gamma,\ldots,\frac{\dd^{n}}{\dd t^{n}}\gamma\right).\]
    This function necessarily has the same sign along the entire curve due to regularity. We can now obtain a unimodular frame by 
    \[\frake(t)\coloneqq |d(t)|^{-1/n}\left(\frac{\dd}{\dd t}\gamma,\frac{\dd^2}{\dd t^2}\gamma,\ldots,\frac{\dd^{n-1}}{\dd t^{n-1}},\pm\frac{\dd^{n}}{\dd t^{n}}\gamma\right),\]
    where the sign of the last vector is chosen so that the resulting frame is positively oriented. It is easy to see that this framing is equivariant under the action of $\SAff_n(\bbR)$ on $\bbA^n$. The parameter $s$ for the curve such that $\dd s=|d(t)|^{1/n}\dd t$ is called the \emph{equi-affine arclength}. w.r.t.\ this parameter, we have 
    \[e_1=\frac{\dd}{\dd s}\gamma,\quad e_{k+1}=\frac{\dd^k}{\dd s^k} e_k,\quad k=1,\ldots,n-1.\]
    Since $\det\frake=1$ is constant, differentiating it w.r.t.\ $s$ leads to 
    \[\det\left(e_1,\ldots,e_{n-1},\frac{\dd}{\dd s}e_n\right)=0,\]
    so $e_n$ must satisfy 
    \[\frac{\dd}{\dd s}e_n=\kappa_1 e_1+\kappa_2 e_2+\cdots+\kappa_{n-1}e_{n-1}\]
    for some functions $\kappa_1,\ldots,\kappa_{n-1}$ called the \emph{equi-affine curvatures} of $\gamma$. Thus, the analog of the Frenet-Serret equations is 
    \[\frac{\dd}{\dd s} \begin{pmatrix}
    \gamma \\ e_1 \\ \vdots \\ e_{n-1} \\ e_n
    \end{pmatrix}=\begin{pmatrix}
        0 & 1 & 0 &  & \\
         & 0 & 1 & 0 &     \\
        & &  & \ddots & \\
         & & & 0 & 1\\
        0 & \kappa_1 & \cdots & \kappa_{n-1}& 0
    \end{pmatrix}\begin{pmatrix}
        \gamma \\ e_1 \\ \vdots \\ e_{n-1} \\ e_n
        \end{pmatrix}.\]
\end{example}

The final example is a complex analog of the Galilean principle. It has to do with complex curves and complex projective structures on Riemann surfaces. It has higher-dimensional generalizations, but the one-dimensional case is already sufficiently intricate.

\begin{example}[Projective structures and Schwarzian derivatives {{\cite[\S1.7]{Ivey}}}]
    Here is an example of a study of curves in a less familiar homogeneous space, the complex projective line $\bbC  P^1$. To find differential invariants in such situations, we generally seek a uniquely defined lift that renders the pullback of the Maurer-Cartan form as simple as possible. Then, after finding differential invariants, we interpret them.

    Recall that a \gls{flt} is a map $\CP^1\to \CP^1$ given in terms of the homogeneous coordinates $[z_1:z_2]$ by 
    \[
        \begin{bmatrix}
            z_1\\z_2
        \end{bmatrix}
        \mapsto \left[\begin{pmatrix}
            a & b\\
            c& d
        \end{pmatrix}
        \begin{pmatrix}
            z_1\\z_2
        \end{pmatrix}\right],\quad ad-bc=1.
    \]
    The group of \glspl{flt} is the M\"obius group\index{M\"obius group} $\PSL_2(\bbC)=\SL_2(\bbC)\slash \{\pm \rmI\}$ (cf.\ Example~\ref{ex Lie group representations}), which acts transitively on $\CP^1$.  Thus, $\CP^1$ is a homogeneous space $\PSL_2(\bbC)\slash P$, where 
    \[P=\left[
        \begin{pmatrix}
            a & b \\
            0 & a^{-1}
        \end{pmatrix}
    \right]\in\PSL_2(\bbC)\]
    is the stabilizer of $[1:0]$. Although $\PSL_2(\bbC)$, as presented, is not a matrix group, we may avoid problems by working locally. If $D\subset \bbC\subset\CP^1$ is a (connected open) domain, then $g\in\PSL_2(\bbC)$ acts on maps $f:D\to \bbC$ by composition, $f\mapsto g\circ f$.

    Suppose $f,\wt{f}:D\to \bbC$ are two holomorphic (that is, complex analytic) maps with nonzero first derivatives. When are they locally equivalent up to a \gls{flt}, $\wt{f}=g\circ f$? (One can ask the same question in the real category for analytic maps $(0,1)\to \RP^1$ and the answer will be the same.) Note that in this example the target is of the same dimension as the source of the mapping, so we cannot expect an analog of curvature, but there will be an analog of velocity.

    The coordinate approach to getting invariants would be to use an \gls{flt} to normalize the map at some point $z_0$, say by requiring $f(z_0)=0$, $f'(z_0)=1$ and $f''(z_0)=0$. Since this is exactly the extent of normalization that $\PSL_2(\bbC)$ can achieve, then $f'''(z_0)$ must be an invariant. Of course, this is valid only at the point $z_0$.

    Instead we construct a lift to the group $\PSL_2(\bbC)$ of ``projective frames'', which we will treat as $\SL_2(\bbC)$ in order to work with a matrix Lie group -- just keep in mind that the overall sign of the frames doesn't matter. As an obvious first try, let 
    \[F\coloneqq \begin{pmatrix}
        f&-1\\
        1&0
    \end{pmatrix}.
    \]
    Since the projection to $\CP^1$ is the equivalence class of the fist column, any other lift $\wt F$ of $f$ must be of the form $\wt F(z)=F(z)g(z)$, where 
    \[g(z)=\begin{pmatrix}
        a(z)& b(z)\\
        0 & a(z)^{-1}
    \end{pmatrix},\quad a(z)\neq 0.\]
    We want to pick $a$ and $b$ to obtain a new lift whose Maurer-Cartan form is as simple as possible. We have 
    \begin{multline}
        \wt{F}^{-1}\dd\wt{F}=g^{-1}(F^{-1}\dd F)g+g^{-1}\dd g=\\
        =\left\{
        \begin{pmatrix}
            a^{-1} & -b \\
            0 & a
        \end{pmatrix}
        \begin{pmatrix}
            0 & 0 \\
            -f' & 0
        \end{pmatrix}
        \begin{pmatrix}
            a & b \\
            0 & a^{-1}
        \end{pmatrix}+
        \begin{pmatrix}
            a^{-1} & -b \\
            0 & a
        \end{pmatrix}
        \begin{pmatrix}
            a' & b' \\
            0 & -a'a^{-2}
        \end{pmatrix}
        \right\}\dd z=\\
        =\begin{pmatrix}
            abf'+a^{-1}a' & a^{-2}ba'+a^{-1}b+b^2f' \\
            -a^2f' & -(abf'+a^{-1}a')
        \end{pmatrix}\dd z.
    \end{multline}
    Choose $a(z)=1/\sqrt{f'(z)}$. (This is the analog of setting $f'(z_0)=1$ in the coordinate approach.) The function $b$ is still free. We use it to set the diagonal term in the pullback of the Maurer-Cartan form to zero, i.e., to set $abf'+a^{-1}a'=0$. This implies 
    \[b=-\frac{a'}{a^2f'}=-a'=\frac{f''}{2(f')^{3/2}}.\]
    Now our lift is unique and its pullback of the Maurer-Cartan form is 
    \[
        \wt{F}^{-1}\dd\wt{F}=\begin{pmatrix}
            0 & -\frac12 \calS_f(z)\\
            -1 & 0
        \end{pmatrix}\dd z,
        \]
    where 
    \[\calS_f=\frac{f'''}{f'}-\frac32\left(\frac{f''}{f'}\right)^2=\left(\ln f'\right)''-\frac12\left((\ln f')'\right)^2.\]
    is a differential invariant called the \emph{Schwarzian derivative}.\index{Schwarzian derivative} Another canonical frame that can be used to compute this invariant is the following:
    \[\frake(z)\coloneqq \wt{F}(z)\cdot \begin{pmatrix}
        -\rmi & 0\\
        -\rmi z & \rmi 
    \end{pmatrix}.\]
    It is an exercise to check that $\frake(z)$ represents the unique \gls{flt} whose $2$-jet at $z$ coincides with that of $f$ (that is, $f(z)$, $f'(z)$, and $f''(z)$ determine this frame). Therefore, $\frake$ is the analog of the Frenet frame for ``complex curves'' in $\CP^1$. The pullback of the Maurer-Cartan form along this frame reads 
    \[\frake^{-1}\dd\frake=\frac12 \calS_f(z)\begin{pmatrix}
        -z & 1\\
        -z^2 & z 
    \end{pmatrix}\dd z.\]
\end{example}

\begin{xca}
    \begin{enumerate}
        \item Show that $f$ is an \gls{flt} iff $\calS_f=0$. So, just as the curvature of a curve in $\bbR^2$ measures the failure of the curve to be a line, $\calS_f(z)$ is an infinitesimal measure of the failure of a holomorphic map to be an \gls{flt}. Since \glspl{flt} map circles to circles, $\calS_f$ may be though of as measureing how much circles are distorted under $f$.
        \item Calculate $\calS_f$ for $f(z)=a\rme^{bz}$ and $f(z)=z^n$. How do these compare asymptotically? What does this say about how circles are distorted as one goes out to infinity?
        \item If $h$ is a \gls{flt}, then $\calS_{h\circ f}=\calS_f$. For arbitrary biholomorphisms (locally invertible holomorphic maps) $f,h$, verify that 
        \[\calS_{f\circ h}=(h')^2 \calS_f\circ h+\calS_h.\label{schwarzian composition}\]
    \end{enumerate}
\end{xca}

\begin{rem}[Schwarzian quadratic differential]
    The appearance of $(h')^2$ in the composition law (\ref{schwarzian composition}) indicates that it may be useful to interpret $\calS_f$ as (the local representative of) a \emph{quadratic differential},\index{Quadratic differential} namely 
    \[\calS(f)(z)\coloneqq \calS_f\cdot \dd z^{\otimes 2},\] 
    where $\dd z^{\otimes 2}=\dd z\otimes \dd z$. The above transformation law takes the form 
    \[\calS(f\circ h)=h^\ast \calS(f)+\calS(h).\]
    In particular, it is useful to consider the case when $h$ is a biholomorphic change of coordinate, $w=h(z)$. For this, the Schwarzian derivative of $f$ w.r.t.\ a given local coordinate $z$ is denoted by 
    \[\{f,z\}\coloneqq \calS_f(z).\]
    Then the transformation law becomes 
    \[\{f,z\}\dd z^{\otimes 2}=\{f,w\}\dd w^{\otimes 2}+\{w,z\}\dd z^{\otimes 2}.\]
    Since the second term vanishes for projective changes of coordinates (i.e., when $w=h(z)$ is an \gls{flt}), $\calS(f)$ is a projective invariant. This lets us identify this quadratic differential with a canonical global section $\calS(f)$ of a holomorphic \gls{fb} over the domain of $f$ with typical fiber $\CP^1$, provided a fixed projective structure on that domain. 
    
    Moreover, this allows us to expand the above discussion to arbitrary \emph{meromorphic functions on a complex projective surface $\Sigma$} (see Example~\ref{ex projective structure}). A meromorphic function is simply a holomorphic map $f:\Sigma\to \CP^1$ (commonly represented by analytic functions with poles), so the above construction produces a well-defined quadratic differential $\calS(f)$ over $\Sigma$. Note that, as long as $f$ is not constant, the quadratic differential is well-defined as meromorphic even at (necessarily isolated) points where $f'=0$. Moreover, $\calS(f)$ is holomorphic iff $f$ is an immersion, i.e., $f'\neq 0$.
    \footnote{The treatment of meromorphic functions as holomorphic might appear confusing at first. For example, the function $f(z)=z^{-1}$ has a pole at zero, so it looks like its derivative is not even well-defined. However, when viewing $w=f(z)$ as a local representative, in local coordinate $w\in\bbC=\CP^1\setminus\{\infty\}$, of a map with values in $\CP^1$, we should pick a local coordinate $\zeta$ on $\CP^1$ near $w=\infty$, for example $\zeta=w^{-1}$. In this local coordinate, $f(z)=z$ and $f'(0)=1$. Thus, in a more careful treatment, we would denote $f$ by different symbols depending on which local charts we are using both on the domain and on $\CP^1$. Similar warnings apply to quadratic differentials and other meromorphic objects. For example, the differential $f(z)\dd z$ on $\bbC$, where $f$ is an analytic function, extends to a holomorphic differential on $\CP^1$ iff $f(z)\dd \frac{1}{w}=-z^2 f(z)\dd w$ stays finite as $w\to \infty$. That is, $f$ needs to decay at infinity at least as fast as $z^{-2}$. }
    
    Finally, we can similarly define $\calS(f)$ for arbitrary holomorphic maps between complex projective surfaces, $f:(\Sigma,\calP)\to (\wt\Sigma,\wt\calP)$, by taking projective charts $z$ and $w$ on $\Sigma$ and $\wt\Sigma$, respectively, and defining locally 
    $\calS(f)(z)\coloneqq \{w\circ f,z\}\dd z^{\otimes 2}.$
    Once again, this is clearly a globally defined meromorphic quadratic differential on $\Sigma$, and it vanishes iff $f$ is projective, i.e., if $f$ is a local isomorphism of the projective structures.
\end{rem}

\begin{rem}[Quadratic differentials and projective structures]
    Schwarzian derivatives are useful for quantifying the difference between projective structures on a Riemann surface. Let $\Sigma$ be a Riemann surface and let $\calP,\wt\calP$ be two projective structures on it. Also denote by $\rmQ(\Sigma)$ the vector space of quadratic differentials on $\Sigma$ (i.e., sections of the holomorphic line bundle with local frames given by $(\dd z)^2$). Consider the identity map $\id_\Sigma$ and compute its Schwarzian differential w.r.t.\ the two projective structures:
    \[\calS(\id_\Sigma)\in \rmQ(\Sigma).\]
    As we observed above, this differential vanishes iff $\calP$ and $\wt\calP$ are isomorphic. Moreover, since $\id_\Sigma$ is an immersion, each nonzero holomorphic differential determines a unique deformation of the projective structure: the local representatives of $q\in\rmQ(\Sigma)$ give rise to local biholomorphisms $f(z)$ unique up to an \gls{flt}, and they become the chart maps of the new projective structure. Since the Schwarzian derivative is the only projective invariant, the correspondence between quadratic differentials and changes of the projective structure is bijective. Hence, the difference between two projective structures can be identified with a unique quadratic differential. This proves that the set of all projective structures on $\Sigma$ is an affine space modeled on $\rmQ(\Sigma)$.
\end{rem}










\section{Surfaces}\label{sec: theory of surfaces}

In this \sect\ we will describe a classical application of the Frobenius Theorem in the context of Gauss' theory of surfaces in the three-dimensional Euclidean space $\bbE^3$, defined as a homogeneous space of the Euclidean group $\SE_3$. We use Cartan's method of moving frames in a way similar to Examples~\ref{ex curves in E2} and \ref{ex serret-frenet}. The main difference in the case of surfaces is that the structure equation on a two-dimensional manifold is nonlinear, so the construction of differential invariants is more complicated and, in the language of \glspl{eds}, requires \emph{prolongation}. Moreover, nondegenerate curves can always be parametrized by arclength, providing a set of natural unit vectors for an orthonormal frame, whereas surfaces usually don't admit orthonormal coordinate frames. As a result, the specification of differential invariants alone is insufficient for uniqueness of surfaces up to congruence.


Let $\Sigma$ be an oriented\footnote{The assumption of orientability is not essential because we will mostly focus on local results about surfaces, while global results for non-orientable surfaces can be obtained by passing to a double cover (the orientation bundle).} $2$-dimensional manifold and let $i:\Sigma\hookrightarrow \bbE^3$ be an immersion, where $\bbE^3$ is the affine space $\bbA(\bbR^3)$ with the standard Euclidean structure, i.e., it is the homogeneous space 
\[\bbE^3=\SE_3(\bbR)\slash \SO_3(\bbR).\]
We will often view $\Sigma$ as a subset of $\bbE^3$, and describe this setting as an \emph{immersed surface}, although non-injective immersions are allowed. The standard Euclidean dot product of (tangent) vectors will be denoted by $\<\,,\,\>$. This dot product can be restricted to tangent vectors of $\Sigma$ to produce a metric $\sfg\in\Gamma^\infty(\bigodot^2\T\Sigma)$ on $\T\Sigma$ that has a special name for historic reasons.

\begin{defn}[First Fundamental Form]\index{First Fundamental Form}
    The First Fundamental Form of an immersed surface $i:\Sigma\hookrightarrow \bbR^3$ is the non-degenerate quadratic form $\rmI\in\Gamma^0_2(\Sigma)$ defined by 
    \[\rmI(X_m,Y_m)=\<X_m,Y_m\>,\quad X_m,Y_m\in \T_m \Sigma.\]
    It is obviously positive definite and can be identified with a metric tensor $\sfg\coloneqq i^\ast\rmI$ on $\Sigma$. It is conventional to denote its components in an arbitrary local parametrization $\bf{ x}: \bbR^2\supset U\to\bbE^3$ of $\Sigma$ by a pair of real variables $(u,v)\in U$ as follows:
    \[(\rmI_{ij})=
    \begin{pmatrix}
        \<\partial_1\bf{x},\partial_1\bf{x}\> & \<\partial_1\bf{x},\partial_2\bf{x}\>\\
        \<\partial_2\bf{x},\partial_1\bf{x}\> & \<\partial_2\bf{x},\partial_2\bf{x}\>
    \end{pmatrix}
    =\begin{pmatrix}
        E&F\\
        F& G
    \end{pmatrix}=\begin{pmatrix}
        g_{11}&g_{12}\\
        g_{21}& g_{22}
    \end{pmatrix}=(\sfg_{ij}).\label{eq fff}\]
\end{defn}

Since $\sfg= i^\ast \rmI$ defines a Riemannian metric on $\Sigma$, this makes $(\Sigma,\sfg)$ a \emph{Riemannian (or metric) surface}.\index{Riemannian surface}

\begin{rem}
    At this point it is important to make a distinction between Riemannian surfaces and immersed surfaces. Since an immersion $i:\Sigma\to \bbE^3$ induces a metric $\sfg$ on $\Sigma$, this automatically turns the immersion into an \emph{isometric immersion}, i.e., the inner products of tangent vectors are preserved by it. Thus, from the \emph{intrinsic} point of view, we are can start with a Riemannian surface $(\Sigma,\sfg)$ and study its isometric immersions into $\bbE^3$. Meanwile, from the \emph{extrinsic} point of view, we start with an arbitrary immersed surface $i:\Sigma\to \bbE^3$ and induce a Riemannian structure on it via the immersion. 
    
    All theorems we prove below apply equally to either an immersed surface or an isometric immersion of a Riemannian surface. However, as we will see, some of the theorems will turn out to be completely intrinsic, i.e., they can be stated for $(\Sigma,\sfg)$ with no reference to any immersions.

    Finally, we note that the term ``Riemannian surface'' should not be confused with the term ``Riemann surface'', which is a complex $1$-dimensional manifold.
\end{rem}

Our goal will be to construct a natural orthonormal frame at every point of $\Sigma$, by analogy with the Frenet frame for curves, so as to compute the differential invariants characterizing the surface. A frame $\frake=(e_1,e_2,e_3)$ will be called a \emph{first-order adapted lift} (of the surface) if $e_3(p)\perp \T_p \Sigma$. 
Thus, let $e_3(p)$ for each $p\in\Sigma$ be the unit normal to $\Sigma$, pointing outward in the sense of Theorem~\ref{thm orientation via normal vector}.  If $\Sigma$ is locally parametrized by a function $\bf{ x}: \bbR^2\supset U\to\bbE^3$ of two real parameters $(u,v)\in U$, then 
\[e_3=\frac{\bf{ x}_u\times \bf{x}_v}{\lVert \bf{x}_u\times \bf{x}_v\rVert},\]
where $\bf{x}_u=\partial_u \bf{x}$ and $\bf{x}_v=\partial_v \bf{x}$. It is easy to verify that this vector is independent of the specific parametrization of $\Sigma$. Since $e_3$ is of unit length, we also conclude that $\partial_u e_3$ and $\partial_v e_3$ are tangent to $\Sigma$. Note, however, that these two vectors are, in general, only defined locally on $\Sigma$, so in the rest of this \sect\ we will freely identify $\Sigma$ with only the piece $\bf{x}(U)\subset \Sigma$, keeping in mind that everything below can be repeated on a neighborhood of any point of $\Sigma$.

\begin{defn}[Gauss map]\index{Gauss map}
    Let us view the unit normal vector $e_3$ as an element of the unit sphere $\bbS^2\subset\bbR^3$ by parallel transporting it to the origin. The resulting map $e_3:\Sigma\to \bbS^2$ is called the Gauss map of the surface $\Sigma\subset \bbR^3$.
\end{defn}

The Gauss map is clearly differentiable and thus we have $(e_3)_\ast:\T\Sigma\to \T\bbS^2$. For a given point $p\in\Sigma$, notice that the tangent planes $\T_p\Sigma$ and $\T_{e_3(p)}\bbS^2$ are parallel and thus can be identified with each other by parallel transporting tangent vectors in $\bbR^3$. Therefore we obtain the equivalent map $(\dd e_3)_{p}:\T_p\Sigma\to \T_p\Sigma$ (it can be viewed as a bundle-valued $1$-form), called the \emph{shape operator}, or the \emph{Weingarten map}, of $\Sigma$.\index{Shape operator}\index{Weingarten map|see {Shape operator}}

\begin{lem}
    The shape operator $(\dd e_3)_{p}:\T_p\Sigma\to \T_p\Sigma$, is a self-adjoint linear map, i.e., 
    \[\<(\dd e_3)_{p}X,Y\>=\<X,(\dd e_3)_{p}Y\>,\quad X,Y\in \T_p\Sigma.\]
\end{lem}
\begin{proof}
    Denote $N\coloneqq e_3$ for simplicity. Let $\bf{x}:\bbR^2\supset U\to \bbR^3$ be a local parametrization of $\Sigma$ at $p\in\Sigma$, and let $\{\bf{x}_u, \bf{x}_v\}$ be the corresponding basis of $\T_p\Sigma$. It suffices to prove that $\<N_{\ast p}(\bf{x}_u),\bf{x}_v\>=\<\bf{x}_u,N_{\ast p}(\bf{x}_v)\>$. Let $\gamma(t)=\bf{x}(u(t),v(t))$ be a parametrized curve in $\Sigma$ with $\gamma(0)=p$. We have 
    \[N_{\ast p}\dot\gamma(0)=N_{\ast p}(\bf{x}_u \dot u(0)+\bf{x}_v \dot v(t))=\restr{\frac{\dd}{\dd t}}{t=0}N(u(t),v(t))=N_u \dot u(0)+N_v\dot v(0).\]
    In particular, $N_{\ast p}(\bf{x}_u)=N_u$ and $N_{\ast p}(\bf{x}_v)=N_v$. Therefore we need to prove that 
    \[\<N_u,\bf{x}_v\>=\<\bf{x}_u,N_v\>.\]
    To see this, take the derivatives of $\<N,\bf{x}_u\>=0$ and $\<N,\bf{x}_v\>=0$ relative to $u$ and $v$, repsectively, to obtain 
    \begin{align}
        \<N_v,\bf{x}_u\>+\<N,\bf{x}_{uv}\>&=0,\\
        \<N_u,\bf{x}_v\>+\<N,\bf{x}_{vu}\>&=0.
    \end{align}
    Thus, 
    \[\<N_u,\bf{x}_v\>=-\<N,\bf{x}_{uv}\>=\<N_v,\bf{x}_u\>.\]
\end{proof}

Therefore the shape operator can be viewed as a quadratic form (symmetric tensor of type $(0,2)$) on $\T\Sigma$.

\begin{defn}[Second Fundamental Form]\index{Second Fundamental Form}
    The scalar Second Fundamental Form of a surface $\Sigma\subset\bbR^3$ is the quadratic form $Q\in\Gamma^0_2(\Sigma)$ defined by 
    \[\wt{Q}_p(X,Y)=-\<(\dd e_3)_{p}X,Y\>.\]
    From the above proof, in local parametrization $\bf{x}(u^1,u^2)$ indexed by $\mu,\nu=1,2$, the components of $\wt{Q}$ read 
    \[(\wt{Q}_{\mu\nu})=
    \begin{pmatrix}
        \<\partial^2_{11}\bf{x},e_3\>& \<\partial^2_{12}\bf{x},e_3\>\\
        \<\partial^2_{21}\bf{x},e_3\> & \<\partial^2_{22}\bf{x},e_3\>
    \end{pmatrix}
    \eqqcolon\begin{pmatrix}
        e&f\\
        g&h
    \end{pmatrix}.\label{eq hopf differential components}
    \]
    We thus see that $\frac12\wt{Q}_{\mu\nu}\dd u^\mu \dd u^\nu$ is exactly the quadratic term in the Taylor expansion of $\<e_3(u^\mu),\bf{x}(u^\mu+\dd u^\mu)\>$, so it measures the ``signed height'' of the surface relative to the tangent plane at $\bf{x}$. In other words, knowledge of $\wt{Q}$ lets us approximate $\Sigma$ locally as the graph of a quadratic function (given an orthonormal frame at one point).
\end{defn}

Similarly, the multilinear forms corresponding to higher terms in the Taylor expansion of $\<e_3(u^\mu),\bf{x}(u^\mu+\dd u^\mu)\>$ are the \emph{higher fundamental forms}. As we will see, they do not contain any new information about the immersed surface.


\begin{rem}
    Due to the abundance of equivalent representations, there is a lot of confusion in the standard nomenclature. The shape operator and $\wt{Q}$ differ from each other only by a ``lowering of an index'' via the First Fundamental Form. Moreover, $\wt{Q}$ as defined above is classically identified with the second fundamental form $\rmII$. To be able to appreciate the difference between these objects, we will define the general Second Fundamental Form slightly differently below.
\end{rem}

Since $\wt{Q}$ is a $\rmI$-symmetric quadratic form, it can be diagonalized by an $\rmI$-orthogonal transformation, giving rise to the following important data. Below we will show that these data are independent of the local parametrization $\bf{x}:U\to \bbE^3$ (as long as the image of $\bf{x}(U)$ still remains in $\Sigma$ and contains the chosen point $m\in\Sigma$).

\begin{defn}[Principal data]
    \begin{enumerate}
        \item The eigenvalues $k_1\geq k_2$ of the shape operator $N_\ast$ at $p\in \Sigma$ are called the \emph{principal curvatures}.\index{Principal curvatures}
        \item The unit eigenvectors $v_1,v_2$ of $\dd e_3$ are called the \emph{principal directions}.\index{Principal directions}
        \item The \emph{Gauss curvature} of $\Sigma$ is $K\coloneqq \kappa_1\kappa_2$. It also satisfies the \emph{Gauss equation}\index{Gauss curvature}\index{Equation!Gauss}
        \[K=\det\left(\rmI^{-1}\circ \wt{Q}\right)=\frac{LN-M^2}{EG-F^2}.\]
        \item The \emph{mean curvature}\index{Mean curvature} of $\Sigma$ is $H\coloneqq \frac12(\kappa_1+\kappa_2)=\frac12\tr\left(\rmI^{-1}\circ \wt{Q}\right)$. Note that its sign depends on the orientation of the surface, so it is a \emph{pseudoscalar}. Surfaces with identically vanishing mean curvature are called \emph{minimal}. $\wt{Q}$ can be uniquely decomposed as
        \[\wt{Q}=Q+H\rmI,\]
        where $Q$ is the traceless part of $\wt{Q}$, called the \emph{Hopf differential}.\index{Hopf differential}
    \end{enumerate}
\end{defn}

\begin{xca}
    Show that if $K>0$ at a point $m\in \Sigma\subset \bbE^3$, then $\Sigma$ lies on one side of $\T_m\Sigma$ in some neighborhood of $m$, and if $K<0$, then it doesn't. As a consequence, show that every compact surface in $\bbE^3$ has at least one point where $K,H>0$.
\end{xca}

\begin{rem}
    If $\Sigma$ is locally represented as a graph of a function $z(x,y)$, i.e., $\bf(x)(x,y)=(x,y,z(x,y))$, then we can use (\ref{eq fff}) and (\ref{eq hopf differential components}) to compute $K$ and $H$ in terms of $z(x,y)$. Using the unit normal vector 
    \[e_3=\frac{(-z_x,-z_y,1)}{\sqrt{1+z_x^2+z_y^2}},\]
    we find
    \[(\rmI_{\mu\nu})= \begin{pmatrix}
        1+z_x^2 & z_xz_y\\
        z_y z_x & 1+z_y^2
    \end{pmatrix},\quad 
    (Q_{\mu\nu})=
    \frac{1}{\sqrt{1+z_x^2+z_y^2}}
    \begin{pmatrix}
        z_{xx} & z_{xy}\\
        z_{yx} & z_{yy}
    \end{pmatrix}.\]
    The determinant of the metric is $\det\rmI=1+z_x^2+z_y^2$, therefore,
    \[((\rmI^{-1}\circ \wt{Q})_{\mu\nu})=
    \frac{1}{(1+z_x^2+z_y^2)^{3/2}}
    \begin{pmatrix}
        (1+z_y^2)z_{xx}-z_xz_yz_{xy} & (1+z_y^2)z_{xy}-z_xz_yz_{xy}\\
        (1+z_x^2)z_{yx}-z_xz_yz_{xy} & (1+z_x^2)z_{yy}-z_xz_yz_{xy}
    \end{pmatrix}.
    \]
    The determinant and the half-trace give us $K$ and $H$:
    \[K(x,y)=\frac{z_{xx}z_{yy}-z_{xy}^2}{(1+z_x^2+z_y^2)^2},\quad 
    H(x,y)=\frac{1}{2}\frac{(1+z_y^2)z_{xx}-2z_xz_yz_{xy}+(1+z_x^2)z_{yy}}{(1+z_x^2+z_y^2)^{3/2}}.\label{eq local formulas for K and H}
    \]
    One use of these expressions is that they provide relatively simple PDEs for surfaces with given curvatures. For example, surfaces with $K=1$ are locally given by solutions of 
    \[z_{xx}z_{yy}-z_{xy}^2=(1+z_x^2+z_y^2)^2.\label{eq 1.4 Ivey}\]
\end{rem}


Note that the values of the local integral $\iint \sqrt{\det \sfg}\dd u\dd v$ are invariant under reparametrizations of the surface due to the transformation rule for the metric tensor $\sfg$. In other words, the local formula 
\[\sfv_{\sfg}=\sqrt{\det\sfg}\dd u\wedge\dd v\]
actually defines a global volume form, or \emph{area form}, on $\Sigma$. The following proposition shows how the area of an immersed surface is related to its mean curvature. We will allow the immersion $\bm{x}$ to vary in such a way that the surface $\Sigma\subset\bbE^3$ is deformed, and use a non-orthonormal framing on the deformed surface to see how the area form gets distorted.

\begin{prop}
    An immersed surface $\bf{x}:U\to \bbE^3$ is minimal iff it is a stationary point of the area functional, defined locally in coordinates $(u,v)$ on $U$ in terms of the induced metric $\sfg$ (First Fundamental Form) by
    \[\mathsf{vol}[\bf{x}]\coloneqq \iint \sqrt{EG-F^2}\dd u\dd v=\iint \sqrt{\det\sfg}\dd u\dd v.\]
\end{prop}
\begin{proof}
    The statement is local, so fix an orthonormal framing $(e_1,e_2,e_3)$ along $\bm{x}(U)$ and let $\bf{x}^t(u,v)$ be a deformation of $x$, i.e.~a smooth homotopy of immersions with $t\in (-\epsilon,\epsilon)$ for some $\epsilon>0$ and $\bf{x}^0=\bf{x}$. We assume that the deformation is nontrivial, i.e., $\dot{\bf{x}}$ is not tangent to $\Sigma$. Then for small $t$ we have 
    \[\bf{x}^t(u,v)=\bf{x}(u,v)+t s(u,v)e_3(u,v)+\calO(t^2),\]
    where $s:U\to \bbR$ is a uniquely determined function. At fixed $t$, calculate 
    \begin{multline}
        \dd \bf{x}^t=\dd\bf{x}+te_3\dd s+ts\dd e_3+\calO(t^2)=\\
        =e_1\theta^1+e_2\theta^2+te_3(s_1\theta^1+s_2\theta^2)-ts(e_1\omega_1^3+e_2\omega_2^3)+\calO(t^2).
    \end{multline}
    Using the same $\theta^1,\theta^2$, we may write $\dd\bf{x}^t=e_1^t\theta^1+e_2^t\theta^2$ where 
    \begin{align}
        e_1^t&= (1-tsh_{11})e_1-t(sh_{12}e_2-s_1e_3)+\calO(t^2),\\
        e_2^t&= (1-tsh_{22})e_2-t(sh_{12}e_1-s_2e_3)+\calO(t^2).
    \end{align}
    This framing is no longer orthonormal. The metric now has the form 
    \[\sfg^t=\begin{pmatrix}
        1-2tsh_{11} & -2tsh_{12}\\
        -2tsh_{12} & 1-2tsh_{22}
    \end{pmatrix}+\calO(t^2).\]
    It is easy to see that
    \[\restr{\frac{\dd}{\dd t}}{t=0}\sqrt{\det \sfg^t}=-2s(h_{11}+h_{22})=-2sH.\]
    This formula is known as \emph{the first variation of area}, and can be generalized to submanifolds of arbitrary Riemannian manifolds. The stationary point condition for the area functional $\int \sqrt{\det\sfg^t}\dd u\dd v$ is exactly $H=0$.
\end{proof}
\begin{rem}
    Note that while the metric can be considered intrinsic for the surface, in the above statement we assume that this metric is induced from the standard Euclidean metric via the immersion $\bm{x}$. This why, even though the area functional itself is defined in terms of the intrinsic area form, its variation is extrinsic -- because the variation is w.r.t.\ the immersion. Denoting the first variation of functionals by $\delta$, the intrinsic variation of the area is easy to compute:
    \[\delta \sqrt{\det\sfg}=\tr (\sfg^{-1}\circ \delta \sfg)\sqrt{\det\sfg},\]
    where $\delta\sfg$ is the variation of the metric and $\sfg^{-1}\circ \delta \sfg$ is a section of $\End(\T M)$, so the trace is well-defined. The proposition above effectively computed the variation $\delta\sfg$ corresponding to a deformation of the surface, namely 
    \[\delta\sfg=-sH\sfg\delta t.\]
    As an example, take the round sphere of radius $r$. Taking the standard outward unit normal, the mean curvature is $H=-1/r$. Consider the deformation that simply changes the radius of the sphere, $r\mapsto r+\delta r$. This induces the first variation of the area form equal to $\delta \sfv_{\sfg}=-\tr(sH \rmI_2)\sfv_{\sfg}=\frac{2\delta r}{r}\sfv_{\sfg}$. This obviously agrees with the fact that the area form is proportional to $r^2$.
\end{rem}











\section{Gauss' equation}


Quantities on $\Sigma$ that depend only on the first fundamental form $\rmI$, and not on the choice of the local isometric immersion $\bf{x}:U\to \bbE^3$, are called \emph{intrinsic}. Clearly, $\wt{Q}$ is \emph{extrinsic} because it depends on the construction of a fiber bundle that depends (via the normal vector $e_3$) on the embedding of $\Sigma$ into $\bbR^3$. However, we can obtain intrinsic invariants from $\wt{Q}$. Gauss' most famous result states that $K$ is an intrinsic differential invariant.

\begin{thm}[Gauss' Theorema Egregium, 1827]\label{thm egregium}
    The Gauss curvature $K$ of a surface $\Sigma\subset\bbR^3$ depends only on the first fundamental form $\rmI$, i.e., it is preserved by local isometries.
\end{thm}

Before we attempt proving this theorem, let us rewrite all of the objects we've constructed so far in a more geometric language.
Let us parametrize the Euclidean group of $\bbE^3$ as follows 
\[\SE_3=\SO_3\ltimes\bbR^3=\left\{g=\begin{pmatrix}
    R & \bf{t}\\
    0 & 1
\end{pmatrix}\middle| \bf{t}\in\bbR^3,R\in\SO_3
\right\}.\]
Then the Lie algebra and the Maurer-Cartan form of this group in this representation read
\[ \frakse_3=\left\{\begin{pmatrix}
    0 & -x_1^2 & -x_1^3& x^1\\
    x_1^2 & 0 & -x_2^3 & x^2\\
    x_1^3 & x_2^3 & 0 & x^3\\
    0 & 0& 0& 0
\end{pmatrix}\middle| x^i,x^i_j\in\bbR\right\},
\quad
\theta_{\SE_3}=
    \begin{pmatrix}
        0 & -\omega_1^2 & -\omega_1^3& \theta^1\\
        \omega_1^2 & 0 & -\omega_2^3 & \theta^2\\
        \omega_1^3 & \omega_2^3 & 0 & \theta^3\\
        0 & 0& 0& 0
    \end{pmatrix},
\]
where $\theta^i,\omega^i_j\in\Omega^1(\SE_3)$ form a basis for the space of left-invariant $1$-forms on $\SE_3$. Since $\dd g=g\omega$, the last column implies 
\[\dd \bf{x}=e_i\theta^i.\]
Thus, $\theta^i$ has the geometric interpretation of measuring the infinitesimal motion of the point $\bf{x}$ in the direction of $e_i$. Similarly, $\omega^i_j$ measures the infinitesimal motion of $e_j$ toward $e_i$, i.e., rotations:
\[\dd e_j=e_i\omega^i_j.\label{eq def of omegas}\]
It's obvious that $\theta^i$ are horizontal for the principal bundle $\pi:\SE_3\to\bbE^3$ since the right $\SO_3$-action changes only the rotational components of $g$.

The fact that the frame $\frake:\Sigma\to \SE_3$ is adapted means that, at every point of $\Sigma$,
\[\frake^\ast(\theta^3)=0,\quad \frake^\ast(\theta^1\wedge\theta^2)\neq 0.\label{eq 2.2 Ivey}\]
Let $\pi:P\to \Sigma$ be the bundle whose fiber over $p\in\Sigma$ is the set of oriented orthonormal bases $(e_1,e_2,e_3)\in\SO_3$ of $\T_p \bbE^3$ such that $e_3\perp \T_p\Sigma$. The first-order adapted lifts are exactly the sections of $P$. After fixing a frame at an arbitrarily chosen origin in $\bbE^3$, $\SE_3$ is the total space of the bundle of all oriented orthonormal frames of $\bbE^3$, and $P$ is a subbundle of $\restr{\SE_3}{\Sigma}$.

The Maurer-Cartan equation lets us calculate the derivatives of the left-invariant forms on $\SE_3$ algebraically:
\[\dd \begin{pmatrix}
    0 & -\omega_1^2 & -\omega_1^3& \theta^1\\
    \omega_1^2 & 0 & -\omega_2^3 & \theta^2\\
    \omega_1^3 & \omega_2^3 & 0 & \theta^3\\
    0 & 0& 0& 0
\end{pmatrix}=-\begin{pmatrix}
    0 & -\omega_1^2 & -\omega_1^3& \theta^1\\
    \omega_1^2 & 0 & -\omega_2^3 & \theta^2\\
    \omega_1^3 & \omega_2^3 & 0 & \theta^3\\
    0 & 0& 0& 0
\end{pmatrix}\wedge \begin{pmatrix}
    0 & -\omega_1^2 & -\omega_1^3& \theta^1\\
    \omega_1^2 & 0 & -\omega_2^3 & \theta^2\\
    \omega_1^3 & \omega_2^3 & 0 & \theta^3\\
    0 & 0& 0& 0
\end{pmatrix}.\label{eq structure for surfaces}\]

As a part of this equation, looking only at vectors tangent to $\Sigma$, which is equivalent to working modulo $\theta^3$, we find one of the structure equations (in fact, it is expressing the absence of torsion)
\[\dd \begin{pmatrix}
    \theta^1 \\\theta^2
\end{pmatrix}+ 
\begin{pmatrix}
    0 & -\omega^2_1\\
    \omega^2_1 & 0
\end{pmatrix}
\wedge \begin{pmatrix}
    \theta^1 \\\theta^2
\end{pmatrix}\equiv 0\pmod{\theta^3}.\label{eq torsion-free structure on surfaces}
\]

\begin{rem}
    Since the $\theta^i$ encode the derivative of the immersion, they can be viewed as defining an \gls{eds} whose integral manifolds are immersions differing only by rigid motions, as we will see. Thus, the last column of the above structure equation describes the tableau of this \gls{eds}, i.e., just the $\omega^i_j$ part of the $4\times 4$ matrix. We thus read off Cartan characters $s_1=2$, $s_2=1$, $s_3=0$ and the predicted dimension of $3$-dimensional integral elements at one point is $s_1+2s_2=4$. Meanwhile, on each such integral element the $\omega^i_j$ are linear combinations of the $\theta^k$ such that $\dd\theta^k=0$, which can easily be seen to be a $3$-dimensional space. Since $4>3$, we conclude that this system is \emph{not} involutive and we can't apply the Cartan-K\"ahler Theorem at this point to recover the immersion just from the $\omega^i_j$. To find an involutive system we will have to perform prolongation.
\end{rem}

Write $i_P:P\hookrightarrow \SE_3$ for the inclusion map. By definition of $P$, $i_P^\ast\theta^3=0$, and hence 
\[0=i_P^\ast(\dd\theta^3)=-i_P^\ast(\omega_1^3\wedge\theta^1+\omega_2^3\wedge\theta^2).\label{eq 2.3 Ivey}\]
By (\ref{eq 2.2 Ivey}), $i_P^\ast\theta^1$ and $i_P^\ast\theta^2$ are independent, and we can apply the Cartan Lemma~\ref{lem cartan} to the right hand side of (\ref{eq 2.3 Ivey}). We get 
\[i_P^\ast 
\begin{pmatrix}
    \omega_1^3 \\ \omega_2^3
\end{pmatrix}
=
\begin{pmatrix}
    h_{11} & h_{12}\\ h_{21} & h_{22}
\end{pmatrix}\cdot
i_P^\ast 
\begin{pmatrix}
    \theta^1 \\ \theta^2
\end{pmatrix},\label{def h}
\]
where $h_{ij}=h_{ji}$ are some uniquely determined functions defined on $P$ (they are related to the Hessian of the parametrizing immersion $\bf{x}:U\to \bbE^3$). We view them as components of a symmetric matrix $h$. Given an adapted (local) lift $\frake:\Sigma\to P$, we have 
\[\frake^\ast \begin{pmatrix}
    \omega_1^3 \\ \omega_2^3
\end{pmatrix}=
h_\frake \cdot \frake^\ast \begin{pmatrix}
    \theta^1 \\ \theta^2
\end{pmatrix},\quad h_\frake\coloneqq \frake^\ast h.
\]
We now determine the invariance of $h_\frake$. Since $\frake$ is uniquely defined up to a rotation of the tangent plane to $\Sigma$, all other possible adapted lifts are of the form
\[\wt\frake=\frake\cdot\begin{pmatrix}
    R &&\\
    &1 &\\
    &&1
\end{pmatrix}\eqqcolon \frake\cdot R,\quad R:\Sigma\to \SO_2.
\]
We compare $\wt\frake^\ast \theta_{\SE_3}=\wt\frake^{-1}\dd \wt\frake$ with $\frake^\ast\theta_{\SE_3}=\frake^{-1}\dd\frake$. A direct substitution leads to 
\[\wt\frake^{-1}\dd\wt\frake=
\begin{pmatrix}
    R^{-1} &&\\
    &1 &\\
    &&1
\end{pmatrix}\cdot
\frake^\ast 
\begin{pmatrix}
    0 & -\omega_1^2 & -\omega_1^3& \theta^1\\
    \omega_1^2 & 0 & -\omega_2^3 & \theta^2\\
    \omega_1^3 & \omega_2^3 & 0 & \theta^3\\
    0 & 0& 0& 0
\end{pmatrix}\cdot
\begin{pmatrix}
    R &&\\
    &1 &\\
    &&1
\end{pmatrix}+
\begin{pmatrix}
    R^{-1}\dd R &&\\
    &0 &\\
    &&0
\end{pmatrix}.
\]
In particular, 
\[\wt\frake^\ast \begin{pmatrix}
    \theta^1 \\ \theta^2
\end{pmatrix}=R^{-1}\cdot \frake^\ast \begin{pmatrix}
    \theta^1 \\ \theta^2
\end{pmatrix},
\quad 
\wt\frake^\ast(\omega_1^3,\omega_2^3)=\frake^\ast(\omega_1^3,\omega_2^3)R.
\]
Since $R^{-1}=R^T$, we conclude that 
\[h_{\wt\frake}=R^{-1}h_\frake R.\]
This is exactly the transformation law for a section of $\T^1_1 \Sigma$, therefore $h_{\frake}$ actually represents a globally defined quadratic form $\sfh$ on $\Sigma$. In particular, the properties of $\sfh$ that are invariant under conjugation by a rotation matrix are invariants of the parametrizing map $\bf{x}$. By the spectral theorem for symmetric matrices, the functions $H=\frac12 \tr(h_\frake)$ and $K=\det h_\frake$ generate the ideal of invariant functions of $h_\frake$. They are exactly the mean curvature and the Gauss curvature. We see immediately that any two congruent surfaces must have the same $K$ and $H$ at corresponding points.


We have the following naturally defined horizontal forms on $P$ (here the Kronecker tensor $\delta_{ij}$ is used in place of the standard metric on $\bbR^3$):
\begin{align}
    \wt{\rmI}&\coloneqq \delta_{\mu\nu} \theta^\mu\otimes\theta^\nu &\in\Gamma^\infty(\pi^\ast(\bigodot^2 \T^\ast \Sigma)),\\
    \wt{\rmII}&\coloneqq \omega^3_\mu\otimes\theta^\mu\otimes e_3=
    h_{\mu\nu}\theta^\mu\otimes\theta^\nu\otimes e_3
    &\in \Gamma^\infty(\pi^\ast(\bigodot^2 \T^\ast \Sigma\otimes N\Sigma)).
\end{align}
The first one is clearly just $\pi^\ast\rmI$. Meanwhile the second one gives rise to the next fundamental object. The transformation rules that we established above ensure that $\frake^\ast \wt{\rmII}=\wt{\frake}^\ast \wt{\rmII}$ for any two adapted framings $\frake,\wt{\frake}$. Therefore $\wt{\rmII}$ also descends to a tensor on $\Sigma$. Note that it is customary to omit the tensor product $\otimes$ between differential forms and vectors $e_3$, since it can be treated as an abelian product.

\begin{defn}[Second fundamental form]\index{Second Fundamental Form}
    $\wt{\rmII}$ descends to a well-defined quadratic form on $\Sigma$ with values in the normal bundle $N\Sigma$, called the second fundamental form $\rmII\in\Gamma^\infty(\bigodot^2\T^\ast\Sigma\otimes N\Sigma)$ defined by
    \[\rmII(X,Y)=-\<\dd e_3(X),Y\>e_3=\wt{Q}(X,Y)e_3.\]
\end{defn}

\begin{rem}
    Treat the sphere $\bbS^2$ as the homogeneous space $\SE_3\slash\SE_2$ via the projection $(\bf{x},e_1,e_2,e_3)\mapsto e_3$. As such, the form $\omega_1^3\wedge\omega_2^3$ is the pullback of the area form on the unit sphere $\bbS^2$ (of total area $4\pi$) because $\dd e_3=-(\omega_1^3 e_1+\omega_2^3 e_2)$. Since $\omega_1^3\wedge\omega_2^3=K\theta^1\wedge\theta^2$, we may interpret $K$ as a measure of how much the area of $\Sigma$ is (infinitesimally) distorted under the Gauss map $e_3:\Sigma\to \bbS^2$:
    \[e_3^\ast \sfv_{\bbS^2}=K\sfv_{\sfg},\label{eq gauss map pullback}\]
    were $\sfv_\sfg=\theta^1\wedge\theta^2$ is the volume form on $\Sigma$. This can be viewed as the local version of the Gauss-Bonnet Theorem relating curvature to a smooth mapping to the sphere.\index{Theorem!Gauss-Bonnet}
\end{rem}

Another way to obtain the Gauss curvature is by differentiating $\omega_1^2$. Using the Maurer-Cartan equation, we obtain the \emph{Gauss equation}\index{Equation!Gauss}\index{Formula|see {Equation}}
\[\boxed{\dd\omega_1^2=-K\theta^1\wedge\theta^2.}\label{eq 2.14 Ivey}\]
We will later be able to interpret this equation as an integrability condition (the vanishing of the torsion) for a certain canonical \gls{eds}. In addition, the definition of $\sfh$ (\ref{def h}) immediately implies, by multiplying its two rows by $\theta^2$ and $\theta^1$, respectively, that
\[\omega_1^3\wedge\theta^2+\omega_2^3\wedge\theta^1=2H\theta^1\wedge\theta^2.\]

\begin{rem}[Special coordinate systems on surfaces]
    \begin{enumerate}
        \item Every Riemannian surface admits local \emph{orthogonal coordinates},\index{Orthogonal coordinates} in which the metric $\rmI$ is diagonalized, i.e., $F=0$. 
        Such coordinates can always be found on any surface by taking an arbitrary parametrization $(u,v)$ and replacing $v$ with a new coordinate $w=v+\varphi(u,v)$ such that $E+F\varphi_v=0$. If we require $\varphi(u,0)=0$ then this equation has a unique solution near any point where $F\neq 0$, and it is easy to see that the metric written in $(u,w)$ is diagonalized. Note that orthogonal coordinates do not always exist for Riemannian manifolds of dimension $4$ and higher.
        \item A more special kind of orthogonal coordinates will be found in Lemma~\ref{lem line of curvature coordinates}. In them, both $\rmI$ and $\rmII$ are diagonalized, which is why they are called \emph{line of curvature coordinates}.\index{Line of curvature coordinates}
        \item Finally, the most special orthogonal coordinates that locally exist on any Riemannian surface are \emph{isothermal coordinates}, in which $E=G$ in addition to $F=0$. We will prove their existence in Corollary~\ref{cor isothermal coords}. Note that $\rmII$ need not be diagonal in isothermal coordinates.
    \end{enumerate}
\end{rem}

\begin{example}[$K$ in orthogonal coordinates]\label{ex Gauss curvature in orthogonal coords}
    Let us assume that we have found local orthogonal coordinates $(x,y)$ on $\Sigma$, i.e., such that $\rmI$ (the metric) takes the form $\rmI=\left(\begin{smallmatrix}
        E & 0\\
        0 & G
    \end{smallmatrix}\right)$.
    Now, a local orthonormal frame and coframe is given by (here we imply pullbacks to $\Sigma$ along $\frake$)
    \[e_1=\frac{1}{\sqrt{E}}\partial_x,\quad e_2=\frac{1}{\sqrt{G}}\partial_y,\quad \theta^1=\sqrt{E}\dd x,\quad \theta^2=\sqrt{G}\dd y.\]
    We can find $\omega_1^2$ from the equation $\dd\theta^i(e_1,e_2)=\omega_1^2(e_i)$ (this is part of the structure equation~(\ref{eq structure for surfaces})):
    \[\omega_1^2(e_1)=\dd\theta^1(e_1,e_2)=-\frac{E_y}{2\sqrt{E}\sqrt{EG}},\quad \omega_1^2(e_2)=\dd\theta^2(e_1,e_2)=\frac{E_x}{2\sqrt{G}\sqrt{EG}},\]
    from whcih we conclude 
    \[\omega_1^2=-\frac{E_y}{2\sqrt{EG}}\dd x+\frac{E_x}{2\sqrt{EG}}\dd y.\]
    Now we compute its derivative:
    \[\dd\omega_1^2=\frac12\left(\left(\frac{E_x}{\sqrt{EG}}\right)_x+\left(\frac{E_y}{\sqrt{EG}}\right)_y\right)\dd x\wedge\dd y.\]
    By the Gauss equation, this should coincide with $-K\theta^1\wedge\theta^2=-K\sqrt{EG}\dd x\wedge\dd y$. We thus find that in orthogonal coordinates ($F=0$), 
    \[K=-\frac{1}{2\sqrt{EG}}\left(\left(\frac{E_x}{\sqrt{EG}}\right)_x+\left(\frac{E_y}{\sqrt{EG}}\right)_y\right).\label{eq K in orthogonal coords}\]
\end{example}


\begin{xca}
    Let $\gamma(s):\bbR\to \Sigma$ be a curve on the surface $\Sigma$ such that $\lVert\dot\gamma(s)\rVert=1$ and $\ddot\gamma(s)\perp \T_{\gamma(s)}\Sigma$ for all $s$ (such curves are \emph{geodesics}, as we will see in \S\ref{sec: pseudospherical surfaces}).\index{Geodesic} Show that the curvature $\kappa$ of the curve can then be expressed as
    \[\kappa=\left|\<\rmII(\dot\gamma,\dot\gamma),e_3\>\right|=|\wt{Q}(\dot\gamma,\dot\gamma)|.\]
\end{xca}







\section{Covariant calculus}


This \sect\ connects the above moving frame formalism to the more conventional formalism of Riemannian geometry and can be safely skipped on first reading. We begin by outlining the original, completely non-geometric discovery of connections, which was only recognized as such decades later.


\begin{rem}[Christoffel symbols]
    Much of the history of the concept of a connection can be described as a \emph{pursuit of a second derivative}. On vector spaces, we know how to take arbitrarily many derivatives of vector-valued functions due to the fact that tangent vectors to a vector space can be identified with elements of the vector space itself (by translation to the origin). On general manifolds, we only know how to take one derivative so far -- via the tangent functor $\T$, i.e., by defining tangent vectors. A major natural question is: how can one take derivatives of tangent vector fields, or second derivatives of manifold-valued functions?

    The first step in this direction actually had nothing to do with curved manifolds, and was made by Elwin Bruno Christoffel in 1869. He considered a structure $(V,\sfg)$, where $V$ is a vector space and $\sfg\in \Gamma(\bigodot^2 \T^\ast V)$ is a nondegenerate quadratic form (a pseudo-Riemannian metric). (Christoffel, in fact studied forms of degree higher than $2$ as well.) He then considered a (nonlinear) change of coordinates $\bf{x}'\mapsto \bf{x}$, i.e., a (local) diffeomorphism $f(\bf{x}')=\bf{x}$. The first derivative $\partial\bf{x}\slash \partial\bf{x}'$ is simply the Jacobi matrix of the transformation. Write out the components of $\sfg$ in both coordinate systems and substitute $\bf{x}=\varphi(\bf{x}')$:
    \[\sfg=\sfg_{ij}(\bf{x})\dd x^i\otimes \dd x^j=\sfg_{ij}(f(\bf{x'}))\frac{\partial \varphi^i}{\partial x^{\prime \alpha}}\frac{\partial \varphi^j}{\partial x^{\prime \beta}}\dd x^{\prime\alpha}\otimes \dd x^{\prime\beta}.\label{eq 1215}\]
    Christoffel was interested in a \emph{local equivalence problem}, similar to the one we have been considering for surfaces. Given two metric tensors $\sfg_{ij}(\bf{x})\dd x^i\otimes \dd x^j$ and $\sfg'_{\alpha\beta}(\bf{x}')\dd x^{\prime\alpha}\otimes \dd x^{\prime\beta}$, when is there a diffeomorphism $\bf{x}'\mapsto \bf{x}$ that transforms one tensor to the other? He found that the answer can be given by \emph{adjoining} extra quantities that depend on the first derivatives of the metric tensor. Decades later, geometers realized that this result is equivalent to the ability to express second derivatives in terms of lower order objects. We now demonstrate this.

    The question is whether second partial derivatives of $\bf{x}$ w.r.t.\ $\bf{x}'$ can be expressed in terms of the metric tensor. To isolate a second partial derivative, we can consider the basis vector fields $e_i=\partial_{x^i}=\partial_i$. A second partial derivative $\frac{\partial^2}{\partial x^j\partial x^k}$ can then be identified with $\partial_{j}e_k$. The reason this makes sense is that $e_k$ takes values in a vector space and thus we can differentiate it as if a scalar function.  The resulting vector field can be decomposed in the same basis:
    \[\partial_{k}e_j=\Gamma^i{}_{jk}e_i,\label{eq 12451}\]
    where $\Gamma^i{}_{jk}$ are some smooth functions now known as the \emph{Christoffel symbols}.\index{Christoffel symbols} These functions can be isolated with the help of the metric:
    \[\Gamma_{ijk}\coloneqq\Gamma^l{}_{jk}\sfg_{li}=\<\partial_{k}e_j,e_i\>.\label{eq 1242308}\]
    Since $\sfg_{li}$ is an invertible matrix, we can freely go between $\Gamma_{ijk}$ and $\Gamma^l{}_{jk}$. Since partial derivatives commute, we immediately observe that $\Gamma^l{}_{jk}=\Gamma^l{}_{kj}$. Now, by using the Leibniz rule, one can compute the partial derivative of the metric tensor (\ref{eq 1215}):
    \[\partial_k \sfg_{ij}=\partial_k \<e_i,e_j\>= \<\partial_k e_i,e_j\>+ \<e_i,\partial_k e_j\>=\Gamma_{jik}+\Gamma_{ijk}.\label{eq 180512}\]
    By permuting the indices and using the symmetry of the Christoffel symbols established above, we get three linear equations on three unknowns, giving
    \[\Gamma^i{}_{jk}=\frac{1}{2}\left(\partial_j \sfg_{ik}+\partial_k\sfg_{ij}-\partial_{i}\sfg_{jk}\right).\]
    This is a deeper result than might seem at first: we have established that the ``second derivative'' (\ref{eq 12451}) can be expressed only in terms of first derivatives (basis vector fields) and first derivatives of the metric tensor, and the formulas are \emph{invariant} in the sense that their form is the same in any coordinate system. It is this fact that interested Christoffel -- that there exists an \emph{intrinsic} description of second derivatives in terms of invariants such as the metric. To answer the original question about second derivatives, one uses the transformation rule (\ref{eq 1215}) for the metric tensor to compute the transformation of the Christoffel symbols. The miraculous result is that the second derivative can be once again isolated:
    \[\frac{\partial x^i}{\partial x^{\prime\alpha}\partial x^{\prime\beta}}=\Gamma^{\prime \gamma}{}_{\alpha\beta}\frac{\partial x^i}{\partial x^{\prime \gamma}}-\Gamma^i_{jk}\frac{\partial x^j}{\partial x^{\prime\alpha}}\frac{\partial x^k}{\partial x^{\prime\beta}}.\label{eq christoffel second derivative}\]
    This also shows that the Christoffel symbols are \emph{not} components of a tensor, and in fact this formula is exactly quantifying the violation of the transformation law for a tensor of rank $(1,2)$, identifying it with the second derivative. This error vanishes iff the second derivative is zero, i.e., iff the change of coordinates is affine. The major consequence of this is that while the Christoffel symbols themselves are not tensor fields, the \emph{difference} of the Christoffel symbols of any two metrics is a tensor field. Thus, the Christoffel symbols solve the equivalence problem for metric tensors: a coordinate transformation $\bf{x}'\mapsto \bf{x}$ maps $\sfg$ to $\sfg'$, up to a linear isomorphism of $V$, iff (\ref{eq christoffel second derivative}) is satisfied. In the ``if'' direction, the statement that the transformation is an isometry follows via the Frobenius Theorem, where (\ref{eq christoffel second derivative}) is seen as the compatibility condition on the system 
    \[\sfg_{ij}=\sfg'_{\alpha\beta}\frac{\partial x^i}{\partial x^{\prime\alpha}}\frac{\partial x^j}{\partial x^{\prime\beta}}.\]
    The remaining ambiguity (linear changes of coordinates) can be eliminated if one provides an initial condition, namely that $\sfg$ is mapped to $\sfg'$ at any one point. 
    
    Christoffel went a step further and also examined the compatibility condition on the new system (\ref{eq christoffel second derivative}). This led him to introduce yet another collection of functions, which were eventually recognized as the components of the Riemann curvature tensor $\sfR^{i}{}_{jkl}$, which we will not detail now. He showed that, at least generically, if two sets of such functions are related to each other under some change of coordinates in the same way that the components of a tensor of rank $(1,3)$ would be, then this change of coordinates is an isometry. Thus, the curvature tensor provides an alternative complete set of differential invariants for generic metric structures. Despite it being a second-order object, the practical benefit of using curvature to solve the equivalence problem is that it is a tensor field, unlike the Christoffel symbols.
\end{rem}

\begin{rem}[Covariant derivatives]
    Equation (\ref{eq 180512}) was interpreted by Christoffel as defining a new kind of derivative acting on the metric tensor $\sfg$, which, aside from taking a partial derivative, adds terms where $\sfg$ is contracted with a Christoffel symbol, one term per index. Formula (\ref{eq 180512}) in condensed form is written as $\nabla_k \sfg=0$, where $\nabla_k$ is the \emph{covariant derivative} along $e_k=\partial_{x^k}$.

    One cannot help but notice the similarity between formula (\ref{eq 1242308}) and (\ref{eq def of omegas}), the latter of which can be rewritten as $\omega^j_i=\<\dd e_i,e_j\>$. We may conclude that the components of the $1$-form $\omega^j_i$ are exactly the Christoffel symbols $\Gamma^j{}_{i\alpha}$, $\alpha=1,2$, except this time they are written w.r.t.\ an orthonormal frame as opposed to a holonomic (coordinate) frame. One of the consequences of this is that $\Gamma^j{}_{i\alpha}$ is antisymmetric in the first two indices.
    
    Let us once again consider the problem of defining a ``second partial derivative'', or rather a derivative of one vector field w.r.t.\ another, but this time on an immersed surface $\bf{x}:\Sigma\to \bbE^3$. The Lie derivative doesn't work because it is not tensorial w.r.t.\ either of the vector fields: it differentiates both vector fields, which is not what we expect from a ``partial derivative''. Let $X,Y\in\fX(\Sigma)$. We can use $\bf{x}$ to push both vector fields forward to $\Sigma\subset \bbE^3$. This allows us to view the values of these vector fields as tangent vectors to $\bbE^3$, which are naturally identified with elements of $\bbR^3$. Thus, $\wt{X}\coloneqq \bf{x}_\ast X$ and $\wt{Y}\coloneqq \bf{x}_\ast Y$ are $\bbR^3$-valued \emph{functions} on $\Sigma$. Now we can take a regular Lie derivative of one of them w.r.t.\ the other vector field:
    \[\Lie_X \wt{Y}\in C^\infty(\Sigma,\bbR^3).\]
    This describes the rate at which the direction of $Y$ changes in $\bbR^3$ as one flows along $X$. This does not yet define an intrinsic derivative on $\Sigma$ because the result is not guaranteed to be tangent to $\Sigma\subset \bbE^3$. We would like to find a correction term to the above expression that gives a true vector field $\nabla_X Y$ on $\Sigma$. Moreover, note that $\wt{Y}$ can also be \emph{any} $\bbR^3$-valued function on $\Sigma$, not necessarily one associated with a tangent vector field, and we will define covariant derivatives of such functions as well. It is intuitively clear that we should define $\nabla_X \wt{Y}$ in such a way that the unit normal vector field $e_3$ is \emph{parallel}:
    \[\nabla_X e_3=0.\]
    We also want $\nabla_X$ to satisfy the Leibniz rule $\nabla_X (fY)=(\nabla_X f)Y+f\nabla_X Y$ and $\nabla_X f=\Lie_X f$. This implies that if we locally decompose $\wt{Y}=\wt{Y}^i e_i$, then 
    \[\nabla_X \wt{Y}=\nabla_X\left(\wt{Y}^\alpha e_\alpha\right)+(\Lie_X\wt{Y}^3)e_3,\quad \alpha=1,2.\]
    $\wt{Y}^\alpha e_\alpha$ is tangent to $\Sigma$ and thus can be identified with an intrinsic vector field $Y\in\fX(\Sigma)$. We can now define $\nabla_X\left(\wt{Y}^\alpha e_\alpha\right)$ by identifying it with a $\wt{Z}\in C^\infty(\Sigma,\bbR^3)$. To define this object, the only natural projection that we have is the orthogonal projection onto $\Sigma$:
    \[\wt{Z}\coloneqq \Lie_X \wt{Y}-\<\Lie_X \wt{Y},e_3\>e_3.\]
    This is manifestly tangent to $\Sigma$ and is thus associated with a vector field $Z\in\fX(\Sigma)$ which we call $\nabla_X Y$. Since the Lie derivative is acting on functions, it behaves tensorially w.r.t.\ $X$ as required. Thus, the covariant derivative computes the rate at which $Y$ changes along $X$ as a vector in $\bbR^3$ and then projects the resulting vector orthogonally onto $\Sigma$.

    Let us go back to our adapted orthonormal frame $\{e_i\}$ and compute its covariant derivative:
    \[\nabla e_\alpha=\dd e_\alpha-\<\dd e_\alpha,e_3\>e_3=\omega^i_\alpha e_i-\omega^3_\alpha e_3=\omega^\beta_\alpha e_\beta,\]
    where Greek indices range over $1,2$. Any vector field $X\in\fX(\Sigma)$ can be decomposed as $X=X^\alpha e_\alpha$, so the Leibniz rule implies 
    \[\nabla(X^\alpha e_\alpha)=(\dd X^\alpha)e_\alpha+\omega^\beta_\alpha e_\beta.\]
    Much like in Christoffel's original setting, we get the miraculous result that the covariant derivative is expressed purely intrinsically, i.e., only in terms of tensor fields on $\Sigma$ itself.
    Willmore's Theorem~\ref{Willmore} helps us extend this operator to all tensor fields on $\Sigma$ via the tensorial Leibniz rule, and we see that
    \[\nabla\sfg=\nabla(\theta^\alpha\otimes \theta^\alpha)=(\dd \theta^\alpha-\omega^\alpha_i\wedge \theta^i)\odot \theta^\alpha,\]
    where sums over $\alpha=1,2$ and $i=1,2,3$ are implied. Now we can use $\dd\theta^\alpha=\omega^\alpha_\beta\wedge\theta^\beta$ to conclude that 
    \[\nabla\sfg=-(\omega^\alpha_3\wedge\theta^3)\odot \theta^\alpha=0\]
    by antisymmetry of $\omega^i_j$. This is another form of equation (\ref{eq 180512}) saying that $\sfg$ is parallel.
\end{rem}








\section{Darboux framings}\label{sec: principal framings}

We are now ready to prove that $K$ is an intrisic quantity, i.e., it depends only on the metric $\sfg=i^\ast\rmI$ on $\Sigma$, and not on the particular isometric immersion $i:\Sigma\hookrightarrow \bbE^3$.

\begin{proof}[Proof of Theorema Egregium~\ref{thm egregium}]
    Let $\bf{x}:U\to \bbE^3$ be a local parametrization and let $\frake:U\to P$ be a first-order adapted lift. Let $\eta^j=\frake^\ast\theta^j$. Since $\eta^1\wedge\eta^2$ is nonvanishing, it spans $\bigwedge^2 \T_p^\ast\Sigma$ at each $p\in\Sigma$. Thus, there exist functions $a,b$ such that 
    \[\dd\eta^1=a\eta^1\wedge\eta^2,\quad \dd\eta^2=b\eta^1\wedge \eta^2.\]
    By antisymmetrizing these two formulas, we find that there exists a $1$-form $\alpha$ such that 
    \[\dd\eta^1=-\alpha\wedge\eta^2,\quad \dd\eta^2=\alpha\wedge\eta^1.\]
    Now, if $\wt\frake$ is a different adapted lift with $\wt\eta^j=\wt\frake^\ast\theta^j$, then it is easy to show that $\dd\wt\alpha=\dd\alpha$. Thus the function $\kappa$ uniquely determined by $\dd\alpha=\kappa\eta^1\wedge\eta^2$ is also invariant under the change of the lift, and hence depends only on the Riemannian metric $(\eta^1)^2+(\eta^2)^2$.

    Finally, we check that $\alpha=\frake^\ast\omega_2^1$, so, by (\ref{eq 2.14 Ivey}), $\kappa=\frake^\ast K$.
\end{proof}

Having constructed $h$, we can finally define a natural orthonormal frame. Note that when the eigenvalues $k_1,k_2$ coincide, they may not be differentiable functions of the point of $\Sigma$. Such points, where $k_1=k_2$, are called \emph{umbilic}. For example, all points of the round sphere are umbilic. Away from umbilic points, $k_1$ and $k_2$ are smooth functions, and we may further adapt the frames by diagonalizing $h$. 

\begin{xca}
    \begin{enumerate}
        \item Find all surfaces in $\bbE^3$ for which all points are umbilic.
        \item Let $\gamma\subset\bbE^3$ be a curve defined by intersecting $\Sigma$ with the plane parallel through $e_1,e_3$ are a point $m\in\Sigma$. Show that the curvature of $\gamma$ at $p$ is $|k_1|$.
    \end{enumerate}
\end{xca}


\begin{defn}[Darboux/principal frame]
    A Darboux, or a principal, frame for a surface $\Sigma$ is a local frame $\frake:\Sigma\to \SE_3$ w.r.t.\ which the function $h$ takes the diagonal form 
    \[h_\frake=\begin{pmatrix}
        k_1&0\\
        0& k_2
    \end{pmatrix}\]
    with $k_1>k_2$. It is is guaranteed to exist locally and to be unique away from umbilic points of $\Sigma$.
\end{defn}

\begin{lem}[Line of curvature coordinates]\label{lem line of curvature coordinates}
    Let $\Sigma$ be an immersed surface in $\bbE^3$. Then there exist local coordinates $(x,y)$ for $\Sigma$ centered at any non-umbilic point $m\in\Sigma$ in which both fundamental forms $\rmI$ and $\rmII$ are diagonalized, i.e., $F=L=0$. \index{Line of curvature coordinates}
\end{lem}
\begin{proof}
    Away from umbilic points, local Darboux frames $(e_1,e_2)$ exist. The flows of these two vector fields generate local coordinates via $m=\Fl^{e_1}_x\circ \Fl^{e_2}_y(m_0)$, and by construction the coordinate lines are lines of curvature (i.e., their tangent directions are principal), so $\rmII$ is diagonalized. Since principal directions are orthogonal (because $\rmII$ is symmetric), the coordinate vector fields $\partial_u$ and $\partial_v$ are orthogonal, hence $\rmI$ is also diagonalized.
\end{proof}

Thus, Darboux frames provide the necessary unique lift of $\Sigma$ into $\SE_3$, and $H,K$ become well-defined differential invariants. The main question now is: to what extent do the functions $H$ and $K$ determine the surface? That is, given an open subset $U\subset\bbR^2$ and functions $H,K\in C^\infty(U)$, does there exist (locally) a map $\bf{x}:U\to \bbE^3$ such that $H$ and $K$ are (the pullbacks of) the mean and Gauss curvatures of $\Sigma=\bf{x}(U)$? There are certain inequalities on admissible pairs of functions because $H,K$ are symmetric functions of the principal curvatures (so, e.g., $H=0$ implies $K\leq 0$). However, stronger compatibility conditions are uncovered when one differentiates and checks that mixed partials commute (in the spirit of the Frobenius Theorem). But first, consider the following two examples of surfaces which demonstrate that $H$ and $K$ don't uniquely determine an immersed surface even in the absence of umbilic points.

\begin{figure}[tp]
    \centering
    \includegraphics[scale=0.5]{figures/helicoid.pdf}
    \caption{A $1$-parameter family of minimal ($H=0$) isometric immersions of a surface connecting the helicoid (top left) to the catenoid (bottom right). From \cite{Spivak3}.}
    \label{fig:helicoid}
\end{figure}

\begin{example}[Helicoid]\label{ex helicoid}
    Let $a>0$ be a constant and consider the following map $\bf{x}:\bbR^2\to \bbR^3$:
    \[\bf{x}(s,t)=(s\cos t,s\sin t,at).\]
    Its image is called the \emph{helicoid}.\index{Helicoid} Note that the $z$-axis is contained in the surface, as is a horizontal line emanating out of each point on the $z$-axis, and this line rotates as we move up the $z$-axis.
    
    We now compute the first-order adapted frame $\frake:\bbR^2\to \bbE^3$ for the helicoid (as usual, we identify the surface with its domain in $\bbR^2$ under the parametrization). Note that 
    \begin{align}
        \bf{x}_s&=(\cos t,\sin t,0),\\
        \bf{x}_t&=(-s\sin t,s\cos t,a),
    \end{align}
    so $\bf{x}_s\perp \bf{x}_t$ and we may take 
    \begin{align}
        e_1&=\frac{\bf{x}_s}{\lVert\bf{x}_s\rVert}=(\cos t,\sin t,0), \notag\\
        e_2&=\frac{\bf{x}_t}{\lVert\bf{x}_t\rVert}=\frac{1}{\sqrt{s^2+a^2}}(-s\sin t,s\cos t,a),\label{eq 2.7 Ivey}\\
        e_3&=e_1\times e_2=\frac{1}{\sqrt{s^2+a^2}}(a\sin t,-a\cos t,s).\notag
    \end{align}
    Since $\dd\bf{x}=\bf{x}_s\dd s+\bf{x}_t\dd t=\frake^\ast(\theta^1)e_1+\frake^\ast(\theta^2)e_2$, we obtain (omitting $\frake^\ast$ from the notation from now on)
    \[\theta^1=\dd s,\quad \theta^2=\sqrt{s^2+a^2} \dd t.\label{eq 2.8 Ivey}\]
    Next, we calculate the Gauss map:
    \begin{multline}
        \dd e_3=\left(-s\left(s^2+a^2\right)^{-3/2}(a\sin t,-a\cos t,s)+(s^2+a^2)^{-1/2}(0,0,1)\right)\dd s+\\
        +(s^2+a^2)^{-1/2}(a\cos t,a\sin t,0)\dd t.
    \end{multline}
    So, using (\ref{eq 2.7 Ivey}) and (\ref{eq 2.8 Ivey}), we obtain 
    \[\omega_1^3=-a(s^2+a^2)^{-1}\theta^2,\quad \omega_2^3=-a(s^2+a^2)^{-1}\theta^1.\]
    The coefficients in front of $\theta^i$ are the principal curvatures $k_i$. We conclude that $H(s,t)=0$ and $K(s,t)=-\frac{a^2}{(s^2+a^2)^2}$. Thus, the helicoid is a umbilic-free minimal surface.
\end{example}

Being a union of disjoint straight lines, the helicoid is an example of a \emph{ruled} surface.

\begin{defn}[Flat, ruled, tangential developable surfaces]\index{Developable surface!see {Flat surface}}\index{Ruled surface}\index{Tangential surface}\index{Flat surface}
    A surface is called \emph{developable}, or simply \emph{flat}, if its Gauss curvature vanishes everywhere, $K\equiv 0$.

    A surface is called \emph{ruled} if every point of the surface is contained in it along with a segment of a straight line passing through that point, whose ends (if they exist) lie on the boundary of the surface.

    In particular, a surface $\Sigma\subset\bbE^3$ is said to be \emph{tangential developable} if it can be described as (a subset of) the union of tangent rays to a curve. (These surfaces are also called \emph{tangential surfaces}.)
\end{defn}
The following proposition clarifies what tangential surfaces look like.
\begin{prop}
    Let $\gamma:\bbR\to \bbE^3$ be a regular parametrized curve with curvature and torsion $\kappa$ and $\tau$, respectively, and consider the tangential surface $\bf{x}:\bbR\times \bbR_+\to \bbE^3$ defined by 
    \[\bf{x}:(u,v)\mapsto \gamma(u)+v\dot\gamma(u),\quad v>0.\]
    Then this surface has $H(u,v)=\frac{\tau(u)}{2\kappa(u)v}$ and $K\equiv 0$.
\end{prop}
\begin{proof}
    Since 
    \[\dd \bf{x}=(\dot\gamma(u)+v\ddot\gamma(u))\dd u+\dot\gamma(u)\dd v,\]
    we see that $\bf{x}$ is regular, i.e., $\dd f$ is of maximal rank, when $\ddot \gamma(u)$ is linearly independent from $\dot\gamma(u)$ and $v\neq 0$, i.e., exactly when $\gamma$ is regular. Now assume that $\gamma$ is parametrized by arclength. Then $\dot\gamma\perp\ddot\gamma$ and we can take $e_1(u,v)=\dot\gamma(u)$ and $e_2(u,v)=\ddot\gamma(u)/\lVert\ddot\gamma(u)\rVert$. Using $\dd \bf{x}=\theta^1e_1+\theta^2e_2$, we calculate 
    \[\theta^1=\dd u+\dd v,\quad \theta^2=v\kappa(u)\dd u.\]
    Note that this frame coincides with the Frenet frame of $\gamma$, so, following Example~\ref{ex serret-frenet}, we have 
    \[\dd e_3=-\tau(u)e_2\dd u.\]
    Therefore, 
    \[\omega_1^3=0,\quad \omega_2^3=\frac{\tau(u)}{\kappa(u)v}\theta^2,\]
    which leads to the asserted $H$ and $K$.
\end{proof}

\begin{rem}
    Not every ruled surface is flat (consider a single-sheet hyperboloid or the hyperbolic paraboloid $z=xy$ in $\bbR^3$). However, the converse does hold (aside from degenerate cases): if a given immersed surface has $K\equiv 0$, then one of the principal curvatures must be zero. Assume the other one isn't. Since line of curvature coordinates exist (see Example~\ref{ex Gauss curvature in orthogonal coords}), one of these coordinates, say $v$, will generate straight lines in $\Sigma$, making it ruled. The surface has to locally lie on one side of its tangent planes containing the $v$-lines and include the entire segments of these lines up to its boundary, otherwise the ends of the segment would be points of positive curvature. In summary, a surface is ruled iff it is flat. Hence, flat surfaces are identified with (pieces of) ``flat sheets of paper'' arbitrarily bent in $3$-dimensional space without stretching. 
    
    Note that these statements are particular to $3$ dimensions and fail already in $\bbE^4$ where, for example, the flat torus $\bbT^2$ can be isometrically embedded, whereas it is obviously not ruled by virtue of being compact with no boundary.
\end{rem}


\begin{example}[Catenoid]\label{ex catenoid}
    Let $a>0$ be a constant and consider the following map $\bf{x}:\bbR^2\to \bbR^3$:
    \[\bf{x}(u,v)=(a\cosh v\cos u,a\cosh v\sin u,av).\]
    Its image is called the \emph{catenoid}.\index{Catenoid}
    By choosing an adapted frame and differentiating one can compute that $H=0$, so this is a minimal surface. Now consider the map $f:\bbR^2\to \bbR^2$ given by
    \[f: (u,v)\mapsto (s,t)=(a\sinh v,u).\]
    One then shows that $f^\ast(K_{\mathrm{helicoid}})=K_{\mathrm{catenoid}}$, and of course the mean curvatures match as well. But while these two surfaces have the same $H$ and $K$, the helicoid is ruled, whereas the catenoid contains no line segments. Thus, they are not congruent.
\end{example}

Nevertheless, $H$ and $K$ are usually sufficient to determine $\Sigma$ up to congruence. Those surfaces for which this is not the case either have constant $H$ or belong to a finite-dimensional family called \emph{Bonnet surfaces}.

\begin{xca}
    A surface $\Sigma$ is called \emph{flat} if $K\equiv 0$. Show that if $\Sigma$ is flat, there exist local coordinates $x^1,x^2$ on it and an orthonormal frame $(e_1,e_2,e_3)$ such that $\theta^1=\dd x^1$, $\theta^2=\dd x^2$.
\end{xca}





\section{Codazzi equation}

Let us now derive the compatibility condition on $\sfh$ by setting up a Pfaffian system. Treat $\{h_{11},h_{12},h_{22}\}$ as coordinates in $\bigodot^2 \bbR^2\cong\bbR^3$ and define an \gls{eds} $\calI\subset \Omega^{\smbullet }(\SE_3\times \bbR^3)$ by
\[\calI\coloneqq \<\theta^3,\omega_1^3-h_{11}\theta^1-h_{12}\theta^2,\omega_2^3-h_{12}\theta^1-h_{22}\theta^2\>_{\mathrm{diff}}\]
with independence condition $\theta^1\wedge\theta^2\neq 0$.
From our above computations, we know that along the lift of any hypothetical surface $\Sigma$, this entire \gls{eds} must vanish. The independence condition means that $\theta^1\wedge\theta^2$ must produce a volume form after pullback to $\Sigma$. The integral manifolds of this system are graphs of immersions $\restr{P}{U}\to \SE_3$ that are adapted frame bundles of isometric immersions $\bf{x}:U\to \bbE^3$ satisfying $\bf{x}^\ast \rmI=\sfg$ and $\bf{x}^\ast \wt{Q}=\sfh$. By the Frobenius Theorem~\ref{thm 4.7.8 RS1}, the derivatives of the generators of $\calI$ must vanish modulo $\calI$ on $\Sigma$. First, it is easy to check that $\dd\theta^3\equiv 0 \pmod{\calI}$. The differentials of the other two forms can be combined into a column-vector and rewritten modulo $\calI$ using the definition of $\sfh$:
\begin{multline}
    \dd \left\{
        \begin{pmatrix}
            \omega_1^3\\\omega_2^3
        \end{pmatrix}
        -\sfh\cdot 
        \begin{pmatrix}
            \theta^1\\\theta^2
        \end{pmatrix}
    \right\}=\\
    =-\begin{pmatrix}
        0&-\omega_1^2\\
        \omega_1^2& 0
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \omega_1^3\\\omega_2^3
    \end{pmatrix}
    -\dd \sfh\wedge 
    \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix}
    +\sfh \cdot\begin{pmatrix}
        0&-\omega_1^2\\
        \omega_1^2& 0
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix} \equiv 
    \\
    \equiv
    -\begin{pmatrix}
        0&-\omega_1^2\\
        \omega_1^2& 0
    \end{pmatrix}\wedge \sfh\cdot
    \begin{pmatrix}
        \theta^1 \\ \theta^2
    \end{pmatrix}
    -\dd \sfh\wedge 
    \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix}
    +\sfh\cdot \begin{pmatrix}
        0&-\omega_1^2\\
        \omega_1^2& 0
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix}\pmod{\calI}.\label{eq I^1_taut structure}
\end{multline}
These derivatives must vanish along the integral manifolds. Thus, $\sfh$ must satisfy the \emph{Codazzi-Mainardi equation},\index{Equation!Codazzi-Mainardi} which we will call the Codazzi equation:
\[\boxed{\left\{\dd \sfh+\left[
\begin{pmatrix}
    0 & -\omega_1^2\\
    \omega_1^2 & 0
\end{pmatrix},\sfh
\right]\right\} \wedge 
\begin{pmatrix}
    \theta^1\\\theta^2
\end{pmatrix}=0,}\label{eq Gauss-Codazzi}
\]
where $[\,,\,]$ is the commutator of matrices. (Note that in this equation a pullback to the adapted frame bundle of a surface is implied, otherwise it holds only modulo $\calI$.)

The proof of Gauss' Theorema Egregium~\ref{thm egregium} showed that, given a metric $\sfg$ on $\Sigma$ and an orthonormal frame $\frake$, $\frake^\ast \omega_1^2$ is uniquely determined. Thus, (\ref{eq Gauss-Codazzi}) is a system of equations for the possible fundamental forms $\rmII=h_{ij}\theta^i\otimes \theta^j\otimes e_3$ for embdeddings of $\Sigma$ into $\bbE^3$ that induce the metric $\sfg$. These equations are well-defined, since (\ref{eq Gauss-Codazzi}) is invariant under changes of the frame $\frake$. Thus, the Frobenius theorem guarantees existence, while uniqueness up to a rigid motion is guaranteed only for a fixed parametrization.

\begin{thm}[Bonnet's Fundamental Theorem of Surfaces]\index{Theorem!Bonnet's Fundamental Theorem}
    Let $U$ be an open domain in $\bbR^2$. Two parametric surfaces $\bf{x},\wt{\bf{x}}:U\to \bbE^3$ are congruent (via an element of $\SE_3$) iff they have the same first and second fundamental forms at corresponding points:
    \[\bf{x}^\ast\rmI=\wt{\bf{x}}^\ast \wt{\rmI},\quad \bf{x}^\ast\rmII=\wt{\bf{x}}^\ast \wt{\rmII}.\] 
    Moreover, if $\sfg$ and $\sfh$ are given quadratic forms on $U$ satisfying the Gauss-Codazzi equations with $\sfg$ positive definite, then there exists an immersion $\bf{x}:U\to \bbE^3$ such that $\bf{x}^\ast  \rmI=\sfg$ and $\bf{x}^\ast  \wt{Q}=\sfh$.
\end{thm}
Note that the immersion $\bf{x}$ needs to be specified to claim uniqueness up to congruence. If only $K$ and $H$ are given, the surface cannot be reconstructed uniquely, as we saw above.
\begin{proof}
    First we show uniqueness. Let $\bf{x}:U\to \bbE^3$ be given. Then, by following the above construction, we define the adapted frame bundle $\pi:P\to U$ consisting of triples $(p,e_1,e_2)$ where $(e_1,e_2)$ are $\rmI$-orthonormal bases for $\T_p U$. There are unique $1$-forms $\theta^1,\theta^2,\omega_1^2$ such that 
    \[\pi_\ast(X)=e_1\theta^1(X)+e_2\theta^2(X),\quad X\in \T_{(p,e_1,e_2)}P,\]
    and
    \[\dd\theta^1=\omega_1^2\wedge \theta^2,\quad \dd\theta^2=-\omega_1^2\wedge\theta^1.\]
    Then 
    \[\pi^\ast\rmI=\sum_{\mu=1}^2\theta^\mu\otimes\theta^\mu,\quad \pi^\ast \wt{Q}=\sum_{\mu,\nu=1}^2 h_{\mu\nu}\theta^\mu\otimes\theta^\nu\]
    with some uniquely determined functions $h_{\mu\nu}$ such that $h_{12}=h_{21}$. Now we define $\omega_1^3\coloneqq h_{11}\theta^1+h_{12}\theta^2$ and $\omega_2^3\coloneqq h_{12}\theta^1+h_{22}\theta^2$. Then, as we saw above, $\frake\coloneqq(\bf{x}_u,\bf{x}_v,\bf{x}_u\times \bf{x}_v)$ must satisfy 
    \[\dd \begin{pmatrix}
        \frake & \bf{x}\\
        0& 1
    \end{pmatrix}=\begin{pmatrix}
        \frake & \bf{x}\\
        0& 1
    \end{pmatrix}
    \begin{pmatrix}
        0 & -\omega_1^2 & -\omega_1^3& \theta^1\\
        \omega_1^2 & 0 & -\omega_2^3 & \theta^2\\
        \omega_1^3 & \omega_2^3 & 0 & 0\\
        0 & 0& 0& 0
    \end{pmatrix}.
    \]
    Then the $4\times 4$ matrix on the right takes values in the Lie algebra $\frakse_3$, and Cartan's Fundamental Theorem~\ref{thm 6.1 Sharpe fundamental local} guarantees the uniqueness of the map $\left(\begin{smallmatrix}
        \frake & \bf{x}\\
        0& 1
    \end{smallmatrix}\right): U\to \SE_3$ up to a left multiplication by an element of $\SE_3$, which is what a congruence is.

    Existence follows from the existence part of Cartan's Fundamental Theorem, since the Gauss-Codazzi equations are equivalent to the structure equation for the function $\left(\begin{smallmatrix}
        \frake & \bf{x}\\
        0& 1
    \end{smallmatrix}\right)$.
\end{proof}

\begin{rem}
    We can put the Gauss-Codazzi equations in an even more suggestive form by splitting up the components of all objects into tangent and normal to $\Sigma$. Let Greek indices range only over tangent directions ($1,2$), and this time we will be careful to put the row (top) index before the column (bottom) index in $\omega^i{}_j$. Then we have the two defining equations on the adapted frame bundle $P$:
    \[\dd e_\mu=e_3\omega^3{}_\mu + e_\nu\omega^\nu{}_\mu,\quad \dd e_3=e_\mu\omega^\mu{}_3.\]
    By definition of $h$ (\ref{def h}), we have $\omega^3_\mu=h_{\mu\nu}\omega^\nu$, and therefore the system becomes 
    \[\dd e_\mu= e_3 h_{\mu\nu}\omega^\nu+ e_\nu\omega^\nu{}_\mu ,\quad \dd e_3=e_\mu\omega^\mu{}_3.\]
    The Frobenius compatibility conditions for these two equations are $\dd^2 e_\mu=0$ and $\dd^2 e_3=0$. We expand the first one, use $\dd e_3=e_\mu\omega^\mu{}_3$, and collect terms containing the same basis vector:
    \[0=\dd^2e_\mu=e_3\left(\dd \omega^3{}_\mu-\omega^\nu{}_\mu\wedge\omega^3{}_\nu\right)
    +e_\nu\left(\dd\omega^\nu{}_\mu+\omega^\nu{}_\lambda\wedge\omega^\lambda{}_\mu+\omega^\nu{}_3\wedge\omega^3{}_\mu\right),
    \]
    which is equivalent to the pair of equations 
    \begin{align}
        \dd\omega^3{}_\mu-\omega^\lambda{}_\mu\wedge\omega^3{}_\lambda&=0,\\
        \dd\omega^\nu{}_\mu-\omega^\lambda{}_\mu\wedge\omega^\nu{}_\lambda&=-\omega^\nu{}_3\wedge \omega^3{}_\mu.
    \end{align}
    It is easy to check that these equations also imply the second compatibility condition, $\dd^2 e_3=0$. 
    
    By putting $b_\mu\coloneqq \omega^3{}_\mu=-\omega^\mu{}_3\eqqcolon-b^\mu$ and $\Gamma^\nu{}_\mu\coloneqq \omega^\nu{}_\mu$, we get the defining equations
    \[\begin{cases}
        \dd e_\mu=b_\mu e_3+\Gamma^\nu{}_\mu e_\nu, &\\
        \dd e_3=b^\mu e_\mu, &\text{(Weingarten)}
    \end{cases}\label{3791}\]
    and the compatibility conditions for them are
    \begin{align}
        \dd b_\mu-\Gamma^\lambda{}_\mu \wedge b_\lambda&=0 &\text{(Codazzi),}\\
        \dd \Gamma^\nu{}_\mu-\Gamma^\lambda{}_\mu\wedge\Gamma^\nu{}_\lambda&=-b^\nu\wedge b_\mu &\text{(Gauss).}
    \end{align}
    Note that the right hand side of the Gauss equation is exactly $K \omega^\nu\wedge\omega^\mu$ since $b_\mu=h_{\mu\nu}\omega^\nu$ and $K=\det h$. Thus, if these Gauss-Codazzi equations are satisfied by the second fundamental form $b_\mu$, then the defining equations (\ref{3791}) can be uniquely solved for $(e_1,e_2,e_3)$ (with some initial condition), providing a map into the orthonormal frame bundle over $\bbE^3$, and hence an isometric immersion into $\bbE^3$. In time we will identify $\Gamma^\nu{}_\mu$ with the components of a (Levi-Civita) connection on the surface and $b_\mu$ with the components of a connection on its normal bundle.
\end{rem}




\section{\texorpdfstring{\gls{eds}}{EDS} for surfaces}


In this \sect\ we put the above discussion in terms of the theory of \glspl{eds} developed in the preceding \chap, and consider some related examples of geometric \glspl{eds}. First let us define the simple \emph{tautological} \gls{eds} for immersed surfaces in $\bbE^3$. This is the Pfaffian system on the orthonormal bundle $\SE_3$ generated by the single form $\theta^3$:
\[\calI_{\mathrm{taut}}=\<\theta^3\>_{\mathrm{diff}}.\]
Any $2$-dimensional integral manifold is locally described by some function $(\bf{x},\frake)$, where $\frake$ is an orthonormal frame at $\bf{x}$. The vanishing of $\theta^3$ along the integral manifolds implies that $\dd \bf{x}=e_1\theta^1+e_2\theta^2$, which is exactly the statement that the image of $(\bf{x},\frake)$ is consists of first-order adapted frames of the surface parametrized by $\bf{x}$. Thus, $3$-dimensional integral manifolds of this system are exactly the bundles of adapted frames of immersed surfaces. The following example establishes that this system is not involutive.

\begin{example}[Involutivity of $\calI_{\mathrm{taut}}$]
    The structure equation is $\dd\theta^3=\omega^3_i\wedge\dd\theta^i$, so $(s_1,s_2,s_3)=(1,0,0)$. A coframe for a bundle of adapted frames is given by $\theta^1,\theta^2,\omega^2_1$, and the remaining directions on $\SE_3$ are $\omega^3_1,\omega^3_2,\theta^3$. Thus, integral elements are parametrized by linear equations of the form 
    \[
    \begin{pmatrix}
        \omega^3_1\\
        \omega^3_2\\
        \theta^3
    \end{pmatrix}=
    \begin{pmatrix}
        a & b & e \\
        c & d & f \\
        0 & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
        \theta^1\\\theta^2\\\omega^2_1
    \end{pmatrix},
    \]
    subject to $0=\dd\theta^3=(b-c)\theta^1\wedge\theta^2+e\omega^2_1\wedge\theta^1+f\omega^2_1\wedge\theta^2$, so $b=c$ and $e=f=0$. Thus, the space of $3$-dimensional integral elements at a point is of dimension $3$, and $3>s_1+2s_2+3s_3=1$, so the system is not involutive.
\end{example}

Another way to see that this system is not involutive is to notice that it has a Cauchy characteristic that corresponds to locally rotating the tangent frames $(e_1,e_2)$. In other words, the system has an angular ``dummy variable'' whose presence forbids the uniqueness of integral manifolds, necessary for the Cartan-K\"ahler Theorem to work. The following example shows this in detail.

\begin{example}[Cauchy characteristics of $\calI_{\mathrm{taut}}$]\label{ex 7.1.10 Ivey}
    The system $\calI_{\mathrm{taut}}$ admits a Cauchy characteristic vector field as follows.

    Let $\{E_j,E^i_j\}$ be a global frame for $\T P$ dual to the one given by the entries of the Maurer-Cartan form $\{\theta^j,\omega^i_j\}$. Expand $X=X^jE_j+X^j_i E^i_j$. Then $i_X\theta^3=0$ implies that $X_3=0$ and 
    \[i_X \dd\theta^3=i_X(-\omega^3_1\wedge\theta^1-\omega^3_2\wedge\theta^2)=X_1\omega^3_1-X^1_3\theta^1+X_2\omega^3_2-X^2_3\theta^2\]
    implies that $X=X^1_2 E^2_1$. We can pick $X=E^2_1$, which generates rotations of the frame in the $\{e_1,e_2\}$-plane. Now, Proposition~\ref{prop 7.1.8 Ivey} implies that any integral surface for $\calI$ may be ``thickened'' to an integral $3$-manifold using the Cauchy characteristic.

    Now, $\calC(\calI)$ is the Frobenius system on $\SE_3$ spanned by $\theta^1,\theta^2,\theta^3,\omega^3_1,\omega^3_2$. Integral curves of $\calC(\calI)$ form a foliation of $\SE_3$. The leaf space for this foliation is a 5-dimensional homogeneous space which we identify with $\bbS(\T\bbE^3)$, the unit sphere bundle of the tangent bundle of $\bbE^3$, by letting $m$ be the basepoint and $e_3$ the unit vector in $\T_m\bbE^3$.\index{Sphere bundle}
\end{example}

The surface $\Sigma$ can be described by the restrictions of the forms $\theta^1,\theta^2$ to its bundle of adapted frames $P\subset \SE_3$. To find out whether these data are sufficient to recover the shape of $\Sigma$, it makes sense to set up another \gls{eds} $\calI_\Sigma$ on $P\times\SE_3$ that \emph{compares} two different sets of forms, namely the Pfaffian system generated by the $1$-forms 
\[\begin{pmatrix}
    \vartheta_1\\\vartheta_2\\\vartheta_3
\end{pmatrix}\coloneqq 
\begin{pmatrix}
    \wt\theta^1-\theta^1\\
    \wt\theta^2-\theta^2\\
    \wt\theta^3
\end{pmatrix},
\]
where $\wt\theta^i$ are the standard forms on $\SE_3$ and $\theta^i$ are the fixed forms on $P$ (we omit pullbacks of both to $P\times\SE_3$). Along $P$, all of these forms vanish, while the $1$-forms $\theta^1,\theta^2,\omega^2_1$ form a coframe. Conversely, we will eventually prove that all integral manifolds with this coframe are locally frame bundles of isometric immersions of $\Sigma$. For the moment, we concentrate on asking whether we can apply the Cartan-K\"ahler Theorem.

\begin{example}[Cartan's Test for $\calI_\Sigma$]
    First we compute the tableau:
    \[\dd \begin{pmatrix}
        \vartheta_1\\\vartheta_2\\\vartheta_3
    \end{pmatrix}
    =-\begin{pmatrix}
        0 & \wt\omega^2_1-\omega^2_1 & 0\\
        \boxed{-(\wt\omega^2_1-\omega^2_1)} & 0 & 0\\
        \boxed{\wt\omega^3_1} & \boxed{\wt\omega^3_2} & 0
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \vartheta_1\\\vartheta_2\\\vartheta_3
    \end{pmatrix} \pmod{\vartheta^1,\vartheta^2,\vartheta^3}.
    \]
    We have $(s_1,s_2,s_3)=(2,1,0)$. Each $3$-dimensional integral element has $\wt\theta^i=\theta^i$, so is determined by the linear equations relating $\wt\omega^i_j$ to $\theta^1,\theta^2,\omega^2_1$ such that $\dd\vartheta^i=0$:
    \[\begin{pmatrix}
        \wt\omega^3_1\\
        \wt\omega^3_2\\
        \wt\omega^2_1-\omega^2_1
    \end{pmatrix}=
    \begin{pmatrix}
        \wt h_{11} & \wt h_{12} & 0\\
        \wt h_{12} & \wt h_{22} & 0\\
        0 & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
        \theta^1\\\theta^2\\\omega^2_1
    \end{pmatrix}.\label{eq 12942}
    \]
    Therefore, there is a $3$-dimensional space of integal elements at each point. But $s_1+2s_2=4>3$, so involution fails and we can't apply the Cartan-K\"aher Theorem, and prolongation is necessary. Another way to see this is to check whether the generic integral line sits in an integral plane. The equations on integral lines are $\wt\theta^1=\theta^1$, $\wt\theta^2=\theta^2$, $\wt\theta^3=0$. On any integral plane $\wt\omega^2_1=\omega^2_1$. The generic integral line does not sit in an integral plane because it doesn't have to satisfy $\wt\omega^2_1=\omega^2_1$.
\end{example}

The procedure in the last \sect\ where we adjoined the Second Fundamental Form to the system as an indepedent variable is in fact exactly the \emph{first prolongation} of $\calI_{\mathrm{taut}}$. We also call the resulting system the tautological system on $\SE_3\times\bbR^3_{h_{ij}}$ for surfaces in $\bbE^3$. The integral manifolds of this system are still the first-order adapted lifts of arbitrary surfaces in $\bbR^3$, together with the components of the second fundamental form $\{h_{ij}\}$, which we view as coordinates of another space $\bbR^3$. This Pfaffian system $\calI^{(1)}_{\mathrm{taut}}=\<I\>_{\mathrm{diff}}$ is generated by 
\[\begin{pmatrix}
    \vartheta^1\\
    \vartheta^2\\
    \vartheta^3
\end{pmatrix}=
\begin{pmatrix}
    \omega^3_1-h_{1\mu}\theta^\mu\\
    \omega^3_2-h_{2\mu}\theta^\mu\\
    \theta^3
\end{pmatrix}.\]
The next example directly verifies, for this particular system, the by now familiar fact that the prolongation of an involutive system is involutive. 

\begin{example}[Involutivity of $\calI^{(1)}_{\mathrm{taut}}$]
    Then (\ref{eq I^1_taut structure}) reads
    \begin{align}
        \dd \begin{pmatrix}
            \vartheta^1\\
            \vartheta^2\\
            \vartheta^3
        \end{pmatrix}
        \equiv& \begin{pmatrix}
            2h_{12}\omega^2_1-\dd h_{11} & (h_{22}-h_{11})\omega^2_1-\dd  h_{11}\\
            (h_{22}-h_{11})\omega^2_1-\dd h_{12} & -2h_{12}\omega^2_1-\dd h_{22}\\
            0 & 0\\
        \end{pmatrix}\wedge 
        \begin{pmatrix}
            \theta^1\\
            \theta^2
        \end{pmatrix}\pmod{I} \notag \\
        \eqqcolon& 
        \begin{pmatrix}
            \pi^1_1 & \pi^1_2\\
            \pi^2_1 & \pi^2_2\\
            \pi^3_1 & \pi^3_2
        \end{pmatrix}\wedge 
        \begin{pmatrix}
            \theta^1\\
            \theta^2
        \end{pmatrix}\pmod{I}.
    \end{align}
    The symbol relations are 
    \[\pi^3_1\equiv \pi^3_2\equiv \pi^2_1-\pi^1_2\equiv 0\pmod{I}.\]
    There is no intrinsic torsion, and $(s_1,s_2)=(2,1)$. Integral elements are given by 
    \begin{align}
        \pi^1_1&=a\theta^1+b\theta^2,\notag\\
        \pi^1_2&=\pi^2_1=b\theta^1+c\theta^2,\notag\\
        \pi^2_2&=c\theta^1+e\theta^2,\notag\\
        \pi^3_1&=\pi^3_2=0,
    \end{align}
    where $a,b,c,e$ are arbitrary. Thus, $\dim A^{(1)}=4=s_1+2s_2$, and the system is involutive. The Cartan-K\"ahler Theorem implies that integral manifolds depend on one function of two variables. This is expected since locally any surface is a graph of a function $z=f(x,y)$. 
    
    Finally, we observe that the Codazzi equation is exactly the structure equation for this system pulled back to an integral surface, and the Gauss equation is similarly the pullback of $\dd\omega^2_1\equiv- K\theta^1\wedge\theta^2\pmod{\calI_{\mathrm{taut}}^{(1)}}$.
\end{example}

Finally, to compute the differential invariants of $\Sigma$, we should prolong $\calI_\Sigma$ and check involutivity. This means that we need to treat $\wt{h}_{ij}$ as new independent variables and turn (\ref{eq 12942}) into the condition for the vanishing of three new generating $1$-forms:
\[
    \begin{pmatrix}
        \vartheta_4\\
        \vartheta_5\\
        \vartheta_6
    \end{pmatrix}\coloneqq 
    \begin{pmatrix}
        \wt\omega^3_1\\
        \wt\omega^3_2\\
        \wt\omega^2_1-\omega^2_1
    \end{pmatrix}=
    \begin{pmatrix}
        \wt h_{11} & \wt h_{12} & 0\\
        \wt h_{12} & \wt h_{22} & 0\\
        0 & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
        \theta^1\\\theta^2\\\omega^2_1
    \end{pmatrix}.
\]
Note that $\dd\vartheta_i\equiv 0\pmod{\vartheta_4,\vartheta_5,\vartheta_6}$ for $i=1,2,3$, so we can omit them in the analysis. 
\[\dd \begin{pmatrix}
    \vartheta_4\\
    \vartheta_5\\
    \vartheta_6
\end{pmatrix} \equiv 
-\begin{pmatrix}
    \boxed{D\wt{h}_{11}} & D\wt{h}_{12} & 0\\
    \boxed{D\wt{h}_{12}} & \boxed{D\wt{h}_{22}} & 0\\
    0 & 0 & 0
\end{pmatrix}\wedge 
\begin{pmatrix}
    \theta^1\\\theta^2\\\omega^2_1
\end{pmatrix}
+\begin{pmatrix}
    0 \\ 0\\ t\theta^1\wedge\theta^2
\end{pmatrix}\pmod{\vartheta_1,\ldots,\vartheta_6},
\]
where 
\[\begin{pmatrix}
    D\wt{h}_{11}\\
    D\wt{h}_{12}\\
    D\wt{h}_{22}
\end{pmatrix}
\coloneqq 
\begin{pmatrix}
    \dd\wt{h}_{11} +2\wt{h}_{12}\omega^2_1+a \theta^1+b\theta^2\\
    \dd\wt{h}_{12}+(\wt{h}_{11}-\wt{h}_{22})\omega^2_1+b\theta^1+c\theta^2\\
    \dd\wt{h}_{22}+2\wt{h}_{12}\omega^2_1+c\theta^1+d\theta^2
\end{pmatrix},
\]
with $a,b,c,d$ arbitrary, and the torsion is 
\[t\coloneqq \det \wt{h}-\det h=\det\wt h-K.\]
This torsion clearly has to vanish on any $3$-dimensional integral element of $\calI^{(1)}_\Sigma$, i.e., every such element lives over the subset of $M=P\times\SE_3$ on which $K=\det\wt h$. To ensure that this subset is a submanifold, we let $M'\subset M$ be the set of points where this equation is satisfied and at least one of $\wt{h}_{ij}$ is not zero. Clearly $M'\subset M$ is a submanifold, on which we find $D\wt h_{ij}$ linearly independent. On $M'$ we have
\[
    \dd \begin{pmatrix}
        \vartheta_4\\
        \vartheta_5\\
        \vartheta_6
    \end{pmatrix} \equiv 
    -\begin{pmatrix}
        \boxed{D\wt{h}_{11}} & D\wt{h}_{12} & 0\\
        \boxed{D\wt{h}_{12}} & D\wt{h}_{22} & 0\\
        0 & 0 & 0
    \end{pmatrix}\wedge 
    \begin{pmatrix}
        \theta^1\\\theta^2\\\omega^2_1
    \end{pmatrix}\pmod{\vartheta_1,\ldots,\vartheta_6},
\]
so $(s_1,s_2,s_3)=(2,0,0)$. There are $2$ dimensions of integral elements (down from $3$ due to Gauss' equation $K=\det\wt{h}_{ij}$), so we have involution. This confirms again that $\wt{h}$ contains the full set of differential invariants.

The next two examples are adapted from Cartan's 1945 treatise \cite{cartan45}.
\begin{example}[Linear Weingarten surfaces]\label{ex Weingarten surfaces}
    Let $A,B,C\in\bbR$ with $A\neq 0$, and let $AK+2BH+C=0$ be a linear relation between functions $H,K$. We will now set up the space of general integral manifolds for first-order adapted liftings of surfaces in $\bbR^3$, together with the components of the second fundamental form, having Gauss and mean curvatures satisfying this relation.

    This is the system above restricted to a codimension one submanifold $M\subset \SE_3\times \bbR^3_{h_{ij}}$. The submanifold is defined by the equation 
    \[A(h_{11}h_{22}-h_{12}^2)+B(h_{11}+h_{22})+C=0.\]
    The differential of this equation implies that on $M$ we may write 
    \[\dd h_{12}=\alpha d h_{11}+\beta dh_{22}\]
    for some functions $\alpha,\beta$, and thus 
    \[\pi^1_2=\alpha\pi^1_1+\beta\pi^2_2.\]
    We still have no intrinsic torsion and have characters $(s_1,s_2)=(2,0)$.  This is automatically involutive because any tableau with characters $(s_1,\ldots,s_{n-1},s_n)=(s,\ldots,s,0)$, where $s=\dim W$, is involutive. Solutions depend on two functions of one variable. This suggests that an appropriate Cauchy problem for determining such surfaces would be to start out with a space curve (the two functions being its curvature and torsion) and then solve for a unique surface containing the curve. Cartan carries out this construction explicitly in his treatise \emph{Les Syst\`emes Ext\'erieurs et leurs Applications G\'eom\'etriques}.
\end{example} 

\begin{example}[Conformally equivalent surfaces]
    Let $(\Sigma,\sfg)$ and $(\wb\Sigma,\wb \sfg)$ be analytic Riemannian surfaces. We set up and solve the \gls{eds} for maps $\phi:\Sigma\to \wb \Sigma$ that preserve the metric up to (point-dependent) scale, i.e., for \emph{conformal} maps.

    Let $P=\Fr_{\SO_2}(\T^\ast \Sigma)$ denote the orthonormal coframe bundle of $\Sigma$, with coframe $\{\theta^1,\theta^2,\omega^2_1=-\omega^1_2\}$ satisfying $\dd\theta^i=-\omega^i_j\wedge \theta^j$ as usual. Similarly, let $\wb P$ denote the orthonormal coframe bundle of $\wb\Sigma$ with coframe $\{\wb\theta^1,\wb\theta^2,\wb\omega^2_1\}$. The metric on $\Sigma$ is given by the pullback of $(\theta^1)^2+(\theta^2)^2$ (tensor squares) along any section $s:\Sigma\to P$, and that on $\wb P$ by the pullback of $(\wb\theta^1)^2+(\wb\theta^2)^2$. Thus, a conformal map $\phi:\Sigma\to \wb\Sigma$ induces  a map $\Phi:P\to \wb P$ such that $\Phi^\ast \left((\wb\theta^1)^2+(\wb\theta^2)^2\right)=\lambda^2 \left((\theta^1)^2+(\theta^2)^2\right)$ for some positive function $\lambda>0$.

    \gls{wlog}, we may require that $\Phi^\ast\theta^j=\lambda\omega^j$ because we have freedom to rotate in the tangent spaces at each point. So on $M\coloneqq P\times \wb P\times \bbR_\lambda$, $\lambda>0$, let 
    \begin{align}
        I&=\<\vartheta^1\coloneqq \theta^1-\lambda\wb\theta^1,\vartheta^2\coloneqq \theta^2-\lambda\wb\theta^2\>,\\
        J&=\<\vartheta^1,\vartheta^2,\theta^1,\theta^2,\omega^2_1\>=\<\vartheta^1,\vartheta^2,\wb\theta^1,\wb\theta^2,\wb\omega^2_1\>.
    \end{align}
    We compute 
    \begin{align}
        \dd \vartheta^1 &= -\omega^1_2\wedge \theta^2-\dd\lambda\wedge\theta^1+\lambda\wb\omega^1_2\wedge\wb\theta^2,\\
        \dd\vartheta^2&=-\omega^2_1\wedge\theta^1-\dd\lambda\wedge\theta^2+\lambda\wb\omega^2_1\wedge \wb\theta^1.
    \end{align}
    Reducing modulo $I$, we obtain 
    \[\dd\begin{pmatrix}
        \vartheta^1\\
        \vartheta^2
    \end{pmatrix}
    \equiv 
    \begin{pmatrix}
        \boxed{-\lambda^{-1}\dd\lambda} & -(\wb\omega^2-\omega^2_1) & 0\\
        \boxed{\wb\omega^2_1 -\omega^2_1} & -\lambda^{-1}\dd\lambda & 0
    \end{pmatrix}
    \wedge 
    \begin{pmatrix}
        \theta^1\\\theta^2\\\omega^2_1
    \end{pmatrix}.
    \]
    Since $-\lambda^{-1}\dd\lambda$ and $\wb\omega^2_1-\omega^2_1$ are independent modulo $J$, there is no intrinsic torsion, and $(s_1,s_2)=(2,0)$, so the tableau is involutive. Solutions depend on two functions of one variable. We may make this dependence explicit as follows.

    Specify parametrized curves $\gamma:\bbR\to \Sigma$ and $\wb\gamma:\bbR\to \wb\Sigma$ and look for conformal maps $\phi$ such that $\phi\circ \gamma=\wb\gamma$. The claim is that up to constants there is a unique such map. In fact, choose an orthonormal frame $e_1,e_2$ on $\Sigma$ such that $e_1$ is tangent to $\gamma(\bbR)$, and adapt similarly on $\wb\Sigma$. Set $\lambda=\dot{\bar\gamma}/\dot\gamma$, then the map is uniquely determined up to constants.

    Conformal maps are exactly the injective holomorphic and anti-holomorphic maps between surfaces (using the complex structures induced by the metric). These are determined by their restriction to an arc, so picking parametrized arcs determines a holomorphic or anti-holomorphic map. Even without knowing the coincidence of Lie groups $\GL_1(\bbC)\cong\CO_2$, one might have guessed this by observing that the tableau above is the same as that of the Cauchy-Riemann equations, augmented with zeros.
\end{example}

By taking $\wb\Sigma=\bbR^2$ with the standard flat metric in the last example, we get the following statement.

\begin{cor}[Korn-Lichtenstein]\label{cor isothermal coords}\index{Theorem!Korn-Lichtenstein}
    Let $\Sigma$ be a surface with an analytic Riemannian metric $\sfg$ and let $m\in\Sigma$. Then there exist local coordinates $(x,y)$ centered at $m$ such that $\sfg=\lambda^2(\dd x^{\otimes 2}+\dd y^{\otimes 2})$, $\lambda\neq 0$, in some neighborhood of $m$. Such coordinates are called \emph{isothermal} and are unique up to isometry. \index{Isothermal coordinates}
\end{cor}

Isothermal coordinates do not usually exist on Riemannian manifolds of dimension $3$ and higher.
Note that isothermal coordinates allow us to construct canonical parametrizations of $\Sigma$ that are \emph{conformally orthonormal}, i.e., the corresponding coordinate vector fields $\partial_x,\partial_y$ are orthonormal only up to an overall scale. This limitation explains why the Fundamental Theorem of Surfaces required a fixed parametrization to guarantee uniqueness of the immersion: there is no natural orthonormal coordinate system on a curved surface. In contrast, immersed curves always have the unique arclength parameter that produces an orthonormal tangent vector, which removes the freedom of reparametrization.

\begin{defn}[Conformal structure]\index{Conformal structure}
    Two (pseudo-)Riemannian metrics $\sfg,\wt\sfg$ on a manifold $M$ are called \emph{conformally equivalent} if there exists a smooth function $\lambda\neq 0$ such that $\wt\sfg=\lambda^2 \sfg$. A conformal structure on a manifold $M$ is a conformal equivalence class of metrics $[\sfg]$.
\end{defn}

Crucially, the metric $\sfg$ on a surface cannot be recovered just from its conformal factor $\lambda^2$ in isothermal coordinates. In other words, not any two metrics on a surface are locally conformally equivalent. In the next example we characterize the intrisic information contained in $\lambda^2$.

\begin{example}[Liouville equation]\index{Equation!Liouville}
    Surfaces with given Gauss curvature have an especially simple description in isothermal coordinates. If the metric (i.e., First Fundamental Form) is $\sfg=\lambda^2(\dd x^{\otimes 2}+\dd y^{\otimes 2})$, then, by (\ref{eq K in orthogonal coords}) with $E=G=\lambda^2$,
    \[K=-\frac{1}{\lambda^2}\left(\left(\frac{\lambda_x}{\lambda}\right)_x+\left(\frac{\lambda_y}{\lambda}\right)_y \right)=-\frac{1}{\lambda^2}(\partial_x^2+\partial_y^2)\ln\lambda.\label{eq K in isothermal coords}\]
    In particular, when $K$ is constant, the conformal factor $\varphi\coloneqq \ln\lambda$ satisfies the \emph{Liouville equation}:
    \[\Delta_0 \varphi+K\rme^{\varphi}=0,\label{eq liouville general}\]
    where $\Delta_0=\partial_x^2+\partial_y^2$ is the ``flat'' Laplace operator.
\end{example}

Thus, $\lambda^2$ and $K$ contain the same local information about the metric (up to the necessary boundary conditions that guarantee a unique solution of Liouville's equation). The rest of the information about the metric, namely the conformal structure, is contained in the isothermal coordinates themselves. We will later identify this information with a \emph{complex structure} on the surface.

We can also obtain the following useful formula for the mean curvature in isothermal coordinates. Since the mean curvature is not intrinsic, we need to assume a fixed isometric immersion $\bf{x}:\Sigma\to \bbE^3$.
\begin{prop}\label{prop mean curvature laplace}
    Let $\bf{x}=\bf{x}(x,y)$ be a surface parametrized by isothermal coordinates $(x,y)$ such that the metric is $\lambda^2((\dd x)^2+(\dd y)^2)$. Let $e_3$ be the unit normal vector (Gauss map) of $\Sigma$. Then 
    \[H e_3=\frac{1}{\lambda^2}\left(\bf{x}_{xx}+\bf{x}_{yy}\right).\]
\end{prop}
\begin{proof}
    Since $\bf{x}(x,y)$ is isothermal, $\<\bf{x}_x,\bf{x}_x\>=\<\bf{x}_y,\bf{x}_y\>$ and $\<\bf{x}_x,\bf{x}_y\>=0$. By differentiation, 
    \[\<\bf{x}_{xx},\bf{x}_x\>=\<\bf{x}_{yx},\bf{x}_y\>=-\<\bf{x}_x,\bf{x}_{yy}\>.\]
    Thus, 
    \[\<\bf{x}_{xx}+\bf{x}_{yy},\bf{x}_x\>=0.\]
    Similarly, 
    \[\<\bf{x}_{xx}+\bf{x}_{yy},\bf{x}_y\>=0.\]
    It follows that $\bf{x}_{xx}+\bf{x}_{yy}$ is parellel to $e_3$. Since $\bf{x}$ is isothermal, from (\ref{eq hopf differential components})
    \[H=\frac{1}{2}\frac{g+e}{\lambda^2}.\]
    Thus,
    \[2\lambda^2 H=g+e=\<e_3,\bf{x}_{xx}+\bf{x}_{yy}\>,\]
    and the result follows.
\end{proof}


\begin{example}[Minimal surfaces with given curvature]
    For simplicity, assume no umbilic points and use Darboux framings. On the orthonormal frame bundle $P\to \bbE^3$ let $K(\bf{x})$ be a given function which will be the curvature and let $k(\bf{x})=\sqrt{-K(\bf{x})}$ be the positive square root.

    Let $I=\<\theta^3,\theta^3_1,\theta^3_2\>$ and $J=\<\theta^3,\theta^3_1,\theta^3_2,\theta^1,\theta^2\>$, where we set $\theta^3_1=\omega^3_1-k\theta^1$ and $\theta^3_2=\omega^3_2+k\theta^2$. The structure equation modulo $I$ is 
    \[\dd\begin{pmatrix}
        \theta^3\\\theta^3_1\\\theta^3_2
    \end{pmatrix}\equiv 
    \begin{pmatrix}
        0 & 0\\
        -dk & -2k\omega^2_1\\
        -2k\omega^2_1 & dk
    \end{pmatrix}
    \wedge \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix}.
    \]
    Write $\dd k=k_1\theta^1+k_2\theta^2$. The symbol relations are  (all modulo $I$)
    \begin{align}
        \pi^0_1\equiv \pi^0_2\equiv& 0 \notag\\
        \pi^2_1-\pi^1_2\equiv& 0\notag\\
        \pi^1_1+\pi^2_2\equiv& 0\notag\\
        \pi^1_1\equiv& k_1\theta^1+k_2\theta^2.
    \end{align}
    We can change bases to attempt to absorb the apparent torsion. If we rewrite our equations as 
    \[\dd\begin{pmatrix}
        \theta^3\\\theta^3_1\\\theta^3_2
    \end{pmatrix}\equiv 
    \begin{pmatrix}
        0 & 0\\
        0 & -2k\omega^2_1+k_2\theta^1\\
        -2k\omega^2_1-k_1\theta^2 & 0
    \end{pmatrix}
    \wedge \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix},
    \]
    the symbol relations become 
    \begin{align}
        \pi^0_1\equiv \pi^0_2&\equiv 0 \notag\\
        \pi^2_1-\pi^1_2&\equiv -k_1\theta^1+k_2\theta^2\notag\\
        \pi^1_1\equiv \pi^2_2&\equiv 0.
    \end{align}
    This still has apparent torsion, but if we instead write 
    \[\dd\begin{pmatrix}
        \theta^3\\\theta^3_1\\\theta^3_2
    \end{pmatrix}\equiv 
    \begin{pmatrix}
        0 & 0\\
        0 & -2k\omega^2_1+k_2\theta^1-k_1\theta^2\\
        -2k\omega^2_1-k_1\theta^2+k_2\theta^1 & 0
    \end{pmatrix}
    \wedge \begin{pmatrix}
        \theta^1\\\theta^2
    \end{pmatrix},
    \]
    the symbol relations become 
    \[\pi^0_1\equiv \pi^0_2\equiv\pi^1_1\equiv\pi^2_2\equiv \pi^2_1-\pi^1_2\equiv 0\pmod{I}.\]
    We see that $(s_1,s_2)=(1,0)$ and $\dim A^{(1)}=0$, so the system is not involutive.

    We can shortcut the prolongation process by realizing that, since the system contains both $\pi^1_2\wedge\theta^1$ and $\pi^1_2\wedge\theta^2$, then $\pi^1_2$ must vanish on all integral manifolds satisfying the independence condition. Thus, we need to add $\pi\coloneqq \pi^1_2=-2k\omega^2_1+k_2\theta^1-k_1\theta^2$ to the system. Call the new system $I^+$. By counting dimensions, we see that $I^+$ will either be Frobenius at $m$ or have no integral manifold passing through $m$. We have $\dd\theta^3\equiv \dd\theta^3_1\equiv \dd\theta^3_2\pmod{I^+}$ and compute 
    \begin{align}
        \dd\pi&=\dd(-2k\omega^2_1+k_2\theta^1-k_1\theta^2)\\
        &\equiv \left(-k_{1,1}-k_{2,2}+\frac{k_1^2+k_2^2}{2k}+2kK\right)\theta^1\wedge\theta^2 \pmod{I^+},
    \end{align}
    where we have written $\dd k_j=k_{j,1}\theta^1+k_{j,2}\theta^2$. The integrability condition we have obtained can be put more simply using the Laplace-Beltrami operator defined in a Darboux frame with principal curvatures $k_1,k_2$ by
    \[\Delta_{\sfg} f \coloneqq f_{11}+f_{22}+\frac{f_1k_{2,1}-f_2k_{1,2}}{k_1-k_2}.\]
    In particular, this implies that
    \[\Delta_{\sfg} \ln(-K)-4K=\frac{2}{k}\left(k_{1,1}+k_{2,2}-\frac{k_1^2+k_2^2}{2k}-2kK\right).\]
    The intergability condition $\dd\pi\equiv 0\pmod{I^+}$ becomes
    \[\Delta_{\sfg}\ln(-K)=4K.\]
\end{example}

In summary:
\begin{thm}[Ricci {{\cite[Thm.~6.8.13]{Ivey}}}]
    Let $(\Sigma,\sfg)$ be a surface with a Riemannian metric. Let $K$ be its curvature function. Away from umbilic points, $\Sigma$ admits a minimal isometric immersion into $\bbE^3$ iff $K<0$ and $\Delta_{\sfg}\ln (-K)=4K$. If $K$ is not constant, then there is a one-parameter family of such immersions, up to congruence.
\end{thm}

Another geometric structure closely related to the \gls{eds} for immersed surfaces if the following.

\begin{example}[Triply orthogonal webs]\index{Web}\label{example orthogonal 3-webs}
    A \emph{triply orthogonal web} is a triple of foliations of the Euclidean space $\bbE^3$ by surfaces whose leaves are pairwise orthogonal. Each leaf is perpendicular to (annihilated by) a unique unit-norm $1$-form $\eta_i$, up to a sign, which satisfies $\eta_i\wedge\dd\eta_i=0$ by the Frobenius Theorem in the form of Proposition~\ref{prop 4.7.6 RS1 pfaffian rank 1}. Let $P=\SE_3$ be the bundle of all orthonormal frames of $\T\bbE^3$, with the usual bundle projection $\pi:P\to \bbE^3$, so that each point of $P$ has the form $p=(m,e_1,e_2,e_3)$ for some $m\in \bbE^3$ and orthonormal basis $\frake=(e_1,e_2,e_3)\in \SO_3$ of $\T_{m}\bbE^3$. The \emph{soldering $1$-form} $\theta\in \Omega^1(P;\bbR^3)$ on $P$ is defined by 
    \[\frake\cdot \theta(X)=\pi_\ast(X),\quad X\in \T P,\]
    i.e., it outputs the components of $\pi_\ast(X)$ in the frame $\frake$. In the above \sect s we encountered its components $\theta^i$, and we also constructed the $1$-forms 
    $\omega^i{}_j=\<\dd e_j,e_i\>,$
    which together comprise a unique $\frakso_3$-valued $1$-form on $P$ that satisfies (part of) the structure equation (\ref{eq structure for surfaces}):
    \[\dd \theta=-\omega\wedge\theta,\]
    where $\omega$ acts on the vector $\theta$ as a matrix. A triply orthogonal web is precisely a global section $\frake:\bbE^3\to P$  on which $0=\theta^i\wedge \dd\theta^i$ for all $i$, hence an integral $3$-manifold of the \gls{eds} $\calI$ on $P$ generated by the closed $3$-forms 
    \[\theta^i\wedge\dd\theta^i,\quad i=1,2,3.\]
    Using the equations above, $\calI$ is also generated by three $3$-forms
    \[\omega^i{}_j\wedge\theta^i\wedge\theta^j,\quad (ij)=(12),(23),(31).\]
    The integral manifolds coframed by $\{\theta^i\}_{i=1}^3$ are locally precisely the triply orthogonal webs. In Example~\ref{example tableau of orthogonal 3-webs} we computed the characters: $(s_1,s_2,s_3)=(0,3,0)$, and the integral elements coframed by $\{\theta^i\}$ form a manifold of dimension $12$ (parametrized by a choice of a point of $P$ and $3\times 2=6$ coefficients determining the values of $\omega^i{}_j$). Again we conclude involution. As a result, triply orthogonal webs exist locally and depend on $3$ functions of $2$ variables (e.g., a system of orthogonal coordinates).
\end{example}

\begin{hrem*}
    The classification of webs is equivalent to Cartan's equivalence problem for certain differential equations. In 1908 he posed the problem of the equivalence of two ODE's:
    \[y_x=f(x,y),\quad \text{ and }\quad Y_X=F(X,Y),\]
    w.r.t.\ coordinate transformations that don't mix the coordinates:
    \[\wh{x}=X(x),\quad \wh{y}=Y(y).\label{6914}\]
    This transformation leaves invariant the coordinate lines $x=a$, $y=b$ in the $xy$-plane as well as the integral lines of the equations. These three families of lines form a $3$-web \emph{in the plane}. Intuitively, the ODE, viewed only up to diffeomorphism, fixes the curvature of the integral curves at all points, which suffices for recovering the curves in two dimensions. Thus, the problem considered by Cartan is equivalent to classifying curvilinear $3$-webs in the plane. He distinguished $3$ classes of ODE's of the above type: those admitting a $3$-parameter group of transformations (\ref{6914}), those admitting a $1$-parameter such group, and those not admitting any such symmetries. This corresponds to $3$ classes of $3$-webs in the plane.
\end{hrem*}







\section{Monge-Amp\`ere systems}


Now we will study a class of second-order PDEs for which one can define an \gls{eds} on a smaller-dimensional manifold than the usual $7$-dimensional jet space of \S\ref{sec: hyperbolic EDS}. It will also be our first example of a non-Pfaffian \gls{eds}, i.e., which is not generated just by $1$-forms. These equations, called \emph{Monge-Amp\`ere equations}, are of the form 
\[Az_{xx}+2Bz_{xy}+Cz_{yy}+D+E(z_{xx}z_{yy}-z_{xy}^2)=0,\label{eq 7.18 Ivey}\]
where $A,B,C,D,E$ are functions of $x,y,z,p=z_x,q=z_y$. As in \S\ref{sec: hyperbolic EDS}, we assume that the partial derivatives of the left hand side w.r.t.\ $z_{xx},z_{xy}$ and $z_{yy}$ are never simultaneously zero. In the next \sect, we will apply this theory to a special class of surfaces that are locally represented by solutions of such systems.

The first observation is that since, in the notation of \S\ref{sec: hyperbolic EDS}, $r=z_{xx}$, $s=z_{xy}$ and $t=z_{yy}$, the determinant $F_rF_t-\frac14 F_s^2$ is exactly $(A+Et)(C+Er)-(B-Es)^2$. Expanding and using the Monge-Amp\`ere equation itself, this determinant is equal to
\[AC-B^2-DE.\]
Thus, the sign of this quantity determines whether (\ref{eq 7.18 Ivey}) is hyperbolic, parabolic, or elliptic.

Let $\theta=\dd z-p\dd x-q\dd y$, the contact form on $\rmJ^1(\bbR^2,\bbR)$. Note that its Pfaff rank is $2$ because $\dd\theta$ consists of two monomials. On an integral surface of $\theta$ satisfying the independence condition $\dd x\wedge\dd y\neq 0$, we have $p=z_x$ and $q=z_y$. Then $z(x,y)$ satisfies (\ref{eq 7.18 Ivey}) iff the surface is also an integral of the $2$-form 
\[
    \Psi\coloneqq A\dd p\wedge \dd y+B(\dd q\wedge \dd y-\dd p\wedge \dd x)-C\dd q\wedge \dd x+D\dd x\wedge\dd y+E\dd p\wedge \dd q.\label{eq 7.19 Ivey}
\]
Therefore, the PDE (\ref{eq 7.18 Ivey}) is equivalent to the \gls{eds} 
\[\calI\coloneqq \<\theta,\Psi\>_{\mathrm{diff}} \text{ on }\rmJ^1(\bbR^2,\bbR).\]
This can be verified by using the relations $p=z_x,q=z_y$ enforced by $\theta=0$, and noting that $\dd p\wedge\dd y=z_{xx}\dd x\wedge \dd y$ and so on. Note that this is not the only possible choice of generators. For example, since $\dd\theta=-(\dd p\wedge\dd x+\dd q\wedge \dd y)$, the $B$-term in $\Psi$ may be replaced by $2B\dd q\wedge \dd y$ or by $-2B\dd p\wedge \dd x$. The prolongation of $\calI$ recovers the usual rank $3$ Pfaffian system on $\rmJ^2(\bbR^2,\bbR)$ described in \S\ref{sec: hyperbolic EDS}.

Thus, the following definition captures the essential features of the Monge-Amp\`ere system on $\rmJ^1(\bbR^2,\bbR)$.

\begin{defn}[Monge-Amp\`ere system]
    A \gls{ma} system on a $5$-dimensional manifold $M$ is an \gls{eds} generated differentially by a $1$-form $\theta$ of Pfaff rank $2$ and a $2$-form $\Psi$ that is linearly independent from $\dd\theta$ modulo $\theta$, i.e., $\Psi-\dd\theta\neq 0\pmod{\theta}$.
\end{defn}

\begin{rem}
    A quasi-linear third-order evolution equation for one function of two variables can also be encoded by an \gls{eds} on a manifold of lower dimension than $\rmJ^3(\bbR^2,\bbR)$.
\end{rem}

\begin{example}\label{ex 7.4.6 Ivey}
    \begin{enumerate}
        \item The Laplace equation $z_{xx}+z_{yy}=0$ is equivalent to the \gls{ma} system on $\rmJ^1(\bbR^2,\bbR)$ generated by $\theta$ and $\Psi=\dd p\wedge\dd y-\dd q\wedge \dd x$.
        \item The \gls{sge} $u_{xy}=\sin u\cos u$ is equivalent to the \gls{ma} system on $\rmJ^1(\bbR^2,\bbR)$ generated by $\theta$ and the decomposable $2$-form $\Psi=(\dd p-\sin u \cos u\dd y)\wedge\dd x$. (The usual version $u_{xy}=\sin u$ of the \gls{sge} is obtained by doubling $u$.) Note that $\Psi+\dd\theta$ is also decomposable.
    \end{enumerate}
\end{example}


It is no accident that these examples can be derived from \gls{ma} equations. In fact, any \gls{ma} system is locally equivalent to one generated by such an equation. The following proposition is an exercise.

\begin{prop}[{{\cite[Prop.~7.4.7]{Ivey}}}]
    Let $M^5$ carry a \gls{ma} system $\calI$. In a neighborhood of any point of $M$, there are local coordinates $x,y,z,p,q$ such that $\calI$ is generated by the form $\theta'=\dd z-p\dd x-q\dd y$ and a $2$-form of the form (\ref{eq 7.19 Ivey}) for some functions $A,B,C,D,E$.
\end{prop}

\begin{example}[Minimal and constant-$K$ surfaces]\label{ex minimal surface EDS}
    Using the coordinate expression (\ref{eq local formulas for K and H}) for the mean curvature of the graph of $z(x,y)$, we see that the \gls{ma} system corresponding to $H=0$ has 
    \[\Psi=(1+q^2)\dd p\wedge \dd y+pq(\dd p\wedge \dd x-\dd q\wedge \dd y)-(1+p^2)\dd q\wedge \dd x.\]
    Similarly, the PDE (\ref{eq 1.4 Ivey}) for graphs with Gauss curvature $K=1$ can be encoded by a \gls{ma} system with 
    \[\Psi=\dd p\wedge \dd q-(1+p^2+q^2)^2\dd x\wedge \dd y.\]
    These conditions on the curvatures $H,K$ of a surface are examples of Weingarten equations, and are naturally modeled by an \gls{eds} on the coframe bundle (see below.)
\end{example}

The characteristic systems for a \gls{ma} equation may be defined in a way similar to \S\ref{sec: hyperbolic EDS}. Namely, suppose $\calI$ is hyperbolic, i.e., there exist two decomposable $2$-forms in $\calI$ which are linearly independent modulo $\theta$, and such that $\calI=\<\theta,\omega_1\wedge\pi_1,\omega_2\wedge\pi_2\>_{\mathrm{alg}}$. Then their respective factors form the two characteristic systems 
\[\calM_i=\<\theta,\omega_i,\pi_i\>.\]
As explained in  \S\ref{sec: hyperbolic EDS}, these pull back to lie in the characteristic system of the prolongation.

\begin{prop}[{{\cite[7.4.11]{Ivey}}}]
    If a hyperbolic \gls{ma} system $(M,\calI)$ is Darboux-integrable, then it is locally equivalent to the system defined by the wave equation $z_{xy}=0$.
\end{prop}
\begin{proof}
    Following the argument in \S\ref{sec: hyperbolic EDS}, around every point in $M$ there is a local coframe $\theta,\omega_1,\omega_2,\pi_1,\pi_2$ such that $\theta\in\calI^1$, $\calM_1^{(1)}=\<\omega_1,\pi_1\>$, $\calM_2^{(1)}=\<\omega_2,\pi_2\>$, and 
    \[\dd\theta\equiv \omega_1\wedge\pi_1 +\omega_2\wedge\pi_2 \pmod{\theta}.\]
    Since $\calI$ is an ideal, there are $1$-forms $\beta_0,\beta_1,\beta_2$ satisfying the structure equations 
    \begin{align}
        \dd\theta&=-\beta_0\wedge\theta +\omega_1\wedge\pi_1+\omega_2\wedge\pi_2,\\
        \dd(\omega_1\wedge\pi_1)&=-\beta_1\wedge\omega_1\wedge\pi_1,\\
        \dd(\omega_2\wedge\pi_2)&=-\beta_2\wedge \omega_2\wedge\pi_2.
    \end{align}
    Note that $\beta_0$ is uniquely determined modulo $\theta$, whereas $\beta_1$ is determined modulo $\omega_1$ and $\pi_1$, and similarly for $\beta_2$. Thus, we can assume that $\beta_i$ contains no $\omega_i,\pi_i$ components for $i=1,2$. By differentiating the first structure equation, we get 
    \[(\beta_0-\beta_1)\wedge\omega_1\wedge\pi_1+(\beta_0-\beta_2)\wedge\omega_2\wedge\pi_2=\dd\beta_0\wedge\theta.\label{3913}\]
    By taking this equation modulo various elements of the coframe, we find that $\beta_0\equiv \beta_1\pmod{\theta,\omega_1,\pi_1}$ and $\beta_0\equiv \beta_2\pmod{\theta,\omega_2,\pi_2}$. Adjusting $\beta_i$, $i=1,2$, so that its $\omega_i,\pi_i$ components match those of $\beta_0$, and adjusting $\beta_0$ by adding some multiple of $\theta$,
    we can assume that 
    \[\beta_0-\beta_1=a\theta,\quad \beta_0-\beta_2=-a\theta\] 
    for some function $a$. Equation~\ref{3913} now implies 
    \[\dd\beta_0=a(\omega_1\wedge\pi_1-\omega_2\wedge\pi_2).\]
    Now observe that $\beta_1=\beta_0-a\theta$ implies that
    \[\dd \beta_1\equiv \dd\beta_0-a\dd \theta=-2a\omega_2\wedge\pi_2\pmod{\theta},\]
    and on the other hand, the derivative of the second structure equation gives 
    \[0=\dd\beta_1\wedge\omega_1\wedge\pi_1.\]
    The only way both of these equalities can hold is if $a=0$ identically, and so 
    \[\beta_0=\beta_1=\beta_2,\quad \dd\beta_0=0.\]
    By Poincar\'e Lemma, on a possibly smaller neighborhood, there exist functions $\lambda,p,q,x,y,z$ such that 
    \begin{align}
        \beta_0&=\dd \lambda, \quad&
        \rme^{\lambda}\omega_1\wedge\pi_1&=\dd x\wedge \dd p,\\
        \rme^\lambda\omega\wedge\pi_2&=\dd y\wedge \dd q, \quad&
        \rme^\lambda\theta&=\dd z-p\dd x-q\dd y.
    \end{align}
    Then $\<e^\lambda\theta,\dd x\wedge\dd p,\dd y\wedge \dd q\>_{\mathrm{diff}}$ is exactly the standard \gls{eds} for the wave equation, because the vanishing of $\dd x\wedge\dd p$ or $\dd y\wedge \dd q$ along $p=z_x,q=z_y$ (which is enforced by $e^\lambda\theta=0$) is equivalent to $z_{xy}=0$.
\end{proof}








\section{Linear Weingarten surfaces}

We now examine a geometrically natural class of surfaces, called \emph{linear Weingarten surfaces}, which are locally equivalent to solutions of a \gls{ma} equation. Recall from Example~\ref{ex Weingarten surfaces} that a linear Weingarten surface is one whose mean and Gauss curvatures $H,K$ satisfy a linear relation $AK+2BH+C=0$. More generally, a \emph{Weingarten surface} is one with $F(H,K)=0$ for some function $F$.

Suppose $\Sigma <\bbE^3$ is a smooth surface satisfying a linear Weingarten equation, and $\frake:\Sigma\to \SE_3$ is a first-order adapted framing along $\Sigma$. Then the framing gives an integral surface for the $1$-form $\theta^3$ on $\SE_3$ and for the $2$-form 
\[\Psi\coloneqq A\omega_1^3 \wedge\omega_2^3+B(\omega_1^3\wedge\theta^2-\omega_2^3\wedge\theta^1)+C\theta^1\wedge\theta^2.\]
This can be seen by verifying that $\frake^\ast \Psi=0$ via (\ref{def h}):
\[\frake^\ast\Psi=(A\det \sfh+B\tr \sfh+C)\theta^1\wedge\theta^2=(AK+2BH+C)\theta^1\wedge\theta^2=0.\]
Thus, the Weingarten equation is equivalent to the \gls{eds} $\calI=\<\theta^3,\Psi,\Theta\>$ on $\SE_3$, where 
\[\Theta\coloneqq -\dd\theta^3=\omega_1^3\wedge\theta^1+\omega_2^3\wedge\theta^2.\]
The \gls{eds} described in Example~\ref{ex Weingarten surfaces}, which encodes the same Weingarten equation, is the prolongation of $\calI$. Note that this system is hyperbolic, elliptic, or parabolic according to the sign of $B^2-AC$.

As in Example~\ref{ex 7.1.10 Ivey}, the retracting space for $\calI$ is spanned by $\{\theta^1,\theta^2,\theta^3,\omega_3^1,\omega_3^2\}$, and the Cauchy characteristic curves are the fibers of the submersion from $\SE_3$ onto the $5$-dimensional unit sphere bundle $E\coloneqq \bbS(\T\bbE^3)$: the projection takes a frame $(e_1,e_2,e_3)$ and returns $e_3$, and the Cauchy vector field generates rotations of the frames about $e_3$.

Thus, $E$ is the leaf space of the Cauchy characteristics of $\calI$, and so there is a reduced \gls{eds} $\wt\calI$ on $E$ that pulls back to $\calI$ and is of \gls{ma} type. In fact, the Maurer-Cartan equation on $\SE_3$ implies that $\theta^3$, $\dd\theta^3$, and all three terms of $\Psi$ are pullbacks of well-defined forms on $E$.

\begin{example}[Parallel surfaces]\label{xca 7.4.15 Ivey}
    A point in $E$ is determined by the basepoint $\bf{x}\in\bbE^3$ and the unit vector $e_3$. Consider the map $F_r:E\to E$ defined by $(\bf{x},e_3)\mapsto (\bf{x}+re_3,e_3)$.

    First we use the fact that $\theta^i=\<e_i,\dd \bf{x}\>$ to compute 
    \[F_r^\ast\theta^3=\<e_3,\dd \bf{x}\>+r\<e_3,\dd e_3\>=\<e_3,\dd\bf{x}\>=\theta^3.\]
    What's important here is that $F_r^\ast\theta^3$ is a multiple of $\theta^3$, so $F_r$ is a \emph{contact transformation} and preserves the set of adapted (\emph{contact}) framings of surfaces. Similarly, we can use $\omega^i_j=\<e_i,\dd e_j\>$ to verify that the $\omega^i_j$ are invariant under $F_r$. Finally, we have 
    \[F_r^\ast\theta^1=\<e_1,\dd\bf{x}+r\dd e_3\>=\theta^1-r\omega^3_1,\quad F_r^\ast\theta^2=\<e_1,\dd\bf{x}+r\dd e_3\>=\theta^2-r\omega^3_2.\]

    Now, let $M< E$ be an integral surface of $\theta^3$ and of $\Psi=\omega_1^3\wedge\omega_2^3-r^{-2}\theta^1\wedge\theta^2$ with the independence condition $\theta^1\wedge\theta^2\neq 0$. Then, according to our \gls{ma} system for linear Weingarten surfaces, $M$ is a lifting of a surface of constant positive Gauss curvature $K=r^{-2}$ in $\bbE^3$.

    Now we consider the translated surface $F_{\pm r}(M)$ and the pullback of the above \gls{eds} to it. $\theta^3$ and $\Theta$ remain unchanged, and we easily compute 
    \[F_{\pm r}^\ast \Psi=\pm r^{-1}(\omega^3_1\wedge\theta^1-\omega^3_2\wedge\theta^2)-r^{-2}\theta^1\wedge\theta^2.\]
    Thus, $F_{\pm r}(M)$ is an integral surface of the \gls{eds} $ \<\theta^3,F_{\pm r}^\ast\Psi,\Theta\>$, which is a Weingarten system for a surface of constant mean curvature $H=\pm 1/(2r)$. Since the distance between parallel tangent planes of $M$ and $F_{\pm r}(M)$ is constant and equal to $r$, such surfaces are called \emph{parallel}, and in this special case we have established that each surface of constant positive $K$ corresponds to two surfaces of constant $H$ of either sign. This theorem was first obtained by Bonnet.
\end{example}


From the above example it follows that solutions of the PDE (\ref{eq 1.4 Ivey}) for surfaces of constant positive Gauss curvature may be obtained by a contact transformation from solutions of the \gls{ma} system for \gls{cmc} surfaces. Moreover, we will see below that any \gls{cmc} surface admits a family of noncongruent isometric deformations, so similar deformations become available for surfaces of constant positive Gauss curvature.








\section{Pseudospherical surfaces}\label{sec: pseudospherical surfaces}

In this section we apply the methods of hyperbolic \gls{eds} to study a special class of surfaces related to the \gls{sge}. But first we need to briefly discuss curves on surfaces.

Let $\gamma(s)$ be a regular curve in $\bbE^3$ parametrized by arclength. Recall that we can adapt the frames so that the Frenet-Serret equations for the Frenet frame, which we will now denote by $(\bf{T},\bf{N},\bf{B})$ (for tangent, normal, and binormal) take the form
\[\dd(\gamma,\bf{T},\bf{N},\bf{B})=(\gamma,\bf{T},\bf{N},\bf{B})\begin{pmatrix}
    0 & 0&0&0\\
    1&0&-\kappa &0\\
    0& \kappa &0 &-\tau \\
    0 & 0& \tau & 0
\end{pmatrix}\dd s,\]
where $\kappa$ is the curvature of $\gamma$ and $\tau$ is the torsion. Now say that $\gamma$ lies on a surface $\Sigma <\bbE^3$. Let $(e_1,e_2,e_3)$ be a first-order adapted framing of $\Sigma$ (so $e_3\perp \T\Sigma$). Let $\varphi$ denote the angle from $e_1$ to $\bf{T}$, and let $\bf{\epsilon}$ be $\bf{T}$ rotated clockwise by $\pi/2$ in the plane $\T_m\Sigma$, so that 
\[\begin{pmatrix}
    \bf{T}\\\bf{\epsilon}
\end{pmatrix}=\begin{pmatrix}
    \cos\varphi & \sin\varphi\\
    -\sin\varphi & \cos\varphi
\end{pmatrix}\begin{pmatrix}
    e_1\\ e_2
\end{pmatrix}.\]
Then the $\{e_3,\bf{\epsilon}\}$-plane is orthogonal to $\bf{T}$. The angle between $\bf{N}$ and $e_3$ is traditionally denoted by $\varpi$ (``var-pi''), so that 
\[\begin{pmatrix}
    \bf{N}\\\bf{B}
\end{pmatrix}=\begin{pmatrix}
    \cos\varpi & \sin\varpi\\
    -\sin\varpi & \cos\varpi
\end{pmatrix}\begin{pmatrix}
    e_3\\ \bf{\epsilon}
\end{pmatrix}.\]
Since $(\bf{T},\bf{\epsilon},e_3)$ gives an orthonormal frame of $\bbE^3$, when we restrict this frame to $\gamma$ we have 
\[\dd (\gamma,\bf{T},\bf{\epsilon},e_3)=(\gamma,\bf{T},\bf{\epsilon},e_3)\begin{pmatrix}
    0&0&0&0\\
    1&0&-\kappa_{\mathrm{g}} &-\kappa_{\mathrm{n}}\\
    0&\kappa_{\mathrm{g}}&0&-\tau_{\mathrm{g}}\\
    0&\kappa_{\mathrm{n}}&\tau_{\mathrm{g}}&0
\end{pmatrix}\dd s\]
for some functions $\kappa_{\mathrm{g}}(s),\kappa_{\mathrm{n}}(s),\tau_{\mathrm{g}}(s)$. To interpret these functions, notice that 
\begin{align}
    \kappa_{\mathrm{g}}&=\kappa\sin\varpi=\<\kappa \bf{N},\bf{\epsilon}\>;\\
    \kappa_{\mathrm{n}}&=\kappa\cos\varpi=\<\kappa \bf{N},e_3\>.\\
\end{align}

\begin{rem}[Covariant derivative and geodesic curvature]\label{rem covariant derivative on surfaces}
    Let $\eta^1,\eta^2\in\Omega^1(\Sigma)$ be a local coframe for $\T^\ast M$ dual to $(e_1,e_2)$. Write $\eta^1_2$ for the form $\alpha$ from the proof of Theorema Egregium in \S\ref{sec: principal framings}, and for convenience $\eta^2_1\coloneqq -\eta^1_2$.

    For $X\in \T_m \Sigma$ and $Y\in\fX(\Sigma)$, write $Y=Y^ie_i$ for some component functions $X^1,X^2$. Define the tangent vector 
    \[\nabla_X Y\coloneqq (\dd Y^1-Y^2\eta^1_2)(X)e_1+(\dd Y^2-Y^1\eta^2_1)(X)e_2.\]
    From the transformation rules for components of vector fields, it is easy to see that this expression is independent of the choice of the orthonormal frames, so $\nabla_X Y$ is well-defined as a tangent vector. The operator $\nabla:\fX(\Sigma)\times \fX(\Sigma)\to \fX(\Sigma)$ given by $(X,Y)\to \nabla_X Y$ is called the \emph{covariant derivative}.\index{Covariant derivative}

    For now, the most important property of $\nabla$ for us is that $Y$ doesn't necessarily have to be defined on an open set of $\Sigma$. Given a smooth curve $\gamma$ on $\Sigma$, we can extend its velocity $\dot \gamma$ to a vector field $Y\in\fX(\Sigma)$ such that $Y\circ\gamma=\dot\gamma$. Then we can consider the object $(\nabla_{\dot\gamma}\dot\gamma)(s)\coloneqq (\nabla_{\dot\gamma}Y)\circ\gamma(s)$ and verify that this is actually independent of the specific choice of the extension $Y$ (indeed, only the components of $\dd Y^i$ along $\dot\gamma$ contribute to the result, and these are simply derivatives of $Y$ along $\gamma$, which don't depend on the extension). 
    
    Curves such that $\nabla_{\dot\gamma}\dot\gamma=0$ are called \emph{geodesics}.\index{Geodesic} The quantity $\kappa_{\mathrm{g}}$, in fact, satisfies 
    \[\kappa_{\mathrm{g}}=\lVert\nabla_{\dot\gamma}\dot\gamma\rVert,\]
    which is why this quantity is called the \emph{geodesic curvature}. \index{Geodesic curvature}
\end{rem}

Note that if $\kappa_{\mathrm{g}}\equiv 0$, then all of the curvature of the curve lies in the normal direction to the surface, and $\bf{\epsilon}\parallel \bf{B}$. Next, the Frenet-Serret equations show that $\kappa_{\mathrm{n}}$ measures the curving of the surface in the direction of $\bf{T}$ (by measuring how the surface normal $e_3$ is turning); it is called the \emph{normal curvature}\index{Normal curvature} of $\Sigma$ along $\gamma$. Since it depends on the pointwise value of $\bf{T}$, it is really an invariant of the surface, independent of the parametrization of $\gamma$. We say $\gamma$ is an \emph{asymptotic line}\index{Asymptotic line} on $\Sigma$ if $\kappa_{\mathrm{n}}\equiv 0$.

Finally, $\tau_{\mathrm{g}}$ measures what the torsion (as a curve in $\bbE^3$) of a geodesic having tangent vector $\bf{T}$ would be; it is called the \emph{geodesic torsion}\index{Geodesic torsion} of $\gamma$. Using the definition of the Second Fundamental Form $\rmII$, it is not hard to see that 
\[\kappa_{\mathrm{n}}=-\<\rmII(\bf{T},\bf{T}),e_3\>,\quad \tau_{\mathrm{g}}=\<\rmII(\bf{\epsilon},\bf{T}),e_3\>,\quad \kappa_{\mathrm{g}}=-(\dd \varphi+\omega^2_1)(\bf{T}).\]

\begin{xca}
    \begin{enumerate}
        \item Show that $\kappa_{\mathrm{g}}\equiv 0$ iff the \emph{osculating plane}\index{Osculating plane} to $\gamma$ spanned by $(\bf{T},\bf{N})$ is perpendicular to $\Sigma$ at each point.
        \item Show that $\kappa_{\mathrm{n}}=0$ (i.e., $\dot\gamma$ is an asymptotic direction) iff the tangent plane $\T_{\gamma}\Sigma$ is an osculating plane of the curve.
        \item Show that $\nabla_{\dot\gamma}\dot\gamma=\kappa_{\mathrm{g}}\bf{\epsilon}$.
        \item Find formulas for $\kappa_{\mathrm{n}},\tau_{\mathrm{g}}$ in terms of the principal curvatures $k_1,k_2$ when our surface is given a principal (Darboux) framing.
        \item Find formulas for $\kappa_{\mathrm{n}},\tau_{\mathrm{g}}$ when our surface is given a framing such that $e_1=\bf{T}$.
        \item Calculate $\tau_{\mathrm{g}}$ of a curve $\gamma$ such that $\dot\gamma$ is a principal direction (i.e., a direction where $\kappa_{\mathrm{n}}$ is a principal curvature) at each point along $\gamma$. Such curves are called \emph{lines of curvature}.\index{Lines of curvature}
    \end{enumerate}
\end{xca}

\begin{figure}[tp]
    \centering
    \includegraphics[scale=1]{figures/geodesic.pdf}
    \caption{Geodesic and normal curvatures of a curve on a surface.}
    \label{fig:geodesic curvature}
\end{figure}

A \emph{pseudospherical surface}\index{Pseudospherical surface} is a surface with Gauss curvature $K\equiv -1$. Setting $A=C=-1$ and $B=0$ in the \gls{eds} $\calI$ described in the last \sect. This system is hyperbolic since $B^2-AC=-1<0$, and indeed, the $2$-forms of $\calI$ are spanned by two decomposable forms 
\[\Psi\pm \Theta=(\omega_1^3\mp \theta^2)\wedge(\omega_2^3\pm \theta^1).\]
Moreover, we may use the factors of the decomposable forms to express the second fundamental form as 
\[\rmII =\left[\frac12(\omega_1^3+\theta^2)\odot (\omega_2^3+\theta^1)-\frac12(\omega_1^3-\theta^2)\odot(\omega_2^3-\theta^1)\right]\otimes e_3,\]
where $\odot$ is the symmetric tensor product (cf.\ Definitions~\ref{def sym operator} and \ref{def exterior and sym product}). 
This shows that each characteristic curve projects to be an asymptotic line on $\Sigma$.

On an open subset of a pseudospherical surface that is free of umbilic points, we may choose a Darboux framing. This breaks the Cauchy characteristic symmetry of the \gls{eds}, but allows us to see how pseudospherical surfaces are connected to solutions of \gls{sge} (see Examples~\ref{ex sine-gordon} and \ref{ex 7.4.6 Ivey}).

Since we are using Darboux frames,
\[\begin{pmatrix}
    \omega^3_1\\\omega^3_2
\end{pmatrix}=\begin{pmatrix}
    \tan u & 0\\
    0 & -\cot u
\end{pmatrix}\begin{pmatrix}
    \theta^1\\\theta^2
\end{pmatrix},\]
where $u\in (0,\pi/2)$ is half of the angle between the asymptotic lines. We adjoin $u$ as a new variable, and enlarge our \gls{eds} to a Pfaffian system 
\[I=\<\theta^3,\omega^3_1-(\tan u)\theta^1,\omega^3_2+(\cot u)\theta^2\>\]
on $\SE_3\times \bbR$. Then a Darboux framing along a pseudospherical surface corresponds to an integral surface of $\calI=\<I\>_{\mathrm{diff}}$ satisfying the independence condition $\theta^1\wedge\theta^2\neq 0$, and vice versa.

The vanishing of the exterior derivatives modulo $I$ of the last two $1$-forms generating $I$ implies that $\theta^1/\cos u$ and $\theta^2/\sin u$ pull back to be closed $1$-forms on any integral surface. Hence, there exist local coordinates $(t_1,t_2)$ such that 
\[\theta^1=\cos u\dd t_1,\quad \theta^2=\sin u\dd t_2.\]
Moreover, 
\[x\coloneqq (t_1+ t_2)/2,\quad y\coloneqq (t_1-t_2)/2,\] are exactly the arclength parameters along the asymptotic lines. This implies that asymptotic lines form what is called a \emph{Chebyshev net} on the surface: parallel transport of one of the two families of curves along the other preserves it. In other words, opposite edges of the net quadrilaterals have the same length. Thus you can stretch a flexible ``knitted'' square mesh over this surface. Note also that the asymptotic lines are bisected by the lines of curvature.

Substituting $\dd u=u_x\dd x+u_y\dd y$ into the $2$-forms of the \gls{eds} shows that $\omega_2^1=u_x\dd x-u_y\dd y$ along any integral surface. Then it is easy to see that the structure equation $\dd\omega^1_2=\omega^3_1\wedge\omega^3_2$ (i.e., the Gauss equation) implies that $u$ (or rather $2u$) satisfies \gls{sge}:
\[u_{xy}=\sin u\cos u.\]

Conversely, we may start with a solution of the \gls{sge} and produce a pseudospherical surface by integration. On a fundamental level, note that the First and Second Fundamental Forms of a pseudospherical surface in the asymptotic coordinates $(x,y)$ read 
\[
    \rmI=\begin{pmatrix}
        1 &\cos 2u\\
        \cos 2u & 1
    \end{pmatrix},\quad
    \rmII=\begin{pmatrix}
        0 & \sin 2u\\
        \sin 2u & 0
    \end{pmatrix},
\]
and $2u$ is the angle between the $x$ and $y$-curves. From here it is easy to see that $H=-2\cot(2u)$. \gls{sge} is equivalent to the Gauss-Kodazzi equations on $H$ with $K=-1$, so by the Fundamental Theorem of Surfaces, each solution of \gls{sge} determines a unique immersed surface up to a rigid motion. 

\begin{figure}[tp]
    \centering
    \includegraphics[scale=0.2]{figures/SG1soliton.png}
    \caption{The $1$-soliton solution (\ref{eq SGE 1-soliton}) (with lines of constant $y$) of \gls{sge} and the corresponding pseudospherical surfaces for different values of $\lambda^2$. The first three surfaces have the lines of curvature marked on them. The rightmost is the pseudosphere $\lambda=1$ with the asymptotic lines marked on it. Note the asymptotic lines becoming tangent at the edge of the surface.}
    \label{fig: SGE 1-soliton}
\end{figure}

More explicitly, if we let $\frake=(e_1,e_2,e_3)$, then the structure equations $\dd e_i=e_j\omega_i^j$ imply that 
\[\partial_x\frake=\frake \begin{pmatrix}
    0 & u_x & -\sin u\\
    -u_x & 0 & -\cos u\\
    \sin u& \cos u & 0
\end{pmatrix},\quad 
\partial_y\frake=\frake \begin{pmatrix}
    0 & -u_y & -\sin u\\
    u_y & 0 & \cos u\\
    \sin u& -\cos u & 0
\end{pmatrix}.\label{eq 7.21 Ivey}
\]
This is an overdetermined system for the matrix $\frake(x,y)$, and its Frobenius integrability condition is \gls{sge} for $u$. In fact, the above pair of equations is a $UV$-pair for \gls{sge} (see Example~\ref{ex UV pairs}; in fact, this $UV$-pair is equivalent to the one in Example~\ref{ex sine-gordon} under the isomorphism of Lie algebras $\frakso_3\cong\fraksu_2$). So, given a solution to sine-Gordon, we may obtain the framing $\frake$ by solving linear systems of ODE's, and then solve for the surface $\bf{x}(x,y)\in\bbR^3$ by integrating 
\[\bf{x}_x=e_1\cos u-e_2\sin u,\quad \bf{x}_y=e_1\cos u+e_2\sin u.\label{eq 7.22 Ivey}\]
For example, the famous \emph{1-soliton}\index{soliton} solution (also called a \emph{traveling wave} due to its translational invariance, or in the context of the sine-Gordon, a \emph{kink})
\[u=2\arctan(c\exp(\lambda x+\lambda^{-1}y)),\quad c\neq 0, \lambda\neq 0,\label{eq SGE 1-soliton}\]
gives the standard \emph{pseudosphere} when $\lambda^2=1$ and \emph{Dini's surfaces} when $\lambda^2\neq 1$, see Figure~\ref{fig: SGE 1-soliton}.\index{Pseudosphere}\index{Dini's surface} (Note that $c$ can be assumed to be $1$ after a shift and/or flip of one of the axes.)

\begin{figure}[tp]
    \centering 
    \includegraphics[scale=0.8]{figures/poincare.png}
    \caption{Poincar\'e's hyperbolic half-plane and disk models with some of their geodesics.}
    \label{fig:hyperbolic plane}
\end{figure}

\begin{example}[Hyperbolic plane and disk]\index{Hyperbolic half-plane}\index{Hyperbolic disk}
    The \emph{hyperbolic (half-)plane} is the set $\bbC^+=\{z=x+\i y\in\bbC\mid \Im z>0\}$ with the Riemannian metric 
    \[\sfg=\frac{|\dd z|^2}{(\Im z)^2}=\frac{\dd x^{\otimes 2}+\dd y^{\otimes 2}}{y^2}.\]
    This metric is conformal to the Euclidean one with the conformal factor of $\lambda^2=\frac{1}{y^2}$. The Gauss curvature is found from formula (\ref{eq K in isothermal coords}): $K=\frac12y^2\partial_y^2\ln y=-1$. The geodesics of this surface are semi-circles perpendicular to the $x$-axis and vertical lines.
    
    Another hyperbolic surface of constant negative curvature is the \emph{hyperbolic disk}  $\bbD\coloneqq \{z=x+\i y\in\bbC \mid |z|<1\}$ with the metric 
    \[\sfg=\frac{4|\dd z|^2}{(1-|z|^2)^2}=\frac{4(\dd x^{\otimes 2}+\dd y^{\otimes 2})}{(1-x^2-y^2)^2}.\]
    It is easy to check that $K=-1$ again, and in fact the disk model is isometric to the half-plane one with the isometry given by the biholomorphic \emph{Cayley transform}\index{Cayley transform} 
    \[\bbC^+\to \bbD,\quad z\mapsto \frac{z-\i }{z+\i}.\]
    As a \gls{flt}, it takes circles and lines to circles and lines. As a consequence, the geodesics of the disk model are diametric lines and arcs of circles perpendicular to the bounding circle, see Figure~\ref{fig:hyperbolic plane}.
\end{example}


A Riemannian surface $(\Sigma,\sfg)$ is called \emph{(geodesically) complete} if every geodesic $\gamma(t)$ on it can be extended to all $t\in\bbR$. Equivalently, all vector fields of bounded norm are complete. The following theorem of Hilbert states that pseudospherical surfaces in Euclidean space cannot be complete. This was one of the earliest \emph{global} results in differential geometry. 

\begin{thm}[Hilbert (1901)]\index{Theorem!Hilbert}
    There is no complete immersed surface of constant negative Gauss curvature in $\bbE^3$.
\end{thm}
\begin{proof}
    Hilbert's original proof is a bit lengthy because first one has to establish that the asymptotic lines of any \emph{complete} immersed surface of constant negative curvature can be extended endlessly. Detailed expositions of this proof can be found in \cite[\S5-11]{doCarmo} and \cite[p.~251]{Spivak3}.  We will instead take an advanced shortcut by using the Uniformization Theorem (widely believed to be true since 1882 but first proved by Poincar\'e only in 1907).

    The Uniformization Theorem (in one of its formulations) states that the universal covering of any complete surface $\Sigma$ of constant negative curvature, say $K\equiv -1$, together with the pullback of the metric from $\Sigma$, is isometric to the hyperbolic plane $\bbC^+$.\footnote{This also shows that any non-compact simply connected surface (without boundary) is diffeomorphic to $\bbR^2$.} Now, if we prove that $\bbC^+$ cannot be isometrically immersed into $\bbE^3$, Hilbert's theorem will follow because the universal covering map $\pi:\bbC^+\to \Sigma$ is a local isometry, and so any isometric immersion  $\bf{x}:\Sigma\to \bbE^3$ would allow us to define an isometric immersion $\bf{x}\circ \pi:\bbC^+\to \bbE^3$ (note that we never required the immersions to be injective), leading to a contradiction.

    Now let $2u$ be the solution of \gls{sge} $(2u)_{xy}=\sin 2u$ correspoding to $\bf{x}(\bbC^+)$. Here $(x,y)$ are the asymptotic coordinates on $\bf{x}(\bbC^+)$, not to be confused with the Cartesian coordinates on $\bbC^+$. Since $\bf{x}$ is an immersion, this surface must have linearly independent asymptotic directions at each point, and hence 
    \[0<u(x,y)<\frac{\pi}{2},\quad (x,y)\in \bbC^+.\]
    Now consider a rectangle $R=[a,b]\times [c,d]\subset\bbC^+$ and compute the area of the quadrilateral $\bf{x}(R)$:
    \begin{multline}
        \mathsf{vol}\left[\restr{\bf{x}}{R}\right]=\int_R \sqrt{\det \sfg}\dd x\dd y=\int_R \sin 2 u\dd x\dd y=\int_R (2u)_{xy}\dd x\dd y=\\
        =2(u(b,d)-u(b,c)-u(a,d)+u(a,c))<2\pi.
    \end{multline}
    Since $\bbC^+$ is simply connected and $\bf{x}$ is an immersion, its asymptotic coordinates are globally defined (by stitching together local pieces if necessary), so the rectangle $R$ can be made arbitrarily large. Since the area of the hyperbolic half-plane is infinite, the area of $R$ can become arbitrarily large. This contradicts the above result showing that $\bf{x}(R)$ has bounded area, since $\bf{x}$ is supposed to be an isometry.
\end{proof}


Hence, even if the sine-Gordon solution is defined for all $x$ and $y$, the corresponding surface will become singular. In fact, $\theta^1\wedge\theta^2=\sin 2u \dd x\wedge \dd y$ shows that the surface will be singular whenever $u$ is a multiple of $\pi/2$, i.e., when the asymptotic lines are tangent to each other. This is why the surfaces in Figure~\ref{fig: SGE 1-soliton} have singularities and are made by joining two pseudospherical surfaces along an edge: the values of the $1$-soliton solution always span $(0,\pi)$.

\begin{rem}
    The sine-Gordon has an obvious scaling symmetry given by $x\mapsto \lambda x$, $y\mapsto \lambda^{-1}y$. Hence, each immersion of $\Sigma$ belongs to a one-parameter family of isometric immersions. These deformations of pseudospherical surfaces are called \emph{Lie transformations}. In the next \sect\ we will find a similar one-parameter family of deformations of minimal surfaces (but parametrized by an element of $\U_1$ instead of $\bbR$ because the coresponding system is elliptic).
\end{rem}

\begin{xca}\label{xca 7.4.19 Ivey}
    Note that each of $x+y$ and $x-y$ is constant along one of the two sets of lines of curvature. 
    This observation is useful if we suppose that $\Sigma$ is a pseudospherical surface of revolution (i.e., is spanned by a curve when rotated about a fixed axis). Show that the corresponding sine-Gordon solution can be assumed to be of the form $u=f(x+y)$ (this is easier using the ansatz $u=2\arctan f(x+y)$). Determine all sine-Gordon solutions of this form. 
\end{xca}







\section{Minimal and \texorpdfstring{\gls{cmc}}{CMC} surfaces}

Recall that a minimal surface is an immersed surface $\Sigma<\bbE^3$ with vanishing mean curvature. From Proposition~\ref{prop mean curvature laplace}, an isometric immersion $\bf{x}:\Sigma\to \bbE^3$ is minimal iff it is \emph{harmonic in isothermal coordinates} $(x,y)$:
\[(\partial_x^2+\partial_y^2)\bf{x}=0.\]
In particular, $\bf{x}$ is \emph{conformal}, i.e., it preserves angles between tangent vectors in the $(x,y)$-plane after they're mapped to tangent vectors on $\Sigma$.

Introducing a local isothermal complex coordinate $z\coloneqq x+\i y$ (so that the metric volume form is $\sfv_\sfg=\lambda^2\dd x\wedge\dd y=\lambda^2\frac{\i}{2}\dd z\wedge\dd\wb{z}$), this suggests that there exist $3$ (locally) holomorphic functions of $z$ whose real parts are exactly the Cartesian components of $\bf{x}$. We seek to find this representation now.

Setting $A=C=0$ and $B=1$ in the \gls{eds} for a general linear Weingarten equation shows that the $2$-forms of $\calI$ are spanned 
\[\Theta=-\dd\theta^3,\quad \Psi=\omega^3_2\wedge\theta^1-\omega^3_1\wedge\theta^2.\]
This system is elliptic since $B^2-AC=1>0$, so we will have to adjust our method of characteristics to solve it. We will see below that studying the characteristic systems of $\calI$ leads to the classical \emph{Weierstrass representation} for minimal surfaces, which relates them to complex Riemann surfaces.

When we attempt to form the characteristic systems, we find that the decomposability equation 
\[(\Theta+\lambda\Psi)^{\wedge 2}=0\]
has constant roots $\lambda=\pm\i$. So, we need to introduce complex-valued differential forms. For example,
\[\Theta\pm \i \Psi=(\omega^3_1\mp \i \omega^3_2)\wedge(\theta^1\pm\i \theta^2),\]
and so if we define 
\[\omega\coloneqq \omega^3_1-\i \omega^3_2,\quad \theta\coloneqq \theta^1+\i \theta^2,\]
then the characteristic systems are 
\[\calM=\<\theta^3,\omega,\theta\>,\quad \wb\calM=\<\theta^3,\wb\omega,\wb\theta\>.\]

When we attempt to apply Darboux's method, we find that neither of these systems contains a rank-$2$ integrable subsystem. In fact, $\dd\omega\equiv 0\pmod{\omega}$, but $\dd\theta\equiv \wb\omega\wedge\theta^3\pmod{\theta}$. However, this shows that the distribution
\[\Re\<\omega,\wb\omega\>=\<\omega^3_1,\omega^3_2\>\eqqcolon J\]
is a Frobenius system on $\SE_3$. The quotient of $\SE_3$ by the leaves of the distribution dual to $J$ is a $2$-sphere, and the quotient map $\gamma:\SE_3\to \bbS^2$ is given by the unit vector $e_3$. Thus, the restriction of $\gamma$ to an integral surface $M$ of $\calI$ is just the Gauss map of the minimal surface $\Sigma=\pi(M)$, where $\pi:\SE_3\to \bbE^3$ is the bundle projection.

Since $\omega$ descends, via $\gamma$, to a well-defined (up to multiple) form on $\bbS^2$, we can define a complex structure on the sphere for which $\omega$ spans the \emph{$(1,0)$-forms}, i.e., the subbundle of $\T^\ast \bbS^2$ locally spanned by $\dd w$ for a local complex coordinate $w$. We have shown the following fundamental fact.

\begin{cor}
    The Gauss map of a minimal surface $\Sigma$ is holomorphic w.r.t.\ the complex structure on $\Sigma$ defined by $\theta=\theta^1+\i \theta^2$ (as a $(1,0)$-form).
\end{cor}

Now let us fix a standard complex coordinate on $\bbS^2$. We identify $\bbS^2$ with the null quadric $N\subset \CP^2$ defined by $z_1^2+z_2^2+z_3^2=0$ on $\bbC^3$, by mapping $e_3$ to the vector 
\[\mathsf{z}\coloneqq e_1-\i e_2 \quad \in\bbC^3\cong \bbR^3\otimes\bbC.\]
In fact, this vector can be determined from $e_3$ in a unique way, up to a scale, by the requirement that $e_3\times \mathsf{z}=\i \mathsf{z}$. Note that the equation defining $N$ implies that $\lVert\Re \mathsf{z}\rVert^2=\lVert\Im \mathsf{z}\rVert^2=\frac12\lVert \mathsf{z}\rVert^2$.

We then use the stereographic projection 
\[\mathsf{z}=\begin{pmatrix}
    1-w^2\\ \i(1+w^2)\\ 2w
\end{pmatrix},\quad w\in\bbC,\]
to define a complex local coordinate $w$ on $N$ (this actually agrees with the standard stereographic projection $\bbC\to \CP^1\setminus\{\infty\}$ given by $w\mapsto \frac{1}{1+|w|^2}(2w,1-|w|^2)=(x^1+\i x^2,x^3)$, so the resulting complex structure induced by $\omega$ on $\bbS^2$ is the standard one). Computing $\dd\mathsf{z}$ and comparing with $\dd(e_1-\i e_2)=\i(e_1-\i e_2)\omega^1_2+e_3\omega$ shows that $\gamma^\ast\dd w$ is a multiple of $\omega$.

Now suppose $z$ is a complex coordinate on our minimal surface $\Sigma$. Then $\theta=f(z)\dd z$ for a nonvanishing holomorphic function $f$, and $\gamma^\ast w=g(z)$ for some holomorphic function $g$ (we can think of $g(z)$ as another local complex coordinate). Notice that the point $\bf{x}\in \Sigma$ satisfies 
\[\dd \bf{x}=e_1\theta^1+e_2\theta^2=\Re((e_1-\i e_2)(\theta^1+\i \theta^2))=\Re(\mathsf{z}\theta).\]
As a consequence, the First Fundamental Form $\rmI=\<\dd\bf{x},\dd\bf{x}\>$ reads 
\[\rmI=\frac12\lVert\mathsf{z}\rVert^2 |\theta|^2=\frac14 \left(1+|g|^2\right)^2 |f|^2 |\dd z|^2,\quad |\theta|^2\coloneqq \theta\odot\wb\theta.\]
Thus, $z$ is an isothermal coordinate. Similarly, the Second Fundamental Form is 
\[\rmII=-\<\dd e_3,\dd\bf{x}\>e_3=-\Re(\theta \otimes \dd g)e_3.\]
(This is automatically symmetric because $\theta\wedge\dd g\propto \dd z\wedge\dd z=0$.)
In particular, a vector $X$ is an asymptotic direction iff $\theta(X)\dd g(X)$ is imaginary, and principal iff it is real. The Gauss curvature is easy to compute from the conformal factor since the metric is already diagonalized (here we're using informal notation for dividing tensors; the trickiest part is the sign):
\[K=-\frac{|\theta|^2|\dd g|^2}{\left(\frac12\Vert \mathsf{z}\rVert^2 |\theta|^2\right)^2}=-\left(\frac{4|g'|}{(1+|g|^2)^2|f|}\right)^2.\]

Finally, by substituting the expressions for $\mathsf{z}$ and $\theta$ in terms of $z$, we find the \emph{Weierstrass-Enneper representation} of $\Sigma$:
\[\bf{x}=\Re\int \mathsf{z}\theta=\Re\int 
\begin{pmatrix}
    (1-g^2)f\\ \i (1+g^2)f\\ 2gf
\end{pmatrix}\dd z.\label{eq Weiestrass-Enneper}\]
Here, the integral is a contour integral of a holomorphic $1$-form, taken from an arbitrary basepoint to the given point, and is independent of homotopic deformations of the contour with fixed endpoints. Hence, it produces a well-defined function of the endpoint. 

Note that, generally, $g$ is allowed to be a meromorphic function on a domain with nontrivial topology ($\gamma$ takes values in $\bbS^2=\CP^1$, and thus can have poles), which allows $\Sigma$ to have nontrivial topology as well. Moreover, it is obvious from the formulas that the Weierstrass parametrization is regular as long as the poles of $g$ coincide with (and are at most half of the order of) the zeros of $f$.

\begin{cor}[Weiestrass-Enneper representation]\index{Weierstrass-Enneper representation}
    Each nonplanar minimal surface $\Sigma<\bbE^3$ is determined, up to rigid motions, by its Weierstrass data consisting of a meromorphic function $g:\Sigma\to \CP^1$ and a $1$-form $\theta\in\Omega^1(\Sigma;\bbC)$ that is holomorphic w.r.t.\ the complex structure on $\Sigma$ induced by the metric and orientation. Conversely, every such pair $(g,\theta)$ determines a minimal surface via (\ref{eq Weiestrass-Enneper}) as long as the poles of $g$ overlap with zeros of $\theta$ so that $g^2\theta$ is holomorphic.
\end{cor}

We can immediately observe that multiplying $f$ (or $\theta$) by a unit complex number produces another valid minimal immersion of the same metric surface.

\begin{defn}[Associate family, conjugate surface]\index{Associate family}\index{Conjugate surface}
    Given a minimal surface $\bf{x}:\Sigma\to \bbE^3$ with Weierstrass-Enneper representation $(g,\theta)$, the one-parameter family of isometric minimal surfaces corresponding to $(g,\rme^{\i t}\theta)$, $t\in (0,2\pi)$, is called the associate family of minimal surfaces.
    
    In particular, the conjugate surface to $\Sigma$ is the surface obtained by multiplying $\theta$ by $\rmi$, or equivalently, by replacing $\Re$ with $\Im$ in (\ref{eq Weiestrass-Enneper}).
\end{defn}

\begin{example}[Catenoid and helicoid]
    The Weierstrass-Enneper representation for the catenoid as parametrized in Example~\ref{ex catenoid} (coordinates $(u,v)$ there are, in fact, isothermal) is 
    \[f(z)=-\i \rme^{-\i z/a},\quad g(z)=\rme^{\i z/a},\quad a>0,\]
    and its conjugate surface is the helicoid (although a slight reparametrization will be necessary to bring to the same form as in Example~\ref{ex helicoid}). This agrees with the standard way of picturing the Riemann surface of $z=\ln w$ as a helicoid. The rest of this $1$-parameter family of surfaces is shown in Figure~\ref{fig:helicoid}.
\end{example}


\begin{xca}
    \begin{enumerate}
        \item Identify the surfaces corresponding to $f=1$ and $g$ being one of $0,z,z^{-1},\i z^{-1}$. The surface with $g(z)=z$ is called the \emph{Enneper surface}\index{Enneper surface} and is the only member of its associate family (in particular, conjugate to itself).
        \item Conclude that the surface obtained by using $(f,g)=(\cos^2\frac{z}{2},\tan\frac{z}{2})$ is regular, and identify it with one of the surfaces in item 1. This shows that the Weierstrass representation of a given minimal surface is not unique.
    \end{enumerate}
\end{xca}

Now let us expand the scope to include \gls{cmc} surfaces. Setting $A=0$, $B=1$, and $C=-2H$, with $H$ a given constant, we get a Weingarten \gls{eds} with $2$-forms 
\[\Theta=-\dd\theta^3,\quad \Psi=\omega^3_1\wedge\theta^2+\theta^1\wedge\omega^3_2-2H\theta^1\wedge\theta^2.\]
As with the minimal surface system, the characteristics are complex. The decomposable $2$-forms are 
\[\Theta+ \i \Psi=(\omega-H\wb\theta)\wedge\theta\]
and its complex conjugate. This complex coframe, adapted as it is to the characteristics, leads to a simple basis for the \gls{eds} and a simple description of its prolongation. Namely, we adjoin a complex variable $q$ and define the $1$-form 
\[\tau\coloneqq \omega-H\wb\theta-q\theta.\]
The prolongation is the Pfaffian system $\<\theta^3,\tau,\wb\tau\>$ on $\SE_3\times\bbC$. The system $2$-forms are 
\[\dd\tau\equiv -(\dd q+2iq\omega^1_2)\wedge\theta\pmod{\theta^3,\tau,\wb\tau}\]
and its complex conjugate. Note that $q$ parametrizes the components of the traceless part of the Second Fundamental Form. For, $\tau=0$ implies that 
\[\begin{pmatrix}
    \omega^3_1\\\omega^3_2
\end{pmatrix}=\begin{pmatrix}
    H+q_1 & -q_2\\
    -q_2 & H-q_1
\end{pmatrix}\begin{pmatrix}
    \theta^1\\\theta^2
\end{pmatrix},\]
where $q=q_1+\i q_2$. Thus, the zeros of $q$ are the umbilic points of the surface.

\begin{prop}[{{\cite[Prop.~7.4.25]{Ivey}}}]\label{prop 7.4.25 Ivey}
    Let $\Sigma$ be an oriented surface with a Riemannian metric, and let $P$ be its oriented orthonormal frame bundle, with the canonical forms $\eta^1,\eta^2$ and connection form $\eta^1_2$ (see Remark~\ref{rem covariant derivative on surfaces}). Endow $\Sigma$ with the complex structure which it inherits from the metric and orientation. Suppose $q$ is a complex-valued function on $P$ that satisfies 
    \[(\dd q+2\i q\eta^1_2)\wedge(\eta^1+\i \eta^2)=0.\label{eq 7.28 Ivey}\]
    Then 
    \begin{enumerate}
        \item then
        \[Q\coloneqq q(\eta^1+\i \eta^2)^{\otimes 2}\]
        is a well-defined holomorphic quadratic differential on $\Sigma$.
        \item For any constant $H$, $q$ determines a unique local isometric embedding of $\Sigma$ as a \gls{cmc} surface of mean curvature $H$ into $\bbE^3$ up to rigid motions.
        \item An immersed surface is \gls{cmc} iff its Hopf differential (the traceless part of the $\wt{Q}$ defined in \S\ref{sec: theory of surfaces}) is holomorphic.
    \end{enumerate}
\end{prop}
\begin{proof}
    To see that the differential $Q$ is well-defined, let $X$ be the vector field tangent to the fibers of $P$ that is dual to $\eta^1_2$. Then it is easy to check that $\Lie_X Q=0$. To see that it is holomorphic, let $Q=p\dd z^{\otimes 2}$, where $z$ is a local complex coordinate such that $\dd z$ is a multiple of $\eta^1+\i \eta^2$. Then (\ref{eq 7.28 Ivey}) implies that $\partial_{\wb z}p=0$.

    Any isometric immersion of $\Sigma$ into $\bbE^3$ will induce an immersion from $P$ to $\SE_3$, and the graph of this map will be an integral $3$-manifold of the Pfaffian system on $P\times \SE_3$ generated by 
    \[\<\theta^3,\theta^1-\eta^1,\theta^2-\eta^2,\omega^1_2-\eta^1_2\>.\]
    To this system we adjoin the form $\tau$ and its conjugate, where $q$ is now given. Our hypothesis about $q$ implies that this enlarged system is Frobenius. Thus, there exists a unique integral $3$-manifold through each point, and any two isometric immersions differ by a rigid motion.
\end{proof}

\begin{cor}[Hopf]\index{Theorem!Hopf}
    Any \gls{cmc} immersion of a sphere $\Sigma=\bbS^2$ (with any metric) is a round sphere, i.e.~$K\equiv H^2=\const$.
\end{cor}
\begin{proof}
    It suffices to show that the space of holomorphic quadratic differentials on a sphere is trivial.
    Choose the standard complex structure on the sphere $\CP^1=\bbC\cup \{\infty\}$ given by the complex coordinate $z\in\bbC$. Any \gls{cmc} immersion corresponds to a holomorphic differential $Q=q\dd z^{\otimes 2}$ on $\CP^1$. Then $q$ is a function holomorphic in $\bbC$, and moreover $Q$ needs to be holomrphic at $\infty$, which means that in the local coordinate $w=z^{-1}$, the expression $Q=q(z)w^{-4}\dd w^{\otimes 2}=q(z)z^{4}\dd w^{\otimes 2}$ has to remain regular as $z\to \infty$. Thus $q(z)z^4\to 0$ as $z\to\infty$. But the only holomorphic function in $\bbC$ that has this property is zero, thus $Q=0$ and $K=H^2$.
\end{proof}


\begin{cor}[Bonnet {{\cite[Cor.~7.4.26]{Ivey}}}]
    Any \gls{cmc} surface has a circle's worth of isometric deformations as a \gls{cmc} surface.
\end{cor}
\begin{proof}
    Given $f:\Sigma\to \bbR^3$, let $q$ be the coefficient of the Hopf differential as above and let 
    \[q^t\coloneqq \rme^{\i t}q,\quad t\in(0,2\pi).\label{eq 7.29 Ivey}\]
    Then $q^t$ also satisfies the conditions of Proposition~\ref{prop 7.4.25 Ivey}, and the First Fundamental Form remains unchanged.
\end{proof}

Moreover, if the surface is not totally umbilic, then at most points $q\neq 0$ and the Second Fundamental Form is changed by (\ref{eq 7.29 Ivey}). So, the surface constructed using $q^t$ is, in general, not congruent to the original surface by rigid motions. This is the \gls{cmc} generalization of the isometric deformations of minimal surfaces that we saw above.

\begin{rem}[Bonnet surfaces]
    The above deformations show that there are noncongruent surfaces with the same $K$ and $H$ (in this case, $H$ is the same constant). Bonnet discovered that, besides \gls{cmc} surfaces, there is a finite-dimensional family of surfaces that admit noncongruent isometric deformations preserving $H$. These \emph{Bonnet surfaces} may be characterized by the property that they admit isothermal coordinates (so $q$ is real) and in these coordinates $1/q$ is harmonic, i.e., $(1/q)_{z\wb z}=0$.
\end{rem}










\section{B\"acklund transformations}


Equations which are integrable by the method of Darboux give one example where we can construct integral manifolds of an \gls{eds} by restricting to a submanifold where the system becomes Frobenius. Another example arises when the integrability condition for an overdetermined system of PDEs can be reduced to finding the solution of another PDE. Then any solution of that PDE enables us to construct (using ODE techniques) a solution of the original system.

\begin{example}\label{ex 7.5.1 Ivey}
    For example, the $UV$-pair representation (\ref{eq 7.21 Ivey}) of \gls{sge} enables us to construct a solution to the \gls{ma} system for pseudospherical surfaces by integrating a Frobenius system.
\end{example}

When this transformation works in both directions, the two PDEs are said to be related by a \emph{B\"acklund transformation}, which we will define later in the \sect. First, we formalize the relationship between the systems seen in the above examples.

\begin{defn}
    Let $\calI$ be an \gls{eds} on a manifold $M$, let $\pi:B\to M$ be a submersion, and let $\calE$ be an \gls{eds} on $B$. Then $\calE$ is an integrable extension of $\calI$ if there exists a Pfaffian system $J<\T^\ast B$ such that 
    \[\calE=\<J\cup \pi^\ast\calI\>_{\mathrm{alg}}\label{eq 7.31 Ivey}\]
    and $J$ is transverse to the fibers of $\pi$ (i.e. a frame of $J$ pulls back to form coframes on each fiber of $\pi$).  The \emph{rank} of an integrable extension is the rank of $J$, or the dimension of the fibers of $\pi$.
\end{defn}


The condition that $\calE$, as defined by (\ref{eq 7.31 Ivey}), is a differential ideal is equivalent to 
\[\dd\theta\equiv 0\pmod{J,\pi^\ast\calI}\text{ for any }\theta\in\Gamma^\infty(J).\label{eq 7.32 Ivey}\]


\begin{example}[Laplace equation]\index{Equation!Laplace}\label{ex laplace equation backlund}
    The ``baby version'' of a B\"acklund transformation is the Cauchy-Riemann system, which relates pairs of solutions to the $2$-dimensional Laplace equation. Recall from Example~\ref{ex 7.4.6 Ivey} that the Laplace equation $u_{xx}+u_{yy}=0$ is equivalent to the \gls{ma} system on $\rmJ^1(\bbR^2,\bbR)$ generated (differentially) by $\theta=\dd z-p \dd x-q \dd y$ and $\Psi=\dd p\wedge\dd y-\dd q\wedge \dd x$. We observe that 
    \[\Psi=\dd (p\dd y-q \dd x)\eqqcolon \dd \phi,\]
    so we can extend the system to $\rmJ^1(\bbR^2,\bbR)\times\bbR$ with a new variable $w$ and let the Pfaffian system $J$ be 
    \[J=\<\dd w-\phi\>=\<\dd w+q\dd x-p\dd y\>.\]
    Clearly $J$ satisfies (\ref{eq 7.32 Ivey}) because $\dd (f\phi)\equiv 0\pmod{\<\phi,\Psi\>}$. Meanwhile, the extended system $\calE$ is a Pfaffian system spanned by $\theta$ and $\phi$, which is equivalent to the following pair of equations on two functions $z=u(x,y)$ and $w=v(x,y)$:
    \[u_x=v_y,\quad u_y=-v_x,\]
    i.e., the Cauchy-Riemann system.\index{Equation!Cauchy-Riemann} Whenever $u,v$ satisfy this system, both $u$ and $v$ must be harmonic. The Cauchy-Riemann system allows one to easily compute $v$ from $u$ (up to constants of integration) using ODE methods. Hence, this system can be seen as a method for generating ``new'' harmonic functions from known ones. Such pairs of harmonic functions are called \emph{conjugate}.\index{Conjugate harmonic function}
\end{example}

If $(B,\calE)$ is an integrable extension of rank $k$ and $N\subset M$ is a $p$-dimensional integral manifold of $\calI$, then (\ref{eq 7.32 Ivey}) implies that the pullback of $J$ to $\pi^{-1}(N)$ is Frobenius. In this way, an integral manifold of $\calI$ gives a $k$-parameter family of integral manifolds of $\calE$. In Example~\ref{ex 7.5.1 Ivey}, the $6$-parameter family of surfaces corresponding to a single sine-Gordon solution are congruent under rigid motions of $\bbE^3$.


\begin{example}[\ref{ex 7.5.1 Ivey} continued]
    Let $M=\bbR^5$ and let $\calI$ be the \gls{ma} system for \gls{sge} given in Example~\ref{ex 7.4.6 Ivey}. Let $B=M\times \SE_3$. The equations (\ref{eq 7.21 Ivey}) and (\ref{eq 7.22 Ivey}) show that a Darboux framing for a pseudospherical surface associated to a sine-Gordon solution $u(x,y)$ is an integral surface for the Pfaffian system 
    \begin{multline}
        J\coloneqq \<\theta^1-\cos u(\dd x+\dd y),\theta^2+\sin u(\dd x-\dd y),\omega^1_2-u_x \dd x+u_y\dd y,\right.\\
        \left. {}\omega^3_1-\sin u(\dd x+\dd y),\omega^3_2+\cos u(\dd x-\dd y)\vphantom{|}\>.
    \end{multline}
    The one can check that $J$ satisfies (\ref{eq 7.32 Ivey}).
\end{example}


\begin{rem}\label{rem 7.5.4 Ivey}
    Suppose $\calI$ is a \gls{eds} on a manifold $M$ with a $2$-form $\Phi\in\calI^2$ closed. Then, by the Poincar\'e Lemma~\ref{lem poincare classic}, in some contractible neighborhood of any given point in $M$ there exists a differential form $\phi$ such that $\dd\phi=\Phi$. We may define a rank-$1$ integrable extension of $\calI$ by introducing a new coordinate $y$ and letting the Pfaffian system $J$ on $U\times\bbR$ be spanned by $\dd y-\phi$. This is exactly what we did for the Laplace equation in Example~\ref{ex laplace equation backlund}. Because such forms $\Phi$ are examples of conservations laws for an \gls{eds}, we call this construction an \emph{extension via conservation law}.
\end{rem}


\begin{rem}
    One could trivially produce an integrable extension by choosing $J$ to be Frobenius. Such extensions are called \emph{flat}. More generally, if the derived flag of $J$ terminates in a Frobenius system $K$ of rank $k'$, then $\calE$ defines an intgerable extension when pulled back to any leaf of the foliation dual to $K$. In this case $(B,\calE)$ is called a \emph{$k'$-parameter family} of integrable extensions.
\end{rem}

Parametric families of integrable extensions are frequently encountered in the study of completely integrable PDEs, i.e., \emph{solitonic equations}. 

\begin{example}\label{ex 7.5.6 Ivey}
    We now describe the integrable extensions of the \gls{kdv} equation 
    \[u_t+u_{xxx}+6uu_x=0\label{eq 7.33 Ivey}\]
    (it coincides with (\ref{eq kdv})) after flipping the sign of $u$). Let $M=\bbR^5$ with coordinates $(x,t,u,p,r)$. Let 
    \begin{align}
        \Theta_1\coloneqq &(\dd u-p\dd x)\wedge\dd t,\\
        \Theta_2\coloneqq &(\dd p-r\dd x)\wedge\dd t,\\
        \Theta_3\coloneqq &(\dd r+6u p\dd x)\wedge \dd t-\dd u\wedge\dd x,
    \end{align}
    and let $\calI=\<\Theta_1,\Theta_2,\Theta_3\>_{\mathrm{diff}}$. Then solutions of (\ref{eq 7.33 Ivey}) correspond to integral surfaces of $\calI$ satisfying the independence condition $\dd x\wedge\dd t\neq 0$. (Note that $M$ is a quotient of $\rmJ^2(\bbR^2,\bbR)$, and $p,r$ have their classical meanings as $u_x$ and $u_{xx}$ respectively. One could also use the \gls{eds} obtained by pulling back the standard contact system on $\rmJ^3(\bbR^2,\bbR)$ to the hypersurface defined by (\ref{eq 7.33 Ivey}), but the extra variables are not needed here.)

    On $B=M\times\bbR^2$ with fiber coordinates $(\mu,y)$, let $J=\<\dd \mu,\eta\>$, where 
    \[\eta\coloneqq \dd y-(y^2+u-\mu)\dd x+(r+2py+2(u+2\mu)(y^2+u-\mu))\dd t,\]
    and let $\calE=\<J\cup \calI\>_{\mathrm{alg}}$. It is an exercise to verify that $\calE$ is an integrable extension of $\calI$.

    Since $J$ contains a rank-$1$ Frobenius system, we have a $1$-parameter family of extensions, with $\mu$ as a parameter. Along an integral surface of $\calE$ that satisfies the independence condition, $y(x,t)$ satisfies 
    \[y_y+y_{xxx}+6(\mu-y^2)y_x=0\label{eq 7.34 Ivey}\]
    for some constant $\mu$. This family of equations may be said to be extensions of \gls{kdv}. When $\mu=0$, it is a version of another well-known PDE, the \emph{modified \gls{kdv} equation}, and the passage from $u$ to $y$ is known as the \emph{Miura transformation}.
    % All integrable extensions of \gls{kdv} have been classified, and each of them corresponds to a finite-dimensional representation of a certain infinite-dimensional Lie algebra, known as the \emph{\gls{kdv} prolongation algebra}. Moreover, this algebra has a $1$-parameter family of finite-dimensional quotients, each of which is isomorphic to a semidirect product of $\fraksl_2(\bbR)$ with $\bbR^5$. Representations of the latter algebra allow us to construct $1$-parameter families of \gls{kdv} extensions, the most well-known of which is the AKNS system (\ref{eq AKNS UV pair})
\end{example}


B\"acklund transformations are a particular form of integrable extension which allows a two-way transformation of solutions of a PDE to solutions of another (or the same) PDE. One of the most well-known is the following transformation, which can produce new solutions of the \gls{sge}.

\begin{example}\label{ex 7.5.9 Ivey}
    Consider the system
    \begin{align}
        u_x-\wb{u}_x=\lambda&\sin(u+\wb{u}),\\
        u_y+\wb{u}_y=\frac{1}{\lambda}&\sin(u-\wb{u}).
    \end{align}
    If $u(x,y),\wb{u}(x,y)$ are smooth functions that satisfy this system for some $\lambda\neq 0$, the differentiating and equating mixed partials implies that $u$ and $\wb{u}$ must be solutions of sine-Gordon $u_{xy}=\sin u\cos u$. Conversely, given a solution $u(x,y)$ of sine-Gordon, we can determine $\wb{u}_x$ and $\wb{u}_y$ from the above, and integrate to get the new solution $\wb{u}(x,y)$ (since we are guaranteed that mixed partials commute). Since this can be done for any $\lambda$, and there will be a constant of integration of the first-order ODE, we get a $2$-parameter family of solutions. For example, the kink solution (\ref{eq SGE 1-soliton}) can be produced in this way by starting with $u\equiv 0$. However, the constants of integration amount to translating the solution in the plane, so we can omit them, keeping the translational invariance in mind. Thus, the kink has one parameter $\lambda$. By iterating this procedure, we get a $2$-parameter family of $2$-soliton solutions, a $3$-parameter family of $3$-soliton solutions, and so on. All of them can be obtained by solving simple ODE's and are expressed in terms of trigonometric and exponential functions. For example, the $2$-soliton solution (Figure~\ref{fig:2-soliton}) is 
    \[u=2\arctan \frac{\lambda_1+\lambda_2}{\lambda_1-\lambda_2}\frac{\rme^{\lambda_1x+\lambda_1^{-1}y}-\rme^{\lambda_2 x+\lambda_2^{-1}y}}{1+\rme^{(\lambda_1+\lambda_2)x+(\lambda_1^{-1}+\lambda_2^{-1})y}}.\label{eq sge 2-soliton}\]
    One can also obtain other interesting exact solutions from these formulas. While $\lambda_1$ and $\lambda_2$ are real, we can put $\lambda_1=\rme^{\i t}=-\lambda_2^{-1}$ for $t\in \bbR$, and discover that the formula for the $2$-soliton solution gives another real solution of sine-Gordon, which is periodic in $x-y$ and is called a \emph{breather} (Figure~\ref{fig:breather}).
\end{example}

\begin{figure}[tp]
    \centering
    \includegraphics[scale=0.2]{figures/SG2soliton.png}
    \caption{A $2$-soliton solution of \gls{sge} (height profiles at constant $y$ for (\ref{eq sge 2-soliton})) and the corresponding pseudospherical surface.}
    \label{fig:2-soliton}
\end{figure}


\begin{defn}[B\"acklund transformation]
    Let $M_1,M_2$ carry \glspl{eds} $\calI_1$ and $\calI_2$, respectively, and let $B\subset M_1\times M_2$ be a submanifold such that the projections $\pr_i:B\to M_i$, $i=1,2$, give $B$ the structure of a double fiber bundle. Then $(B,\calE)$ defines a B\"acklund transformation between $\calI_1$ and $\calI_2$ if $\calE$ is an \gls{eds} on $B$ that is an integrable extension of both $\calI_1$ and $\calI_2$.
\end{defn}

We will often define B\"acklund transformations by giving a Pfaffian system $J<\T^\ast B$ such that 
\begin{align}
    &\<J\cup \pr_1^\ast \calI_1\>_{\mathrm{alg}}=\<J\cup \pr_2^\ast\calI_2\>_{\mathrm{alg}},\label{eq 7.37a Ivey}\\
    &\calE\coloneqq \<J\cup \pr_1^\ast \calI_1\cup \pr_2^\ast \calI_2\>_{\mathrm{alg}}\text{ is a differential ideal}.\label{eq 7.37b Ivey}
\end{align}
Note that $J$ need not be transverse to the fibers of $\pr_1$ or $\pr_2$.

\begin{example}[\ref{ex 7.5.9 Ivey} continued]
    Let $M_1$ and $M_2$ be two copies of $\rmJ^1(\bbR^2,\bbR)$ where we denote the forms and coordinates on $M_2$ with bars. For $i=1,2$ let the \gls{eds} $\calI_i$ on $M_i$ be a copy of the \gls{ma} system for \gls{sge} from Example~\ref{ex 7.4.6 Ivey}. For any $\lambda\neq 0$, let $B_\lambda<M_1\times M_2$ be defined by $\wb{x}=x$, $\wb{y}=y$ and 
    \begin{align}
        p-\wb{p}&=\lambda\sin(u+\wb{u}),\\
        q+\wb{q}&=\frac{1}{\lambda}\sin(u-\wb{u}).
    \end{align}
    Let $\theta$ be the standard cotact form on $\rmJ^1(\bbR^2,\bbR)$. On $B_\lambda$, let $J=\<\pr_1^\ast\theta,\pr_2^\ast\wb\theta\>$. Then it is easy to check that (\ref{eq 7.37a Ivey}-\ref{eq 7.37b Ivey}) are satisfied.
\end{example}

\begin{figure}[tp]
    \centering
    \includegraphics[scale=0.2]{figures/SGbreather.png}
    \caption{A breather wave solution of \gls{sge} (height profiles at constant $x+y$) and the corresponding pseudospherical surface.}
    \label{fig:breather}
\end{figure}


\begin{example}[\ref{ex 7.5.6 Ivey} continued]
    Let $M_1,M_2$ be two copies of $\bbR^5$, each carrying a copy of the \gls{kdv} \gls{eds}. (Again, we use barred coordinates on $M_2$.) Define $B=M_1\times\bbR^2$ as before, and define a submersion $\pr_2:B\to M_2$ by 
    \begin{align}
        \wb{x}&=x,\\
        \wb{y}&=y,\\
        \wb{u}&=2(\mu-y^2)-u,\\
        \wb{p}&=4y(\mu-u-y^2)-p,\\
        \wb{r}&=-4(u+y^2-\mu)(u+3y^2-\mu)-4yp-r.
    \end{align}
    Then $J$, as defined above, gives a B\"acklund transformation between the \gls{kdv} equation and itself. One can check that 
    \[
    \begin{rcases}
        \pr_2^\ast\Theta_1&\equiv -\pr_1^\ast\Theta_1\\
        \pr_2^\ast\Theta_2&\equiv -\pr_1^\ast\Theta_2-4y\pr_1^\ast\Theta_1 \\
        \pr_2^\ast\Theta_3&\equiv -\pr_1^\ast\Theta_3-4y\pr_1^\ast\Theta_2-8(u+2y^2-\mu)\pr_1^\ast\Theta_1
    \end{rcases} \pmod{J}.
    \]
    The presence of an arbitrary parameter in the B\"acklund transformation for \gls{kdv} is central to its complete integrability, both in the sense of inverse scattering and in the Hamiltonian sense.
\end{example}

In many important cases B\"acklund transformations relate two \emph{different} PDEs.

\begin{example}[Wave and Liouville equations]
    Let $M_1\subset \rmJ^2(\bbR^2,\bbR)$ be the submanifold defined by the hyperbolic Liouville equation $z_{xy}=\rme^z$, with the standard contact system $\calI_1$ generated by $\theta_0,\theta_1,\theta_2$ defined in Example~\ref{ex 7.3.6 Ivey}. We use the standard notation $(p,q,r,s,t)$ for the jet coordinates restricted to $M_1$. Then (\ref{eq 7.14 Ivey}) implies that $(r-\frac12p^2)_y=0$ and $(t-\frac12q^2)_x=0$ for any solution. Thus, on $B=M_1\times \bbR$ with coordinate $v$ on the second factor, we may define an extension by letting $J=\<\theta_0,\theta_1,\theta_2,\eta\>$, where 
    \[\eta\coloneqq \dd v-(r-\frac12 p^2)\dd x-(t-\frac12 q^2)\dd y.\]
    Because $\dd\eta\equiv 0\pmod{\calI_1}$, $\calE=\<J\cup\calI_1\>_{\mathrm{alg}}$ is an integrable extension of $\calI_1$.

    Furthermore, let $M_2=\rmJ^2(\bbR^2,\bbR)$ with coordinates $(\wb{x},\wb{y},\wb u,\wb p,\wb q)$ and let $\calI_2$ be the standard \gls{ma} system for the wave equation $\wb{u}_{\wb x\wb y}=0$. Define a submersion $\pr_2:B\to M_2$ by 
    \[\wb{x}=x,\quad\wb{y}=y,\quad \wb{u}=v,\quad \wb{p}=r-\frac12 p^2,\quad \wb{q}=t-\frac12 q^2.\]
    Then $\calE$ is an integrable extension of $\calI_2$ (with the role of the transverse Pfaffian system played by $\<\theta_0,\theta_1,\theta_2\>$). Thus, $(B,\calE)$ defines a B\"acklund transformation between Liouville and wave equations.

    Explicitly, the system $\calE$ is equivalent to the two PDEs
    \begin{align}
        u_x+\wb{u}_x&=2\lambda \exp\frac{u-\wb{u}}{2},\\
        u_y-\wb{u}_y&=\frac{1}{\lambda}\exp \frac{u+\wb{u}}{2}.
    \end{align}
    Whenever this system is satisfied, $u$ must be a solution of the Liouville equation, whereas $\wb{u}$ must be a solution of the wave equation. By taking $\wb{u}$, we can recover $u$ up to a constant of integration, thus producing the general solution of the Liouville equation. Letting  $\wb{u}(x,u)=\xi(x)+\eta(y)$, which is the general solution of the wave equation, we separate variables in the above system to find
    \[\exp\left(-\frac{u}{2}\right)=-\exp\left(\frac{\xi-\eta}{2}\right)\left(\lambda\int \rme^{-\xi(x)}\dd x+\frac{1}{2\lambda}\int \rme^{\eta(y)}\dd y\right).\label{eq 9.31 Clellan}\]
    Setting $X(x)\coloneqq -\lambda\int \rme^{-\xi(x)}\dd x$ and $Y(y)\coloneqq -\frac{1}{2\lambda}\int \rme^{\eta(y)}\dd y$, it is easy to solve (\ref{eq 9.31 Clellan}) and get the general solution (\ref{eq Liouville general solution}), where $X(x)$ and $Y(y)$ are arbitrary functions of a single variable, with the property that $X'$ and $Y'$ are nonzero and have the same sign.
\end{example}



The B\"acklund transformation for pseudospherical surfaces arises naturally in a classical context, the study of \emph{line congruences} in Euclidean space.

\begin{defn}[Line congruence]\index{Line congruence}
    A line congruence in $\bbE^3$ is an immersed surface in $\Gr_1(\bbE^3)$, i.e., a $2$-parameter family of lines $\ell:U\to \Gr_1(\bbE^3)$, where $U\subset\bbR^2$ and each element of $\Gr_1(\bbE^3)$ (a tangent line to $\bbE^3$) is viewed as a line in $\bbE^3$. It can be expressed (non-uniquely) as 
    \[\ell(\bf{u})=[\bf{x}(\bf{u}),e(\bf{u})],\]
    where $\bf{x}(\bf{u})$ is a point on the line $\ell(\bf{u})$ and $e(\bf{u})\in\bbS^2$ is a unit vector parallel to $\ell(\bf{u})$. If $\bf{x}$ is chosen to be smooth, then the surface $\Sigma=\bf{x}(U)$ is called a \emph{surface of reference} for $\ell$. Any other surface of reference $\wb\Sigma=\wb{\bf{x}}(U)$ for $\ell$ can then be parametrized as 
    \[\wb{x}(\bf{u})=\bf{x}(\bf{u})+\lambda(\bf{u})e(\bf{u}),\quad \lambda\in C^\infty(U).\]

    For a generic line congruence $\ell:U\to \Gr_1(\bbE^3)$ there are two distinguished surfaces of reference, $\Sigma=\bf{x}(U)$, $\wb\Sigma=\wb{\bf{x}}(U)$, called \emph{focal surfaces}, to which each line of the congruence is tangent (we omit the detailed construction). Aside from degeneracies, the lines locally give a $1$-to-$1$ correspondence between points of the focal surfaces.
\end{defn}


\begin{defn}[Pseudospherical line congruence]
    Let $\ell:U\to \Gr_1(\bbR^3)$ be a line congruence with focal surfaces $\Sigma,\wb{\Sigma}$ parametrized as above. The congruence is called pseudospherical if 
    \begin{enumerate}[label=(\alph*)]
        \item The distance $r=\lVert\bar{\bf x}(\bf{u})-\bf{x}(\bf{u})\rVert$ is a constant independent of $\bf{u}$,
        \item The angle $\alpha$ (assumed to be nonzero) between the surface normal vectors $e_3(\bf{u})$, $\wb{e}_3(\bf{u})$ to the surfaces $\Sigma,\wb\Sigma$, respectively, is a constant independent of $\bf{u}$.
    \end{enumerate}
\end{defn}

\begin{thm}[B\"acklund]\index{Theorem!B\"acklund}
    If $\ell$ is a pseudospherical line congruence with focal surfaces $\Sigma,\wb{\Sigma}$, then both of them have constant Gauss curvature $K=-\frac{\sin^2\alpha}{r^2}$, where $r,\alpha$ are as above. 
    
    Conversely, given a surface $\Sigma$ with $K=-\frac{\sin^2\alpha}{r^2}$, a point $\bf{x}_0\in\Sigma$ and a unit non-principal tangent vector $e_0\in \T_{\bf{x}_0}\Sigma$, there exists a unique surface $\wb\Sigma$ such that if $\bar{\bf x}_0$ is the point corresponding to $\bf{x}_0$, then $\bar{\bf{x}}-\bf{x}_0=r e_0$ and the angle between the surface normals of $\Sigma$, $\wb\Sigma$ at $\bf{x}_0$, $\bar{\bf x}_0$, respectively, is $\alpha$.
\end{thm}
\begin{proof}
    \gls{wlog}, we can assume $\lambda=\sin \alpha$, so that $K\equiv -1$. The starting point  of the proof is adapting frames $(\bf{x},\frake)$ and $(\bar{\bf{x}},\wb{\frake})$ along the two surfaces so that $e_1=\wb{e}_1$ is tangent to the line connecting corresponding points $\bf{x}$ and $\bar{\bf x}$. For any fixed $\lambda$, the graph of the B\"acklund transformation is a $6$-dimensional submanifold of $\SE_3\times\SE_3$ defined by 
    \begin{align}
        \bar{\bf x}&= \bf{x}+\lambda e_1,\\
        \bar{e}_1 &= e_1,\\
        \bar{e}_2 &= e_2\cos \alpha+e_3\sin\alpha,\\
        \bar{e}_3&=e_3\cos \alpha-e_2\sin\alpha.
    \end{align} 
    However, we will regard this system as defining a $7$-dimensional submanifold $B<\SE_3\times\SE_3\times\bbR$ with $\lambda$ as the extra coordinate. On $B$, let $J=\<\theta^3,\wb\theta^3,\dd\lambda\>$. Then the exercise below verifies that (\ref{eq 7.37a Ivey}-\ref{eq 7.37b Ivey}) are satisfied, and B\"acklund's Theorem follows from the fact that 
    \[\<\omega^3_1\wedge\omega^3_2+\theta^1\wedge\theta^2,\wb\omega^3_1\wedge\wb\omega^3_2+\wb\theta^1\wedge\wb\theta^2\>\equiv \<\dd\theta^3,\dd\wb\theta^3\>\pmod{J}.\]
\end{proof}



\begin{xca}
    \begin{enumerate}
        \item Differentiate the system of equations in the above proof to obtain the following relations between the pullbacks to $B$ of the canonical forms:
        \begin{align}
            \wb\theta^1&=\theta^1+\dd\lambda,\quad \wb\omega^2_3=\omega^2_3-\dd\alpha,\\
            \begin{pmatrix}
                \wb\theta^2\\\wb\theta^3
            \end{pmatrix}&=
            \begin{pmatrix}
                \cos\alpha & \sin\alpha \\
                -\sin\alpha & \cos\alpha
            \end{pmatrix}\begin{pmatrix}
                \theta^2-\lambda\omega^1_2\\
                \theta^3-\lambda\omega^1_3
            \end{pmatrix},\\
            \begin{pmatrix}
                \wb\omega^1_2\\\wb\omega^1_3
            \end{pmatrix}&=
            \begin{pmatrix}
                \cos\alpha & \sin\alpha \\
                -\sin\alpha & \cos\alpha
            \end{pmatrix}\begin{pmatrix}
                \omega^1_2\\
                \omega^1_3
            \end{pmatrix},
        \end{align}
        Using these, verify (\ref{eq 7.37a Ivey}-\ref{eq 7.37b Ivey}).
        \item Show that (\ref{eq 7.37a Ivey}) implies that decomposable $2$-forms in one system are congruent to decomposables for the other modulo the contact forms $\<\theta^3,\wb\theta^3\>$. The asymptotic lines are dual to the factors of these decomposables, therefore the B\"acklund transformation takes asymptotic lines to asymptotic lines.
        \item Show that if two pseudospherical surfaces are related by a B\"acklund transformation, then their corresponding solutions of \gls{sge} are related by a B\"acklund transformation with the same parameter $\lambda$.
        \item Show that B\"acklund transformations are transitive, so the existence of a B\"acklund transformation between two systems is an equivalence relation on \glspl{eds}.
    \end{enumerate}
\end{xca}


As we wrap up our exploration of the geometry of surfaces, we can make some observations about the deep relationship between surfaces and completely integrable systems. As we have seen, many basic problems about surfaces get reduced to integrable systems such as the Liouville equation, \gls{sge}, and the AKNS system. In fact, the \gls{kdv} equation also describes certain classes of surface, and various extensions of these systems appear as well. Aside from geometry of surfaces and dynamical systems, integrable systems appear across all sectors of mathematics: probability and statistics, combinatorics, statistical mechanics, classical analysis, numerical analysis, asymptotic representation theory, algebraic geometry, and so on. While there is no general formal definition of a completely integrable system, all of the following features are considered necessary parts of integrability:
\begin{enumerate}
    \item \emph{A linearizing coordinate transformation}, after which the problem is reduced to linear equations. This property is the most natural extension of the classical notion of integrability (existence of action-angle variables). For example, the Weierstrass representation of minimal surfaces reduced the problem to the linear Cauchy-Riemann system describing holomorphic functions. Similarly, the \gls{kdv} dynamics become linear after being put in terms of the scattering data of the Schr\"odinger equation in which the \gls{kdv} solution acts as the potential. 
    \item \emph{B\"acklund transformations} that allow one to generate solutions of one integrable system using solutions of another.
    \item \emph{A Hamiltonian structure} which describes solutions as Hamiltonian flows on an infinite-dimensional manifold.
    \item \emph{An infinite-dimensional Lie algebra of symmetries}, which generates an infinite number of conserved quantities (analogs of initial data in a Frobenius system).
    \item \emph{Existence of solitonic solutions}, each of which is described by a finite set of parameters related to the conserved quantities. This is another manifestation of the large space of symmetries.
    \item \emph{Well understood function spaces}, such as special functions (elliptic, hypergeometric, Painlev\'e). One a nonlinear coordinate transformation was found that reduces the problem to a linear one, the space of solutions to the linear problem needs to be highly legible. A standard criterion for this property is the Painlev\'e Test, which is related to the classification of ODE's whose solutions have certain natural analytic properties (such as singularities of Fuchsian type whose location is independent of the initial condition), a generalization of the Cauchy-Kovalevskaya Theorem. Solutions to Painlev\'e equations encompass all classical special functions and are currently the broadest well-studied class of special functions related to integrable PDEs.
    \item \emph{Lax pair or zero curvature representations}, which pair the original system with a linear time-dependent operator ($L$ in Example~\ref{ex Lax pairs}) whose dynamics is \emph{isospectral}. The existence of a Lax pair is often conflated with integrability, but it alone does not actually imply the rest of the features listed above.
\end{enumerate} 

For a much more detailed review of the concept of integrable systems, we direct the reader to \cite{deift}. For more on the theory of classical integrable systems, see the books \cite{moser,babelon}.





\section{Gauss-Bonnet and Poincar\'e theorems}\label{sec: gauss-bonnet}

We finish this \chap\ with a classical theorem that is a major early milestone in the history of differential geometry due to being the first \emph{global} result of the theory of surfaces. Moreover, it turns out to relate local geometric data (Gauss curvature) to global topological data, which is indepedent of the choice of metric, thus becoming a harbinger of the more modern results about topological invariants constructed out of geometric data.


Suppose $\frake=(e_1,e_2)$ and $\wt\frake=(\wt e_1,\wt e_2)$ are two local orthonormal frames on a Riemannian surface $(\Sigma,\sfg)$. They are related by $\wt\frake=\frake\cdot R$ for some function $R:\Sigma\to \SO_2$. We have seen that the \emph{local connection form} $\omega\coloneqq\frake^\ast\omega^2_1$ is intrinsic and can be expressed using an isometric immersion of $\Sigma$ into $\bbE^3$ via 
\[e_2\omega=\dd e_1-\<\dd e_1,e_3\>e_3,\] 
where $e_1,e_2,e_3$ are treated as $\bbR^3$-valued functions on $\Sigma$. (One can also obtain an intrinsic formula for $\omega$ in terms of $\sfg$ but we won't need it in this \chap.) From here, the rotation matrix $R$ induces the following transformation of the connection form:
\[\wt\omega =\wt{\frake}^\ast\omega^2_1=\omega+R^{-1}\dd R.\]
The rotation matrix $R$ is of course uniquely identified with a counter-clockwise rotation through some angle $\theta(m)$ dependent on the point $m\in \Sigma$. In terms of this angle, 
\[\wt\omega =\omega+\dd\theta.\label{eq 169}\]

Now consider a curve $\gamma:[0,1]\to \Sigma$ which lies in a region covered by an orthonormal frame $\frake$. Suppose that $X\in\fX(\Sigma)$ is a vector field whose values $X(t)$ along $\gamma$ have unit length. We define a map $\alpha:[0,1]\to \bbS^1\subset \bbR^2$ by letting $\alpha(t)$ be the image of $X(t)$ under the unique linear map $\im(\gamma)\to \bbR^2$ which takes $e_1(\gamma(t))$ to $\bf{e}_1=(1,0)$. We then have a continuous map $\phi:[0,1]\to \bbR$ with $\alpha(t)=(\cos\phi(t),\sin\phi(t))$, and any two such maps differ by a multiple of $2\pi$. We will refer to any such $\phi$ as a continuous choice of the angle between $e_1$ and $X$. It is easy to see that $\phi$ is actually smooth if $X$ and $\gamma$ are. 

By choosing another local frame $\wt\frake$ such that $\wt e_1=X$ along $\gamma$ and using (\ref{eq 169}), it is now easy to see that 
\[\nabla_{\dot\gamma}X=0 \Leftrightarrow \omega(\dot\gamma(t))+\dot\phi(t)=\wt\omega(\dot\gamma(t))=\<\nabla_{\dot\gamma}X,\wt e_2\> =0.\]
We say that $X$ is \emph{parallel} along $\gamma$ when this holds. It follows that the connection form $\omega$ describes the rate at which a vector rotates while being parallel transported along $\gamma$. If $X$ is not parallel along $\gamma$, we get a nonzero quantity. In \S\ref{sec: pseudospherical surfaces} we defined the geodesic curvature and noted that it is intrinsic since $\kappa_{\mathrm{g}}=\lVert\nabla_{\dot\gamma}\dot\gamma\rVert$, or 
\[\kappa_{\mathrm{g}}=\<\nabla_{\dot\gamma}\dot\gamma,\bf{N}\>.\label{eq geodesic curvature}\]
In terms of the angle $\phi$ between $e_1$ and $\dot\gamma(t)$, we have 
\[\kappa_{\mathrm{g}}(t)=\omega(\dot\gamma(t))+\dot\phi(t).\]


\begin{prop}
    Let $(\Sigma,\sfg)$ be a compact oriented Riemannian surface, with connected boundary $\partial \Sigma$, diffeomorphic to a subset of $\bbR^2$. Let its Gaussian curvature be $K$ and its canonical area form $\sfv_\sfg$. Let $s$ be the arclength parameter along $\partial \Sigma$ and let $\kappa_{\mathrm{g}}$ be the signed geodesic curvature of $\partial \Sigma$ (on which the direction is induced by orientation). Then 
    \[\int_\Sigma K\sfv_\sfg=-\oint_{\partial \Sigma}\kappa_{\mathrm{g}}\dd s+2\pi.\]
\end{prop}
\begin{proof}
    Because of our assumptions, we may as well assume that $\Sigma\subset \bbR^2$. On it we define a positively oriented orthonormal frame $(e_1,e_2)$ be requiring $e_1$ to be a positive multiple of $\partial_{x^1}$. Let $\gamma:[0,1]\to \partial \Sigma$ be a closed curve, parametrized by arclength $\sigma$, such that $\dot\gamma(\sigma)$ is positively oriented, and let $\phi$ be a continuous choice of the angle between $e_1$ and $\dot\gamma$. Let $\omega$ be the connection form, which in this case can be defined globally. Then, using the Stokes Theorem and the above formula for $\kappa_{\mathrm{g}}$,
    \begin{align}
        \int_\Sigma K\sfv_\sfg&=\int_\Sigma K\theta^1\wedge\theta^2=-\int_\Sigma \dd \omega=-\int_{\partial \Sigma}\omega=\\
        &=-\int_0^1 \omega(\dot\gamma(\sigma))\dd \sigma=\\
        &=-\int_0^1\kappa_{\mathrm{g}}(\sigma)\dd\sigma+\int_0^1\dot\phi(\sigma)\dd\sigma=\\
        &=-\int_{\partial \Sigma}\kappa_{\mathrm{g}}\dd s+\phi(1)-\phi(0).
    \end{align}
    To complete the proof, we have to show that $\phi(1)-\phi(0)=2\pi$. This is done essentially by reducing it to the flat case via a continuous deformation of the metric.

    \begin{enumerate}[label=(\arabic*)]
        \item The number $\phi(1)-\phi(0)$ is a multiple of $2\pi$ since $\phi(0),\phi(1)$ are both choices of the abgle for $\dot\gamma(0)=\dot\gamma(1)$.
        \item Let $\delta$ be the standard metric on $\bbR^2$ (the Kronecker tensor). It is easy to check that for each $\lambda\in [0,1]$, the tensor 
        \[\sfg^\lambda\coloneqq \lambda\sfg+(1-\lambda)\delta\]
        is also a Riemannian metric. Let $(e_1^\lambda, e_2^\lambda)$ be a positively oriented local frame which is orthonormal w.r.t.\ $\sfg^\lambda$ and for which $e_1^\lambda$ is a positive multiple of $\partial_{x^1}$; then let $\phi^\lambda$ be a continuous choice of the angle between $e_1^\lambda$ and $\dot\gamma/\lVert\dot\gamma\rVert^\lambda$. The choice $\phi^\lambda$ clearly depends continuously on $\lambda$ (if we make $\phi^\lambda(0)$ vary continuously). Consequently, $\phi^\lambda(1)-\phi^\lambda(0)$ varies continuously with $\lambda$. Since it is always a multiple of $2\pi$, it must be constant.
        \item When $\lambda=0$, we have $e_1^\lambda=\partial_{x^1}$ and $e_2^\lambda=\partial_{x^2}$, and consequently $\phi^0$ is just a choice of the angle between the $x$-axis and $\dot\gamma$. 
    \end{enumerate}
    So $\phi^0(1)-\phi^0(0)$ is the \emph{total curvature} of $\gamma$, which is  $2\pi$ by the \emph{Hopf Umlaufsatz}: indeed, curvature is the rate of rotation of the tangent to the curve in $\bbR^2$, and so the total curvature is the total change of that angle. But it is easy to see that replacing the tangent line with the line passing through two different points $\gamma(s_1),\gamma(s_2)$, $s_1\leq s_2$, on the curve gives a homotopy, where the original angle is the value along the diagonal $s_1=s_2$, and the total change from $(s_1,s_2)=(0,0)$ to $(1,1)$ is independent of the path taken within the triangle $0\leq s_1\leq s_2\leq 1$. On the other hand, if $s_1=0$ if fixed and $s_2$ increases to $1$, the change is obviously $\pi$ assuming $\gamma$ is a simple closed curve, and similarly for the segment from $(0,1)$ to $(1,1)$.
\end{proof}


In the next theorem we consider a generalization of this result for \emph{piecewise smooth} curves. Namely, a \emph{polygon} in $\Sigma$ is a simple closed curve which is a smooth embedding on each interval $[t_i,t_{i+1}]$ of some partition $0=t_0<\cdots<t_{n+1}=1$. Thus, the one-sided derivatives $\dot\gamma(t_i\pm 0)$ exist but may not coincide. It is clear how to define the vertices and the edges of the polygon. At each vertex $\gamma(t_i)$ we also define the \emph{interior angle} $\iota_i$ as the oriented angle from $\dot\gamma(t_i+0)$ to $-\dot\gamma(t_i-0)$ (if they point in the same direction, then one defines the angle to be either $0$ or $2\pi$ based on the orientation of the nearby pairs $(\dot\gamma(t_i+\epsilon),-\dot\gamma(t_i-\epsilon))$ for small $\epsilon>0$).

Having defined the interior angle $\iota_i$, we define the \emph{discontinuity} $\delta_i$ of $\dot\gamma$ at $t_i$ by 
\[\delta_i\coloneqq \pi-\iota_i\in [-\pi,\pi].\]
This describes the oriented angle from $\dot\gamma(t_i-0)$ to $\dot\gamma(t_i+0)$.

\begin{thm}[Gauss-Bonnet formula (1827-1848) {{\cite[Thm.~6.6]{Spivak3}}}]\index{Equation!Gauss-Bonnet}
    In the setting of the preceding theorem, let $\partial M$ be a polygon with vertices $t_1,\ldots,t_n$ and discontinuities $\delta_1,\ldots,\delta_n$. Then 
    \[\int_\Sigma K\sfv_\sfg=-\oint_{\partial \Sigma}\kappa_{\mathrm{g}}\dd s-\sum_{i=1}^n\delta_i+2\pi=-\oint_{\partial \Sigma}\kappa_{\mathrm{g}}\dd s+\sum_{i=1}^n\iota_i+(2-n)\pi.\]
\end{thm}
\begin{proof}
    The proof proceeds much like in the previous theorem, except on each interval $[t_i,t_{i+1}]$ separately, leading to the sum $\sum_{i=1}^{n+1}(\phi_i(t_i)-\phi_i(t_{i-1}))$ instead of the single $\phi(1)-\phi(0)$. This equals $-\sum_{i=1}^n\delta_i+[\phi_{n+1}(1)-\phi_1(0)]$, so it remains only to show that the last term is $2\pi$. This is done in an obvious way by generalizing the Hopf Umlaufsatz by approximating the polygon with a smooth curve.
\end{proof}


\begin{cor}[{{\cite[Cor.~6.7]{Spivak3}}}]\label{cor 6.7 Spivak3}
    If the sides of the polygon in the last theorem are geodesics, then 
    \[\int_\Sigma K\sfv_\sfg=-\sum_{i=1}^n\delta_i+2\pi=\sum_{i=1}^n\iota_i+(2-n)\pi.\]
    In particular, for a geodesic triangle, the total Gauss curvature equals $\iota_1+\iota_2+\iota_3-\pi$.
\end{cor}

We are now ready to compute the total curvature of a \emph{closed surface}, i.e., a compact one with no boundary. We do this under the assumption that the surface has a \emph{triangulation}, i.e., a (finite in this case) collection  $\{\sigma_i\}$ of diffeomorphic images of the standard triangle (\emph{2-simplex}) $\Delta_2\coloneqq \{\bf{x}\in\bbR^3:0\leq x^i\leq 1,\; \sum_{i=1}^3 x^i=1\}$ such that if two of them intersect, then the intersection must be an edge or a vertex. It is a difficult theorem that every smooth surface has a triangulation (and an analogous statement holds for all smooth manifolds of any dimensionality). For a given triangulation of $\Sigma$, which we treat as a ``curved'' polyhedron, we let 
\[(V,E,F)\coloneqq \text{number of (vertices, edges, faces)}.\]
One can prove directly that the quantity $V-E+F$ is independent of the triangulation, but we will do so indirectly in the following main theorem.

\begin{thm}[Gauss-Bonnet-von Dyck (1888)]\index{Theorem!Gauss-Bonnet}\label{thm gauss-bonnet}
    If $(\Sigma,\sfg)$ is a closed (compact with no boundary) oriented Riemannian surface with Gaussian curvature $K$, canonical area form $\sfv_\sfg$, and some triangulation with numbers $(V,E,F)$ defined as above, then 
    \[\int_\Sigma K\sfv_\sfg=2\pi (V-E+F).\]
    In particular, the integer $(V-E+F)$ is not dependent neither on the triangulation nor on the metric, and is thus a topological invariant called the \emph{Euler characteristic} $\chi(\Sigma)$. \index{Euler characteristic!of a closed surface}
\end{thm}
\begin{proof}
    Let the triangulation consist of faces $\sigma_1,\ldots,\sigma_F$. Let $A_j,B_j,C_j$ be the three interior angles of $\sigma_j$. Then by Corollary~\ref{cor 6.7 Spivak3}
    \[\int_\Sigma K\sfv_\sfg=\sum_{j=1}^F \oint_{\partial \sigma_i}\kappa_{\mathrm{g}}\dd s+\sum_{j=1}^F(A_j+B_j+C_j)-\sum_{j=1}^F 3\pi +\sum_{j=1}^F 2\pi.\]
    Now we note the following equalities that lead to the asserted result.
    \begin{enumerate}[label=(\arabic*)]
        \item $\sum_j \oint \kappa_{\mathrm{g}}\dd s=0$, because each edge of the triangulation appears twice with opposite orientations.
        \item $\sum_j (A_j+B_j+C_j)=2\pi V$ since the sum of all interior angles occurring at each vertex is $2\pi$.
        \item $-\sum_j 3\pi=-3F\pi$. On the other hand, any triangulation has $3F=2E$ since $3F$ is the total number of edges of all faces, each edge being counted twice as it belongs to two faces. So, $-\sum_j 3\pi =2\pi (-E)$.
        \item $\sum_j 2\pi=2\pi F$.
    \end{enumerate}
\end{proof}

\begin{xca}
    It turns out that $\chi(\Sigma)$ completely classifies closed oriented surface up to homeomorphism. Show that a surface of genus $g$ has $\chi=2-2g$.
\end{xca}

The most immediate implications of this theorem are the connections between the bounds on the values of $K$ and the topology of $\Sigma$. For example, if $\Sigma$ admits a flat metric, then it must be (homeomorphic to) a torus, and if it admits a metric of everywhere positive curvature, then it must be a sphere. If $K$ is everywhere negative, then an upper bound on its values puts a lower bound on the genus $g>0$.

The following corollary has to do with the degree of the Gauss map. If $M$ and $N$ are both compact $n$-manifolds, then the \emph{(Brouwer) degree} of a map $f:M\to N$ is defined by the formula \index{Degree (Brouwer)}
\[\int_M f^\ast \omega=\deg f\cdot \int_N\omega\]
for any $\omega\in\Omega^n(N)$. For non-compact manifolds, the degree can also be defined for proper maps by requiring that $\omega$ have compact support. For now, we will not prove the surprising fact that $\deg f$ is an integer independent of $\omega$. In the case of $M=N=\bbS^n$, the degree is exactly the corresponding element of the homotopy group $\pi_n(\bbS^n)\cong\bbZ$ (where the generator of the group is given by the identity map).

\begin{cor}[{{\cite[Thm.~6.10]{Spivak3}}}]
    Let $\Sigma\subset\bbE^3$ be an embedded oriented closed surface and let $e_3:\Sigma\to \bbS^2$ be its Gauss map (normal vector). Then 
    \[\deg e_3=\frac12 \chi(\Sigma).\]
\end{cor}
\begin{proof}
    By definition of the degree, $\int_\Sigma e_3^\ast \omega=\deg e_3\cdot\int_{\bbS^2}\omega$ for all $\omega\in\Omega^2(\bbS^2)$. Choosing $\omega=\sfv_{\bbS^2}$ to be the standard are form on $\bbS^2$, this means that by (\ref{eq gauss map pullback})
    \[4\pi \deg e_3=\int_\Sigma e_3^\ast \sfv_{\bbS^2}=\int_\Sigma K \sfv_\sfg.\]
    Together with the Gauss-Bonnet Theorem, this yields the assertion.
\end{proof}

This relation between the degree and the Euler characteristic can also be proven directly, and in fact holds for hypersurfaces in $\bbE^n$ for any $n$. This was an important intermediate result on the way to the higher-dimensional generalization of the Gauss-Bonnet Theorem.

The final classical theorem involves the notion of the index of a vector field. For a vector field $X\in\fX(\Sigma)$ on a surface $\Sigma$, let $m_0\in \Sigma$ be an \emph{isolated zero}, i.e., $X\neq 0$ in a punctured open neighborhood $U\setminus\{m_0\}$ of $m_0$. Choose $U$ so that it is diffeomorphic to a disk. Then the \emph{index $\ind_{m_0}X$ of $X$ at $m_0$} is defined as the winding number of the map $\bbS^1\to \bbS^1$ given by \index{Index!of a vector field}
\[\bbS^1\ni p\mapsto X(i(p))/\lVert X(i(p))\rVert\in\bbS^1,\]
where $i:\bbS^1\to \partial U$ is a diffeomorphism and $\lVert\cdot\rVert$ is an arbitrary metric. It is easy to see that all possible choices of $U, i$, or the metric lead to homotopic maps, so the index is a well-defined invariant of $X$ itself. 

On a closed surface $\Sigma$, we will consider vector fields $X$ that have only isolated zeros. In this case there can only be finitely many zeros $m_1,\ldots,m_r$, and we define the \emph{(total) index} of $X$ as 
\[\ind X\coloneqq \sum_{i=1}^r \ind_{m_i}X.\]
One can prove directly that $\ind X=\chi(\Sigma)$ for any admissible $X$, as was first done by Poincar\'e in 1881. The idea is to first show that the index is independent of the particular vector field $X$, and then to associate to every triangulation a standard vector field as in Figure~\ref{fig poincare-hopf} whose index is manifestly $V-E+F$. Instead of detailing this argument, we will obtain the same result indirectly via the following theorem.

\begin{figure}[tp]
    \centering
    \includegraphics[scale=0.8]{figures/poincare-hopf.pdf}
    \caption{A standard vector field associated to a triangulation in the direct proof of Poincar\'e's Theorem. From \cite{Ivey}. \label{fig poincare-hopf}}
\end{figure}

\begin{thm}[Poincar\'e (1881) {{\cite[Thm.~6.9]{Spivak3}}}]\label{thm poincare-hopf}
    On a closed Riemannian surface $(\Sigma,\sfg)$ with Gaussian curvature $K$ and canonical area form $\sfv_\sfg$, let $X$ be a smooth vector fields with only isolated zeros. Then 
    \[\int_\Sigma K\sfv_\sfg=2\pi \ind X.\]
    In particular, $\ind X$ is independent of $X$ and hence is a topological invariant of $\Sigma$ equal to the Euler characteristic $\chi(\Sigma)$.
\end{thm}
\begin{proof}
    Let $m_1,\ldots,m_r$ be the zeros of $X$, and choose disjoint disks $D_i\subset \Sigma$ containing $m_i$. Each $D_i$ is diffeomorphic to the standard disk $\bbD^2=\{\bf{x}\in\bbR^2\mid \lVert\bf{x}\rVert\leq 1\}$, and we let $D_i(\epsilon)$ denote the set corresponding to $\lVert \bf{x}\rVert\leq \epsilon$. Let 
    \[\Sigma(\epsilon)\coloneqq \Sigma\setminus \left(\bigcup_i \mathring{D}_i(\epsilon)\right).\]
    On $\Sigma(\epsilon)$ there is a positively oriented local frame $(e_1,e_2)$ with $e_1=X/\lVert X\rVert$. Then 
    \[\int_{\Sigma(\epsilon)}K\sfv_\sfg=-\int_{\Sigma(\epsilon)}\dd \omega=-\sum_i \oint_{\partial D_i(\epsilon)} \omega.\]
    Consider one particular $i$. Let $(\wt e_1,\wt e_2)$ be a positively oriented orthonormal frame on $D_i$. On $D_i$ minus a line segment we have a differentiable choice of the angle $\theta$ between $e_1$ and $\wt e_1$, and by (\ref{eq 169}),
    \[-\oint_{\partial D_i(\epsilon)}\omega=\oint_{\partial D_i(\epsilon)} \dd\theta-\oint_{\partial D_i(\epsilon)}\wt\omega=\ind_{m_i}X-\oint_{\partial D_i(\epsilon)}\wt\omega,\]
    where $\wt\omega$ also depends on $i$. Therefore, 
    \[-\lim_{\epsilon\to 0}\oint_{\partial D_i(\epsilon)}\omega=\ind_{m_i}X,\]
    which concludes the proof.
\end{proof}

\begin{rem}
    We have thus proven the equivalence of three different ways of computing the Euler characteristic of a closed oriented surface: via a triangulation, via the index of a generic vector field, and via the total Gaussian curvature:
    \[\ind X=\chi(\Sigma)=\int_\Sigma K\sfv_\sfg.\]
    The generalization of the equality $\ind X=\chi(M)$ to closed manifolds $M$ of arbitrary dimensionality was obtained by Hopf in 1921 and is known as the Poincar\'e-Hopf Theorem. \index{Theorem!Poincar\'e-Hopf} Meanwhile, the generalization of the Gauss-Bonnet Theorem to closed oriented manifolds of arbitrary even dimensionality was completed by Chern in 1944 and is known as the Chern-Gauss-Bonnet Theorem. We will prove both of these generalizations as part of our discussion of characteristic classes.
\end{rem}




